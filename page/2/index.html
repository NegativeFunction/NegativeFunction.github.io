<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/logo.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/logo.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/logo.png">
  <link rel="mask-icon" href="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/logo.png" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"negativefunction.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Hope Sometimes Love Brain">
<meta property="og:type" content="website">
<meta property="og:title" content="Welcome To Lin&#39;s World">
<meta property="og:url" content="https://negativefunction.github.io/page/2/index.html">
<meta property="og:site_name" content="Welcome To Lin&#39;s World">
<meta property="og:description" content="Hope Sometimes Love Brain">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Linyuxuan">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://negativefunction.github.io/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Welcome To Lin's World</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Welcome To Lin's World</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">The Future Will Come</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">16</span></a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://negativefunction.github.io/2023/01/21/JVM/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/05.jpg">
      <meta itemprop="name" content="Linyuxuan">
      <meta itemprop="description" content="Hope Sometimes Love Brain">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Welcome To Lin's World">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/01/21/JVM/" class="post-title-link" itemprop="url">JVM</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2023-01-21 07:18:44 / Modified: 07:25:02" itemprop="dateCreated datePublished" datetime="2023-01-21T07:18:44+08:00">2023-01-21</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>JVM笔记</p>
<h2 id="Chapter1-JVM基础"><a href="#Chapter1-JVM基础" class="headerlink" title="Chapter1  JVM基础"></a>Chapter1  JVM基础</h2><h3 id="1-1-JVM基础知识"><a href="#1-1-JVM基础知识" class="headerlink" title="1.1 JVM基础知识"></a>1.1 JVM基础知识</h3><p>Java从代码到执行的过程。通常分为两个部分</p>
<ul>
<li>第一部分：javac部分将源代码文件通过javac指令生成相对应的class文件</li>
<li>第二部分：java部分 class文件通过classloader加载到内存中，需要相对应的java类库的支持，比如String.class或Object.class。调节字节码解释器或者JIT即时编译器，来进行解释和编译，编译之后会由执行引擎开始执行，执行引擎对应到操作系统和硬件，这个java指令部分的流程就是</li>
</ul>
<p>注意：<em>有时会将classloader和jaav类库部分划分出来，主要概念相差不多，具体划分也是为了理解</em></p>
<p>字节码和JIT即时编译：<br>本质上解释和编译是可以混合的，针对特别常用的代码，会将代码做成一种即时编译的状态，需要本地支持，在下一次使用时就不需要解释器对代码进行一行一行的解释执行。执行引擎可以将代码直接交到操作系统，使其进行调用。效率会提升很多。当然也不是所有代码都要被JIT即时编译后再执行，java是一门跨平台语言，如果它将所有代码都进行即时编译，那么就违背了它跨平台的特点。</p>
<h3 id="1-2-从跨平台语言"><a href="#1-2-从跨平台语言" class="headerlink" title="1.2 从跨平台语言"></a>1.2 从跨平台语言</h3><ul>
<li>跨平台的语言 —-Java</li>
<li>跨语言的平台 —-JVM</li>
</ul>
<p>JVM是跨语言的平台：JVM上除了执行Java语言，还支持很多其他语言，据调查大约有100多种语言都可以在JVM虚拟机上运行。<br>例如：java scala kotlin groovy clojure 通过Java Virtual Machine 都能对应到各类操作系统 Linux Unix Windows Mac Android</p>
<p><em><strong>JVM本质上是一种规范。JVM的出现帮我们更好的封装了直接对应操作系统的底层，包括Linux Unix Windows这样的系统</strong></em></p>
<p>在JVM上跑的语言需要满足的条件：<em><strong>能够生成class文件</strong></em></p>
<p>任何语言，只要能够生成class文件，则就能在JVM上进行执行：<br>任何语言—&gt;class—&gt;JVM</p>
<p>跨平台的概念：</p>
<p>当我们编写的java程序，在Linux Unix Windows等等操作系统上都可以不用修改其内容，直接执行，即此语言满足跨平台的概念。故而JVM和Java是没有任何关系的</p>
<p><em>JVM是一种规范，定义了java虚拟机能够执行的内容。</em></p>
<p>官网可以查看Java语言的版本规范和JVM的版本规范</p>
<p>虚拟机则是虚拟出来的机器</p>
<h3 id="1-3-常见JVM虚拟机"><a href="#1-3-常见JVM虚拟机" class="headerlink" title="1.3 常见JVM虚拟机"></a>1.3 常见JVM虚拟机</h3><p>Hotspot 是Oracle官方发行的JVM虚拟机，同样是实验使用相对较多的虚拟机。</p>
<p><em>在cmd中通过java -version指令能够看到我们安装的JVM是哪种实现</em></p>
<p>与Hotspot相似的JVM也有很多种：</p>
<ul>
<li>Jrokit –BEA 曾经号称世界上最快的JVM后被Oracle收购。并与Hotspot合并，提高了Hotspot性能。</li>
<li>J9 –IBM</li>
<li>Microsoft VM – Microsoft  IBM和微软都是较大的厂商，不会去依赖Oracle的平台，他们都有自己的平台。由于版本问题，他们都会去独立开发属于自己的平台，只有较大规模的企业才能实现。</li>
<li>TaoBaoVM –淘宝 Hotspot定制版 属于淘宝深度定制版虚拟机 阿里天猫都是使用的这款虚拟机。</li>
<li>LiquidVM 直接针对硬件操作 它本身是没有操作系统的，没有Linux与Unix，故而运行效率会更高。</li>
<li>Azul zing GC 虚拟机回收的业界标杆，使用成本极其昂贵，通常只有银行 电信会使用，平均垃圾回收都在1ms以内。</li>
</ul>
<p><em>通常能写JVM程序的整个阿里大约10人以内 通常需要达到P9 P10 P11的级别水准</em></p>
<p>Oracle在Hotspot8版本以后就不再提供免费升级了，更高级别的版本需要收费，根据企业去进行一定商业行为达到盈利目的。</p>
<p>JKD、JRE、JVM：</p>
<ul>
<li>JVM是本质一种代码规范，根据JVM规范写的代码平台，提供语言跨平台操作的特性<br>虚拟机–用于执行class文件 执行程序</li>
<li>JRE&#x3D;JVM+core lib<br>java程序运行时 除了需要虚拟机以外还需要java的核心代码包，提供java类库进行加载，支持java程序的运行</li>
<li>JDK&#x3D;JRE+development kit<br>java程序的开发工具包 JDK&#x3D;JRE+JVM</li>
</ul>
<h2 id="Chapter2-Class文件结构"><a href="#Chapter2-Class文件结构" class="headerlink" title="Chapter2  Class文件结构"></a>Chapter2  Class文件结构</h2><p>秋招 以及 招聘 中考的较少</p>
<h3 id="2-1-class-file-format"><a href="#2-1-class-file-format" class="headerlink" title="2.1 class file format"></a>2.1 class file format</h3><p>编写一个小测试项目，生成一个class文件，使用idea对class(.out.production.demo01.class)文件进行反编译，观察此生成的.class文件。理论上不论是什么格式的文件avi、doc等 其在内存中的表示都是0101010这样的二进制流</p>
<p>如何去查看classfile：</p>
<ol>
<li>SublimeText去查看.class文件</li>
<li>IDEA插件BinEd去查看</li>
</ol>
<p><em>在file—&gt;Open As Binary…下打开的文件则是以二进制流形式表示</em></p>
<p>由此可以看出classfile本质就是二进制文件的字节流</p>
<p>class文件是一组以8字节为基础单位的二进制字节流，各项数据项目会严格按照顺序紧凑排列在class文件种，中间没有任何分隔符，使得class文件中存储的内容即是全部程序运行的内容。</p>
<h3 id="2-2-class文件结构的解析"><a href="#2-2-class文件结构的解析" class="headerlink" title="2.2 class文件结构的解析"></a>2.2 class文件结构的解析</h3><p>java虚拟机规范规定class文件格式采用类似C语言结构体的伪结构来存储数据，这种结构只有两种数据类型： 无符号数 和 表 。</p>
<ul>
<li>无符号数<br>属于基本数据类型，主要用来描述数字、索引符号、数量值或按照UTF-8编码构成字符串的值<br>数据类型：u1 u2 u4 u8 该数据类型是从逻辑上分类，分别表示1字节 2字节 4字节 8字节</li>
<li>表：是由多个无符号或者其他表作为数据项构成的符合数据类型，所有表都习惯以_info 来结尾。表主要用于描述有层次关系的复合结构数据，比如：方法、字段等，需要注意的是class文件没有分隔符，故而每个二进制数据类型都是严格定义的，具体顺序如下：</li>
</ul>
<table>
<thead>
<tr>
<th>类型</th>
<th>名称</th>
<th>数量</th>
</tr>
</thead>
<tbody><tr>
<td>u4</td>
<td>magic魔术</td>
<td>1</td>
</tr>
<tr>
<td>u3</td>
<td>minor_version次版本号</td>
<td>1</td>
</tr>
<tr>
<td>u2</td>
<td>major_version主版本号</td>
<td>1</td>
</tr>
<tr>
<td>u2</td>
<td>constant_pool_count常量个数</td>
<td>1</td>
</tr>
<tr>
<td>cp_info</td>
<td>constant_pool常量池表</td>
<td>constant_pool_count-1</td>
</tr>
<tr>
<td>u2</td>
<td>access_flags类的访问控制权限</td>
<td>1</td>
</tr>
<tr>
<td>u2</td>
<td>this_class类名</td>
<td>1</td>
</tr>
<tr>
<td>u2</td>
<td>super_class父类名</td>
<td>1</td>
</tr>
<tr>
<td>u2</td>
<td>interface_count接口个数</td>
<td>1</td>
</tr>
<tr>
<td>u2</td>
<td>interfaces接口名</td>
<td>interfaces_count</td>
</tr>
<tr>
<td>u2</td>
<td>fields_count域个数</td>
<td>1</td>
</tr>
<tr>
<td>field_info</td>
<td>fields域的表</td>
<td>fields_count</td>
</tr>
<tr>
<td>u2</td>
<td>methods_count方法的个数</td>
<td>1</td>
</tr>
<tr>
<td>method_info</td>
<td>methods方法表</td>
<td>methods_count</td>
</tr>
<tr>
<td>u2</td>
<td>attributes_count附加表属性的个数</td>
<td>1</td>
</tr>
<tr>
<td>attribute_info</td>
<td>attributes附加属性的表</td>
<td>attributes_count</td>
</tr>
</tbody></table>
<h4 id="2-2-1-魔数"><a href="#2-2-1-魔数" class="headerlink" title="2.2.1 魔数"></a>2.2.1 魔数</h4><ol>
<li>每个class文件的前4个字节称为魔数magicNumber</li>
<li>魔数唯一作用就是确定这个文件是否为能够被虚拟机接受的class文件</li>
<li>class文件魔数值为0xCAFEBABE，如果文件不是以0xCAFEBABE为开头，则此文件一定不是java的class文件</li>
<li>0xCAFEBABE是class文件的识别魔数</li>
</ol>
<p><em>很多文件存储标准中都使用魔数来进行身份识别，比如 图片格式 .gif .jpeg在文件头部中都存有魔数的使用，使用魔数而不是使用扩展名是基于安全性的考虑，扩展名则是可以随意更改的</em></p>
<h4 id="2-2-2-class文件版本号"><a href="#2-2-2-class文件版本号" class="headerlink" title="2.2.2 class文件版本号"></a>2.2.2 class文件版本号</h4><p>在魔数4个字节后是class文件的版本号，版本号有：</p>
<ul>
<li>次版本号：minor_version 前2个字节用于表示次版本号<br>例如：00 00</li>
<li>主版本号：magic_version 后2个字节用于表示主版本号<br>例如：00 34</li>
</ul>
<p>版本号随着JDK的不同而表示不同的版本范围。Java版本号是从45开始的，如果class文件的版本号超过虚拟机版本则将被拒绝执行</p>
<p>0x0034(对应十进制52)：JDK1.8版本</p>
<p>0x0034(对应十进制51)：JDK1.7版本</p>
<p>0x0034(对应十进制50)：JDK1.6版本</p>
<h4 id="2-2-3-常量池"><a href="#2-2-3-常量池" class="headerlink" title="2.2.3 常量池"></a>2.2.3 常量池</h4><p>魔数与版本号之后的是常量池，常量池可以理解为class文件的资源库</p>
<p>常量池特点：</p>
<ol>
<li>常量池是class文件结构中与其他项目关联最多的数据类型</li>
<li>常量池是占用class文件空间最大的数据项目之一</li>
<li>常量池是在文件中第一个出现的表类型数据项目</li>
</ol>
<p><em>由于常量池中常量的数量是不固定的，所以常量池的入口需要放置任意u2类型的数据，代表常量池容量的计数值constant_pool_count</em></p>
<blockquote>
<p>constant_pool_count是从1开始计数的。在class文件结构中只有常量池的容量计数是从1开始的。第0个空出来满足后面某些指向常量池索引值的数据在特定情况下需要表达”不引用任何一个常量池项目“的意思，此时将索引值置为0来表示(即留给自己的虚拟机来使用)。尽管constant_pool列表中没有索引值为0的入口，但缺失的入口同样也被constant_pool_count技术在内。例如当constant_pool中存在14项，则constant_pool_count的值为15</p>
</blockquote>
<p>常量池中主要存放两大类常量：</p>
<ul>
<li>字面量：比较接近于Java语言的常量概念，例如：文本字符串、声明为final的常量值等</li>
<li>符号引用：属于编译原理理念包括有<ul>
<li>类和接口的全限定名</li>
<li>字段名称和描述符</li>
<li>方法名称和描述符</li>
</ul>
</li>
</ul>
<blockquote>
<p>java代码在进行编译的过程中，不像C++与C有”连接“这样的步骤，而是在虚拟机加载class文件的时候进行动态连接，即在class文件中不会保存各个方法嗯好字段的最终内存布局信息。因为这些字段和方法的符号引用如果不经过转换，则无法被虚拟机使用。当虚拟机运行时，需要从常量池中获得对应的符号引用，然后在类的创建或运行时解析并翻译到具体的内存地址中。</p>
<p>constant_pool_count占2个字节0x0020转换成十进制为32 也就是说明常量池中有31个常量。(常量池技术是从1就开始的。其他集合类型均为从0开始)索引值为1~31，第0项具有特殊意义。</p>
<p>constant_pool表示类型数据集合，即常量池中每一项常量都是一个表，1.8版本中有14种(在1.7版本中有11种)结构各不相同的表结构数据。这14种表都有一个共同的特点，均由一个u1类型的标志位开始，可以通过标志位来判断这个常量属于哪种常量类型</p>
</blockquote>
<p>常量类型及其数据结构 –见表格</p>
<table>
<thead>
<tr>
<th>编号</th>
<th>tag位标识数值表示</th>
<th>数据类型</th>
<th>格式</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>1</td>
<td>CONSTANT_UTF8_info</td>
<td>2-byte unsigned integer<br />Bytes</td>
<td>Length of the bytes Text</td>
</tr>
<tr>
<td>2</td>
<td>3</td>
<td>CONSTANT_Integer_info</td>
<td>4-byte signed integer</td>
<td>int constant</td>
</tr>
<tr>
<td>3</td>
<td>4</td>
<td>CONSTANT_Float_info</td>
<td>4-byte floating-point number</td>
<td>float constant</td>
</tr>
<tr>
<td>4</td>
<td>5</td>
<td>CONSTANT_Long_info</td>
<td>8-byte signed long integer</td>
<td>long constant</td>
</tr>
<tr>
<td>5</td>
<td>6</td>
<td>CONSTANT_Double_info</td>
<td>8-byte double-precision number</td>
<td>double constant</td>
</tr>
<tr>
<td>6</td>
<td>7</td>
<td>CONSTANT_Class_info</td>
<td>2-byte UTF8 index</td>
<td>Names a class</td>
</tr>
<tr>
<td>7</td>
<td>8</td>
<td>CONSTANT_String_info</td>
<td>2-byte UTF8 index</td>
<td>String constant</td>
</tr>
<tr>
<td>8</td>
<td>9</td>
<td>CONSTANT_Fieldref_info</td>
<td>2-byte Class index</td>
<td>Class containing the field</td>
</tr>
<tr>
<td>9</td>
<td>10</td>
<td>CONSTANT_Methodref_info</td>
<td>2-byte NameAndType index</td>
<td>Field name and type</td>
</tr>
<tr>
<td>10</td>
<td>11</td>
<td>CONSTANT_InterfaceMethodref_info</td>
<td>2-byte Class index<br />2-byte NameAndType index</td>
<td>Class containing the method</td>
</tr>
<tr>
<td>11</td>
<td>12</td>
<td>CONSTANT_NameAndType_info</td>
<td>2-byte Class index<br />2-byte NameAndType index</td>
<td>Interface containing the method Method name the type</td>
</tr>
</tbody></table>
<h4 id="2-2-4-access-flags"><a href="#2-2-4-access-flags" class="headerlink" title="2.2.4 access_flags"></a>2.2.4 access_flags</h4><p>access_flags标志的掩码，用于对该类或接口的访问权限以及该类或接口的属性</p>
<table>
<thead>
<tr>
<th>标志名称</th>
<th>Value</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>ACC_PUBLIC</td>
<td>0x0001</td>
<td>宣布public修饰，可以从太不进行访问</td>
</tr>
<tr>
<td>ACC_FINAL</td>
<td>0x0010</td>
<td>被final修饰，不允许子类继承 重写</td>
</tr>
<tr>
<td>ACC_SUPER</td>
<td>0x0020</td>
<td>如何调用父类的方法</td>
</tr>
<tr>
<td>ACC_INTERFACE</td>
<td>0x0200</td>
<td>标识这是一个接口</td>
</tr>
<tr>
<td>ACC_ABSTRACT</td>
<td>0x0400</td>
<td>这是一个抽象类，不能实例化</td>
</tr>
<tr>
<td>ACC_SYNTHETIC</td>
<td>0x1000</td>
<td>表示合成，源码中不存在</td>
</tr>
<tr>
<td>ACC_ANNOTATION</td>
<td>0x2000</td>
<td>声明这是一个注解类型</td>
</tr>
<tr>
<td>ACC_ENUM</td>
<td>0x4000</td>
<td>声明这是一个枚举类型</td>
</tr>
</tbody></table>
<h4 id="2-2-5-this-class"><a href="#2-2-5-this-class" class="headerlink" title="2.2.5 this_class"></a>2.2.5 this_class</h4><p>this_class必须是constant_pool表中的有效索引，constant_pool索引处的条目必须是表示此文件定义的类或接口的constant_class_info结构.class</p>
<h4 id="2-2-6-super-class"><a href="#2-2-6-super-class" class="headerlink" title="2.2.6 super_class"></a>2.2.6 super_class</h4><p>对于一个类，super_class值必须为零或者必须是constant_pool表中的有效索引，如果super_class不为零，则constant_pool条目必须为constant_class_info的结构，该结构表示类在文件定义类中的直接超类，直接超类或其他任何超类都不能在其ClassFile的access_fiags项中设置ACC_FINAL标志</p>
<p><em>观察bytecode的方法：</em></p>
<ol>
<li><p>Javap</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br></pre></td><td class="code"><pre><span class="line">javap -v E:\aPersonalData\SpringFrameProjects\Demo01\out\production\Demo01\Solution01.class</span><br><span class="line"><span class="function">C:\<span class="title">Users</span>\黎明&gt;<span class="title">javap</span> -<span class="title">v</span> <span class="title">E</span>:\<span class="title">aPersonalData</span>\<span class="title">SpringFrameProjects</span>\<span class="title">Demo01</span>\<span class="title">out</span>\<span class="title">production</span>\<span class="title">Demo01</span>\<span class="title">Solution01.class</span></span></span><br><span class="line"><span class="function"><span class="title">Classfile</span> /<span class="title">E</span>:/<span class="title">aPersonalData</span>/<span class="title">SpringFrameProjects</span>/<span class="title">Demo01</span>/<span class="title">out</span>/<span class="title">production</span>/<span class="title">Demo01</span>/<span class="title">Solution01.class</span></span></span><br><span class="line"><span class="function">  <span class="title">Last</span> <span class="title">modified</span> 2022-7-8; <span class="title">size</span> 1925 <span class="title">bytes</span></span></span><br><span class="line"><span class="function">  <span class="title">MD5</span> <span class="title">checksum</span> 8<span class="title">cc678a13dcd5f4c9a8b1188c9a442c6</span></span></span><br><span class="line"><span class="function">  <span class="title">Compiled</span> <span class="title">from</span> &quot;<span class="title">Solution01.java</span>&quot;</span></span><br><span class="line"><span class="function"><span class="title">class</span> <span class="title">Solution01</span></span></span><br><span class="line"><span class="function">  <span class="title">minor</span> <span class="title">version</span>: 0</span></span><br><span class="line"><span class="function">  <span class="title">major</span> <span class="title">version</span>: 52</span></span><br><span class="line"><span class="function">  <span class="title">flags</span>: <span class="title">ACC_SUPER</span></span></span><br><span class="line"><span class="function"><span class="title">Constant</span> <span class="title">pool</span>:</span></span><br><span class="line"><span class="function">    #1 = <span class="title">Methodref</span>          #22.#58       // <span class="title">java</span>/<span class="title">lang</span>/<span class="title">Object</span>.&quot;&lt;<span class="title">init</span>&gt;&quot;:()<span class="title">V</span></span></span><br><span class="line"><span class="function">    #2 = <span class="title">Methodref</span>          #21.#59       // <span class="title">Solution01.twoSum</span>:([<span class="title">II</span>)[[<span class="title">I</span></span></span><br><span class="line"><span class="function">    #3 = <span class="title">Fieldref</span>           #60.#61       // <span class="title">java</span>/<span class="title">lang</span>/<span class="title">System.out:Ljava</span>/<span class="title">io</span>/<span class="title">PrintStream</span>;</span></span><br><span class="line"><span class="function">    #4 = <span class="title">Methodref</span>          #62.#63       // <span class="title">java</span>/<span class="title">util</span>/<span class="title">Arrays.toString</span>:([<span class="title">I</span>)<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">String</span>;</span></span><br><span class="line"><span class="function">    #5 = <span class="title">Methodref</span>          #64.#65       // <span class="title">java</span>/<span class="title">io</span>/<span class="title">PrintStream.println</span>:(<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">String</span>;)<span class="title">V</span></span></span><br><span class="line"><span class="function">    #6 = <span class="title">Class</span>              #66           // <span class="title">java</span>/<span class="title">util</span>/<span class="title">HashMap</span></span></span><br><span class="line"><span class="function">    #7 = <span class="title">Methodref</span>          #6.#58        // <span class="title">java</span>/<span class="title">util</span>/<span class="title">HashMap</span>.&quot;&lt;<span class="title">init</span>&gt;&quot;:()<span class="title">V</span></span></span><br><span class="line"><span class="function">    #8 = <span class="title">Methodref</span>          #67.#68       // <span class="title">java</span>/<span class="title">lang</span>/<span class="title">Math.min</span>:(<span class="title">II</span>)<span class="title">I</span></span></span><br><span class="line"><span class="function">    #9 = <span class="title">Methodref</span>          #18.#69       // <span class="title">java</span>/<span class="title">lang</span>/<span class="title">Integer.valueOf</span>:(<span class="title">I</span>)<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">Integer</span>;</span></span><br><span class="line"><span class="function">   #10 = <span class="title">Methodref</span>          #67.#70       // <span class="title">java</span>/<span class="title">lang</span>/<span class="title">Math.max</span>:(<span class="title">II</span>)<span class="title">I</span></span></span><br><span class="line"><span class="function">   #11 = <span class="title">Methodref</span>          #6.#71        // <span class="title">java</span>/<span class="title">util</span>/<span class="title">HashMap.put</span>:(<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">Object</span>;<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">Object</span>;)<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">Object</span>;</span></span><br><span class="line"><span class="function">   #12 = <span class="title">Methodref</span>          #6.#72        // <span class="title">java</span>/<span class="title">util</span>/<span class="title">HashMap.size</span>:()<span class="title">I</span></span></span><br><span class="line"><span class="function">   #13 = <span class="title">Class</span>              #40           // &quot;[[<span class="title">I</span>&quot;</span></span><br><span class="line"><span class="function">   #14 = <span class="title">Methodref</span>          #6.#73        // <span class="title">java</span>/<span class="title">util</span>/<span class="title">HashMap.keySet</span>:()<span class="title">Ljava</span>/<span class="title">util</span>/<span class="title">Set</span>;</span></span><br><span class="line"><span class="function">   #15 = <span class="title">InterfaceMethodref</span> #74.#75       // <span class="title">java</span>/<span class="title">util</span>/<span class="title">Set.iterator</span>:()<span class="title">Ljava</span>/<span class="title">util</span>/<span class="title">Iterator</span>;</span></span><br><span class="line"><span class="function">   #16 = <span class="title">InterfaceMethodref</span> #76.#77       // <span class="title">java</span>/<span class="title">util</span>/<span class="title">Iterator.hasNext</span>:()<span class="title">Z</span></span></span><br><span class="line"><span class="function">   #17 = <span class="title">InterfaceMethodref</span> #76.#78       // <span class="title">java</span>/<span class="title">util</span>/<span class="title">Iterator.next</span>:()<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">Object</span>;</span></span><br><span class="line"><span class="function">   #18 = <span class="title">Class</span>              #79           // <span class="title">java</span>/<span class="title">lang</span>/<span class="title">Integer</span></span></span><br><span class="line"><span class="function">   #19 = <span class="title">Methodref</span>          #18.#80       // <span class="title">java</span>/<span class="title">lang</span>/<span class="title">Integer.intValue</span>:()<span class="title">I</span></span></span><br><span class="line"><span class="function">   #20 = <span class="title">Methodref</span>          #6.#81        // <span class="title">java</span>/<span class="title">util</span>/<span class="title">HashMap.get</span>:(<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">Object</span>;)<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">Object</span>;</span></span><br><span class="line"><span class="function">   #21 = <span class="title">Class</span>              #82           // <span class="title">Solution01</span></span></span><br><span class="line"><span class="function">   #22 = <span class="title">Class</span>              #83           // <span class="title">java</span>/<span class="title">lang</span>/<span class="title">Object</span></span></span><br><span class="line"><span class="function">   #23 = <span class="title">Utf8</span>               &lt;<span class="title">init</span>&gt;</span></span><br><span class="line"><span class="function">   #24 = <span class="title">Utf8</span>               ()<span class="title">V</span></span></span><br><span class="line"><span class="function">   #25 = <span class="title">Utf8</span>               <span class="title">Code</span></span></span><br><span class="line"><span class="function">   #26 = <span class="title">Utf8</span>               <span class="title">LineNumberTable</span></span></span><br><span class="line"><span class="function">   #27 = <span class="title">Utf8</span>               <span class="title">LocalVariableTable</span></span></span><br><span class="line"><span class="function">   #28 = <span class="title">Utf8</span>               <span class="title">this</span></span></span><br><span class="line"><span class="function">   #29 = <span class="title">Utf8</span>               <span class="title">LSolution01</span>;</span></span><br><span class="line"><span class="function">   #30 = <span class="title">Utf8</span>               <span class="title">main</span></span></span><br><span class="line"><span class="function">   #31 = <span class="title">Utf8</span>               ([<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">String</span>;)<span class="title">V</span></span></span><br><span class="line"><span class="function">   #32 = <span class="title">Utf8</span>               <span class="title">i</span></span></span><br><span class="line"><span class="function">   #33 = <span class="title">Utf8</span>               <span class="title">I</span></span></span><br><span class="line"><span class="function">   #34 = <span class="title">Utf8</span>               <span class="title">args</span></span></span><br><span class="line"><span class="function">   #35 = <span class="title">Utf8</span>               [<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">String</span>;</span></span><br><span class="line"><span class="function">   #36 = <span class="title">Utf8</span>               <span class="title">nums</span></span></span><br><span class="line"><span class="function">   #37 = <span class="title">Utf8</span>               [<span class="title">I</span></span></span><br><span class="line"><span class="function">   #38 = <span class="title">Utf8</span>               <span class="title">target</span></span></span><br><span class="line"><span class="function">   #39 = <span class="title">Utf8</span>               <span class="title">result</span></span></span><br><span class="line"><span class="function">   #40 = <span class="title">Utf8</span>               [[<span class="title">I</span></span></span><br><span class="line"><span class="function">   #41 = <span class="title">Utf8</span>               <span class="title">StackMapTable</span></span></span><br><span class="line"><span class="function">   #42 = <span class="title">Class</span>              #35           // &quot;[<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">String</span>;&quot;</span></span><br><span class="line"><span class="function">   #43 = <span class="title">Class</span>              #37           // &quot;[<span class="title">I</span>&quot;</span></span><br><span class="line"><span class="function">   #44 = <span class="title">Utf8</span>               <span class="title">twoSum</span></span></span><br><span class="line"><span class="function">   #45 = <span class="title">Utf8</span>               ([<span class="title">II</span>)[[<span class="title">I</span></span></span><br><span class="line"><span class="function">   #46 = <span class="title">Utf8</span>               <span class="title">j</span></span></span><br><span class="line"><span class="function">   #47 = <span class="title">Utf8</span>               <span class="title">key</span></span></span><br><span class="line"><span class="function">   #48 = <span class="title">Utf8</span>               <span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">Integer</span>;</span></span><br><span class="line"><span class="function">   #49 = <span class="title">Utf8</span>               <span class="title">map</span></span></span><br><span class="line"><span class="function">   #50 = <span class="title">Utf8</span>               <span class="title">Ljava</span>/<span class="title">util</span>/<span class="title">HashMap</span>;</span></span><br><span class="line"><span class="function">   #51 = <span class="title">Utf8</span>               <span class="title">index</span></span></span><br><span class="line"><span class="function">   #52 = <span class="title">Utf8</span>               <span class="title">LocalVariableTypeTable</span></span></span><br><span class="line"><span class="function">   #53 = <span class="title">Utf8</span>               <span class="title">Ljava</span>/<span class="title">util</span>/<span class="title">HashMap</span>&lt;<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">Integer</span>;<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">Integer</span>;&gt;;</span></span><br><span class="line"><span class="function">   #54 = <span class="title">Class</span>              #66           // <span class="title">java</span>/<span class="title">util</span>/<span class="title">HashMap</span></span></span><br><span class="line"><span class="function">   #55 = <span class="title">Class</span>              #84           // <span class="title">java</span>/<span class="title">util</span>/<span class="title">Iterator</span></span></span><br><span class="line"><span class="function">   #56 = <span class="title">Utf8</span>               <span class="title">SourceFile</span></span></span><br><span class="line"><span class="function">   #57 = <span class="title">Utf8</span>               <span class="title">Solution01.java</span></span></span><br><span class="line"><span class="function">   #58 = <span class="title">NameAndType</span>        #23:#24       // &quot;&lt;<span class="title">init</span>&gt;&quot;:()<span class="title">V</span></span></span><br><span class="line"><span class="function">   #59 = <span class="title">NameAndType</span>        #44:#45       // <span class="title">twoSum</span>:([<span class="title">II</span>)[[<span class="title">I</span></span></span><br><span class="line"><span class="function">   #60 = <span class="title">Class</span>              #85           // <span class="title">java</span>/<span class="title">lang</span>/<span class="title">System</span></span></span><br><span class="line"><span class="function">   #61 = <span class="title">NameAndType</span>        #86:#87       // <span class="title">out:Ljava</span>/<span class="title">io</span>/<span class="title">PrintStream</span>;</span></span><br><span class="line"><span class="function">   #62 = <span class="title">Class</span>              #88           // <span class="title">java</span>/<span class="title">util</span>/<span class="title">Arrays</span></span></span><br><span class="line"><span class="function">   #63 = <span class="title">NameAndType</span>        #89:#90       // <span class="title">toString</span>:([<span class="title">I</span>)<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">String</span>;</span></span><br><span class="line"><span class="function">   #64 = <span class="title">Class</span>              #91           // <span class="title">java</span>/<span class="title">io</span>/<span class="title">PrintStream</span></span></span><br><span class="line"><span class="function">   #65 = <span class="title">NameAndType</span>        #92:#93       // <span class="title">println</span>:(<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">String</span>;)<span class="title">V</span></span></span><br><span class="line"><span class="function">   #66 = <span class="title">Utf8</span>               <span class="title">java</span>/<span class="title">util</span>/<span class="title">HashMap</span></span></span><br><span class="line"><span class="function">   #67 = <span class="title">Class</span>              #94           // <span class="title">java</span>/<span class="title">lang</span>/<span class="title">Math</span></span></span><br><span class="line"><span class="function">   #68 = <span class="title">NameAndType</span>        #95:#96       // <span class="title">min</span>:(<span class="title">II</span>)<span class="title">I</span></span></span><br><span class="line"><span class="function">   #69 = <span class="title">NameAndType</span>        #97:#98       // <span class="title">valueOf</span>:(<span class="title">I</span>)<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">Integer</span>;</span></span><br><span class="line"><span class="function">   #70 = <span class="title">NameAndType</span>        #99:#96       // <span class="title">max</span>:(<span class="title">II</span>)<span class="title">I</span></span></span><br><span class="line"><span class="function">   #71 = <span class="title">NameAndType</span>        #100:#101     // <span class="title">put</span>:(<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">Object</span>;<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">Object</span>;)<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">Object</span>;</span></span><br><span class="line"><span class="function">   #72 = <span class="title">NameAndType</span>        #102:#103     // <span class="title">size</span>:()<span class="title">I</span></span></span><br><span class="line"><span class="function">   #73 = <span class="title">NameAndType</span>        #104:#105     // <span class="title">keySet</span>:()<span class="title">Ljava</span>/<span class="title">util</span>/<span class="title">Set</span>;</span></span><br><span class="line"><span class="function">   #74 = <span class="title">Class</span>              #106          // <span class="title">java</span>/<span class="title">util</span>/<span class="title">Set</span></span></span><br><span class="line"><span class="function">   #75 = <span class="title">NameAndType</span>        #107:#108     // <span class="title">iterator</span>:()<span class="title">Ljava</span>/<span class="title">util</span>/<span class="title">Iterator</span>;</span></span><br><span class="line"><span class="function">   #76 = <span class="title">Class</span>              #84           // <span class="title">java</span>/<span class="title">util</span>/<span class="title">Iterator</span></span></span><br><span class="line"><span class="function">   #77 = <span class="title">NameAndType</span>        #109:#110     // <span class="title">hasNext</span>:()<span class="title">Z</span></span></span><br><span class="line"><span class="function">   #78 = <span class="title">NameAndType</span>        #111:#112     // <span class="title">next</span>:()<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">Object</span>;</span></span><br><span class="line"><span class="function">   #79 = <span class="title">Utf8</span>               <span class="title">java</span>/<span class="title">lang</span>/<span class="title">Integer</span></span></span><br><span class="line"><span class="function">   #80 = <span class="title">NameAndType</span>        #113:#103     // <span class="title">intValue</span>:()<span class="title">I</span></span></span><br><span class="line"><span class="function">   #81 = <span class="title">NameAndType</span>        #114:#115     // <span class="title">get</span>:(<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">Object</span>;)<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">Object</span>;</span></span><br><span class="line"><span class="function">   #82 = <span class="title">Utf8</span>               <span class="title">Solution01</span></span></span><br><span class="line"><span class="function">   #83 = <span class="title">Utf8</span>               <span class="title">java</span>/<span class="title">lang</span>/<span class="title">Object</span></span></span><br><span class="line"><span class="function">   #84 = <span class="title">Utf8</span>               <span class="title">java</span>/<span class="title">util</span>/<span class="title">Iterator</span></span></span><br><span class="line"><span class="function">   #85 = <span class="title">Utf8</span>               <span class="title">java</span>/<span class="title">lang</span>/<span class="title">System</span></span></span><br><span class="line"><span class="function">   #86 = <span class="title">Utf8</span>               <span class="title">out</span></span></span><br><span class="line"><span class="function">   #87 = <span class="title">Utf8</span>               <span class="title">Ljava</span>/<span class="title">io</span>/<span class="title">PrintStream</span>;</span></span><br><span class="line"><span class="function">   #88 = <span class="title">Utf8</span>               <span class="title">java</span>/<span class="title">util</span>/<span class="title">Arrays</span></span></span><br><span class="line"><span class="function">   #89 = <span class="title">Utf8</span>               <span class="title">toString</span></span></span><br><span class="line"><span class="function">   #90 = <span class="title">Utf8</span>               ([<span class="title">I</span>)<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">String</span>;</span></span><br><span class="line"><span class="function">   #91 = <span class="title">Utf8</span>               <span class="title">java</span>/<span class="title">io</span>/<span class="title">PrintStream</span></span></span><br><span class="line"><span class="function">   #92 = <span class="title">Utf8</span>               <span class="title">println</span></span></span><br><span class="line"><span class="function">   #93 = <span class="title">Utf8</span>               (<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">String</span>;)<span class="title">V</span></span></span><br><span class="line"><span class="function">   #94 = <span class="title">Utf8</span>               <span class="title">java</span>/<span class="title">lang</span>/<span class="title">Math</span></span></span><br><span class="line"><span class="function">   #95 = <span class="title">Utf8</span>               <span class="title">min</span></span></span><br><span class="line"><span class="function">   #96 = <span class="title">Utf8</span>               (<span class="title">II</span>)<span class="title">I</span></span></span><br><span class="line"><span class="function">   #97 = <span class="title">Utf8</span>               <span class="title">valueOf</span></span></span><br><span class="line"><span class="function">   #98 = <span class="title">Utf8</span>               (<span class="title">I</span>)<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">Integer</span>;</span></span><br><span class="line"><span class="function">   #99 = <span class="title">Utf8</span>               <span class="title">max</span></span></span><br><span class="line"><span class="function">  #100 = <span class="title">Utf8</span>               <span class="title">put</span></span></span><br><span class="line"><span class="function">  #101 = <span class="title">Utf8</span>               (<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">Object</span>;<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">Object</span>;)<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">Object</span>;</span></span><br><span class="line"><span class="function">  #102 = <span class="title">Utf8</span>               <span class="title">size</span></span></span><br><span class="line"><span class="function">  #103 = <span class="title">Utf8</span>               ()<span class="title">I</span></span></span><br><span class="line"><span class="function">  #104 = <span class="title">Utf8</span>               <span class="title">keySet</span></span></span><br><span class="line"><span class="function">  #105 = <span class="title">Utf8</span>               ()<span class="title">Ljava</span>/<span class="title">util</span>/<span class="title">Set</span>;</span></span><br><span class="line"><span class="function">  #106 = <span class="title">Utf8</span>               <span class="title">java</span>/<span class="title">util</span>/<span class="title">Set</span></span></span><br><span class="line"><span class="function">  #107 = <span class="title">Utf8</span>               <span class="title">iterator</span></span></span><br><span class="line"><span class="function">  #108 = <span class="title">Utf8</span>               ()<span class="title">Ljava</span>/<span class="title">util</span>/<span class="title">Iterator</span>;</span></span><br><span class="line"><span class="function">  #109 = <span class="title">Utf8</span>               <span class="title">hasNext</span></span></span><br><span class="line"><span class="function">  #110 = <span class="title">Utf8</span>               ()<span class="title">Z</span></span></span><br><span class="line"><span class="function">  #111 = <span class="title">Utf8</span>               <span class="title">next</span></span></span><br><span class="line"><span class="function">  #112 = <span class="title">Utf8</span>               ()<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">Object</span>;</span></span><br><span class="line"><span class="function">  #113 = <span class="title">Utf8</span>               <span class="title">intValue</span></span></span><br><span class="line"><span class="function">  #114 = <span class="title">Utf8</span>               <span class="title">get</span></span></span><br><span class="line"><span class="function">  #115 = <span class="title">Utf8</span>               (<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">Object</span>;)<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">Object</span>;</span></span><br><span class="line"><span class="function">&#123;</span></span><br><span class="line"><span class="function">  <span class="title">Solution01</span>();</span></span><br><span class="line"><span class="function">    <span class="title">descriptor</span>: ()<span class="title">V</span></span></span><br><span class="line"><span class="function">    <span class="title">flags</span>:</span></span><br><span class="line"><span class="function">    <span class="title">Code</span>:</span></span><br><span class="line"><span class="function">      <span class="title">stack</span>=1, <span class="title">locals</span>=1, <span class="title">args_size</span>=1</span></span><br><span class="line"><span class="function">         0: <span class="title">aload_0</span></span></span><br><span class="line"><span class="function">         1: <span class="title">invokespecial</span> #1                  // <span class="title">Method</span> <span class="title">java</span>/<span class="title">lang</span>/<span class="title">Object</span>.&quot;&lt;<span class="title">init</span>&gt;&quot;:()<span class="title">V</span></span></span><br><span class="line"><span class="function">         4: <span class="title">return</span></span></span><br><span class="line"><span class="function">      <span class="title">LineNumberTable</span>:</span></span><br><span class="line"><span class="function">        <span class="title">line</span> 3: 0</span></span><br><span class="line"><span class="function">      <span class="title">LocalVariableTable</span>:</span></span><br><span class="line"><span class="function">        <span class="title">Start</span>  <span class="title">Length</span>  <span class="title">Slot</span>  <span class="title">Name</span>   <span class="title">Signature</span></span></span><br><span class="line"><span class="function">            0       5     0  <span class="title">this</span>   <span class="title">LSolution01</span>;</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">  <span class="title">public</span> <span class="title">static</span> <span class="title">void</span> <span class="title">main</span>(<span class="title">java.lang.String</span>[]);</span></span><br><span class="line"><span class="function">    <span class="title">descriptor</span>: ([<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">String</span>;)<span class="title">V</span></span></span><br><span class="line"><span class="function">    <span class="title">flags</span>: <span class="title">ACC_PUBLIC</span>, <span class="title">ACC_STATIC</span></span></span><br><span class="line"><span class="function">    <span class="title">Code</span>:</span></span><br><span class="line"><span class="function">      <span class="title">stack</span>=4, <span class="title">locals</span>=5, <span class="title">args_size</span>=1</span></span><br><span class="line"><span class="function">         0: <span class="title">bipush</span>        6</span></span><br><span class="line"><span class="function">         2: <span class="title">newarray</span>       <span class="title">int</span></span></span><br><span class="line"><span class="function">         4: <span class="title">dup</span></span></span><br><span class="line"><span class="function">         5: <span class="title">iconst_0</span></span></span><br><span class="line"><span class="function">         6: <span class="title">iconst_1</span></span></span><br><span class="line"><span class="function">         7: <span class="title">iastore</span></span></span><br><span class="line"><span class="function">         8: <span class="title">dup</span></span></span><br><span class="line"><span class="function">         9: <span class="title">iconst_1</span></span></span><br><span class="line"><span class="function">        10: <span class="title">iconst_4</span></span></span><br><span class="line"><span class="function">        11: <span class="title">iastore</span></span></span><br><span class="line"><span class="function">        12: <span class="title">dup</span></span></span><br><span class="line"><span class="function">        13: <span class="title">iconst_2</span></span></span><br><span class="line"><span class="function">        14: <span class="title">bipush</span>        -2</span></span><br><span class="line"><span class="function">        16: <span class="title">iastore</span></span></span><br><span class="line"><span class="function">        17: <span class="title">dup</span></span></span><br><span class="line"><span class="function">        18: <span class="title">iconst_3</span></span></span><br><span class="line"><span class="function">        19: <span class="title">iconst_3</span></span></span><br><span class="line"><span class="function">        20: <span class="title">iastore</span></span></span><br><span class="line"><span class="function">        21: <span class="title">dup</span></span></span><br><span class="line"><span class="function">        22: <span class="title">iconst_4</span></span></span><br><span class="line"><span class="function">        23: <span class="title">iconst_0</span></span></span><br><span class="line"><span class="function">        24: <span class="title">iastore</span></span></span><br><span class="line"><span class="function">        25: <span class="title">dup</span></span></span><br><span class="line"><span class="function">        26: <span class="title">iconst_5</span></span></span><br><span class="line"><span class="function">        27: <span class="title">iconst_1</span></span></span><br><span class="line"><span class="function">        28: <span class="title">iastore</span></span></span><br><span class="line"><span class="function">        29: <span class="title">astore_1</span></span></span><br><span class="line"><span class="function">        30: <span class="title">iconst_1</span></span></span><br><span class="line"><span class="function">        31: <span class="title">istore_2</span></span></span><br><span class="line"><span class="function">        32: <span class="title">aload_1</span></span></span><br><span class="line"><span class="function">        33: <span class="title">iload_2</span></span></span><br><span class="line"><span class="function">        34: <span class="title">invokestatic</span>  #2                  // <span class="title">Method</span> <span class="title">twoSum</span>:([<span class="title">II</span>)[[<span class="title">I</span></span></span><br><span class="line"><span class="function">        37: <span class="title">astore_3</span></span></span><br><span class="line"><span class="function">        38: <span class="title">iconst_0</span></span></span><br><span class="line"><span class="function">        39: <span class="title">istore</span>        4</span></span><br><span class="line"><span class="function">        41: <span class="title">iload</span>         4</span></span><br><span class="line"><span class="function">        43: <span class="title">aload_3</span></span></span><br><span class="line"><span class="function">        44: <span class="title">arraylength</span></span></span><br><span class="line"><span class="function">        45: <span class="title">if_icmpge</span>     67</span></span><br><span class="line"><span class="function">        48: <span class="title">getstatic</span>     #3                  // <span class="title">Field</span> <span class="title">java</span>/<span class="title">lang</span>/<span class="title">System.out:Ljava</span>/<span class="title">io</span>/<span class="title">PrintStream</span>;</span></span><br><span class="line"><span class="function">        51: <span class="title">aload_3</span></span></span><br><span class="line"><span class="function">        52: <span class="title">iload</span>         4</span></span><br><span class="line"><span class="function">        54: <span class="title">aaload</span></span></span><br><span class="line"><span class="function">        55: <span class="title">invokestatic</span>  #4                  // <span class="title">Method</span> <span class="title">java</span>/<span class="title">util</span>/<span class="title">Arrays.toString</span>:([<span class="title">I</span>)<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">String</span>;</span></span><br><span class="line"><span class="function">        58: <span class="title">invokevirtual</span> #5                  // <span class="title">Method</span> <span class="title">java</span>/<span class="title">io</span>/<span class="title">PrintStream.println</span>:(<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">String</span>;)<span class="title">V</span></span></span><br><span class="line"><span class="function">        61: <span class="title">iinc</span>          4, 1</span></span><br><span class="line"><span class="function">        64: <span class="title">goto</span>          41</span></span><br><span class="line"><span class="function">        67: <span class="title">return</span></span></span><br><span class="line"><span class="function">      <span class="title">LineNumberTable</span>:</span></span><br><span class="line"><span class="function">        <span class="title">line</span> 5: 0</span></span><br><span class="line"><span class="function">        <span class="title">line</span> 6: 30</span></span><br><span class="line"><span class="function">        <span class="title">line</span> 7: 32</span></span><br><span class="line"><span class="function">        <span class="title">line</span> 8: 38</span></span><br><span class="line"><span class="function">        <span class="title">line</span> 9: 48</span></span><br><span class="line"><span class="function">        <span class="title">line</span> 8: 61</span></span><br><span class="line"><span class="function">        <span class="title">line</span> 11: 67</span></span><br><span class="line"><span class="function">      <span class="title">LocalVariableTable</span>:</span></span><br><span class="line"><span class="function">        <span class="title">Start</span>  <span class="title">Length</span>  <span class="title">Slot</span>  <span class="title">Name</span>   <span class="title">Signature</span></span></span><br><span class="line"><span class="function">           41      26     4     <span class="title">i</span>   <span class="title">I</span></span></span><br><span class="line"><span class="function">            0      68     0  <span class="title">args</span>   [<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">String</span>;</span></span><br><span class="line"><span class="function">           30      38     1  <span class="title">nums</span>   [<span class="title">I</span></span></span><br><span class="line"><span class="function">           32      36     2 <span class="title">target</span>   <span class="title">I</span></span></span><br><span class="line"><span class="function">           38      30     3 <span class="title">result</span>   [[<span class="title">I</span></span></span><br><span class="line"><span class="function">      <span class="title">StackMapTable</span>: <span class="title">number_of_entries</span> = 2</span></span><br><span class="line"><span class="function">        <span class="title">frame_type</span> = 255 /* <span class="title">full_frame</span> */</span></span><br><span class="line"><span class="function">          <span class="title">offset_delta</span> = 41</span></span><br><span class="line"><span class="function">          <span class="title">locals</span> = [ <span class="title">class</span> &quot;[<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">String</span>;&quot;, <span class="title">class</span> &quot;[<span class="title">I</span>&quot;, <span class="title">int</span>, <span class="title">class</span> &quot;[[<span class="title">I</span>&quot;, <span class="title">int</span> ]</span></span><br><span class="line"><span class="function">          <span class="title">stack</span> = []</span></span><br><span class="line"><span class="function">        <span class="title">frame_type</span> = 250 /* <span class="title">chop</span> */</span></span><br><span class="line"><span class="function">          <span class="title">offset_delta</span> = 25</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">  <span class="title">public</span> <span class="title">static</span> <span class="title">int</span>[][] <span class="title">twoSum</span>(<span class="title">int</span>[], <span class="title">int</span>);</span></span><br><span class="line"><span class="function">    <span class="title">descriptor</span>: ([<span class="title">II</span>)[[<span class="title">I</span></span></span><br><span class="line"><span class="function">    <span class="title">flags</span>: <span class="title">ACC_PUBLIC</span>, <span class="title">ACC_STATIC</span></span></span><br><span class="line"><span class="function">    <span class="title">Code</span>:</span></span><br><span class="line"><span class="function">      <span class="title">stack</span>=5, <span class="title">locals</span>=7, <span class="title">args_size</span>=2</span></span><br><span class="line"><span class="function">         0: <span class="title">new</span>           #6                  // <span class="title">class</span> <span class="title">java</span>/<span class="title">util</span>/<span class="title">HashMap</span></span></span><br><span class="line"><span class="function">         3: <span class="title">dup</span></span></span><br><span class="line"><span class="function">         4: <span class="title">invokespecial</span> #7                  // <span class="title">Method</span> <span class="title">java</span>/<span class="title">util</span>/<span class="title">HashMap</span>.&quot;&lt;<span class="title">init</span>&gt;&quot;:()<span class="title">V</span></span></span><br><span class="line"><span class="function">         7: <span class="title">astore_2</span></span></span><br><span class="line"><span class="function">         8: <span class="title">iconst_0</span></span></span><br><span class="line"><span class="function">         9: <span class="title">istore_3</span></span></span><br><span class="line"><span class="function">        10: <span class="title">iload_3</span></span></span><br><span class="line"><span class="function">        11: <span class="title">aload_0</span></span></span><br><span class="line"><span class="function">        12: <span class="title">arraylength</span></span></span><br><span class="line"><span class="function">        13: <span class="title">iconst_1</span></span></span><br><span class="line"><span class="function">        14: <span class="title">isub</span></span></span><br><span class="line"><span class="function">        15: <span class="title">if_icmpge</span>     85</span></span><br><span class="line"><span class="function">        18: <span class="title">iload_3</span></span></span><br><span class="line"><span class="function">        19: <span class="title">iconst_1</span></span></span><br><span class="line"><span class="function">        20: <span class="title">iadd</span></span></span><br><span class="line"><span class="function">        21: <span class="title">istore</span>        4</span></span><br><span class="line"><span class="function">        23: <span class="title">iload</span>         4</span></span><br><span class="line"><span class="function">        25: <span class="title">aload_0</span></span></span><br><span class="line"><span class="function">        26: <span class="title">arraylength</span></span></span><br><span class="line"><span class="function">        27: <span class="title">if_icmpge</span>     79</span></span><br><span class="line"><span class="function">        30: <span class="title">aload_0</span></span></span><br><span class="line"><span class="function">        31: <span class="title">iload_3</span></span></span><br><span class="line"><span class="function">        32: <span class="title">iaload</span></span></span><br><span class="line"><span class="function">        33: <span class="title">aload_0</span></span></span><br><span class="line"><span class="function">        34: <span class="title">iload</span>         4</span></span><br><span class="line"><span class="function">        36: <span class="title">iaload</span></span></span><br><span class="line"><span class="function">        37: <span class="title">iadd</span></span></span><br><span class="line"><span class="function">        38: <span class="title">iload_1</span></span></span><br><span class="line"><span class="function">        39: <span class="title">if_icmpne</span>     73</span></span><br><span class="line"><span class="function">        42: <span class="title">aload_2</span></span></span><br><span class="line"><span class="function">        43: <span class="title">aload_0</span></span></span><br><span class="line"><span class="function">        44: <span class="title">iload_3</span></span></span><br><span class="line"><span class="function">        45: <span class="title">iaload</span></span></span><br><span class="line"><span class="function">        46: <span class="title">aload_0</span></span></span><br><span class="line"><span class="function">        47: <span class="title">iload</span>         4</span></span><br><span class="line"><span class="function">        49: <span class="title">iaload</span></span></span><br><span class="line"><span class="function">        50: <span class="title">invokestatic</span>  #8                  // <span class="title">Method</span> <span class="title">java</span>/<span class="title">lang</span>/<span class="title">Math.min</span>:(<span class="title">II</span>)<span class="title">I</span></span></span><br><span class="line"><span class="function">        53: <span class="title">invokestatic</span>  #9                  // <span class="title">Method</span> <span class="title">java</span>/<span class="title">lang</span>/<span class="title">Integer.valueOf</span>:(<span class="title">I</span>)<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">Integer</span>;</span></span><br><span class="line"><span class="function">        56: <span class="title">aload_0</span></span></span><br><span class="line"><span class="function">        57: <span class="title">iload_3</span></span></span><br><span class="line"><span class="function">        58: <span class="title">iaload</span></span></span><br><span class="line"><span class="function">        59: <span class="title">aload_0</span></span></span><br><span class="line"><span class="function">        60: <span class="title">iload</span>         4</span></span><br><span class="line"><span class="function">        62: <span class="title">iaload</span></span></span><br><span class="line"><span class="function">        63: <span class="title">invokestatic</span>  #10                 // <span class="title">Method</span> <span class="title">java</span>/<span class="title">lang</span>/<span class="title">Math.max</span>:(<span class="title">II</span>)<span class="title">I</span></span></span><br><span class="line"><span class="function">        66: <span class="title">invokestatic</span>  #9                  // <span class="title">Method</span> <span class="title">java</span>/<span class="title">lang</span>/<span class="title">Integer.valueOf</span>:(<span class="title">I</span>)<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">Integer</span>;</span></span><br><span class="line"><span class="function">        69: <span class="title">invokevirtual</span> #11                 // <span class="title">Method</span> <span class="title">java</span>/<span class="title">util</span>/<span class="title">HashMap.put</span>:(<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">Object</span>;<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">Object</span>;)<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">Object</span>;</span></span><br><span class="line"><span class="function">        72: <span class="title">pop</span></span></span><br><span class="line"><span class="function">        73: <span class="title">iinc</span>          4, 1</span></span><br><span class="line"><span class="function">        76: <span class="title">goto</span>          23</span></span><br><span class="line"><span class="function">        79: <span class="title">iinc</span>          3, 1</span></span><br><span class="line"><span class="function">        82: <span class="title">goto</span>          10</span></span><br><span class="line"><span class="function">        85: <span class="title">aload_2</span></span></span><br><span class="line"><span class="function">        86: <span class="title">invokevirtual</span> #12                 // <span class="title">Method</span> <span class="title">java</span>/<span class="title">util</span>/<span class="title">HashMap.size</span>:()<span class="title">I</span></span></span><br><span class="line"><span class="function">        89: <span class="title">iconst_2</span></span></span><br><span class="line"><span class="function">        90: <span class="title">multianewarray</span> #13,  2            // <span class="title">class</span> &quot;[[<span class="title">I</span>&quot;</span></span><br><span class="line"><span class="function">        94: <span class="title">astore_3</span></span></span><br><span class="line"><span class="function">        95: <span class="title">iconst_0</span></span></span><br><span class="line"><span class="function">        96: <span class="title">istore</span>        4</span></span><br><span class="line"><span class="function">        98: <span class="title">aload_2</span></span></span><br><span class="line"><span class="function">        99: <span class="title">invokevirtual</span> #14                 // <span class="title">Method</span> <span class="title">java</span>/<span class="title">util</span>/<span class="title">HashMap.keySet</span>:()<span class="title">Ljava</span>/<span class="title">util</span>/<span class="title">Set</span>;</span></span><br><span class="line"><span class="function">       102: <span class="title">invokeinterface</span> #15,  1           // <span class="title">InterfaceMethod</span> <span class="title">java</span>/<span class="title">util</span>/<span class="title">Set.iterator</span>:()<span class="title">Ljava</span>/<span class="title">util</span>/<span class="title">Iterator</span>;</span></span><br><span class="line"><span class="function">       107: <span class="title">astore</span>        5</span></span><br><span class="line"><span class="function">       109: <span class="title">aload</span>         5</span></span><br><span class="line"><span class="function">       111: <span class="title">invokeinterface</span> #16,  1           // <span class="title">InterfaceMethod</span> <span class="title">java</span>/<span class="title">util</span>/<span class="title">Iterator.hasNext</span>:()<span class="title">Z</span></span></span><br><span class="line"><span class="function">       116: <span class="title">ifeq</span>          166</span></span><br><span class="line"><span class="function">       119: <span class="title">aload</span>         5</span></span><br><span class="line"><span class="function">       121: <span class="title">invokeinterface</span> #17,  1           // <span class="title">InterfaceMethod</span> <span class="title">java</span>/<span class="title">util</span>/<span class="title">Iterator.next</span>:()<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">Object</span>;</span></span><br><span class="line"><span class="function">       126: <span class="title">checkcast</span>     #18                 // <span class="title">class</span> <span class="title">java</span>/<span class="title">lang</span>/<span class="title">Integer</span></span></span><br><span class="line"><span class="function">       129: <span class="title">astore</span>        6</span></span><br><span class="line"><span class="function">       131: <span class="title">aload_3</span></span></span><br><span class="line"><span class="function">       132: <span class="title">iload</span>         4</span></span><br><span class="line"><span class="function">       134: <span class="title">aaload</span></span></span><br><span class="line"><span class="function">       135: <span class="title">iconst_0</span></span></span><br><span class="line"><span class="function">       136: <span class="title">aload</span>         6</span></span><br><span class="line"><span class="function">       138: <span class="title">invokevirtual</span> #19                 // <span class="title">Method</span> <span class="title">java</span>/<span class="title">lang</span>/<span class="title">Integer.intValue</span>:()<span class="title">I</span></span></span><br><span class="line"><span class="function">       141: <span class="title">iastore</span></span></span><br><span class="line"><span class="function">       142: <span class="title">aload_3</span></span></span><br><span class="line"><span class="function">       143: <span class="title">iload</span>         4</span></span><br><span class="line"><span class="function">       145: <span class="title">aaload</span></span></span><br><span class="line"><span class="function">       146: <span class="title">iconst_1</span></span></span><br><span class="line"><span class="function">       147: <span class="title">aload_2</span></span></span><br><span class="line"><span class="function">       148: <span class="title">aload</span>         6</span></span><br><span class="line"><span class="function">       150: <span class="title">invokevirtual</span> #20                 // <span class="title">Method</span> <span class="title">java</span>/<span class="title">util</span>/<span class="title">HashMap.get</span>:(<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">Object</span>;)<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">Object</span>;</span></span><br><span class="line"><span class="function">       153: <span class="title">checkcast</span>     #18                 // <span class="title">class</span> <span class="title">java</span>/<span class="title">lang</span>/<span class="title">Integer</span></span></span><br><span class="line"><span class="function">       156: <span class="title">invokevirtual</span> #19                 // <span class="title">Method</span> <span class="title">java</span>/<span class="title">lang</span>/<span class="title">Integer.intValue</span>:()<span class="title">I</span></span></span><br><span class="line"><span class="function">       159: <span class="title">iastore</span></span></span><br><span class="line"><span class="function">       160: <span class="title">iinc</span>          4, 1</span></span><br><span class="line"><span class="function">       163: <span class="title">goto</span>          109</span></span><br><span class="line"><span class="function">       166: <span class="title">aload_3</span></span></span><br><span class="line"><span class="function">       167: <span class="title">areturn</span></span></span><br><span class="line"><span class="function">      <span class="title">LineNumberTable</span>:</span></span><br><span class="line"><span class="function">        <span class="title">line</span> 14: 0</span></span><br><span class="line"><span class="function">        <span class="title">line</span> 15: 8</span></span><br><span class="line"><span class="function">        <span class="title">line</span> 16: 18</span></span><br><span class="line"><span class="function">        <span class="title">line</span> 17: 30</span></span><br><span class="line"><span class="function">        <span class="title">line</span> 18: 42</span></span><br><span class="line"><span class="function">        <span class="title">line</span> 16: 73</span></span><br><span class="line"><span class="function">        <span class="title">line</span> 15: 79</span></span><br><span class="line"><span class="function">        <span class="title">line</span> 22: 85</span></span><br><span class="line"><span class="function">        <span class="title">line</span> 23: 95</span></span><br><span class="line"><span class="function">        <span class="title">line</span> 24: 98</span></span><br><span class="line"><span class="function">        <span class="title">line</span> 25: 131</span></span><br><span class="line"><span class="function">        <span class="title">line</span> 26: 142</span></span><br><span class="line"><span class="function">        <span class="title">line</span> 27: 160</span></span><br><span class="line"><span class="function">        <span class="title">line</span> 28: 163</span></span><br><span class="line"><span class="function">        <span class="title">line</span> 29: 166</span></span><br><span class="line"><span class="function">      <span class="title">LocalVariableTable</span>:</span></span><br><span class="line"><span class="function">        <span class="title">Start</span>  <span class="title">Length</span>  <span class="title">Slot</span>  <span class="title">Name</span>   <span class="title">Signature</span></span></span><br><span class="line"><span class="function">           23      56     4     <span class="title">j</span>   <span class="title">I</span></span></span><br><span class="line"><span class="function">           10      75     3     <span class="title">i</span>   <span class="title">I</span></span></span><br><span class="line"><span class="function">          131      32     6   <span class="title">key</span>   <span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">Integer</span>;</span></span><br><span class="line"><span class="function">            0     168     0  <span class="title">nums</span>   [<span class="title">I</span></span></span><br><span class="line"><span class="function">            0     168     1 <span class="title">target</span>   <span class="title">I</span></span></span><br><span class="line"><span class="function">            8     160     2   <span class="title">map</span>   <span class="title">Ljava</span>/<span class="title">util</span>/<span class="title">HashMap</span>;</span></span><br><span class="line"><span class="function">           95      73     3 <span class="title">result</span>   [[<span class="title">I</span></span></span><br><span class="line"><span class="function">           98      70     4 <span class="title">index</span>   <span class="title">I</span></span></span><br><span class="line"><span class="function">      <span class="title">LocalVariableTypeTable</span>:</span></span><br><span class="line"><span class="function">        <span class="title">Start</span>  <span class="title">Length</span>  <span class="title">Slot</span>  <span class="title">Name</span>   <span class="title">Signature</span></span></span><br><span class="line"><span class="function">            8     160     2   <span class="title">map</span>   <span class="title">Ljava</span>/<span class="title">util</span>/<span class="title">HashMap</span>&lt;<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">Integer</span>;<span class="title">Ljava</span>/<span class="title">lang</span>/<span class="title">Integer</span>;&gt;;</span></span><br><span class="line"><span class="function">      <span class="title">StackMapTable</span>: <span class="title">number_of_entries</span> = 7</span></span><br><span class="line"><span class="function">        <span class="title">frame_type</span> = 253 /* <span class="title">append</span> */</span></span><br><span class="line"><span class="function">          <span class="title">offset_delta</span> = 10</span></span><br><span class="line"><span class="function">          <span class="title">locals</span> = [ <span class="title">class</span> <span class="title">java</span>/<span class="title">util</span>/<span class="title">HashMap</span>, <span class="title">int</span> ]</span></span><br><span class="line"><span class="function">        <span class="title">frame_type</span> = 252 /* <span class="title">append</span> */</span></span><br><span class="line"><span class="function">          <span class="title">offset_delta</span> = 12</span></span><br><span class="line"><span class="function">          <span class="title">locals</span> = [ <span class="title">int</span> ]</span></span><br><span class="line"><span class="function">        <span class="title">frame_type</span> = 49 /* <span class="title">same</span> */</span></span><br><span class="line"><span class="function">        <span class="title">frame_type</span> = 250 /* <span class="title">chop</span> */</span></span><br><span class="line"><span class="function">          <span class="title">offset_delta</span> = 5</span></span><br><span class="line"><span class="function">        <span class="title">frame_type</span> = 250 /* <span class="title">chop</span> */</span></span><br><span class="line"><span class="function">          <span class="title">offset_delta</span> = 5</span></span><br><span class="line"><span class="function">        <span class="title">frame_type</span> = 254 /* <span class="title">append</span> */</span></span><br><span class="line"><span class="function">          <span class="title">offset_delta</span> = 23</span></span><br><span class="line"><span class="function">          <span class="title">locals</span> = [ <span class="title">class</span> &quot;[[<span class="title">I</span>&quot;, <span class="title">int</span>, <span class="title">class</span> <span class="title">java</span>/<span class="title">util</span>/<span class="title">Iterator</span> ]</span></span><br><span class="line"><span class="function">        <span class="title">frame_type</span> = 250 /* <span class="title">chop</span> */</span></span><br><span class="line"><span class="function">          <span class="title">offset_delta</span> = 56</span></span><br><span class="line"><span class="function">&#125;</span></span><br><span class="line"><span class="function"><span class="title">SourceFile</span>: &quot;<span class="title">Solution01.java</span>&quot;</span></span><br></pre></td></tr></table></figure>

<p>可以清晰看到方法映射和变量映射等…</p>
<p>对文件进行了MD5的加密</p>
<p>minor version: 0<br>major version: 52</p>
<p>flags: ACC_SUPER —public&#x2F;super</p>
<p>#4 &#x3D; Class —#24 this_class编号为多少<br>#5 &#x3D; Class —#5 super_class编号为多少</p>
</li>
<li><p>JBE<br>工具：可以直接修改class文件 –不仅可以查看bytecode 也可以通过汇编语言进行对classfile的修改</p>
</li>
<li><p>JClasslib IDEA中的插件 –安装setting中选择plugins然后安装JClasslib<br>若字节码文件没有生成 则可以build project<br><em>使用：选中类，然后在view中查看show bytecode with Jclasslib</em></p>
</li>
</ol>
<blockquote>
<p>访问标志为0x0021 是一个按位与运算，通过ACC_SUPER&amp;ACC_PUBLIC 这两个属性的按位与运算得来的值。使用2个字节来表示。对应ACCESS_FLAGS表中的内容</p>
</blockquote>
<h4 id="2-2-7-常量池详细解析"><a href="#2-2-7-常量池详细解析" class="headerlink" title="2.2.7 常量池详细解析"></a>2.2.7 常量池详细解析</h4><p>常量池类型：共有18个编号的常量类型：</p>
<blockquote>
<p>编号1： CONSTANT_UTF8_INFO</p>
<p>TAG1 —占用一个空间字节</p>
<p>Length： utf-8字符串占用的字节数</p>
<p>Bytes 长度为length字符串</p>
<p>用于表示utf-8的编码的字符串</p>
<p>编号3 CONSTANT_integer_info</p>
<p>Tag3</p>
<p>Bytes 4个字节 Big_Endian(高位在前) 存储int类型的值</p>
<p>编号4 CONSTANT_float_info</p>
<p>Tag4</p>
<p>Bytes 4个字节 Big_Endian(高位在前) 存储float类型的值</p>
<p>编号5 CONSTANT_long_info</p>
<p>Tag5</p>
<p>Bytes 8个字节 Big_Endian(高位在前) 存储long类型的值</p>
<p>编号6 CONSTANT_double_info</p>
<p>Tag6</p>
<p>Bytes 8个字节 Big_Endian(高位在前) 存储double类型的值</p>
<p>编号7 CONSTANT_Class_info</p>
<p>Tag7</p>
<p>Index 2个字节 指向类的全限定名的项的索引</p>
<p>类和接口符号引用</p>
<p>编号8 CONSTANT_String_info</p>
<p>Tag8</p>
<p>Index 2个字节 指向字符串的字面量的索引</p>
<p>编号9 CONSTANT_Fieldref_info</p>
<p>Tag9</p>
<p>Index 2个字节 指向声明字段的类或接口的描述符 CONSTANT_Class_info的索引项</p>
<p>Index 2个字节 指向字段描述符CONSTANT_NameAndType的索引项</p>
<p>字段的符号引用</p>
<p>编号10 CONSTANT_Methodref_info</p>
<p>Tag10</p>
<p>Index 2个字节 指向声明字段的类或接口的描述符 CONSTANT_Class_info的索引项</p>
<p>Index 2个字节 指向字段描述符CONSTANT_NameAndType的索引项</p>
<p>类中方法的符号引用</p>
<p>编号11 CONSTANT_InterfaceMethodref_info</p>
<p>Tag11</p>
<p>Index 2个字节 指向声明字段的类或接口的描述符 CONSTANT_Class_info的索引项</p>
<p>Index 2个字节 指向字段描述符CONSTANT_NameAndType的索引项</p>
<p>接口中方法的符号引用</p>
<p>编号12 CONSTANT_NameAndType</p>
<p>Tag12</p>
<p>Index 2个字节 指向该字段或方法名称常量项的索引<br> Index 2个字节 指向该字段或方法描述符常量项的索引</p>
<p>字段或方法的符号引用</p>
<p>编号15 CONSTANT_MethodHandler_info</p>
<p>Tag15</p>
<p>Reference_kind 1个字节 1-9之间的一个值 决定了方法句柄的类型。方法句柄类型的值表示方法句柄的字节码行为</p>
<p>Reference_index 2个字节 对常量池的有效索引。</p>
<p>表示方法句柄</p>
<p>编号16 CONSTANT_MethodType_info</p>
<p>Tag16</p>
<p>Descriptor_index 2个字节 指向UTF8_info 结构表示的方法描述符</p>
<p>编号18CONSTANT_InvokeDynamic_info</p>
<p>Tag18</p>
<p>Bootstrap_method_attr_index: 2个字节 当前class文件中引导方法表的bootstrap_methods[] 数组的有效索引</p>
<p>Name_and_type_index: 2个字节 指向NameAndType_info 表示方法名和方法描述符。</p>
<p>表示动态方法的调用点。</p>
</blockquote>
<p><em>例：案例解析见视频</em></p>
<p><em>附录信息：案例中常量池中有31个常量信息，第一个是Constant_methodref_info 为方法引用信息</em></p>
<p><em>#5类名 指向常量池第五个的信息 —Object的类的信息，</em></p>
<p><em>#19名字和描述符 CONSTANT_NameAndType_info</em></p>
<p><em>关于init字样，是一个构造方法</em></p>
<p><em>关于()V</em> </p>
<p><em>() 表示方法没有参数</em></p>
<p><em>V 表示void 方法没有返回值。</em></p>
<p><em><strong>常量池中classfile的表示形式：</strong></em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cafe babe 0000 0034 0020 0a00 0500 1309</span><br><span class="line">0014 0015 0a00 1600 1707 0018 0700 1901</span><br><span class="line">0006 3c69 6e69 743e 0100 0328 2956 0100</span><br><span class="line">0443 6f64 6501 000f 4c69 6e65 4e75 6d62</span><br><span class="line">6572 5461 626c 6501 0012 4c6f 6361 6c56</span><br><span class="line">6172 6961 626c 6554 6162 6c65 0100 0474</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>第1个常量池</p>
<p>从0a00 那么0a对应的是十进制的10 这个10映射到常量表中的Tag10的标志 CONSTANT_Methodref_info;</p>
<p>0005 表示 index 2个字节 指向声明方法的类或接口的描述符#5 CONSTANT_Class_info的索引项。指向#5行的内容。</p>
<p>0013 13 转成十进制是19 指向#19行的内容是，表示的index2个字节 指向字段描述符CONSTANT_NameAndType_info的索引项</p>
<p>那么以上的常量池是5个字节。</p>
<p>第2个常量池</p>
<p> 从09 开始 09对应的是十进制9 这个9映射到Tag9的标志 </p>
<p>CONSTANT_Fieldref_info;</p>
<p> 0014 对应的十进制是20 对应的#20的内容</p>
<p> 0015 对应十进制是21 对应的就是#21的内容</p>
<p>第3个常量池</p>
<p> 从0a开始那么0a对应的是十进制的10 这个10映射到常量表中的Tag10的标志 CONSTANT_Methodref_info;</p>
<p>0016 —-十进制22 对应#22行的内容</p>
<p>0017 —-十进制23 对应的#23行的内容</p>
<p>第4个常量池</p>
<p>  从07开始 对应的tag7 CONSTANT_Class_info</p>
<p>0018 —- 十进制24 对应着#24的内容 表示的是this_class</p>
<p>第5个常量池</p>
<p>从07开始 对应的tag7 CONSTANT_Class_info</p>
<p>0019 —- 十进制25 对应着#25的内容 表示的是super_class</p>
<p>第6个常量池</p>
<p> 01 —-CONSTANT_UTF8_INFO</p>
<p>0006 表示占用的字节数和长度</p>
<p>3c69 6e69 743e 表示字符串内容的字节。init字符串的构造方法</p>
<p>这段总共是9个字节。</p>
<p>第7个常量池</p>
<p>01 —-CONSTANT_UTF8_INFO</p>
<p>0003 表示常量池第七个常量的字符串长度占用的字节</p>
<p>28 2956 表示 ()V构造方法 V表示无返回值</p>
<p>这段总共6个字节。</p>
<p><strong>Method属性</strong></p>
<p>Method属性包含三个字段值</p>
<p>名称access_flag 类型u2 数量1个attributes_count 1</p>
<p>名称 name_index 类型u2 数量1个 attribute_info attributes —-attributes_count</p>
<p>名称 descriptior_index 类型u2 数量1个</p>
<p>descriptior_index</p>
<ol>
<li><p>参数列表(参数类型) 后-返回值</p>
</li>
<li><p>void m() 等同于 ()V</p>
</li>
<li><p>String toString() -&gt;()Ljava&#x2F;lang&#x2F;String；</p>
</li>
<li><p>Long pos(int[] arr1,int arr2,long length) -&gt;([IIJ)J</p>
</li>
</ol>
<ul>
<li><em><strong>字段类型(Field Type)</strong></em></li>
<li><em><strong>基本数据类型(Base Type)</strong></em><ul>
<li><em><strong>B –byte 有符号的字节型数</strong></em></li>
<li><em><strong>C –char Unicode字符，UTF-16编码</strong></em></li>
<li><em><strong>D –double，双精度浮点数</strong></em></li>
<li><em><strong>F –float，单精度浮点数</strong></em></li>
<li><em><strong>I –int，整型数</strong></em></li>
<li><em><strong>J –long，长整型</strong></em></li>
<li><em><strong>S –short，有符号短整型</strong></em></li>
<li><em><strong>Z –boolean，布尔值。true&#x2F;false</strong></em></li>
</ul>
</li>
<li><em><strong>对象引用类型(Object Type) –L Classname; –一个名为<Classname>的实例</strong></em></li>
<li><em><strong>数组类型(Object Type) –[ –表示一个数组的引用</strong></em></li>
</ul>
<p>[ 一维数组</p>
<p>[[ 表示二维数组</p>
<p>关于attributes_count 附加属性的数量</p>
<p>关于 attributes  附加属性</p>
<p>第8个常量池</p>
<p> 01 —-CONSTANT_UTF8_INFO</p>
<p> 0004 表示常量池第八个常量的字符串长度占用的字节</p>
<p>43 6f 64 65 表示 code字符串内容</p>
<p>这段总共是7个字节</p>
<p><strong>Fields属性</strong></p>
<p>名称access_flag 类型u2 数量1个attributes_count 1</p>
<p>同method属性</p>
<p>名称 name_index 类型u2 数量1个 attribute_info attributes —-attributes_count</p>
<p>名称 descriptior_index 类型u2 数量1个</p>
<p>同method属性值。</p>
<p>关于attributes_count 附加属性的数量</p>
<p>关于 attributes  附加属性</p>
<p>第9个常量池LineNumberTable 是在后面要使用的常量的名字，在code当中被引用到。</p>
<p>第10个常量池LocalVariableTable是在后面要使用的常量的名字，在code当中被引用到。</p>
<p>第11个常量池 指向的字符串面值this</p>
<p>第12个常量池 表示整个类的类名称</p>
<p>第13个常量池内容 表示的是main方法的字符串名称</p>
<p>第14个常量池内容 表示的是main方法中的参数 字符串数组 无返回值</p>
<p>第15个常量池 main方法的参数名称的字符串字面量</p>
<p>第16个常量池 mian方法中参数类型的字符串字面量值</p>
<p>第17个常量池 SourceFile 对应后面的附加属性的SourceFile 表示的是源文件的索引</p>
<p>第18个常量池内容 表示的是源文件的名称的字符串字面值</p>
<p>第19个常量池 CONSTANT_NameAndType_info 对应6号常量池构造方法的名字和7号常量池  方法的参数和返回值</p>
<p>第20个常量池 CONSTANT_Class_info 对应的System类 对应了26号常量池的System的字面值</p>
<p>第21个常量池 CONSTANT_NameAndType_info 对应的是27号常量池 out字面值属性的名称，对应了28号常量池的PrintStream的类的字符串字面值。</p>
<p>从22个开始到31个，按照字面意思去理解就可以了。</p>
</blockquote>
<p><em>注意：可以右击code显示JVM规范</em></p>
<p><strong>Interfaces</strong> <strong>和</strong> <strong>Fields</strong> <strong>选项</strong> <strong>method</strong> <strong>选项</strong> </p>
<p>因为案例中没有声明接口和成员变量，所以对应没有展开选项 </p>
<p>由于有两个 method：</p>
<ol>
<li>init无参的构造方法 –默认提供的构造方法</li>
<li>主函数 main</li>
</ol>
<p><strong>方法中的 access_flag</strong></p>
<p>方法访问标志：</p>
<table>
<thead>
<tr>
<th>标志名称</th>
<th>标志值</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>ACC_PUBLIC</td>
<td>0x0001</td>
<td>方法是否为public</td>
</tr>
<tr>
<td>ACC_PRIVATE</td>
<td>0x0002</td>
<td>方法是否为private</td>
</tr>
<tr>
<td>ACC_PROTECTED</td>
<td>0x0004</td>
<td>方法是否为protected</td>
</tr>
<tr>
<td>ACC_STATIC</td>
<td>0x0008</td>
<td>方法是否为static</td>
</tr>
<tr>
<td>ACC_FINAL</td>
<td>0x0010</td>
<td>方法是否为final</td>
</tr>
<tr>
<td>ACC_SYNCHRONIZED</td>
<td>0x0020</td>
<td>方法是否为synchronized</td>
</tr>
<tr>
<td>ACC_BRIDGE</td>
<td>0x0040</td>
<td>方法是否是由编译器产生的桥接方法</td>
</tr>
<tr>
<td>ACC_VARARGS</td>
<td>0x0080</td>
<td>方法是否接受不定参数</td>
</tr>
<tr>
<td>ACC_ NATIVE</td>
<td>0x0100</td>
<td>方法是否为native</td>
</tr>
<tr>
<td>ACC_ABSTRACT</td>
<td>0x0400</td>
<td>方法是否为abstract</td>
</tr>
<tr>
<td>ACC_STRICTFP</td>
<td>0x0800</td>
<td>方法是否为strictfp</td>
</tr>
<tr>
<td>ACC_SYNTHETIC</td>
<td>0x1000</td>
<td>方法是否是由编译器自动产生的</td>
</tr>
</tbody></table>
<p><strong>attributes_count</strong> <strong>和</strong> <strong>attribute附加属性</strong> </p>
<p>方法中的附加属性就是 code，code在这里是比较重要的概念，code是指具体代码的实现，当我们写入方法的时候，它就能把方法中代码转化为一条条指令。</p>
<p>在官方文档中 有很多十六进制数字 它们对应方法中code的内容实现 可以鼠标右击 显示JVM规范</p>
<p><strong>Attributes 附加属性</strong></p>
<ol>
<li>既有预定义的属性，也可以自定义 java 虚拟机会自动忽略它不认识属性</li>
<li>Code表示的是方法表 方法表能够编译成字节码指令，还存放了操作数栈和局部变量的信息</li>
</ol>
<blockquote>
<p>u2 attribute_name_index 指向常量池中的 CONSTANT_UTF8_info 存放的当前属性的名字就 </p>
<p>是 code。 </p>
<p>u4 attribute_length 表示的 code 属性的长度 （不包括前 6 个字节）。 </p>
<p>u2 max_stack 指定当前方法被执行引擎执行的时候，在栈帧中需要分配的操作数栈的大小 </p>
<p>u2 max_locals 指定当前方法被执行引擎执行的时候，在栈帧中需要分配的局部变量表的大 </p>
<p>小</p>
<p>u4 code_length 指定方法字节码的长度， class 文件中每条字节码都占用一个字节 </p>
<p>u1 code 存放字节码指令本身，它的长度是 code_length 个字节。 </p>
<p>U2 exception_table_length 指定异常表的大小 </p>
<p>Exception_table 异常表 作用对 try-catch-finally 的描述，可以把它看成是一个数组。每一个 </p>
<p>数组项都是一个 exception_info 结构， 一般来说每个 catch 块对应一个 exception_info,编译 </p>
<p>器也可能会对当前的方法生成一些 exception_info.</p>
<p>U2 start_pc 是从字节码 code 属性中的一部分 起始处到当前异常处理器的起始处的偏移量 </p>
<p>量</p>
<p>u2 end_pc 从字节码起始处到当前异常处理器 末尾的偏移量 </p>
<p>u2 handler_pc 是指当前异常处理器用于处理异常（即 catch 块）的第一条指令相对于字节码 </p>
<p>开始处的偏移量。 </p>
<p>U2 catch_type 是常量池的索引 指向的是常量池 CONSTANT-Class_info 数据项，描述了 catch </p>
<p>块中的异常类型的信息。这个类必须是 java.lang.Throwable 的或者是它的子类。 </p>
<p>总结： </p>
<p>如果偏移量从 start_pc 到 end_pc 之间，如果字节码出现了 catch_type 所描述的异常，那么 </p>
<p>就跳转偏移量到 handler_pc 的字节码中去执行。如果 catch_type 为 0 就代表不引用任何常 </p>
<p>量池的信息，那么这个 exception_info 用于实现 finally 的子句。 </p>
<p>U2 attribute_count 表示的是 code 属性中存在的其他属性的个数。会出现在 class 中的属性， </p>
<p>在 field 属性也有，在 method 属性也有 </p>
<p>Attributes 可以把它看成是个数组，里面存放了 code 属性的其他属性。 </p>
<p>ConstantValue —-字段表 final 关键字自定义的常量值 </p>
<p>Deprecated —类 方法表 字段表 </p>
<p>Exception 异常表 </p>
<p>EnclosingMethod 类文件 局部类或匿名类的外部封装方法 </p>
<p>InnerClass 类文件 内部类列表 </p>
<p>可选属性 </p>
<p>LineNumberTable 源码的行号和字节码行号的对应关系 可以把这个属性看成是一个数组， </p>
<p>数组中的每项 LineNumberinfo 结构描述了一条字节码和源码行号的对应关系 </p>
<p>LocalVariableTable 建立了方法中的局部变量与源代码中的局部变量的对应关系。</p>
</blockquote>
<h2 id="Chapter3-类加载和初始化"><a href="#Chapter3-类加载和初始化" class="headerlink" title="Chapter3  类加载和初始化"></a>Chapter3  类加载和初始化</h2><p>涉及面试题：</p>
<ol>
<li>描述一下类加载器的层次</li>
<li>双亲委派流程</li>
<li>为什么要双亲委派</li>
</ol>
<p>class文件是如何加载到内存中的 并且是如何执行的</p>
<h3 id="3-1-Class-Cycle"><a href="#3-1-Class-Cycle" class="headerlink" title="3.1 Class Cycle"></a>3.1 Class Cycle</h3><p>Class文件存储在硬盘中 是如何加载到内存中的 其主要步骤如下：</p>
<ol>
<li><p>Loading步骤<br>Loading是将本地classfile的二进制内容加载到内存中</p>
</li>
<li><p>Linking步骤</p>
<ul>
<li><p>Verification 校验</p>
<p>Verification 的主要过程就是用来校验，如何加载的文件字节码头不是CAFEBABE，该过程就会被直接拒绝</p>
</li>
<li><p>Preparation 静态变量赋默认值</p>
<p>Preparation 过程的主要作用就是将静态变量赋默认值，假设定义</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">8</span>;</span><br></pre></td></tr></table></figure>

<p>在这个过程中并不是将 i 的值赋值成8，而是对静态变量 i 进行默认值的赋值 也就是0</p>
</li>
<li><p>Resolution 判断符号位</p>
<p>Resolution 过程是将class文件中常量池用到的一些符号引用转换为内存地址</p>
</li>
</ul>
</li>
<li><p>Initializing步骤</p>
<p>在Initializing步骤中静态变量会进行赋值成初始值，同时在这个步骤中会调用静态代码块</p>
</li>
</ol>
<h3 id="3-2-ClassLoader"><a href="#3-2-ClassLoader" class="headerlink" title="3.2 ClassLoader"></a>3.2 ClassLoader</h3><p>JVM本身有类加载器，这个类加载器表现形式就是普通的class，此加载器的层次就是用来加载不同的class</p>
<p><em><strong>注意：任何一个classfile被加载到内存中都会存在两个部分</strong></em></p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220801140111683.png" alt="image-20220801140111683"></p>
<ol>
<li><em><strong>第一部分 二进制的classfile确实被load进内存中</strong></em></li>
<li><em><strong>第二部分 生成的class类对象，class中还会存在其他对象，引用到class对象，而class类对象指向classfile的内存加载器</strong></em></li>
</ol>
<blockquote>
<p><em>扩展：Class对象究竟存储在哪里？</em></p>
<p><em>Class对象存储在metaspace中</em></p>
<p><em>Metaspace 是 JDK1.8 版本出现的，Metaspace 就是方法区 methodarea 1.8 版本移出了永久代，原本在 1.8 版本之前 PermGenerationspace 部分变更成了metaspace 而这两个地方指代 的都是方法区</em></p>
</blockquote>
<p>怎么才能够知道哪些类是由哪些加载器进行加载的？</p>
<table>
<thead>
<tr>
<th>类加载器层次</th>
<th>作用</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>第一层（最顶）层加载器 BootstrapClassLoader</td>
<td>负责加载lib&#x2F;rt.jar charset.jar等核心类（由C++实现）。其主要负责加载jdk中最核心的jar，例如runtime.jar或者是平时常见的String.class、Object.class 它们都是位于lib&#x2F;rt.jar中的</td>
<td>其调用最顶层加载器 由于其使用C++实现，故而在Java的类中并没有这样一个对象去应对他 所以会出现null值</td>
</tr>
<tr>
<td>第二层 加载器 ExtClassLoader</td>
<td>用于加载扩展的jar包，jre&#x2F;lib&#x2F;ext&#x2F;*.jar或由-Djava.ext.dirs 指定</td>
<td></td>
</tr>
<tr>
<td>第三层 加载器AppClassLoader</td>
<td>加载 classpath 指定的内容</td>
<td></td>
</tr>
<tr>
<td>第四层 自定义加载器  Custom ClassLoader</td>
<td>加载自定义的类的内容</td>
<td></td>
</tr>
</tbody></table>
<p><em>类加载器的加载过程被称为双亲委派</em></p>
<p><strong>双亲委派中存在一个父加载器的概念</strong></p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220801140941306.png" alt="image-20220801140941306"></p>
<p><em>加载器图中描述的是语法上的一种继承关系 而此继承关系与父加载器没有关系</em></p>
<p>&#x3D;&#x3D;父类加载器&#x3D;&#x3D;是如何理解的：注意父加载器不是继承关系 <em><strong>父加载器指代的是ClassLoader源码中有一个变量类型为ClassLoader类型 名称为parent</strong></em></p>
<h3 id="3-3-双亲委派"><a href="#3-3-双亲委派" class="headerlink" title="3.3 双亲委派"></a>3.3 双亲委派</h3><p><em>双亲委派是类加载器的一个加载过程 &#x3D;&#x3D;双亲委派本身是被写死的&#x3D;&#x3D;</em></p>
<p><strong>双亲委派是通过递归来实现的</strong></p>
<p>class文件加载到内存当中先通过Custom ClassLoader进行判断是否已加载。如果没有加载 则会进行向上检查这个类是否被加载了。当检查到这个类没有被Custom ClassLoader加载时 就会进行一个向上委托。从而使AppClassLoader来进行加载 然后重复操作，直至顶层加载器BootstrapClassLoader。顶层加载器BootstrapClassLoader在进行检查是否为自己负责可以加载的部分，若不是顶层负责的则又会向下委托。当自下而上 自上而下都跑完之后 如果当所有下级都没有加载 则会抛出异常 ClassNotFoundException</p>
<blockquote>
<p>如果一个类加载器收到了加载某个类的请求，则该类加载器并不会去加载该类，而是把这个请求委派给父类加载器，每一个层次的类加载器都是如此。因此所有类加载器请求最终都会传送到顶端的启动类加载器；只有当父类加载器在其搜索范围内无法找到所需的类，并将该结果反馈给子类加载器，子类加载器会尝试去自己加载</p>
</blockquote>
<p><em>双亲：指一个从子到父的过程 与一个从父到子的过程</em></p>
<p><em>委派：当前加载器进行加载 委托上级去完成</em></p>
<blockquote>
<p>向上委派时，父类加载器都是到Cache缓存中寻找。可以将这个Cache缓存理解成一个list或者一个数组</p>
</blockquote>
<p>&#x3D;&#x3D;为什么需要使用双亲委派？&#x3D;&#x3D;</p>
<p><em>双亲委派机制的优势：</em> <strong>沙箱安全机制保证核心class文件不被篡改</strong>和<strong>避免类class的重复加载</strong></p>
<p>沙箱安全机制：<em>如果有人想替换系统级别的类：String.java。篡改它的实现，在这种机制下这些系统的类已经被Bootstrap classLoader加载过了（当一个类需要加载的时候，最先去尝试加载的就是BootstrapClassLoader），<strong>而对于任意一个类，都需要由加载它的类加载器和这个类本身一同确立其在Java虚拟机中的唯一性</strong>，所以其他类加载器并没有机会再去加载，从一定程度上防止了危险代码的植入。</em></p>
<blockquote>
<p>保证核心class文件不被篡改，即使被篡改了也不会被加载，即便被加载了也不会是同一个class对象 确保了class的执行安全</p>
</blockquote>
<p>避免类的重复加载：当父ClassLoader已经加载了该类的时候，就不需要子ClassLoader再加载一次</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220801135651212.png" alt="image-20220801135651212"></p>
<p>全盘负责委托机制：当一个ClassLoader加载一个类的时候，除非显示使用另一个ClassLoader，否则该类所依赖和引用的类也是由这个ClassLoader载入</p>
<h3 id="3-4-父加载器"><a href="#3-4-父加载器" class="headerlink" title="3.4 父加载器"></a>3.4 父加载器</h3><p>&#x3D;&#x3D;父类加载器&#x3D;&#x3D;是如何理解的：注意父加载器不是继承关系 <em><strong>父加载器指代的是ClassLoader源码中有一个变量类型为ClassLoader类型 名称为parent</strong></em></p>
<p><em>父加载器不是类加载器的加载器，也不是加载器父类的加载器</em></p>
<h3 id="3-5-类加载器范围"><a href="#3-5-类加载器范围" class="headerlink" title="3.5 类加载器范围"></a>3.5 类加载器范围</h3><p>案例结果：</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sun.misc.Launcher$AppClassLoader@18b4aac2</span><br><span class="line">null</span><br><span class="line">sun.misc.Launcher$ExtClassLoader@4554617c</span><br><span class="line">null</span><br></pre></td></tr></table></figure>

<p>从案例执行结果中 可以看出AppClassLoader与ExtClassLoader都是Launcher的内部类。Launcher是ClassLoader的包装类或者启动类</p>
<p>从翻看Launcher源码可以看到：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">bootClassPath</span> <span class="operator">=</span> System.getProperty(<span class="string">&quot;sun.boot.class.path&quot;</span>);</span><br><span class="line"><span class="keyword">final</span> <span class="type">String</span> <span class="variable">var1</span> <span class="operator">=</span> System.getProperty(<span class="string">&quot;java.class.path&quot;</span>);</span><br><span class="line"><span class="type">String</span> <span class="variable">var0</span> <span class="operator">=</span> System.getProperty(<span class="string">&quot;java.ext.dirs&quot;</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>sun.boot.class.path 是BootstrapClassloader的加载路径</li>
<li>java.class.path 是AppClassloader的加载路径</li>
<li>java.ext.dirs 是ExtClassLoader的加载路径</li>
</ul>
<p>查看类加载器范围结果代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sun.misc.Launcher;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo07</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">pathBoot</span> <span class="operator">=</span> System.getProperty(<span class="string">&quot;sun.boot.class.path&quot;</span>);</span><br><span class="line">        System.out.println(pathBoot.replaceAll(<span class="string">&quot;;&quot;</span>,System.lineSeparator()));</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;---------------------------------&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">pathExt</span> <span class="operator">=</span> System.getProperty(<span class="string">&quot;java.ext.dirs&quot;</span>);</span><br><span class="line">        System.out.println(pathExt.replaceAll(<span class="string">&quot;;&quot;</span>,System.lineSeparator()));</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;---------------------------------&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">pathApp</span> <span class="operator">=</span> System.getProperty(<span class="string">&quot;java.class.path&quot;</span>);</span><br><span class="line">        System.out.println(pathApp.replaceAll(<span class="string">&quot;;&quot;</span>,System.lineSeparator()));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220801212453081.png" alt="image-20220801212453081"></p>
<p>查看</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">D:\JAVA\jdk1.8_0_211\jre\lib\resources.jar</span><br><span class="line">D:\JAVA\jdk1.8_0_211\jre\lib\rt.jar</span><br><span class="line">D:\JAVA\jdk1.8_0_211\jre\lib\sunrsasign.jar</span><br><span class="line">D:\JAVA\jdk1.8_0_211\jre\lib\jsse.jar</span><br><span class="line">D:\JAVA\jdk1.8_0_211\jre\lib\jce.jar</span><br><span class="line">D:\JAVA\jdk1.8_0_211\jre\lib\charsets.jar</span><br><span class="line">D:\JAVA\jdk1.8_0_211\jre\lib\jfr.jar</span><br><span class="line">D:\JAVA\jdk1.8_0_211\jre\classes</span><br><span class="line">---------------------------------上为Bootstrap ClassLoader</span><br><span class="line">D:\JAVA\jdk1.8_0_211\jre\lib\ext</span><br><span class="line">C:\WINDOWS\Sun\Java\lib\ext</span><br><span class="line">---------------------------------上为Extension ClassLoader</span><br><span class="line">D:\JAVA\jdk1.8_0_211\jre\lib\charsets.jar</span><br><span class="line">D:\JAVA\jdk1.8_0_211\jre\lib\deploy.jar</span><br><span class="line">D:\JAVA\jdk1.8_0_211\jre\lib\ext\access-bridge-64.jar</span><br><span class="line">D:\JAVA\jdk1.8_0_211\jre\lib\ext\cldrdata.jar</span><br><span class="line">D:\JAVA\jdk1.8_0_211\jre\lib\ext\dnsns.jar</span><br><span class="line">D:\JAVA\jdk1.8_0_211\jre\lib\ext\jaccess.jar</span><br><span class="line">D:\JAVA\jdk1.8_0_211\jre\lib\ext\jfxrt.jar</span><br><span class="line">D:\JAVA\jdk1.8_0_211\jre\lib\ext\localedata.jar</span><br><span class="line">D:\JAVA\jdk1.8_0_211\jre\lib\ext\nashorn.jar</span><br><span class="line">D:\JAVA\jdk1.8_0_211\jre\lib\ext\sunec.jar</span><br><span class="line">D:\JAVA\jdk1.8_0_211\jre\lib\ext\sunjce_provider.jar</span><br><span class="line">D:\JAVA\jdk1.8_0_211\jre\lib\ext\sunmscapi.jar</span><br><span class="line">D:\JAVA\jdk1.8_0_211\jre\lib\ext\sunpkcs11.jar</span><br><span class="line">D:\JAVA\jdk1.8_0_211\jre\lib\ext\zipfs.jar</span><br><span class="line">D:\JAVA\jdk1.8_0_211\jre\lib\javaws.jar</span><br><span class="line">D:\JAVA\jdk1.8_0_211\jre\lib\jce.jar</span><br><span class="line">D:\JAVA\jdk1.8_0_211\jre\lib\jfr.jar</span><br><span class="line">D:\JAVA\jdk1.8_0_211\jre\lib\jfxswt.jar</span><br><span class="line">D:\JAVA\jdk1.8_0_211\jre\lib\jsse.jar</span><br><span class="line">D:\JAVA\jdk1.8_0_211\jre\lib\management-agent.jar</span><br><span class="line">D:\JAVA\jdk1.8_0_211\jre\lib\plugin.jar</span><br><span class="line">D:\JAVA\jdk1.8_0_211\jre\lib\resources.jar</span><br><span class="line">D:\JAVA\jdk1.8_0_211\jre\lib\rt.jar</span><br><span class="line">----------------------------------上为Application ClassLoader</span><br><span class="line"></span><br><span class="line">E:\aPersonalData\Temporary\Test01\out\production\Test01</span><br><span class="line">D:\IntelliJ IDEA\IntelliJ IDEA 2021.2.3\lib\idea_rt.jar</span><br><span class="line"></span><br><span class="line">Process finished with exit code 0</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<blockquote>
<p>对于虚拟机，只有两种不同的类加载器：</p>
<p>1.启动类加载器(Bootstrap ClassLoader)，这个类加载器使用C++语言实现，是虚拟机自身的一部分；</p>
<p>2.其它所有的类加载器，这些类加载器都由Java语言实现，独立于虚拟机外部，并且全部继承自java.lang.ClassLoader。</p>
<p>具体划分，如下：</p>
<ol>
<li>启动类加载器(Bootstrap ClassLoader)：这个类加载器负责将放置在<JAVA_HOME>\lib目录中的，或者被-Xbootclasspath参数所指定路径中的，并且是虚拟机能识别的(仅按照文件名识别，如rt.jar，名字不符合的类库即使放置在lib目录中也不会被加载)类库加载到虚拟机内存中。启动类加载器无法被Java程序直接使用，因为是C++语言实现的。</li>
<li>扩展类加载器(Extension ClassLoader)：这个类加载器由sun.misc.Launcher$ExtClassLoader实现，它负责加载<JAVA_HOME>\lib\ext目录中的，或者被java.ext.dirs系统变量所指定的路径中的所有类库，开发者可以直接使用扩展类加载器。</li>
<li>应用程序类加载器(Application ClassLoader)：这个类加载器由sum.misc.Launcher.$AppClassLoader来实现。由于这个类加载器是ClassLoader中的getSystemClassLoader()方法的返回值，所以一般也被称为系统类加载器。它负责加载用户类路径上所指定的类库（classPath），开发者可以直接使用这个类加载器，如果应用程序中没有自定义过自己的类加载器，一般情况下这个就是程序中默认的类加载器。</li>
</ol>
</blockquote>
<h3 id="3-6-自定义加载器"><a href="#3-6-自定义加载器" class="headerlink" title="3.6 自定义加载器"></a>3.6 自定义加载器</h3><p>手动加载类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.openlab;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ClassLoaderTest04</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">        <span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> ClassLoaderTest04.class.getClassLoader().loadClass(<span class="string">&quot;com.openlab.Person&quot;</span>);</span><br><span class="line">        System.out.println(clazz.getName());</span><br><span class="line"><span class="comment">//       类加载器也可以用来加载资源</span></span><br><span class="line"><span class="comment">//       ClassLoaderTest04.class.getClassLoader().getResourceAsStream();</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这种加载方式 通常使用在 </p>
<ul>
<li>Tomcat 加载 Servlet</li>
<li>Spring 框架中加载ApplicationContext</li>
<li>在写一些类库或修改底层框架时 常会使用到</li>
</ul>
<p><em>用于在于 根据需求 调用相对应的方法加载某个类 、</em></p>
<p>源码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> Class&lt;?&gt; loadClass(String name, <span class="type">boolean</span> resolve)</span><br><span class="line">    <span class="keyword">throws</span> ClassNotFoundException</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// 加锁</span></span><br><span class="line">    <span class="keyword">synchronized</span> (getClassLoadingLock(name)) &#123;</span><br><span class="line">        <span class="comment">// First, check if the class has already been loaded</span></span><br><span class="line">        Class&lt;?&gt; c = findLoadedClass(name);</span><br><span class="line">        <span class="keyword">if</span> (c == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="type">long</span> <span class="variable">t0</span> <span class="operator">=</span> System.nanoTime();</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line"><span class="comment">//继续使用parent的classloader 递归调用loadClass方法</span></span><br><span class="line">                <span class="keyword">if</span> (parent != <span class="literal">null</span>) &#123;</span><br><span class="line">                    c = parent.loadClass(name, <span class="literal">false</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    c = findBootstrapClassOrNull(name);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">                <span class="comment">// ClassNotFoundException thrown if class not found</span></span><br><span class="line">                <span class="comment">// from the non-null parent class loader</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用findClass方法去找class</span></span><br><span class="line">            <span class="keyword">if</span> (c == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="comment">// If still not found, then invoke findClass in order</span></span><br><span class="line">                <span class="comment">// to find the class.</span></span><br><span class="line">                <span class="type">long</span> <span class="variable">t1</span> <span class="operator">=</span> System.nanoTime();</span><br><span class="line">                c = findClass(name);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// this is the defining class loader; record the stats</span></span><br><span class="line">                sun.misc.PerfCounter.getParentDelegationTime().addTime(t1 - t0);</span><br><span class="line">                sun.misc.PerfCounter.getFindClassTime().addElapsedTimeFrom(t1);</span><br><span class="line">                sun.misc.PerfCounter.getFindClasses().increment();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (resolve) &#123;</span><br><span class="line">            resolveClass(c);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> c;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>实现自定义加载器步骤：</p>
<ol>
<li><p>继承ClassLoader</p>
</li>
<li><p>重写模板方法 findClass</p>
</li>
<li><p>调用defineClass方法</p>
</li>
</ol>
<blockquote>
<p>实现需求：从目录中读取class文件 将class文件通过自定义加载器进行加载 –利用IO流</p>
</blockquote>
<p>针对问题优化：–由于Java语言容易被反编译</p>
<ul>
<li>如何防止反编译</li>
<li>如何防止篡改</li>
</ul>
<p>解决方案 –在自定义加载器中对class文件进行加密 解密</p>
<p>自定义加载器代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.openlab;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MacluClassLoader</span> <span class="keyword">extends</span> <span class="title class_">ClassLoader</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> Class&lt;?&gt; findClass(String name) <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(</span><br><span class="line">                <span class="string">&quot;c:/test&quot;</span>,</span><br><span class="line">                name.replaceAll(<span class="string">&quot;.&quot;</span>,<span class="string">&quot;/&quot;</span>).concat(<span class="string">&quot;.class&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">FileInputStream</span> <span class="variable">fis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(file);</span><br><span class="line">            <span class="type">ByteArrayOutputStream</span> <span class="variable">baos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">            <span class="type">int</span> <span class="variable">b</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> ((b = fis.read())!=<span class="number">0</span>)&#123;</span><br><span class="line">                baos.write(b);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">          <span class="type">byte</span>[] bytes = baos.toByteArray();</span><br><span class="line"></span><br><span class="line">            baos.close();</span><br><span class="line">            fis.close();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> defineClass(name,bytes,<span class="number">0</span>,bytes.length);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">         <span class="keyword">return</span> <span class="built_in">super</span>.findClass(name);<span class="comment">// throw ClassNotFoundException</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, IllegalAccessException, InstantiationException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">ClassLoader</span> <span class="variable">cl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MacluClassLoader</span>();</span><br><span class="line">        <span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> cl.loadClass(<span class="string">&quot;com.openlab.Person&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Person</span> <span class="variable">person</span> <span class="operator">=</span> (Person) clazz.newInstance();</span><br><span class="line">        person.m();</span><br><span class="line"></span><br><span class="line">        System.out.println(cl.getClass().getClassLoader());</span><br><span class="line">        System.out.println(cl.getParent());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>通过定义自己格式的classloader（一般情况下class文件就是一个二进制文件流）可以采用一种比较简单的方式对class文件进行加密和解密</p>
<ul>
<li><p>加密： 通过^ 异或 可以定义 一个数字 在读取每一个字节后写入操作时，使用流里面获取到的数据和这个数字进行异或的算法， 从而进行加密的操作</p>
</li>
<li><p>解密: 字节数字 ^ 这个数字 ^ 这个数字 就完成了解密的操作</p>
</li>
</ul>
<p>自定义加载器 并实现 加密 - 解密  代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.openlab;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MacluClassLoaderWithEncription</span> <span class="keyword">extends</span> <span class="title class_">ClassLoader</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">seed</span> <span class="operator">=</span> <span class="number">0B10110110</span>; <span class="comment">// 进行参加加密算法的数字</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> Class&lt;?&gt; findClass(String name) <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(</span><br><span class="line">                <span class="string">&quot;c:/test&quot;</span>,</span><br><span class="line">                name.replaceAll(<span class="string">&quot;.&quot;</span>,<span class="string">&quot;/&quot;</span>).concat(<span class="string">&quot;.class&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">FileInputStream</span> <span class="variable">fis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(file);</span><br><span class="line">            <span class="type">ByteArrayOutputStream</span> <span class="variable">baos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">            <span class="type">int</span> <span class="variable">b</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> ((b = fis.read())!=<span class="number">0</span>)&#123;</span><br><span class="line">                baos.write(b^seed);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="type">byte</span>[] bytes = baos.toByteArray();</span><br><span class="line"></span><br><span class="line">            baos.close();</span><br><span class="line">            fis.close();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> defineClass(name,bytes,<span class="number">0</span>,bytes.length);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>.findClass(name);<span class="comment">// throw ClassNotFoundException</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, IllegalAccessException, InstantiationException, IOException &#123;</span><br><span class="line"></span><br><span class="line">        encFile(<span class="string">&quot;com.openlab.Person&quot;</span>);</span><br><span class="line">        <span class="type">ClassLoader</span> <span class="variable">cl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MacluClassLoaderWithEncription</span>();</span><br><span class="line"></span><br><span class="line">        <span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> cl.loadClass(<span class="string">&quot;com.openlab.Person&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Person</span> <span class="variable">person</span> <span class="operator">=</span> (Person) clazz.newInstance();</span><br><span class="line">        person.m();</span><br><span class="line"></span><br><span class="line">        System.out.println(cl.getClass().getClassLoader());</span><br><span class="line">        System.out.println(cl.getParent());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">encFile</span><span class="params">(String name)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(</span><br><span class="line">                <span class="string">&quot;c:/test/&quot;</span>,</span><br><span class="line">                name.replace(<span class="string">&quot;.&quot;</span>,<span class="string">&quot;/&quot;</span>).concat(<span class="string">&quot;.class&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="type">FileInputStream</span> <span class="variable">fis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(file);</span><br><span class="line">        <span class="type">FileOutputStream</span> <span class="variable">fos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;c:/test&quot;</span>,name.replaceAll(<span class="string">&quot;.&quot;</span>,<span class="string">&quot;/&quot;</span>).concat(<span class="string">&quot;.macluclass&quot;</span>)));</span><br><span class="line">        <span class="type">int</span> <span class="variable">b</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> ((b = fis.read())!=-<span class="number">1</span>)&#123;</span><br><span class="line">            fos.write(b^seed);</span><br><span class="line">        &#125;</span><br><span class="line">        fis.close();</span><br><span class="line">        fos.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="3-7-编译器-JIT"><a href="#3-7-编译器-JIT" class="headerlink" title="3.7 编译器 JIT"></a>3.7 编译器 JIT</h3><p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220802145305626.png" alt="image-20220802145305626"></p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220802145053434.png" alt="image-20220802145053434"></p>
<p>Java：</p>
<ul>
<li>解释器： bytecode-interpreter</li>
<li>即时编辑器：JIT Just In Time compiler</li>
</ul>
<p>java程序执行流程：</p>
<p>x.java –&gt;javac 通过编译 –&gt; x.class –&gt;classfile 通过 classloader 进行加载（期间需要类库的支持）–&gt; 加载后 通过两个方式 ：解释器 与JIT 即时编译器 执行</p>
<ul>
<li>解释器 通过解释class文件 进行执行</li>
<li>即使编译器 将class文件变成本地文件 –例如windows中 .exe 文件</li>
</ul>
<p>引出问题：Java是解释型语言还是编译型语言？</p>
<p>Java可以使用 编译器 进行编译执行 同样可以使用 解释器 进行解释执行 主要根据需求来对JVM进行参数设置</p>
<p><strong>&#x3D;&#x3D;Java程序执行默认是一种混合模式&#x3D;&#x3D;</strong></p>
<ul>
<li><p>混合模式：使用解释器+热点编辑器 hotspot</p>
<p>起始阶段采用解释来执行 同时伴有 热点代码的检测 默认值为10000</p>
<ul>
<li><p>多次被调用的方法(通过方法计数器检测 ：检测方法的执行频率)</p>
</li>
<li><p>多次被调用的循环(通过循环计数器检测 ：检测循环的执行频率)</p>
</li>
</ul>
</li>
</ul>
<p><strong>当这样的一个循环或者是一个方法，或者是一段代码，被多次调用，判定这段代码执行频率特别高的情况下，就将这段代码编译成本地的代码，在下次直接访问的时候，直接访问本地的代码。不需要解释器对其进行解释执行。从而达到效率的提升。这种执行代码的方式被称为混合模式。</strong></p>
<p>为什么不直接编译成本地代码，编译的执行速度更快？能够提高效率？</p>
<ol>
<li>现在的解释器的执行效率已经是非常高了，对于一些简单的代码执行，它的性能并不输于编译器。</li>
<li>当要执行的程序依赖类库特别多的情况下，在虚拟机中编译一遍，会导致启动过程会非常的缓慢。</li>
</ol>
<p>更改JVM执行代码参数：</p>
<ul>
<li><p>-Xmixed 为混合模式：</p>
<p> 开始解释执行，启动速度比较快，对热点代码进行检测和编译。</p>
</li>
<li><p>-Xint 解释模式</p>
<p> 启动速度很快，执行较慢</p>
</li>
<li><p>-Xcomp 纯编译模式</p>
<p>启动较慢，执行较快</p>
</li>
</ul>
<p>代码案例：测试这三个jvm参数</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.openlab;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WayToRunTest01</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">        <span class="comment">//这段代码被短时间执行很多次，请JVM虚拟机对其进行优化</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;<span class="number">10_0000</span>;i++)</span><br><span class="line">            m();</span><br><span class="line">        <span class="type">long</span> <span class="variable">start</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;<span class="number">10_0000</span>;i++)&#123;</span><br><span class="line">            m();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(end-start);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 该方法本身没有意义，就是耗时间用的。</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">m</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;<span class="number">10_0000L</span>;i++)&#123;</span><br><span class="line">             <span class="type">long</span> <span class="variable">j</span> <span class="operator">=</span> i%<span class="number">3</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>默认混合模式：2345</p>
<p>-Xint 解释模式：6522</p>
<p>-Xcomp纯编译模式：5973</p>
<h3 id="3-8-懒加载"><a href="#3-8-懒加载" class="headerlink" title="3.8 懒加载"></a>3.8 懒加载</h3><p>classfile加载到工程中 一共有三个部分</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220802150756088.png" alt="image-20220802150756088"></p>
<p>initializing 实际上为 lazyInitializing 懒加载 严格上讲 应该是懒初始化</p>
<p>扩展：JVM规范中并没有规定什么时候加载 但是严格规定了初始化的规则  以下情况需要执行初始化</p>
<ol>
<li><p>New对象  getstatic 访问静态变量  putstatic 访问静态实例 invokestatic指令</p>
<p>以上指令是必须要初始化这个类  访问final变量除外</p>
</li>
<li><p>反射调用的时候 必须要初始化这个类</p>
</li>
<li><p>初始化子类的时候 首先父类初始化</p>
</li>
<li><p>虚拟机启动时 被执行的主类必须要初始化</p>
</li>
<li><p>动态语言支持java.lang.invoke.MethodHandler解析结果为REF-getstatic REF-putstatic REF-invokestatic的方法句柄时 该类必须要初始化</p>
</li>
</ol>
<p>案例代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.openlab;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LazyLoadingTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line"><span class="comment">//        P p;</span></span><br><span class="line"><span class="comment">//        X x = new X();</span></span><br><span class="line"><span class="comment">//        System.out.println(P.i);</span></span><br><span class="line"><span class="comment">//        System.out.println(P.j);</span></span><br><span class="line">        Class.forName(<span class="string">&quot;com.openlab.LazyLoadingTest$P&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">P</span>&#123;</span><br><span class="line">        <span class="keyword">final</span>  <span class="keyword">static</span> <span class="type">int</span> i=<span class="number">8</span>;<span class="comment">// 打印final的值是不需要加载整个类的</span></span><br><span class="line">        <span class="keyword">static</span> <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">9</span>;</span><br><span class="line">        <span class="keyword">static</span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;P&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">X</span> <span class="keyword">extends</span> <span class="title class_">P</span>&#123;</span><br><span class="line">        <span class="keyword">static</span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;X&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<blockquote>
<p>面试题：如何打破classloader的双亲委派机制？</p>
</blockquote>
<p>主要思想 策略：重写Classloader中的loadClass方法 而不是findClass方法</p>
<p>重写Classloader就能够打破双亲委派的机制</p>
<p>&#x3D;&#x3D;什么时候需要打破需要去打破双亲委派的机制？&#x3D;&#x3D;</p>
<ol>
<li>在JDK1.2版本之前 要自定义classloader 必须要重写loadClass方法</li>
<li>在一个线程中设定自己的线程上下文的加载器对象 ThreadContextClassLoader 可以实现基础调用实现类的代码， 通过thread.setContextClassLoader 来设定classloader。</li>
<li>模块化的 热部署 热启动 的情况下 也可以打破classloader的双亲委派机制<br>例如osgi和tomcat 都有自己的模块指定classloader，可以加载同一个类库的不同版本的对象，来可以打破classloader的双亲委派机制，目前这个方式用的比较多。</li>
</ol>
<p>Tomcat中 Webapplication 对象是可以存在多个的，有两个Webapplication 被加载，但是他们的版本不同，这种情况下可以打破双亲委派的。</p>
<p>注意：类的名字的是相同的 只是说版本不同 如果采用双亲委派的机制，那么这两个对象是不可能加载到同一个空间里面 因为加载的过程中，发现在同一空间有同名的类，那么他一定不会被加载。</p>
<p>所以tomcat的每一个Webapplication 都有一个classloader</p>
<p>双亲委派模式加载：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.openlab;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ClassReloadingTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String [] args)</span> <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">        <span class="type">MacluClassLoader</span> <span class="variable">classloader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MacluClassLoader</span>();</span><br><span class="line">        <span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> classloader.loadClass(<span class="string">&quot;com.openlab.Person&quot;</span>);</span><br><span class="line">        classloader = <span class="literal">null</span>;</span><br><span class="line">        System.out.println(clazz.hashCode());</span><br><span class="line">        classloader = <span class="literal">null</span>;</span><br><span class="line">        classloader = <span class="keyword">new</span> <span class="title class_">MacluClassLoader</span>();</span><br><span class="line">        <span class="type">Class</span> <span class="variable">clazz1</span> <span class="operator">=</span> classloader.loadClass(<span class="string">&quot;com.openlab.Person&quot;</span>);</span><br><span class="line">        System.out.println(clazz1.hashCode());</span><br><span class="line">        System.out.println(clazz == clazz1);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>从上案例中可以看出，双亲委派，即便重新创建了classloader对象，那么曾经被加载的对象，再次加载的时候，加载的还是这个对象。</p>
<p>热部署应该如何实现</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.openlab;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">T012_ClassReloading2</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">MyLoader</span> <span class="keyword">extends</span> <span class="title class_">ClassLoader</span> &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> Class&lt;?&gt; loadClass(String name) <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">            <span class="type">File</span> <span class="variable">f</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;C:/test/&quot;</span> + name.replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;/&quot;</span>).concat(<span class="string">&quot;.class&quot;</span>));</span><br><span class="line">            <span class="keyword">if</span>(!f.exists()) <span class="keyword">return</span> <span class="built_in">super</span>.loadClass(name);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(f);</span><br><span class="line">                <span class="type">byte</span>[] b = <span class="keyword">new</span> <span class="title class_">byte</span>[is.available()];</span><br><span class="line">                is.read(b);</span><br><span class="line">                <span class="keyword">return</span> defineClass(name, b, <span class="number">0</span>, b.length);</span><br><span class="line">            &#125; <span class="keyword">catch</span> ( FileNotFoundException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">super</span>.loadClass(name);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">MyLoader</span> <span class="variable">m</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyLoader</span>();</span><br><span class="line">        <span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> m.loadClass(<span class="string">&quot;com.openlab.Person&quot;</span>);</span><br><span class="line">        m = <span class="keyword">new</span> <span class="title class_">MyLoader</span>();</span><br><span class="line">        <span class="type">Class</span> <span class="variable">clazzNew</span> <span class="operator">=</span> m.loadClass(<span class="string">&quot;com.openlab.Person&quot;</span>);</span><br><span class="line">        System.out.println(clazz == clazzNew);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<blockquote>
<p>复习 初始化</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.openlab;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        System.out.println(T.count);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">T</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> count=<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">T</span> <span class="variable">t</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">T</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">T</span><span class="params">()</span>&#123;</span><br><span class="line">        count++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>分析执行过程：</p>
<p>当我们调用T.count的时候，需要把T.class load到内存，通过appclassloader到内存， 进行校验，然后在进行 preparation 对T中的静态变量进行赋默认值，这个时候count的默认值为0，然后进行resolution 解析，最后在进行initialzing 给这些值进行赋初始值。</p>
<p><strong>构造器先执行 – 后静态代码再执行赋值</strong></p>
<p>如果我们定义成员变量public int m &#x3D; 8; m什么时候被赋初始值，</p>
<p>当创建T对象的时候，才会赋默认值，当调用构造方法的时候才会赋值为8</p>
<p>New — 申请内存 — 默认值 — 初始值</p>
<blockquote>
<p>单例模式复习</p>
</blockquote>
<p>Double check loading</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.openlab;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ConcurrentHashMap;</span><br><span class="line"><span class="comment">//懒汉式</span></span><br><span class="line"><span class="comment">// 虽然达到了按需初始化的目的，但是带来线程不安全问题</span></span><br><span class="line"><span class="comment">// 可以通过synchronized 解决 但也带来效率下降</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Singleton</span> &#123;</span><br><span class="line"></span><br><span class="line">     <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> Singleton instance;<span class="comment">// JIT</span></span><br><span class="line">     <span class="keyword">private</span> <span class="title function_">Singleton</span><span class="params">()</span>&#123;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="type">ConcurrentHashMap</span> <span class="variable">chm</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">     <span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title function_">getInstance</span><span class="params">()</span>&#123;</span><br><span class="line">         <span class="keyword">if</span>(instance == <span class="literal">null</span>)&#123;</span><br><span class="line">             <span class="keyword">synchronized</span> (Singleton.class)&#123;</span><br><span class="line">                 <span class="keyword">if</span>(instance == <span class="literal">null</span>)&#123;</span><br><span class="line">                    <span class="keyword">try</span>&#123;</span><br><span class="line">                        Thread.sleep(<span class="number">1</span>);</span><br><span class="line">                    &#125;<span class="keyword">catch</span>(InterruptedException e)&#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                     instance = <span class="keyword">new</span> <span class="title class_">Singleton</span>();</span><br><span class="line">                 &#125;</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="keyword">return</span> instance;</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>双重锁</p>
<p>第一重检查，说明还没有任何一个线程给它赋值，那么就给它加锁，第二重检查的主要目的，就是为了防止多次被初始化， 因为在第一次检查的初始化的时候，其他线程有可能已经对其进行初始化， 第二次检查如果结果依然为null 说明，在上面的这段代码执行期间，没有其他线程对它进行初始化。</p>
<blockquote>
<p>面试题：上一段代码是否需要加入volatile关键字</p>
</blockquote>
<p>程序的可见性</p>
<p>有序性 –指令重排序</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220808154345620.png" alt="image-20220808154345620"></p>
<p>用jclasslib</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220808154357699.png" alt="image-20220808154357699"></p>
<p>当调用new的指令的时候，那么内存已经申请了 invokespecial是调用构造方法，如果把内存中额m的值原来是0 现在变成8 astore_1 指的是将结果赋值给小ta，但是因为指令重排序的问题，那么invokespecial 和astore_1 的执行顺序可能会产生变化的。如果发生了指令重排序的问题，astore_1指令先执行的话 就相当于把这个内存地址扔给了ta 然后在进行初始化。 类似双重检查时到一半的时候的初始化问题。</p>
<h2 id="Chapter4-JMM-Java内存架构"><a href="#Chapter4-JMM-Java内存架构" class="headerlink" title="Chapter4  JMM Java内存架构"></a>Chapter4  JMM Java内存架构</h2><p><strong>Java memory model</strong></p>
<h3 id="4-1-硬件层并发优化的基础知识"><a href="#4-1-硬件层并发优化的基础知识" class="headerlink" title="4.1 硬件层并发优化的基础知识"></a>4.1 硬件层并发优化的基础知识</h3><p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220808155347587.png" alt="image-20220808155347587"></p>
<p>寄存器如何读取硬盘中的内容， 首先将硬盘的数据load到内存中，然后寄存器先到高速缓存中去找，如果找到就直接使用，速度是非常快的，如果没找到，就去下层的高速缓存中去寻找，依次类推。</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220808155420699.png" alt="image-20220808155420699"></p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220808155556886.png" alt="image-20220808155556886"></p>
<p>假如 有一个数字在主存中，这个数字会被load到L3缓存中，L2和L1高速缓存是在CPU的内部的，主存中的数字会被load到不同的CPU中，第一个cpu把x赋值为1，第二个CPU把x赋值为2 那么就会产生一个问题 数据一致性问题。</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220808161744716.png" alt="image-20220808161744716"></p>
<p>当多个CPU 访问主存的时候，会因为更改主存中的数据值，可以给总线加锁，也就是说当一个CPU访问主存中的数据的时候 其他的CPU不能对总线进行访问，老的CPU的做法，这个锁被称为总线锁， 但是这种方法效率是比较低的。</p>
<p>新的CPU 会使用各种各样的办法来解决一致性的问题。</p>
<p>MESI 数据一致性协议的一种。</p>
<p>MSI MESI MOSI Synapse FireFly Dragon 都是数据的一致性协议。</p>
<p>为什么会这么多数据的一致性的协议，CPU的厂商特别多</p>
<p>MESI intel的CPU 使用的MESI一致性协议。</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/xiaowenmu1/article/details/89705740">https://blog.csdn.net/xiaowenmu1/article/details/89705740</a></p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220808161806061.png" alt="image-20220808161806061"></p>
<p>MESI 这个协议是给每个缓存的内容做了一个标记，如果CPU读取了一个数字进来 X，这个x和主存中的内容相比，到底有没有改变这个值，如果更改了，就标记为m也就是modified如果x可以被独享，就标记为Excusive，如果这个x 被其他的别人也可以使用，就标记为shared，如果x在读的时候被其他CPU改过了，就标记为Invalid。</p>
<p>MESI协议让各个CPU的缓存保持一致性的，如果要使用的数字是Invalid，马上要对这个数字进行计算，那么这种情况 需要到主存中再把这个数字读一遍，它就变得有效了。</p>
<p>MESI 也叫缓存锁。</p>
<p>现在的CPU的底层解决数据的一致性： 通过MESI缓存锁+总线锁 组合来实现的。</p>
<h3 id="4-2-缓存行和伪共享"><a href="#4-2-缓存行和伪共享" class="headerlink" title="4.2 缓存行和伪共享"></a>4.2 缓存行和伪共享</h3><p>当我们要把内存中的数据放入到缓存里的时候，它不会只把这一个数据放入到缓存中，例如int i&#x3D; 12 它只有4个字节，不会只把这4个字节读取到缓存中，为了提高效率，而是会把这4个字节后面的一对内容都读进去 所读进去的这一行内容 就是一个基本的缓存单位，这个缓存的单位被称为缓存行。</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220808163035465.png" alt="image-20220808163035465"></p>
<p>Cacheline 缓存行 —-基本单位。</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220808163116027.png" alt="image-20220808163116027"></p>
<p>伪共享 面试题</p>
<p>X和Y 位于同一个缓存行 第一个cpu只使用x 读的时候会把x和y都读出来，第二个CPU只要y变量也会把x和y都读进来。这种情况下会出现伪共享问题。</p>
<p>第一个cpu在修改了x的值之后，会通知其他cpu，x已经被修改了，其他CPU会标记x为invalid 状态，在通知的时候 变更的是整个缓存行的内容，那么这个时候，第二个cpu要使用y这个变量，就会到主存中再次去读取整个缓存行的内容，那么y变量才有效，第二个cpu也会通知其他cpu y的变量又改了一遍，而第一个cpu跟y是没关系，他只要读x 结果他又要把整个缓存行重新读一遍。</p>
<p>两个不相干的cpu在读取内容的时候，会因为缓存行的关系 产生互相影响。这种情况叫做伪共享。</p>
<p>代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.openlab;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CacheLineTest01</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">T</span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">volatile</span> <span class="type">long</span> <span class="variable">x</span> <span class="operator">=</span> <span class="number">0L</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> T[] arr = <span class="keyword">new</span> <span class="title class_">T</span>[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        arr[<span class="number">0</span>] = <span class="keyword">new</span> <span class="title class_">T</span>();</span><br><span class="line">        arr[<span class="number">1</span>] = <span class="keyword">new</span> <span class="title class_">T</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">Thread</span> <span class="variable">t1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(()-&gt;&#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">long</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i&lt;<span class="number">1000_0000L</span>;i++)&#123;</span><br><span class="line">                arr[<span class="number">0</span>].x = i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="type">Thread</span> <span class="variable">t2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(()-&gt;&#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">long</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i&lt;<span class="number">1000_0000L</span>;i++)&#123;</span><br><span class="line">                arr[<span class="number">1</span>].x = i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> <span class="type">long</span> <span class="variable">start</span> <span class="operator">=</span> System.nanoTime();</span><br><span class="line">        t1.start();</span><br><span class="line">        t2.start();</span><br><span class="line">        t1.join();</span><br><span class="line">        t2.join();</span><br><span class="line">        System.out.println((System.nanoTime() - start)/<span class="number">100_0000</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220808163205632.png" alt="image-20220808163205632"></p>
<p>执行时间</p>
<p>200多-300多</p>
<p>代码二 缓存行对其</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.openlab;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CacheLineTest02</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Padding</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">volatile</span> <span class="type">long</span> p1, p2, p3, p4, p5, p6, p7; <span class="comment">//缓存行对其</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">T</span> <span class="keyword">extends</span> <span class="title class_">Padding</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">volatile</span> <span class="type">long</span> <span class="variable">x</span> <span class="operator">=</span> <span class="number">0L</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> T[] arr = <span class="keyword">new</span> <span class="title class_">T</span>[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        arr[<span class="number">0</span>] = <span class="keyword">new</span> <span class="title class_">T</span>();</span><br><span class="line">        arr[<span class="number">1</span>] = <span class="keyword">new</span> <span class="title class_">T</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Thread</span> <span class="variable">t1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(()-&gt;&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">long</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">1000_0000L</span>; i++) &#123;</span><br><span class="line">                arr[<span class="number">0</span>].x = i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="type">Thread</span> <span class="variable">t2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(()-&gt;&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">long</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">1000_0000L</span>; i++) &#123;</span><br><span class="line">                arr[<span class="number">1</span>].x = i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> <span class="type">long</span> <span class="variable">start</span> <span class="operator">=</span> System.nanoTime();</span><br><span class="line">        t1.start();</span><br><span class="line">        t2.start();</span><br><span class="line">        t1.join();</span><br><span class="line">        t2.join();</span><br><span class="line">        System.out.println((System.nanoTime() - start)/<span class="number">100_0000</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>类T 继承了Padding 类 T 对象new 处理就占了64个字节 正好对应一个缓存行，arr [0].x</p>
<p>在写回主存的时候，不需要通知Cpu2 就不会频繁的再去重主存中更新数据。</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220808163411544.png" alt="image-20220808163411544"></p>
<p>执行时间</p>
<p>120-130左右</p>
<p>解决伪共享的问题： 使用缓存行对其的方式 能够提高效率 它也会浪费一定的空间。</p>
<p>有volatile 去修饰变量 在进行写的操作 汇编代码 出现第二行汇编代码</p>
<p>Lock前缀的指令在多核的处理器下引发两件事情</p>
<ol>
<li><p>将当前处理器缓存行的数据写回到系统内存</p>
</li>
<li><p>这个写回内存的操作会使其他的cpu李的缓存的该内存地址的数据无效</p>
</li>
</ol>
<p>为了去提高处理的速度，CPU不直接和内存进行通信，而是先将系统内存的数据读到内部缓存(L1 和L2 或其他)后，再进行操作，但操作完不知道何时会写入到内存，如果声明volatile的变量的写的操作 JVM就会向CPU发送一条Lock前缀指令，将这个变量所在的缓存行的数据写回到系统内存，就算写回处理内存，其他CPU处理的缓存的值还是旧的，再执行计算操作就会有问题，所以在多个cpu 为了保证各个处理器的缓存是一致的，就会实现缓存的一致性协议。</p>
<blockquote>
<p>Volatile的两条实现原则：</p>
</blockquote>
<ol>
<li><p>Lock前缀指令会引起CPU缓存回写到内存中</p>
<p>Lock前缀指令导致在执行指令期间，声明的CPU处理器的Lock信号，该信号在多CPU环境中，cpu可以独占任何共享内存，但CPU的lock信号 一般不锁总线，而是锁缓存，因为总线锁的开销比较大。</p>
<p>对于Intel486和Pentium处理器 在锁的操作时，经常的在总线上声明lock信号，相反它会锁定这块内存区域的缓存，并写回的内存，使用缓存的一致性机制来确保修改的原子性，所以这个操作被称为“缓存锁定”缓存一致性的机制，会阻止同时修改由两个以上的CPU缓存的内存区域数据。</p>
</li>
<li><p>一个CPU的缓存回写到内存会导致其他CPU缓存无效。</p>
<p>Intel处理器 使用MESI协议去维护内部缓存和其他处理器缓存的一致性</p>
<p>缓存行对其、追加字节</p>
</li>
</ol>
<p>LinkedTransferQueue 使用的一个内部类类型来定义队列的头head和尾节点，这个内部类PaddedAtomicReferecne相对于父类AtimicReference 只做了一件事情。就是将共享变量追加到64个字节。</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220808164615323.png" alt="image-20220808164615323"></p>
<h3 id="4-3-乱序问题"><a href="#4-3-乱序问题" class="headerlink" title="4.3 乱序问题"></a>4.3 乱序问题</h3><p> 现在的cpu 为了提高效率 会有各种各样的优化，这个优化被叫做CPU乱序执行。</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220808164636661.png" alt="image-20220808164636661"></p>
<p>CPU为了提高效率会打乱指令的执行顺序。</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220808164646778.png" alt="image-20220808164646778"></p>
<p>读的时候 乱序执行还是好理解一些，写的时候并发叫做合并写。</p>
<p>WCBuffer Write Combine Buffer 合并写。</p>
<p>当cpu需要给某一个数做计算，然后把这个数存储到主存中，在写回主存的时候有L1和L2两个高速缓存。Cpu先把这个数写入L1中 假如L1中没有个数，缓存就没有命中，那么会写入L2中，但是因为L2的速度比较慢，所以在写的过程中，后续的指令也改变了这个数值。那么它就会把这些指令合并到一起 扔到一个合并缓存中，做一个最终的计算结果扔到L2中 这个情况合并写。</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/liushaodong/p/4777308.html">https://www.cnblogs.com/liushaodong/p/4777308.html</a></p>
<p> WCBuffer 这个缓存的级别是高于L1高速缓存 Intel的cpu里面 其实只有4个WC可以被我们同时使用。</p>
<p>一种方式： 写操作的时候 小于4个wc 那么可以同时写1-3个WC 将其写入到L2中</p>
<p>二种方式： 写操作的时候 如果一次写超过4个wc 需要分2次把合并的内容写入到L2中</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220808165052847.png" alt="image-20220808165052847"></p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220808165057124.png" alt="image-20220808165057124"></p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220808165114702.png" alt="image-20220808165114702"></p>
<p>充分的利用合并写 能够看出来分开执行的效率是速度更快的 效率更高</p>
<p>正是由于CPU有一个特别告诉的缓存 只有4个字节 所以一次填写4个的执行效率更快一些 而4+2 模式 4个填充之后 还要等待另外两个其他的字节进行填充，而3+3的模式只要等待1个字节填充就可以执行，执行完了之后还要等待第二次的执行。</p>
<h3 id="4-4-乱序证明"><a href="#4-4-乱序证明" class="headerlink" title="4.4 乱序证明"></a>4.4 乱序证明</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.openlab;</span><br><span class="line"><span class="comment">// 这个程序是美团的人写的</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Disorder</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">x</span> <span class="operator">=</span> <span class="number">0</span>, y = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> <span class="number">0</span>, b =<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(;;) &#123;</span><br><span class="line">                i++;</span><br><span class="line">                x = <span class="number">0</span>; y = <span class="number">0</span>;</span><br><span class="line">                a = <span class="number">0</span>; b = <span class="number">0</span>;</span><br><span class="line">                <span class="comment">// 1 0  0 1  1 1  0 0</span></span><br><span class="line">                <span class="type">Thread</span> <span class="variable">one</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">                    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                        <span class="comment">//由于线程one先启动，下面这句话让它等一等线程two. 读着可根据自己电脑的实际性能适当调整等待时间.</span></span><br><span class="line">                        shortWait(<span class="number">100000</span>);</span><br><span class="line">                        a = <span class="number">1</span>;</span><br><span class="line">                        x = b;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line">                <span class="type">Thread</span> <span class="variable">other</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">                    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                        b = <span class="number">1</span>;</span><br><span class="line">                        y = a;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">                one.start();other.start();</span><br><span class="line">                one.join();other.join();</span><br><span class="line">                <span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> <span class="string">&quot;第&quot;</span> + i + <span class="string">&quot;次 (&quot;</span> + x + <span class="string">&quot;,&quot;</span> + y + <span class="string">&quot;）&quot;</span>;</span><br><span class="line">                <span class="keyword">if</span>(x == <span class="number">0</span> &amp;&amp; y == <span class="number">0</span>) &#123;</span><br><span class="line">                    System.err.println(result);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    System.out.println(result);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">shortWait</span><span class="params">(<span class="type">long</span> interval)</span>&#123;</span><br><span class="line">            <span class="type">long</span> <span class="variable">start</span> <span class="operator">=</span> System.nanoTime();</span><br><span class="line">            <span class="type">long</span> end;</span><br><span class="line">            <span class="keyword">do</span>&#123;</span><br><span class="line">                end = System.nanoTime();</span><br><span class="line">            &#125;<span class="keyword">while</span>(start + interval &gt;= end);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p> 1 0 0 1 1 1 如果一旦出现 a-0 b-0 乱序的问题就发生了。</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220808165219357.png" alt="image-20220808165219357"></p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220808165222723.png" alt="image-20220808165222723"></p>
<h3 id="4-5-如何保证特定情况下不乱序"><a href="#4-5-如何保证特定情况下不乱序" class="headerlink" title="4.5 如何保证特定情况下不乱序"></a>4.5 如何保证特定情况下不乱序</h3><p> Java的层面 应用volatile关键字去修饰变量 保证有序性</p>
<p>硬件层面：使用CPU的汇编指令</p>
<ol>
<li><p>加锁 加锁百分百能够完成了 提高效率 在CPU的指令级别中很多cpu都做了同一件事，内存屏障 也叫内存栅栏。</p>
</li>
<li><p>这里说的cpu的内存屏障 和java的内存屏障没有关系。</p>
</li>
</ol>
<p>拿Intel处理器的内存屏障来说：</p>
<p>不同的CPU 它的内存屏障指令是不一样的，而且有逻辑上也有区别。</p>
<p>Intel 的内存屏障的设计比较简单 只有三条指令。</p>
<p>指令1 ：sfence 写屏障 在sfence 指令前的写操作 必须在sfence 指令的写操作前完成。</p>
<p>指令2： lfence 读屏障 在lfence指令前的读操作 必须在lfence指令的读操作前完成。</p>
<p>指令3：mfence 读写屏障 在mfence 指令的读写操作 必须在mfence指令的读写操作前完成。</p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/64240319ed60">https://www.jianshu.com/p/64240319ed60</a></p>
<p>有序性保障：</p>
<p>Intel lock 指令</p>
<p>原子指令 比如X86上的lock指令是一个FullBarrire 执行的时候会锁住内存子系统来确保执行顺序 甚至可以跨越多个CPU</p>
<p>Software locks 通常使用内存屏障或原子指令来实现变量的可见性和保持程序的执行顺序。  </p>
<p>作业： </p>
<p>博客1 关于内存屏障 java的内存屏障怎么搞。</p>
<p>博客2 如何实线并发的原子性 可见性 有序性。</p>
<h2 id="Chapter5-JVM内存结构"><a href="#Chapter5-JVM内存结构" class="headerlink" title="Chapter5  JVM内存结构"></a>Chapter5  JVM内存结构</h2><p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220823133047662.png" alt="image-20220823133047662"></p>
<p>知识结构：</p>
<ul>
<li>classfile</li>
<li>classloader</li>
<li>内存结构</li>
<li>执行引擎 – 解释器 JIT 即时编译器 GC</li>
</ul>
<blockquote>
<p>类的对象存储在方法区中，堆中存储对象和成员变量，而堆中的对象在方法的执行过程中，需要用到虚拟机栈，程序计数器，以及本地方法栈，方法在执行的时候，它的每行代码都是由执行引擎中的解释器逐行解释的，对于热点代码则通过JIT即时编译器进行编译，在执行引擎中还有一个比较重要的模块，垃圾回收GC，它会对堆中的不再引用对象进行垃圾回收，还会有一些java不太方便实现的功能， 调用底层操作系统的功能，通过本地方法接口来进行实现</p>
</blockquote>
<h3 id="5-1-JVM-系统线程"><a href="#5-1-JVM-系统线程" class="headerlink" title="5.1 JVM 系统线程"></a>5.1 JVM 系统线程</h3><p>有很多的线程其实是在后台运行的，这些后台线程与主函数的主线程以及主线程创建的一些其他线程在一起运行 HotSpotVM 后台运行的系统线程有以下几个</p>
<table>
<thead>
<tr>
<th>线程名称</th>
<th>线程作用</th>
</tr>
</thead>
<tbody><tr>
<td>虚拟机线程（VM thread）</td>
<td>这个线程等待JVM到达安全点操作出现。这些操作必须要再独立的线程里执行，因为当堆修改无法进行时，线程都需要JVM位于安全点，这些操作的类型的有 stop-the-world 垃圾回收，线程栈 dump 线程暂停，线程偏向锁（biased locking）接触</td>
</tr>
<tr>
<td>周期性任务线程</td>
<td>这个线程负责定时器事件（也就是中断） 用来调度周期性操作的执行</td>
</tr>
<tr>
<td>GC线程</td>
<td>这些线程支持JVM 中不同的垃圾回收活动</td>
</tr>
<tr>
<td>编译器线程</td>
<td>这些线程在运行时讲字节码动态编译成本地平台相关的机器码</td>
</tr>
<tr>
<td>信号分发线程</td>
<td>这个线程接受发送到JVM的信号并调用适当的JVM方法处理</td>
</tr>
</tbody></table>
<h3 id="5-2-程序计数器"><a href="#5-2-程序计数器" class="headerlink" title="5.2 程序计数器"></a>5.2 程序计数器</h3><p>程序计数器 Program Counter Register</p>
<p> 指的是当前指令（操作码）的地址 本地指令除外，如果当前的方法native方法 PC的值为undefined。 所有的CPU 都有一个PC 每执行一条指令PC都会自增 因此PC存储了指向下一条要被执行的指令。</p>
<p>程序计数器在这里记住的JVM下一条指令的执行地址，当第一条指令执行完，那么解释器就会到程序计数器中取寻找下一条指令。在物理上来讲的话 程序计数器是通过寄存器来实现的</p>
<p>程序计数器特点：</p>
<ul>
<li><p>线程私有</p>
<p>多个线程在执行代码的时候，CPU会用一个调度系数，给线程分配时间片，线程在现有的时间片，没有执行完，那么会让它执行一个暂存的指令，然后切换到其他线程，其他线程也是如此。那么线程在切换的过程中，如果想知道下一个指令执行到哪了，会使用程序计数器来进行记录。</p>
<p>每条线程里都有自己的程序计数器，来记录自己线程执行到的指令 当线程切换后 又切换到原有的线程那么它就从自己的程序计数器中取出要执行的下一条指令</p>
</li>
<li><p>程序计数器 不存在内存溢出 OOM</p>
</li>
<li><p>程序计数器是很小的空间 ，可以把它看成字节码行号的指示器</p>
</li>
</ul>
<h3 id="5-3-虚拟机栈"><a href="#5-3-虚拟机栈" class="headerlink" title="5.3 虚拟机栈"></a>5.3 虚拟机栈</h3><p>Java中每个线程在运行的时候都需要划分内存空间，虚拟机栈是指每个线程在运行时需要的内存空间，所以说每条线程中都会存在一个虚拟机栈，而虚拟机栈中的每一块空间都是一个栈帧，一个栈帧对应着一次方法的调用。</p>
<p>栈帧： 每个方法在执行的时候需要的内存</p>
<p>方法在调用的时候，需要参数 局部变量 返回地址 都是需要地址</p>
<p>一个虚拟机栈是由多个栈帧组成</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220823135537366.png" alt="image-20220823135537366"></p>
<p>栈帧存储 局部变量表 操作栈 动态链接 方法出口等信息 后进先出 <strong>LIFO</strong></p>
<p>Frames 表示栈帧</p>
<p>提出问题：</p>
<ol>
<li><p>垃圾回收是否涉及到虚拟机栈？</p>
<p>不需要 因为每一次方法的执行完之后都会被弹出栈空间 根本就不需要垃圾回收</p>
</li>
<li><p>栈内存分配越大越好吗？</p>
<p><a target="_blank" rel="noopener" href="https://docs.oracle.com/en/java/javase/11/tools/java.html#GUID-3B1CE181-CD30-4178-9602-230B800D4FAE">https://docs.oracle.com/en/java/javase/11/tools/java.html#GUID-3B1CE181-CD30-4178-9602-230B800D4FAE</a></p>
<p>可以通过-Xss来设置栈空间的大小，栈的空间越大 并不会提升程序的运行的速度，反而会让程序的线程数量变少， 因为物理内存是固定的。栈的内存越大 提升方法进行递归调用的次数</p>
</li>
<li><p>方法内的局部变量是否是线程安全的？</p>
<p>主要取决于局部变量被多个线程共享</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220823170311194.png" alt="image-20220823170311194"></p>
<p>如果两个线程中的局部变量互补干扰 那么局部变量是对线程私有的，不会存在线程的安全的问题</p>
<p>当这个变量一旦被static关键字修饰，它就会引发安全问题</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220823170356870.png" alt="image-20220823170356870"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.openlab;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo02</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//        StringBuilder sb = new StringBuilder();</span></span><br><span class="line"><span class="comment">//        sb.append(4);</span></span><br><span class="line"><span class="comment">//        sb.append(5);</span></span><br><span class="line"><span class="comment">//        sb.append(6);</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//        new Thread(()-&gt;&#123;</span></span><br><span class="line"><span class="comment">//           m2(sb);</span></span><br><span class="line"><span class="comment">//        &#125;).start();</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">m1</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">StringBuffer</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>();</span><br><span class="line">        sb.append(<span class="number">1</span>);</span><br><span class="line">        sb.append(<span class="number">2</span>);</span><br><span class="line">        sb.append(<span class="number">3</span>);</span><br><span class="line">        System.out.println(sb.toString());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">m2</span><span class="params">(StringBuilder sb)</span>&#123;</span><br><span class="line"></span><br><span class="line">        sb.append(<span class="number">1</span>);</span><br><span class="line">        sb.append(<span class="number">2</span>);</span><br><span class="line">        sb.append(<span class="number">3</span>);</span><br><span class="line">        System.out.println(sb.toString());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> StringBuilder <span class="title function_">m3</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        sb.append(<span class="number">1</span>);</span><br><span class="line">        sb.append(<span class="number">2</span>);</span><br><span class="line">        sb.append(<span class="number">3</span>);</span><br><span class="line">        <span class="keyword">return</span> sb;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>M1方法 线程安全的 StringBuffer 本身就是一个局部变量 </p>
<p>M2 方法 StringBuilder 变成了一个参数 所以它线程不安全， 有可能会有其他线程访问到它 sb对象 不是线程私有的了。</p>
<p>M3 方法 将StringBuilder 做成了返回值 那么它线程不安全， 其他线程是可以拿到这个方法的返回值的 并且去修改它。</p>
</li>
</ol>
<p>总结：</p>
<ul>
<li>每个线程运行时需要的内存 ——-虚拟机栈</li>
<li>每个栈都由多个栈帧组成 每一个栈帧又对应着方法调用的内存</li>
<li>每个线程只能有一个活动的栈帧 对应着当前正在执行的方法</li>
</ul>
<h4 id="5-3-1-局部变量表"><a href="#5-3-1-局部变量表" class="headerlink" title="5.3.1 局部变量表"></a>5.3.1 局部变量表</h4><p>局部变量表存放内容：</p>
<ol>
<li>编译期 基本数据类型</li>
<li>对象的引用 reference 类型 引用指针</li>
<li>ReturnAddress 类型 – 指向了一条字节码指令</li>
</ol>
<p>64位的long double 会占用两个局部变量的空间(slot) 其余的类型都只占用1个slot</p>
<p>在局部变量表中包含了方法在执行过程中的所有的变量 甚至包括this的引用，方法的参数，其他局部变量 静态方法</p>
<p>在虚拟机规范中，对这个区域规定两种异常情况：</p>
<ol>
<li><p>如果线程请求的栈的深度大于虚拟机所允许的深度</p>
<p>StackOverFlowError</p>
</li>
<li><p>虚拟机的栈是可以进行动态扩展的，当扩展时申请不到足够的内存时</p>
<p>OutOfMemoryError</p>
</li>
</ol>
<h4 id="5-3-2-JVM栈帧"><a href="#5-3-2-JVM栈帧" class="headerlink" title="5.3.2 JVM栈帧"></a>5.3.2 JVM栈帧</h4><p>方法调用的和方法执行的一个数据结构 一个方法从调用到执行完成</p>
<p>每一个栈帧都包括：</p>
<ul>
<li>局部变量表</li>
<li>操作数栈</li>
<li>动态链接</li>
<li>方法返回地址</li>
<li>额外信息</li>
</ul>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220823175433302.png" alt="image-20220823175433302"></p>
<h4 id="5-3-3-操作数栈"><a href="#5-3-3-操作数栈" class="headerlink" title="5.3.3 操作数栈"></a>5.3.3 操作数栈</h4><p>类似局部变量表， 操作栈 也是后进先出</p>
<p>操作数栈的最大深度 class文件中的Code属性max_stacks 数据项</p>
<p>操作数栈可以存储任意类型</p>
<p>32位的数据类型 栈容量为1</p>
<p>64位的数据类型 栈容量为2</p>
<p>栈容量的单位 —-字宽</p>
<p>对32位的虚拟机 一个字宽是 4个字节</p>
<p>对64位的虚拟机 一个字宽是8个字节</p>
<p>在进行算术运算上就是通过操作数栈来进行的</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220823175501748.png" alt="image-20220823175501748">、</p>
<h4 id="5-3-4-动态链接"><a href="#5-3-4-动态链接" class="headerlink" title="5.3.4 动态链接"></a>5.3.4 动态链接</h4><p>每个栈帧都包含 一个指向运行时常量池中这个栈帧属性和方法的引用，持有这个引用是为了支持方法调用过程的动态连接。</p>
<p>在class文件的常量池中有大量的符号引用的，方法在调用的时候调用指令的时候会以符号引用作为参数。</p>
<p>符号引用的一部分是在类的加载阶段或是在第一次使用的时候转化为直接引用 静态解析</p>
<p>另一部分在每次运行期间转化的直接引用动态链接。</p>
<h4 id="5-3-5-方法返回地址"><a href="#5-3-5-方法返回地址" class="headerlink" title="5.3.5 方法返回地址"></a>5.3.5 方法返回地址</h4><p>方法的退出方式有两种</p>
<ul>
<li><p>正常完成出口</p>
<p>执行引擎遇到return的指令返回的字节码指令 返回值和返回类型</p>
</li>
<li><p>异常完成出口</p>
<p>方法在执行时遇到了异常 异常没有在方法体内得到处理 一种是虚拟机内部异常，代码中athrow字节码的异常。当出现异常时是不会产生任何返回值的。</p>
</li>
</ul>
<p> 只要是方法的退出，都要回到方法的调用位置 这个位置是由程序计数器来记录的可以作为返回的地址 栈帧中会保存这个计数器的值，异常退出的话，返回的地址是通过异常处理器来确定的。异常信息是不会保存栈帧中</p>
<h4 id="5-3-6-附加信息"><a href="#5-3-6-附加信息" class="headerlink" title="5.3.6 附加信息"></a>5.3.6 附加信息</h4><p>栈帧的信息</p>
<h3 id="5-4-本地方法栈-Native栈"><a href="#5-4-本地方法栈-Native栈" class="headerlink" title="5.4 本地方法栈 Native栈"></a>5.4 本地方法栈 Native栈</h3><p>和虚拟机栈类似 发挥的作用基本相同。</p>
<p>虚拟机栈是为虚拟机执行字节码服务</p>
<p>本地方法栈是为虚拟机使用到native方法服务</p>
<p>提供支持的JVM一般都会为每个线程创建本地方法栈</p>
<p>C-linkage 模型实现 JNI java native Invocation 这个本地栈就被称为C栈 本地方法栈参数的顺序，返回值和C程序相同的。</p>
<p>Hotspot 直接将虚拟机栈和本地方法栈合二为一</p>
<h3 id="5-5-堆"><a href="#5-5-堆" class="headerlink" title="5.5 堆"></a>5.5 堆</h3><p>Java Heap java虚拟机中管理内存的最大一块 堆是被所有线程共享的内存区域。在虚拟机启动的时候创建。</p>
<p> 所有的对象实例以及数组都要在堆上分配。</p>
<p>栈帧只能存储指向堆中的对象和数组的引用。 对象只能由垃圾回收器移除。</p>
<p>Java堆是收集器管理的主要区域， GC堆 采用的分代收集的算法。</p>
<ul>
<li><p>新生代</p>
<p>经常被分为Eden空间和Survivor空间</p>
</li>
<li><p>老年代</p>
</li>
<li><p>永久带</p>
<p>1.8 的jdk之后，就不存在永久代了。</p>
</li>
</ul>
<p>再细致去分</p>
<ul>
<li>Eden空间</li>
<li>FromSurvivor空间</li>
<li>ToSurvivor 空间</li>
</ul>
<p>进一步划分的目的是为了更好的回收内存或者更快的分配内存</p>
<h4 id="5-5-1-分代策略"><a href="#5-5-1-分代策略" class="headerlink" title="5.5.1 分代策略"></a>5.5.1 分代策略</h4><p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220824161934127.png" alt="image-20220824161934127"></p>
<p>1.8 的jdk之后，就不存在永久代了。被metaspace替代了，采用永久代的方式来实现方法区，永久代 用于放常量类的信息 静态变量等数据 这些数据和垃圾回收的关系不是很大，和垃圾回收关系比较大的两个区域分别是新生代和老年代</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220824162011519.png" alt="image-20220824162011519"></p>
<h3 id="5-6-内存管理"><a href="#5-6-内存管理" class="headerlink" title="5.6 内存管理"></a>5.6 内存管理</h3><p>所有的对象和数组都会在堆内存中进行分配，并且永远不会显示回收，而是由垃圾回收器自动回收。通常新的对象和数组被创建并放入老年代。</p>
<p>Minor 垃圾回收器 回收将发生在新生代，依旧存活的对象将从eden区域移到Survivor区</p>
<p>Major 垃圾回收 一般会导致应用进程的暂停，它将在三个区内移动对象， 仍然存活的对象，被会从新生代移动到老年代。</p>
<p>每次老年代回收时也会进行永久代的回收，它们中任何一个变满了，都会进行回收。</p>
<h4 id="5-6-1-新生代"><a href="#5-6-1-新生代" class="headerlink" title="5.6.1 新生代"></a>5.6.1 新生代</h4><p>新生成的对象优先的放在新生代中，存活率很低</p>
<p>新生代中的常规应用进行一次垃圾回收， 可以回收到70%-95% 效率很高</p>
<p>HotSpot 将新生代划分为三个区</p>
<p>一块比较大的 Eden 伊甸</p>
<p>和两块较小的 Survivor 幸存者</p>
<p>默认比例为：8:1:1 </p>
<p>为什么用这个比例 原因是因为hotspot 采用的复制算法来回收新生代。</p>
<p>大的对象是不会进入新生代的 而是直接进入老年代</p>
<p>当Eden区没有足够的空间进行分配，虚拟机将发起一次MinorGC</p>
<p>GC开始的时候 对象会存在Eden区 。 这个时候FormSurvivor区和ToSurvivor 是空的，作为保留区域。</p>
<p>GC进行时 Eden区的所有存活的对象都会被复制到ToSurvivor 区中 而在FormSurvivor区，扔存活的对象，根据他们的年龄值决定去向。年龄值达到年龄的阀值（15 新生代中的对象每熬过一次GC 年龄就+1）的对象会被移动到老年代中，没有达到阀值的对象会被复制的ToSurvivor区，接着FormSurvivor和ToSurvivor 两者交换角色。都要保证ToSurvivor 区在一轮GC后是空的 GC时 当ToSurvivor没有足够的空间存放上一次新生代收集下来的存活对象，需要依赖老年代进行分配担保，将这些对象放入到老年代。</p>
<h4 id="5-6-2-老年代"><a href="#5-6-2-老年代" class="headerlink" title="5.6.2 老年代"></a>5.6.2 老年代</h4><p>在新生代经历了多次GC（具体要看虚拟机的配置的情况）后仍然存活了下来的对象就会进入老年代，对象的生命周期长，存活率高，在老年代进行GC的频率比较低，而且回收速度也比较慢</p>
<h4 id="5-6-3-永久代-PermanentGeneration-metaspace"><a href="#5-6-3-永久代-PermanentGeneration-metaspace" class="headerlink" title="5.6.3 永久代 PermanentGeneration -metaspace"></a>5.6.3 永久代 PermanentGeneration -metaspace</h4><p>类的信息 常量 静态变量 JIT即时编译器编译后的代码等数据。这个区域是不进行垃圾回收的</p>
<h3 id="5-7-非堆内存"><a href="#5-7-非堆内存" class="headerlink" title="5.7 非堆内存"></a>5.7 非堆内存</h3><p>在逻辑是是JVM的一部分对象，但实际是哪个不在堆上创建</p>
<p>非堆内存：</p>
<ul>
<li>永久代：<ul>
<li>方法区</li>
<li>驻留字符串</li>
</ul>
</li>
</ul>
<p>代码缓存 Code Cache 用于编译和存储哪些被JIT即时编译器编译的原生代码方法</p>
<h3 id="5-8-栈内存溢出"><a href="#5-8-栈内存溢出" class="headerlink" title="5.8 栈内存溢出"></a>5.8 栈内存溢出</h3><p>栈内存溢出情况：</p>
<ol>
<li>栈帧过多的时候容易造成溢出</li>
<li>栈帧过大的时候容易造成溢出</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.openlab;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StackOverflowTest</span> &#123;</span><br><span class="line">    <span class="keyword">private</span>  <span class="keyword">static</span> <span class="type">int</span> count;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            method1();</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Throwable e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            System.out.println(count);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">method1</span><span class="params">()</span>&#123;</span><br><span class="line">        count++;</span><br><span class="line">        method1();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220824171020711.png" alt="image-20220824171020711"></p>
<p>可以通过-Xss256k 去调整栈空间的大小</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220824171045409.png" alt="image-20220824171045409"></p>
<h3 id="5-9-堆内存溢出"><a href="#5-9-堆内存溢出" class="headerlink" title="5.9 堆内存溢出"></a>5.9 堆内存溢出</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.openlab;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HeapOverFlowTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">     <span class="keyword">try</span>&#123;</span><br><span class="line">         List&lt;String&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;String&gt;();</span><br><span class="line">         <span class="type">String</span> <span class="variable">a</span> <span class="operator">=</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">         <span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">             list.add(a);</span><br><span class="line">             a = a+a;<span class="comment">// hellohellohellohello</span></span><br><span class="line">             i++;</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;<span class="keyword">catch</span>(Throwable e)&#123;</span><br><span class="line">         e.printStackTrace();</span><br><span class="line">         System.out.println(i);</span><br><span class="line">     &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220824171114736.png" alt="image-20220824171114736"></p>
<p>通过虚拟机参数去指定堆空间的大小</p>
<p>-Xmx8m</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220824171122692.png" alt="image-20220824171122692"></p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220824171129278.png" alt="image-20220824171129278"></p>
<h3 id="5-10-堆内存诊断"><a href="#5-10-堆内存诊断" class="headerlink" title="5.10 堆内存诊断"></a>5.10 堆内存诊断</h3><ol>
<li>命令行工具 jps<br>查看当前系统中有哪些java</li>
<li>命令行工具 jmap  jmap -heap 进程id<br>查看堆内存中的占用情况</li>
<li>图形界面的工具 多功能的检测工具 可以连续监控<br>jconsole</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.openlab;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo03</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;1...&quot;</span>);</span><br><span class="line">        Thread.sleep(<span class="number">30000</span>);</span><br><span class="line">        <span class="type">byte</span>[] array = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>*<span class="number">1024</span>*<span class="number">10</span>];<span class="comment">// 10M</span></span><br><span class="line">        System.out.println(<span class="string">&quot;2...&quot;</span>);</span><br><span class="line">        Thread.sleep(<span class="number">30000</span>);</span><br><span class="line">        array = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        System.gc();</span><br><span class="line">        System.out.println(<span class="string">&quot;3...&quot;</span>);</span><br><span class="line">        Thread.sleep(<span class="number">1000000L</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>命令行窗口的使用：<br>View -Tool Windows -Terminal</p>
<h4 id="5-10-1-jsp指令"><a href="#5-10-1-jsp指令" class="headerlink" title="5.10.1 jsp指令"></a>5.10.1 jsp指令</h4><p>输入jps指令 查看系统中的java进程</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220824171325350.png" alt="image-20220824171325350"></p>
<h4 id="5-10-2-jmap指令"><a href="#5-10-2-jmap指令" class="headerlink" title="5.10.2 jmap指令"></a>5.10.2 jmap指令</h4><p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220824171408005.png" alt="image-20220824171408005"></p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220824171414254.png" alt="image-20220824171414254"></p>
<p>Heap Configuration 堆的配置</p>
<p>MaxHeapSize 最大的堆内存空间</p>
<p>NewSize 新生代内存</p>
<p>MaxNewSize 最大的新生代内存空间</p>
<p>OldSize 老年代内存</p>
<p>Metaspace 元空间的内存</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220824171427554.png" alt="image-20220824171427554"></p>
<p>Heap Usage 表示堆内存的占用</p>
<p>Edenspace 表示新生代的Eden区</p>
<p>Form Form Survivor</p>
<p>To   To Survivor</p>
<p>Old Generation 表示老年代</p>
<p>实验流程：</p>
<p>Jps 操作</p>
<ol>
<li>Jmap 查看 没有声明数组的内存占用情况</li>
<li>Jmap 查看 有声明数组的内存占用情况</li>
<li>Jmap 查看 数组被赋值为null 以及调用gc之后的内存使用情况</li>
</ol>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220824171524749.png" alt="image-20220824171524749"></p>
<blockquote>
<p> 容量 32M</p>
<p>使用的容量 4.48 M</p>
<p>空闲 27.51M</p>
</blockquote>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220824171545730.png" alt="image-20220824171545730"></p>
<blockquote>
<p>使用容量 14.48M</p>
<p>空闲容量 17.51M</p>
</blockquote>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220824171556147.png" alt="image-20220824171556147"></p>
<blockquote>
<p>使用容量 0.64M</p>
<p>空闲容量 31.35M</p>
</blockquote>
<h4 id="5-10-3-jconsole"><a href="#5-10-3-jconsole" class="headerlink" title="5.10.3 jconsole"></a>5.10.3 jconsole</h4><ol>
<li><p>运行程序</p>
</li>
<li><p>然后在命令行输入jconsole</p>
</li>
</ol>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220824171639542.png" alt="image-20220824171639542"></p>
<ol start="3">
<li>选择不安全连接</li>
</ol>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220824171717553.png" alt="image-20220824171717553"></p>
<ol start="4">
<li>展示监控平台的工具</li>
</ol>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220824171726659.png" alt="image-20220824171726659"></p>
<ol start="5">
<li>里面可以检测出 内存的占用 线程 类的加载情况等等</li>
</ol>
<h4 id="5-10-4-面试题"><a href="#5-10-4-面试题" class="headerlink" title="5.10.4 面试题"></a>5.10.4 面试题</h4><blockquote>
<p> 垃圾回收之后 内存的占用率依旧很高 这种情况应该怎么检测 怎么排解这个问题</p>
</blockquote>
<ol>
<li><p>使用jps去查看进程</p>
</li>
<li><p>然后 jmap -heap +id 进程内存</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220824172342717.png" alt="image-20220824172342717"></p>
<p>而是在老年代里面占用的空间相对比较大 182.88+19.45 —- 200多M</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220824172401399.png" alt="image-20220824172401399"></p>
<p>执行GC 之后 已经进行垃圾回收 ，在执行结果中继续检测，那么能够发现执行的效率不是很高，内存使用率依旧是200多M</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220824172410304.png" alt="image-20220824172410304"></p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220824172414187.png" alt="image-20220824172414187">、</p>
<p>可以看到新生代的内存被回收了一些， 但是老年代还是很多</p>
<p>这里面为什么垃圾回收没有把内存回收掉？ 要对问题进行检测</p>
</li>
<li><p>检测工具：jvisualvm</p>
<p>在命令行输入指令就可以 它也是一个可视化的工具 可视化的虚拟机</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220824172436229.png" alt="image-20220824172436229"></p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220824172439177.png" alt="image-20220824172439177"></p>
<p>堆Dump 是堆空间的快照</p>
<p>把我们此刻的堆的内存信息截取出来， 并且也会把堆中的哪些类型的对象和对象的信息也收集起来</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220824172445857.png" alt="image-20220824172445857"></p>
<p>检查 —-点击查找</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220824172453234.png" alt="image-20220824172453234"></p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220824172458651.png" alt="image-20220824172458651"></p>
<p>在这里可以看到ArrayList这条占用的空间是比较大的 点击进去</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220824172515062.png" alt="image-20220824172515062"></p>
<p>ArrayList这项 占用了200多MB 点开 elementData 能够查看的里面有一个byte[]</p>
<p>还能够发现 200个student对象的创建，就能够排查出来问题的原因，因为student对象没有被回收，student对象是被长期使用的。导致垃圾回收器没有回收它的内存</p>
</li>
</ol>
<p>我们在生产环境中，也是使用证的办法来进行排查 垃圾回收后，内存占用率依旧很大的问题</p>
<h3 id="5-11-方法区MethodArea"><a href="#5-11-方法区MethodArea" class="headerlink" title="5.11 方法区MethodArea"></a>5.11 方法区MethodArea</h3><p><a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/specs/jvms/se7/html/jvms-2.html">https://docs.oracle.com/javase/specs/jvms/se7/html/jvms-2.html</a></p>
<p>方法区 Methodarea 与java中堆一样的，方法区中的数据可以被每个线程共享，用于存储已经被加载的类的信息 ，常量 静态变量 ，以及JIT即时编译器的代码数据 等等。JVM虚拟机的规范中，把方法区描述为堆的一个逻辑部分，也有一个名字来对应 Non-heap 是为了与java中的堆进行分区。</p>
<p>很多人把方法区称为永久代， 本质上其实是不一样，按照HotSpot设计团队选择把GC分代收集扩展至方法区，永久代知识方法区的实现而已 目前永久代被废除 叫metaspace</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220824172750119.png" alt="image-20220824172750119"></p>
<p>Java的虚拟机 对方法区的限制是比较宽松的，除了和java堆一样不需要连续的内存 也可以选择固定的大小或者可以扩展，还可以选择不实现垃圾回收。垃圾回收在方法区中出现的比较少。</p>
<p>方法区 内存回收目标是对常量池的回收和对类型的卸载</p>
<h4 id="5-11-1-方法区结构"><a href="#5-11-1-方法区结构" class="headerlink" title="5.11.1 方法区结构"></a>5.11.1 方法区结构</h4><p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220824172821629.png" alt="image-20220824172821629"></p>
<h4 id="5-11-2-JDK1-6版本-JDK1-7版本-JDK1-8版本"><a href="#5-11-2-JDK1-6版本-JDK1-7版本-JDK1-8版本" class="headerlink" title="5.11.2 JDK1.6版本 JDK1.7版本 JDK1.8版本"></a>5.11.2 JDK1.6版本 JDK1.7版本 JDK1.8版本</h4><p>常量池主要分成以下几种：</p>
<ol>
<li>静态常量池<br>就是.class文件中的常量池， 包含字符串数字这些字面量，还包含 类的方法的信息， 占用了classfile的大部分空间，这个常量池主要用于放两大类的常量：字面量和符号引用，包含了三种类型的常量 类和接口的全限定名 字段名称和描述符，方法名称和描述符</li>
<li>运行时常量池<br>虚拟机会将各个的class文件中常量池载入到运行时常量池中 即编译期间 生成字面量 符号引用，装载class文件</li>
<li>字符串常量池 StringTable<br>可以把它理解为运行时常量池分出来的一部分内容，加载时 对于class的静态常量池 字符串会被装载到字符串常量池中</li>
<li>整型常量池 Integer<br>类似StringTable 可以把它理解为运行时常量池分出来的一部分内容 在加载时如果是整型的数据被装到整型的常量池中</li>
</ol>
<blockquote>
<p>在永久代移出之后，字符串的常量池也不再放在永久代了， 也没有放入到元空间里，而是继续留在了堆空间了Heap-？ 方便回收？</p>
<p>运行时常量池搬到了元空间里， 它是装静态变量 字节码的信息 有它的地方才被称为方法区</p>
</blockquote>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220824175607841.png" alt="image-20220824175607841"></p>
<p>所有的线程共享同一个方法区，因为访问方法区的数据和动态链接的进程必须是线程安全的，方法区存储了每个类的信息，比如：</p>
<ul>
<li><p>lassloader 引用</p>
<p>通过this.getClass().getClassLoader()进行获取</p>
<p>通过上图可以看出来，对象中含有字节码和加载器的地址引用</p>
</li>
<li><p>类型信息</p>
</li>
<li><p>修饰符(public final)</p>
</li>
<li><p>是类还是接口(class,interface)</p>
</li>
<li><p>类的全限定名(Test&#x2F;ClassStruct.class)</p>
</li>
<li><p>直接父类的全限定名(java&#x2F;lang&#x2F;Object.class)</p>
</li>
<li><p>直接父接口的权限定名数组(java&#x2F;io&#x2F;Serializable)</p>
<ul>
<li>运行时常量池</li>
<li>数值型常量</li>
<li>字段引用</li>
<li>方法引用</li>
<li>属性</li>
<li>字段数据</li>
<li>针对每个字段的信息</li>
<li>字段名</li>
<li>类型</li>
<li>修饰符</li>
<li>属性（Attribute）</li>
<li>方法数据</li>
<li>每个方法</li>
<li>方法名</li>
<li>返回值类型</li>
<li>参数类型（按顺序）</li>
<li>修饰符</li>
<li>属性</li>
<li>方法代码</li>
<li>每个方法</li>
<li>字节码</li>
<li>操作数栈大小</li>
<li>局部变量大小</li>
<li>局部变量表</li>
<li>异常表</li>
<li>每个异常处理器</li>
<li>开始点</li>
<li>结束点</li>
<li>异常处理代码的程序计数器（PC）偏移量</li>
<li>被捕获的异常类对应的常量池下标</li>
<li>常量池</li>
</ul>
</li>
</ul>
<p>直接常量：</p>
<ol>
<li>CONSTANT_INGETER_INFO整型直接常量池public final int CONST_INT&#x3D;0;</li>
<li>CONSTANT_String_info字符串直接常量池<br>public final String CONST_STR&#x3D;”CONST_STR”;</li>
<li>CONSTANT_DOUBLE_INFO浮点型直接常量池</li>
</ol>
<p>等等各种基本数据类型基础常量池、方法名、方法描述符、类名、字段名，字段描述符的符号引用</p>
<p>参考博客内容：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43684005/article/details/119615972">https://blog.csdn.net/qq_43684005/article/details/119615972</a></p>
<h4 id="5-11-3-方法区内存溢出"><a href="#5-11-3-方法区内存溢出" class="headerlink" title="5.11.3 方法区内存溢出"></a>5.11.3 方法区内存溢出</h4><p>1.8版本以前 导致永久代的内存溢出</p>
<p>1.8版本之后 导致元空间的内存溢出</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.openlab;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jdk.internal.org.objectweb.asm.ClassWriter;</span><br><span class="line"><span class="keyword">import</span> jdk.internal.org.objectweb.asm.Opcodes;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 元空间内存溢出</span></span><br><span class="line"><span class="comment">//-XX:MaxMetaspaceSize=8m</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo05</span>  <span class="keyword">extends</span>  <span class="title class_">ClassLoader</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">try</span>&#123;</span><br><span class="line">          <span class="type">Demo05</span> <span class="variable">demo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Demo05</span>();</span><br><span class="line"></span><br><span class="line">          <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;<span class="number">10000</span>;i++,j++)&#123;</span><br><span class="line">             <span class="comment">// 用代码的方式生成字节码</span></span><br><span class="line">              <span class="type">ClassWriter</span> <span class="variable">cw</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassWriter</span>(<span class="number">0</span>);</span><br><span class="line">              <span class="comment">// 版本号 public 类的名字  包名 类的父类 接口</span></span><br><span class="line">              cw.visit(Opcodes.V1_8,Opcodes.ACC_PUBLIC,<span class="string">&quot;Class&quot;</span>+i,<span class="literal">null</span>,<span class="string">&quot;java/lang/Object&quot;</span>,<span class="literal">null</span>);</span><br><span class="line">              <span class="type">byte</span>[] code = cw.toByteArray();</span><br><span class="line">              <span class="comment">// 执行了类的加载</span></span><br><span class="line">              demo.defineClass(<span class="string">&quot;Class&quot;</span>+i,code,<span class="number">0</span>,code.length);</span><br><span class="line"></span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">      &#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">           System.out.println(j);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>1.8jdk 版本之后永久代被移出 由metaspace来替代，元空间是没有上限的，所以这段代码在不调整JVM的虚拟机参数的情况下是不会溢出的</p>
<p>-XX:MaxMetaspaceSize&#x3D;8m</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825164311304.png" alt="image-20220825164311304"></p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825164318155.png" alt="image-20220825164318155"></p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825164321497.png" alt="image-20220825164321497"></p>
<p>如果测试永久代溢出 把jdk版本修改成1.6的版本 并且需要修改一下虚拟机的参数</p>
<p>-XX:MaxPermSize&#x3D;8m;</p>
<p>这里应该出现的error OutofMemoryError 异常信息</p>
<p>场景：在生产环境中 这种动态生成class的方法 是非常常用的方式</p>
<ul>
<li><p>Spring Aop</p>
<p>动态代理 —-cglib Aop的核心</p>
</li>
<li><p>Mybatis</p>
<p>也应用cglib 比如mapper接口的生成</p>
</li>
</ul>
<h4 id="5-11-4-StringTable-串池"><a href="#5-11-4-StringTable-串池" class="headerlink" title="5.11.4 StringTable 串池"></a>5.11.4 StringTable 串池</h4><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/260939453">https://zhuanlan.zhihu.com/p/260939453</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_26632895/article/details/105587461">https://blog.csdn.net/qq_26632895/article/details/105587461</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_25884515/article/details/104187125?spm=1001.2101.3001.6661.1&utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~default-1.pc_relevant_paycolumn_v2&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~default-1.pc_relevant_paycolumn_v2&utm_relevant_index=1">https://blog.csdn.net/qq_25884515/article/details/104187125?spm=1001.2101.3001.6661.1&amp;utm_medium=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7Edefault-1.pc_relevant_paycolumn_v2&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7Edefault-1.pc_relevant_paycolumn_v2&amp;utm_relevant_index=1</a></p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825164538545.png" alt="image-20220825164538545"></p>
<p>String 字符串这个类 不可变的 底层是字符数组</p>
<p>当String 类 String s&#x3D;”hello” 是在StringTable当中的“hello”字符串引用给s这个变量</p>
<p>String拼接的底层使用的StringBuilder 通过append的方法进行底层的拼接，再把StringBuilder转换成String类型</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825164552844.png" alt="image-20220825164552844"></p>
<p>面试题：</p>
<ul>
<li><p>为什么要把StringTable放入到堆空间中</p>
<p>在1.6的JDK中永久代，很少去做垃圾回收的，降低了它的效率 FullGC垃圾回收时才会回收StringTable，但是FullGC的触发条件 老年代空间不足，在永久代空间也不足时才会触发FullGC。会导致StringTable的回收效率不高。 研发的时候 String变量是经常使用的，所以在1.8版本中 放在堆空间里，提升StringTable的回收效率。</p>
<blockquote>
<p>StringTbale的底层数据结构是<strong>HashTable</strong>，每个元素都是<strong>key-value</strong>结构，采用了数组+单向链表的实现方式</p>
<p>Sting中的intern() 这个方法 就是将字符串对象放入的StringTable</p>
<p>调优的代码跑一下</p>
</blockquote>
</li>
</ul>
<h4 id="5-11-5-直接内存"><a href="#5-11-5-直接内存" class="headerlink" title="5.11.5 直接内存"></a>5.11.5 直接内存</h4><p>直接内存 DirectMemory 并不是虚拟机运行时数据区的一部分，也不是规范中定义的内存区域，但它也会OOM。</p>
<p>JDK1.4 加入了NIO new Input&#x2F;Output 引入了一种基于通道 Channel 与缓冲区buffer的IO的方式。可以使用native函数库直接分配堆外的内存，然后通过Java的对象DirectBuffer对象作为这块内存的引用而进行操作。在某些场景中是可以提高性能的，因为它避免了在java堆和native堆中来回的复制数据。</p>
<p>直接内存分配是不受java的堆的大小控制 ，但他还是内存，只要是内存就有限制，</p>
<p>一般情况下我们使用-Xmx 等一些参数的收，会忽略直接内存。 从而导致动态扩展的时候内存总和大于物理内存限制，而出现OOM。</p>
<p>直接内存 是系统内存</p>
<ul>
<li>NIO操作用于数据缓冲区 比普通的IO性能要高</li>
<li>不受JVM内存的回收管理。</li>
<li>分配回收成本比较高，读写的性能比较强。</li>
</ul>
<p>作业：</p>
<ol>
<li>博客作业：整理JVM常用调优参数</li>
<li>博客作业：JVM 内存模型整理，</li>
</ol>
<blockquote>
<p> 美团 面试题 Object o &#x3D; new Object() 有多少个字节 底层如何实现的 内存区域划分</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.openlab;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.nio.ByteBuffer;</span><br><span class="line"><span class="keyword">import</span> java.nio.channels.FileChannel;</span><br><span class="line"><span class="comment">// 使用IO和NIO哪个效率更高</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo06</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FROM</span> <span class="operator">=</span> <span class="string">&quot;D:\\教学资料\\秋招备战法则\\刷题\\javaWeb\\录屏\\0113Stringtable和直接内存.wmv&quot;</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">TO</span> <span class="operator">=</span> <span class="string">&quot;D:\\a.wmv&quot;</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span>  <span class="type">int</span> <span class="variable">_1MB</span> <span class="operator">=</span> <span class="number">1024</span>*<span class="number">1024</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">      io();</span><br><span class="line">      directBuffer();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 使用NIO的方式去读取文件</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span>  <span class="keyword">static</span> <span class="keyword">void</span>  <span class="title function_">directBuffer</span><span class="params">()</span>  &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">start</span> <span class="operator">=</span> System.nanoTime();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>(<span class="type">FileChannel</span> <span class="variable">from</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(FROM).getChannel();</span><br><span class="line">            <span class="type">FileChannel</span> <span class="variable">to</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(TO).getChannel();</span><br><span class="line">        )&#123;</span><br><span class="line">           <span class="type">ByteBuffer</span> <span class="variable">bb</span> <span class="operator">=</span> ByteBuffer.allocateDirect(_1MB);</span><br><span class="line">           <span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">               <span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> from.read(bb);</span><br><span class="line">               <span class="keyword">if</span>(len == -<span class="number">1</span>)&#123;</span><br><span class="line">                   <span class="keyword">break</span>;</span><br><span class="line">               &#125;</span><br><span class="line">               bb.flip();</span><br><span class="line">               to.write(bb);</span><br><span class="line">               bb.clear();</span><br><span class="line">           &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span>(IOException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.nanoTime();</span><br><span class="line">        System.out.println(<span class="string">&quot;directBuffer用时&quot;</span>+(end-start)/<span class="number">1000_000.0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * IO的方式</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">io</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">start</span> <span class="operator">=</span> System.nanoTime();</span><br><span class="line">        <span class="keyword">try</span>(<span class="type">FileInputStream</span> <span class="variable">from</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(FROM);</span><br><span class="line">            <span class="type">FileOutputStream</span> <span class="variable">to</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(TO);</span><br><span class="line">        )&#123;</span><br><span class="line">            <span class="type">byte</span>[] buf = <span class="keyword">new</span> <span class="title class_">byte</span>[_1MB];</span><br><span class="line">            <span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> from.read(buf);</span><br><span class="line">                <span class="keyword">if</span>(len == -<span class="number">1</span>)&#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                to.write(buf,<span class="number">0</span>,len);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span>(IOException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.nanoTime();</span><br><span class="line">        System.out.println(<span class="string">&quot;io用时&quot;</span>+(end-start)/<span class="number">1000_000.0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行结果</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825164837171.png" alt="image-20220825164837171"></p>
<blockquote>
<p>为什么byteBuffer 它的性能会这么高</p>
</blockquote>
<p>Java本身其实不具备磁盘读写的能力，如果要使用java语言对磁盘进行读写的情况，需要调用操作系统的函数，比如说本地的方法，这里涉及到状态上的切换</p>
<p>使用java语言的IO去读取文件的时候，java的用户态需要切换到系统内核态，先要把文件读取到系统缓存中，java代码没有办法直接去访问系统的缓存，，它就会在堆空间分配一个java缓冲区，然后在通过IO到java的堆的缓冲区内读取，读取后在将内核态转换为用户态，在内存中会存在两份要读取的文件流，所以浪费内存空间，效率降低</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825164907439.png" alt="image-20220825164907439"></p>
<p>使用NIO调用的过程，通过ByteBuffer bb &#x3D; ByteBuffer.<em>allocateDirect</em>(<em>_1MB</em>); 申请一个直接内存，是在系统内存你和java的堆内存之间的，系统可以使用，java代码也可以使用，成倍的速度的提升</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825164918297.png" alt="image-20220825164918297"></p>
<h4 id="5-11-6-直接内存溢出"><a href="#5-11-6-直接内存溢出" class="headerlink" title="5.11.6 直接内存溢出"></a>5.11.6 直接内存溢出</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.openlab;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.nio.ByteBuffer;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">//直接内存溢出</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo07</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> <span class="variable">_100MB</span> <span class="operator">=</span> <span class="number">1024</span>*<span class="number">1024</span>*<span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        List&lt;ByteBuffer&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;ByteBuffer&gt;();</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line"></span><br><span class="line">                <span class="type">ByteBuffer</span> <span class="variable">byteBuffer</span> <span class="operator">=</span> ByteBuffer.allocateDirect(_100MB);</span><br><span class="line">                list.add(byteBuffer);</span><br><span class="line">                i++;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">            System.out.println(i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825164959450.png" alt="image-20220825164959450"></p>
<h4 id="5-11-7-直接内存释放原理"><a href="#5-11-7-直接内存释放原理" class="headerlink" title="5.11.7 直接内存释放原理"></a>5.11.7 直接内存释放原理</h4><p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825165020188.png" alt="image-20220825165020188"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.openlab;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.nio.ByteBuffer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo08</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> <span class="variable">_1GB</span> <span class="operator">=</span> <span class="number">1024</span>*<span class="number">1024</span>*<span class="number">1024</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">ByteBuffer</span> <span class="variable">byteBuffer</span> <span class="operator">=</span> ByteBuffer.allocateDirect(_1GB);</span><br><span class="line">        System.out.println(<span class="string">&quot;分配完毕&quot;</span>);</span><br><span class="line">        System.in.read();</span><br><span class="line">        System.out.println(<span class="string">&quot;开始释放&quot;</span>);</span><br><span class="line">        byteBuffer = <span class="literal">null</span>;</span><br><span class="line">        System.gc();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825165037466.png" alt="image-20220825165037466"></p>
<p>释放内存后</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825165048337.png" alt="image-20220825165048337"></p>
<blockquote>
<p>是不是因为调用垃圾回收器，所以这个直接内存是由垃圾回收器回收？</p>
</blockquote>
<h4 id="5-11-8-Unsafe"><a href="#5-11-8-Unsafe" class="headerlink" title="5.11.8 Unsafe"></a>5.11.8 Unsafe</h4><p>Java语言不像C语言或者是C++可以自己申请内存，java依靠Unsafe这个类提供了类似于C++手动管理内存的能力，所以这个类很危险</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825170104464.png" alt="image-20220825170104464"></p>
<p>这个类本身是final 而且它的构造方法也是private 那么这个对象的创建需要通过反射来完成。Unsafe对象的创建</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Unsafe <span class="title function_">getInstance</span><span class="params">()</span> <span class="keyword">throws</span> IllegalAccessException &#123;</span><br><span class="line">    <span class="type">Field</span> <span class="variable">unsafeField</span> <span class="operator">=</span> Unsafe.class.getDeclaredFields()[<span class="number">0</span>];</span><br><span class="line">    unsafeField.setAccessible(<span class="literal">true</span>);</span><br><span class="line">    <span class="type">Unsafe</span> <span class="variable">unsafe</span> <span class="operator">=</span> (Unsafe) unsafeField.get(<span class="literal">null</span>);</span><br><span class="line">    <span class="keyword">return</span> unsafe;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825170129198.png" alt="image-20220825170129198"></p>
<p>运行程序</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825170139465.png" alt="image-20220825170139465"></p>
<p>点击回车 查看任务管理器， 进程是没有被关掉的，但是内存也被释放了</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825170148128.png" alt="image-20220825170148128"></p>
<p>查看一下ByteBuffer的源码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">DirectByteBuffer(<span class="type">int</span> cap) &#123;                   <span class="comment">// package-private</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">super</span>(-<span class="number">1</span>, <span class="number">0</span>, cap, cap);</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">pa</span> <span class="operator">=</span> VM.isDirectMemoryPageAligned();</span><br><span class="line">    <span class="type">int</span> <span class="variable">ps</span> <span class="operator">=</span> Bits.pageSize();</span><br><span class="line">    <span class="type">long</span> <span class="variable">size</span> <span class="operator">=</span> Math.max(<span class="number">1L</span>, (<span class="type">long</span>)cap + (pa ? ps : <span class="number">0</span>));</span><br><span class="line">    Bits.reserveMemory(size, cap);</span><br><span class="line"></span><br><span class="line">    <span class="type">long</span> <span class="variable">base</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line"><span class="comment">//这里调用的是unsafe的内存申请</span></span><br><span class="line">        base = unsafe.allocateMemory(size);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (OutOfMemoryError x) &#123;</span><br><span class="line">        Bits.unreserveMemory(size, cap);</span><br><span class="line">        <span class="keyword">throw</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">    unsafe.setMemory(base, size, (<span class="type">byte</span>) <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (pa &amp;&amp; (base % ps != <span class="number">0</span>)) &#123;</span><br><span class="line">        <span class="comment">// Round up to page boundary</span></span><br><span class="line">        address = base + ps - (base &amp; (ps - <span class="number">1</span>));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        address = base;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// Deallocator 这个对象里面调用了释放直接内存</span></span><br><span class="line">    cleaner = Cleaner.create(<span class="built_in">this</span>, <span class="keyword">new</span> <span class="title class_">Deallocator</span>(base, size, cap));</span><br><span class="line">    att = <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Deallocator</span></span><br><span class="line">    <span class="keyword">implements</span> <span class="title class_">Runnable</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">Unsafe</span> <span class="variable">unsafe</span> <span class="operator">=</span> Unsafe.getUnsafe();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> address;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> size;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> capacity;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Deallocator</span><span class="params">(<span class="type">long</span> address, <span class="type">long</span> size, <span class="type">int</span> capacity)</span> &#123;</span><br><span class="line">        <span class="keyword">assert</span> (address != <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">this</span>.address = address;</span><br><span class="line">        <span class="built_in">this</span>.size = size;</span><br><span class="line">        <span class="built_in">this</span>.capacity = capacity;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (address == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">// Paranoia</span></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        unsafe.freeMemory(address);</span><br><span class="line">        address = <span class="number">0</span>;</span><br><span class="line">        Bits.unreserveMemory(size, capacity);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Cleaner 这个对象是个虚引用，特点是它所关联的对象被引用时，Cleaner就会触发它的clean方法，unsafe调用freeMemory 来进行释放内存，直接内存的实现是接住了java中的虚引用。</p>
<p>禁用显示的垃圾回收：</p>
<p>我们在代码中写的System.gc() 显示的垃圾回收 让System.gc()无效</p>
<p>-XX:+DisableExplicitGC</p>
<p>System.gc() 其实是FullGC </p>
<p>FullGC是一种比较影响性能的垃圾回收，它不光要回收新生代，也要回收老年代，会造成程序的暂停时间比较长，一般在JVM调优过程中会使用这个命令 禁用显示的垃圾回收</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.openlab;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.nio.ByteBuffer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo08</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> <span class="variable">_1GB</span> <span class="operator">=</span> <span class="number">1024</span>*<span class="number">1024</span>*<span class="number">1024</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">ByteBuffer</span> <span class="variable">byteBuffer</span> <span class="operator">=</span> ByteBuffer.allocateDirect(_1GB);</span><br><span class="line">        System.out.println(<span class="string">&quot;分配完毕&quot;</span>);</span><br><span class="line">        System.in.read();</span><br><span class="line">        System.out.println(<span class="string">&quot;开始释放&quot;</span>);</span><br><span class="line">        byteBuffer = <span class="literal">null</span>;</span><br><span class="line">        System.gc();</span><br><span class="line">        System.in.read();</span><br><span class="line">        System.out.print(<span class="string">&quot;程序结束&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825170339346.png" alt="image-20220825170339346"></p>
<h2 id="Chapter6-JVM常用指令"><a href="#Chapter6-JVM常用指令" class="headerlink" title="Chapter6  JVM常用指令"></a>Chapter6  JVM常用指令</h2><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h2 id="Chapter7-垃圾回收算法-GC调优"><a href="#Chapter7-垃圾回收算法-GC调优" class="headerlink" title="Chapter7 垃圾回收算法 GC调优"></a>Chapter7 垃圾回收算法 GC调优</h2><h3 id="7-1-引用计数法"><a href="#7-1-引用计数法" class="headerlink" title="7.1 引用计数法"></a>7.1 引用计数法</h3><p>原理：只要是有引用的对象，就给这个对象增加一个计数，删除一个引用则减少一个计数，垃圾回收的时候，只回收计数为的0对象，这个算法的比较致命的问题，无法处理循环引用的问题</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825170540153.png" alt="image-20220825170540153"></p>
<p>说早期python使用的是这种算法，java使用的不是这种算法，java中应用的叫可达性分析算法</p>
<h3 id="7-2-可达性分析算法"><a href="#7-2-可达性分析算法" class="headerlink" title="7.2 可达性分析算法"></a>7.2 可达性分析算法</h3><p>通过一系列的被称为GC Roots的根对象作为起始节点集，从这些节点开始，根据引用关系向下搜索，这个搜索的过程所走的路径被称为 引用链 Reference Chain。如果某个对象到GCRoots 间没有任何引用链相连，则证明此对象不可能再被使用。</p>
<p>什么是GC Roots 不能被垃圾回收的对象 首先先对堆内存进行扫描，堆中的对象如果被GCRoots引用的话，那么就不会被回收，反之没有被GCRoots引用，就需要被回收。</p>
<p>监听堆内存的工具。</p>
<p>Memory Analyzer MAT 是一个Eclipse的工具</p>
<p><a target="_blank" rel="noopener" href="https://www.eclipse.org/mat/">https://www.eclipse.org/mat/</a></p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825170620289.png" alt="image-20220825170620289"></p>
<p>通过这段代码来检测</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.maclu;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo1</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//主要是看list1在有值和没值的情况下做个对比。</span></span><br><span class="line">        List&lt;Object&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Object&gt;();</span><br><span class="line">        list.add(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;b&quot;</span>);</span><br><span class="line">        System.out.println(<span class="number">1</span>);</span><br><span class="line">        System.in.read();</span><br><span class="line">        list = <span class="literal">null</span>;</span><br><span class="line">        System.out.println(<span class="number">2</span>);</span><br><span class="line">        System.in.read();</span><br><span class="line">        System.out.println(<span class="string">&quot;end...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们需要配合几个命令行工具 jps jmap</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825170651668.png" alt="image-20220825170651668"></p>
<p>输入指令： jmap -dump:format&#x3D;b,live,file&#x3D;4.bin 12684</p>
<p>-dump  将内存中的运行的内容转储成一个文件</p>
<p>:format b 表示以二进制的文件来展示，live 展示当前进程中没有被回收的变量，live这个参数在执行之前会执行一次垃圾回收 file&#x3D;4.bin 表示文件存储的位置和名称 当前程序的目录下。</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825170713685.png" alt="image-20220825170713685"></p>
<p>在程序console下点击回车，再次执行指令</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825170723719.png" alt="image-20220825170723719"></p>
<p>用检测工具打开我们生成的文件</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825170731638.png" alt="image-20220825170731638"></p>
<p>发送一个分析报告</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825170743940.png" alt="image-20220825170743940"></p>
<p>在javabasic 选项中 点击GCRoots的对象</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825170759683.png" alt="image-20220825170759683"></p>
<p>System Class 系统执行的时候需要加载的类，这些类都是对象，肯定不会被回收</p>
<p>Native Stack 本地方法栈中的对象，需要系统调用的方法 也不会被回收</p>
<p>Thread 表示活动的线程 正在活动的线程是不会被回收</p>
<p>Busy Monitor 里面的内容是加了lock的对象 也不会被回收</p>
<p>4.bin</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825170809528.png" alt="image-20220825170809528"></p>
<p>第一个4.bin的文件中可以看到main线程中存在ArrayList这个对象</p>
<p> Bin</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825172307718.png" alt="image-20220825172307718"></p>
<p>bin的快照中是没有ArrayList的对象的，那么这个ArrayList就被回收了</p>
<p>GC Roots 中包含了哪些对象：</p>
<ol>
<li>在虚拟机栈中引用的对象</li>
<li>在方法区中类静态属性引用的对象</li>
<li>方法区中常量引用对象</li>
<li>本地方法栈中的JNI引用对象</li>
<li>Java虚拟机的内部引用</li>
<li>所有被同步锁持有的对象</li>
<li>反映java虚拟机内部青苦瓜的JMXBean JVMTI 中注册的回调本地代码缓存的</li>
<li>还有一些是在垃圾收集器中 分代收集和局部回收当中的一些对象</li>
</ol>
<p>怎么去判断哪些变量是需要被回收的，其实就是看GCRoots 是否引用到堆中的对象？</p>
<h3 id="7-3-四种应用"><a href="#7-3-四种应用" class="headerlink" title="7.3 四种应用"></a>7.3 四种应用</h3><p>断对象是否存活和“引用”离不开关系 我们所定义的对象只能处于“被引用”和“未被引用”的状态，那么如果一些对象 当内存不足的时候，是继续保留在内存中，还是应该被回收，如果内存空间在进行垃圾回收后依旧很紧张，那么是应该抛弃这些对象，还是如何处理？</p>
<p>在JDK1.2的版本中java对引用的概念进行了统一的扩充</p>
<p>分为 强引用 软引用 弱引用 和虚引用 (终结器引用)</p>
<ul>
<li><p>强引用： Strongly Reference</p>
<p>最传统的引用的定义，在程序中做的引用赋值操作 比如说Object obj &#x3D; new Object(); 这种引用关系就是强引用，只要强引用存在，垃圾回收器就不会回收被引用的对象，当GCRoots 引用到堆中的对象时 该对象不会被回收，当GCRoots 的引用断开时，会被回收</p>
</li>
<li><p>软引用： Soft Reference</p>
<p>是用来描述一些 还有用，但是非必须的对象，被软引用关联的对象，在系统要发生内存溢出异常前，会把这些对象列进回收范围之中，进行二次回收，如果回收之后内存还不够，才会抛出内存溢出异常，提供了SoftReference类来实现软引用 内存不足的时候会回收，前提是软引用所引用的对象，没有强引用去引用它</p>
</li>
<li><p>弱引用： Weak Reference</p>
<p>非必须的对象，强度比软引用更弱一些， 被弱引用关联的对象，只能活到下一次垃圾回收之前，垃圾回收之后，无论是内存是否足够， 都会回收弱引用所关联的对象。提供WeakReference类来实现弱引用。前提是弱引用所引用的对象，没有强引用去引用它，不管这个弱引用的对象是否重要，都被回收</p>
<p>不管是软引用还是弱引用，他们也都占据了内存，如果要释放掉他们，需要将引用移动到引用队列，由引用队列来进一步处理</p>
</li>
<li><p>虚引用： Phantom Reference</p>
<p>最弱的的一种关系， 对象是否有虚引用的存在，完全不会对生存时间产生影响，使用虚引用目的，在对象被回收的时候，收到一个系统的通知 提供了PhantomReference类来实现 虚引用</p>
<p>举例 在ByteBuffer中有一个对象 Cleaner 继承PhantomReference 虚引用，当强引用和ByteBuffer断开 ByteBuffer 肯定是要被回收的，ByteBuffer还申请了直接内存，直接内存又不能通过java垃圾回收器来回收掉，这个时候会把Cleaner对象拉入引用队列中，队列中有个对象 ReferenceHandler 在引用队列中定时去寻找是否有新的引用传递过来，如果有Cleaner 就会调用自己的clean方法去释放直接内存</p>
</li>
<li><p>终结器引用</p>
<p>所有的对象都会继承Object object中有一个方法叫finalize() 该方法是终结方法。当我们去重写finalize()方法 对象没有强引用时，那么这个对下就可以被当做垃圾进行回收，会将终结器引用 加入到引用队列中，再由一个优先级很低的线程FinalizeHandler 去查看引用队列中是否有终结器的引用， 根据终结器的引用找到这个对象重写的finalize()方法 进行回收。finalize()方法的效率很低，基本上是二次回收，还要将终结器的引用移动到队列， 就会导致finalize() 方法迟迟不会调用，这个对象的内存也是迟迟不能释放。 不推荐大家去使用finalize()方法</p>
</li>
</ul>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825172929460.png" alt="image-20220825172929460"></p>
<h4 id="7-3-1-软引用的使用场景"><a href="#7-3-1-软引用的使用场景" class="headerlink" title="7.3.1 软引用的使用场景"></a>7.3.1 软引用的使用场景</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span>  <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">_4MB</span> <span class="operator">=</span> <span class="number">1024</span>*<span class="number">1024</span>*<span class="number">4</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line">    List&lt;<span class="type">byte</span>[]&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;<span class="type">byte</span>[]&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)&#123;</span><br><span class="line">        list.add(<span class="keyword">new</span> <span class="title class_">byte</span>[_4MB]);</span><br><span class="line">    &#125;</span><br><span class="line">    System.in.read();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>-Xmx20M 设置最大空间</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825173206235.png" alt="image-20220825173206235"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">soft</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// list --&gt; SoftReference --&gt; byte[]</span></span><br><span class="line"></span><br><span class="line">    List&lt;SoftReference&lt;<span class="type">byte</span>[]&gt;&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">        SoftReference&lt;<span class="type">byte</span>[]&gt; ref = <span class="keyword">new</span> <span class="title class_">SoftReference</span>&lt;&gt;(<span class="keyword">new</span> <span class="title class_">byte</span>[_4MB]);</span><br><span class="line">        System.out.println(ref.get());</span><br><span class="line">        list.add(ref);</span><br><span class="line">        System.out.println(list.size());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    System.out.println(<span class="string">&quot;循环结束：&quot;</span> + list.size());</span><br><span class="line">    <span class="keyword">for</span> (SoftReference&lt;<span class="type">byte</span>[]&gt; ref : list) &#123;</span><br><span class="line">        System.out.println(ref.get());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825173220101.png" alt="image-20220825173220101"></p>
<p>程序是正常执行的，没有溢出，后面的软引用对象被清空了，只保留了一个</p>
<p>加上GC的详细打印的参数：</p>
<p>-XX:+PrintGCDetails -verbose:gc</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825173307573.png" alt="image-20220825173307573"></p>
<p>在第三个弱引用对象建立的时候，内存不太够了，内存 分配的失败，触发了垃圾回收，只是回收了新生代，创建第四个软引用，内存的分配又失败，垃圾回收之后 新生代的内存的分配效率还是很低，触发FullGC FullGC 不仅仅要回收新生代，也要回收老年代，一分配又失败，再次触发垃圾回收，新生代的内存全部为清空，老年代中的内存也被清空了一部分</p>
<p>总结： 软引用再内存空间的好处：不重要的对象使用软引用进行关联，在堆空间内存紧张时，就可将其回收</p>
<h4 id="7-3-2-软引用引用队列"><a href="#7-3-2-软引用引用队列" class="headerlink" title="7.3.2 软引用引用队列"></a>7.3.2 软引用引用队列</h4><p>通过上面的案例list的软引用对象已经为null，没必要保存在list集合中，配合引用队列把软引用对象本身清理掉</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.maclu;</span><br><span class="line"><span class="keyword">import</span> java.lang.ref.Reference;</span><br><span class="line"><span class="keyword">import</span> java.lang.ref.ReferenceQueue;</span><br><span class="line"><span class="keyword">import</span> java.lang.ref.SoftReference;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo2_1</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 演示软引用, 配合引用队列</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">_4MB</span> <span class="operator">=</span> <span class="number">4</span> * <span class="number">1024</span> * <span class="number">1024</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">            List&lt;SoftReference&lt;<span class="type">byte</span>[]&gt;&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 引用队列</span></span><br><span class="line">            ReferenceQueue&lt;<span class="type">byte</span>[]&gt; queue = <span class="keyword">new</span> <span class="title class_">ReferenceQueue</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">                <span class="comment">// 关联了引用队列， 当软引用所关联的 byte[]被回收时，软引用自己会加入到 queue 中去</span></span><br><span class="line">                SoftReference&lt;<span class="type">byte</span>[]&gt; ref = <span class="keyword">new</span> <span class="title class_">SoftReference</span>&lt;&gt;(<span class="keyword">new</span> <span class="title class_">byte</span>[_4MB], queue);</span><br><span class="line">                System.out.println(ref.get());</span><br><span class="line">                list.add(ref);</span><br><span class="line">                System.out.println(list.size());</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 从队列中获取无用的 软引用对象，并移除</span></span><br><span class="line">            Reference&lt;? <span class="keyword">extends</span> <span class="title class_">byte</span>[]&gt; poll = queue.poll();</span><br><span class="line">            <span class="keyword">while</span>( poll != <span class="literal">null</span>) &#123;</span><br><span class="line">                list.remove(poll);</span><br><span class="line">                poll = queue.poll();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">&quot;===========================&quot;</span>);</span><br><span class="line">            <span class="keyword">for</span> (SoftReference&lt;<span class="type">byte</span>[]&gt; reference : list) &#123;</span><br><span class="line">                System.out.println(reference.get());</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>从执行结果来看几个null值的不见了，说明被引用队列清理掉了</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825173402512.png" alt="image-20220825173402512"></p>
<h4 id="7-3-3-弱引用"><a href="#7-3-3-弱引用" class="headerlink" title="7.3.3 弱引用"></a>7.3.3 弱引用</h4><p>List 强引用 WeakReference </p>
<p>WeakReference 弱引用byte数组</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.maclu;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.ref.WeakReference;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo2_2</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 演示弱引用</span></span><br><span class="line"><span class="comment">     * -Xmx20m -XX:+PrintGCDetails -verbose:gc</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">_4MB</span> <span class="operator">=</span> <span class="number">4</span> * <span class="number">1024</span> * <span class="number">1024</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">            <span class="comment">//  list --&gt; WeakReference --&gt; byte[]</span></span><br><span class="line">            List&lt;WeakReference&lt;<span class="type">byte</span>[]&gt;&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">                WeakReference&lt;<span class="type">byte</span>[]&gt; ref = <span class="keyword">new</span> <span class="title class_">WeakReference</span>&lt;&gt;(<span class="keyword">new</span> <span class="title class_">byte</span>[_4MB]);</span><br><span class="line">                list.add(ref);</span><br><span class="line">                <span class="keyword">for</span> (WeakReference&lt;<span class="type">byte</span>[]&gt; w : list) &#123;</span><br><span class="line">                    System.out.print(w.get()+<span class="string">&quot; &quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                System.out.println();</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;循环结束：&quot;</span> + list.size());</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825173426024.png" alt="image-20220825173426024"></p>
<h3 id="7-4-垃圾回收算法"><a href="#7-4-垃圾回收算法" class="headerlink" title="7.4 垃圾回收算法"></a>7.4 垃圾回收算法</h3><h4 id="7-4-1-标记清除法"><a href="#7-4-1-标记清除法" class="headerlink" title="7.4.1 标记清除法"></a>7.4.1 标记清除法</h4><p>最早出现的也是最基础的垃圾回收算法，这个算法分为两个阶段，“标记”和“清除”两个阶段，首先标记出所有要回收的对象，在标记完成之后，统一回收掉所有被标记的对象（清除），也可以反 标记存活的对象，统一回收未被标记的对象，这个算法需要暂定应用，同时会产生内存碎片</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825173519950.png" alt="image-20220825173519950"></p>
<p>扫描整个堆对象，通过GCRoots的链去判断哪些垃圾需要被清楚</p>
<p>定义：Mark Sweep</p>
<p>阶段一： 先去标记，看哪些对象可以被垃圾回收</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825173533264.png" alt="image-20220825173533264"></p>
<p>阶段二： 清除 释放对象占用的空间，释放不是把占用的整个内存进行清零的做操做，而是记录对象的起始地址和结束地址，放入空闲地址链表里就可以了，下次分配新对象，就从空闲的链表中找，看看有没有一块足够的空间去容纳新的对象，如果有就进行内存的分配，不会占用的整个内存进行清零的做操做</p>
<ul>
<li><p>优点：速度较快</p>
</li>
<li><p>缺点：执行效率不稳定<br>Java堆中包含大量的对象时，而且大部分是需要被回收的，必须要经历大量的标记和清除动作，导致这两个过程随着对象的增长而性能降低</p>
<blockquote>
<p> 内存空间的碎片化问题</p>
</blockquote>
<p>会产生不连续的空间，如果有大的对象需要足够的连续空间时，会不得不触发另一次垃圾回收的操作</p>
</li>
</ul>
<h4 id="7-4-2-标记整理算法"><a href="#7-4-2-标记整理算法" class="headerlink" title="7.4.2 标记整理算法"></a>7.4.2 标记整理算法</h4><p>定义：Mark Compact</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825173723036.png" alt="image-20220825173723036"></p>
<p>阶段一： 标记可回收的对象</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825173730016.png" alt="image-20220825173730016"></p>
<p>阶段二： 内存被回收之后，多加了一个步骤，即合并空闲内存区域，减少内存碎片</p>
<ul>
<li><p>缺点：</p>
<p>速度慢，对象在整理的过程中需要被移动，一移动，如果有引用引用了这些对象，则需要改变引用的地址</p>
</li>
</ul>
<h4 id="7-4-3-标记复制算法"><a href="#7-4-3-标记复制算法" class="headerlink" title="7.4.3 标记复制算法"></a>7.4.3 标记复制算法</h4><p>首先把内存划分成了大小相同的两块区域</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825173814511.png" alt="image-20220825173814511"></p>
<p>阶段一： 先标记</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825173820513.png" alt="image-20220825173820513"></p>
<p>再把from区存活的对象复制到to区，然后就完成了区域碎片的整理，，复制完成之后，From区全是无用的对象，要被回收。回收之后From区就空了</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825173834260.png" alt="image-20220825173834260"></p>
<p>两者交换位置</p>
<p>定义：copy</p>
<ul>
<li>优点：<ul>
<li>不会有内存碎片</li>
<li>不需要占用双倍的内存空间</li>
</ul>
</li>
</ul>
<h3 id="7-5-分代回收"><a href="#7-5-分代回收" class="headerlink" title="7.5 分代回收"></a>7.5 分代回收</h3><h4 id="7-5-1-分代思想"><a href="#7-5-1-分代思想" class="headerlink" title="7.5.1 分代思想"></a>7.5.1 分代思想</h4><p>实际上，虚拟机不会使用单独的垃圾回收算法，而是多个算法协同工作，具体的实现即是JVM里的分代的垃圾回收机制</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825173950991.png" alt="image-20220825173950991"></p>
<p>Java 8 堆被分成两份，新生代和老年代（1:2） 在java7还存在永久代</p>
<p>为什么要进行区域的划分？ </p>
<p>内存中的变量可能会需要很长的时间的使用，那么长时间要使用的对象放入到老年代中，新使用的对象放入到新生代中，就可以根据对象的生命周期的不同的特点，来进行垃圾回收。老年代回收很久才发生一次，而新生代垃圾回收会比较频繁</p>
<ul>
<li>新生代：复制算法</li>
<li>老年代：标记-清除 或者标记-整理算法</li>
</ul>
<h4 id="7-5-2-Minor-GC和Full-GC"><a href="#7-5-2-Minor-GC和Full-GC" class="headerlink" title="7.5.2 Minor GC和Full GC"></a>7.5.2 Minor GC和Full GC</h4><p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825174547324.png" alt="image-20220825174547324"></p>
<p>当新生代的存储空间满了之后，会执行Minor GC 会按照可达性分析算法进行标记，这里会使用复制的算法，把存活下来对象复制到幸存区To中</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825174555411.png" alt="image-20220825174555411"></p>
<p>会把Eden区域清空，然后把幸存区To的对象寿命+1</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825174603129.png" alt="image-20220825174603129"></p>
<p>然后会交换幸存区From和幸存区To </p>
<p>大小的默认比例：8:1:1</p>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825174609788.png" alt="image-20220825174609788"></p>
<p>Minor GC ：回收新生代，新生代的对象存活的时间很短，所以Minor GC会频繁的执行，执行的速度也是比较快的</p>
<p>Full GC： 回收老年代和新生代 那么老年代对象存活时间比较长，所以FullGC很少执行，执行的速度要比Minor GC 慢很多</p>
<h4 id="7-5-3-分代分配"><a href="#7-5-3-分代分配" class="headerlink" title="7.5.3 分代分配"></a>7.5.3 分代分配</h4><p>对象优先在Eden区分配：</p>
<p>当创建一个对象时，对象会被分配到新生代的Eden区，当Eden区满了的时候，触发Young GC。</p>
<p>当进行YoungGC之后，此时Eden区存活的对象被移动到To区，并且对象的年龄会+1，清空Eden区。</p>
<p>当再次触发Young GC的时候，会把Eden区中存活下来的对象和To中存活的对象，移动到From区，这些对象的年龄又会+1， 清空Eden区 和To区。</p>
<p>To区永远是空的 Survivor区 From区 有数据区，每次Minor GC后，两个区域互换</p>
<p>会引发stop the world，暂停其他用户的线程 等待垃圾回收结束，用户线程恢复执行。</p>
<p>From区和To区 也可以叫做 S0区 和S1区。</p>
<p>新生代的垃圾回收 一般叫Minor GC 或 YoungGC</p>
<p>晋升到老年代：</p>
<p>长期存活的对象，进入老年代，会为对象定义年龄计数器，对象在Eden出生，经过Minor GC依然存活，就会移动到幸存区，年龄+1，当增加到一定次数的时候，则移动到老年代。</p>
<p>-XX:MaxTenuringThreshold 定义年龄的阀值，对象头中用4个bit做存储，所以最大值是15 默认值也是15。</p>
<p>大对象直接进入到老年代， 需要连续的内存空间，例如很长的字符串或者是数组，避免对象Eden区和幸存区之间进行大量的复制，大对象的出现会提前触发GC 获取足够大的连续空间分配给大对象。</p>
<p>-XX:PretenureSizeThreshold 大于此值的对象会直接放在老年代分配</p>
<p>动态对象的年龄判定： 如果在幸存区中，相同年龄的对象的所有大小和超过了幸存区的空间的一半，年龄大于该年龄的对象就可以直接放入到老年代。</p>
<p>空间分配担保：</p>
<p> 在发生Minor GC之前，虚拟机会先检查老年代最大可用的连续空间是否大于新生代所有的对象总空间，如果这个条件的成立的话，那么Minor GC 可以确认是安全的。如果不成立的话 虚拟机会查看 HandlerPromotionFailure的值是否允许担保失败，如果允许那么就会基础检查老年代最大可用的连续空间是否大于历次晋升到老年代对象的平均大小，如果大于将尝试着进行一次Minor GC，如果小于或者HandlerPromotionFailure的值不允许冒险，那么就进行Full GC</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>对象首先分配在Eden区域</p>
<p>新生代空间不足会触发MinorGC Eden和From存活对象会使用copy的算法复制到TO中，存活的对象年龄+1并且交换From和to</p>
<p>MinorGC 触发会引起stop the world 暂停其他用户线程，等待垃圾回收结束，用户线程才恢复运行</p>
<p>当对象的寿命超过阀值 会晋升到老年代，最大的寿命是15 -4个bit</p>
<p>当老年代空间不足时会触发MinorGC ，如果之后空间依旧不足会触发FullGC ，SWT的时间回更长</p>
<h3 id="7-6-JVM的常用参数"><a href="#7-6-JVM的常用参数" class="headerlink" title="7.6 JVM的常用参数"></a>7.6 JVM的常用参数</h3><p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825174811500.png" alt="image-20220825174811500"></p>
<h4 id="7-6-1-垃圾回收过程分析"><a href="#7-6-1-垃圾回收过程分析" class="headerlink" title="7.6.1 垃圾回收过程分析"></a>7.6.1 垃圾回收过程分析</h4><blockquote>
<p>实验1 在没有任何代码的情况下观察GC日志</p>
</blockquote>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825174836660.png" alt="image-20220825174836660"></p>
<p>问题1：新生代的总计部分是9M eden区占了8M form区占1M to区1M 为什么是9M</p>
<p>原因： 没有计算to空间 to区是用来存放依旧存活的对象</p>
<blockquote>
<p>实验2 list中放入7M的byte类型数组</p>
</blockquote>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825174857523.png" alt="image-20220825174857523"></p>
<p>2053 新生代回收前的占用 -&gt; 回收后的占用 回收花费的时间 整个堆在回收前占用的总大小。</p>
<p>注意：为什么了进行了一次GC</p>
<blockquote>
<p>实验3 list中在放入512k的byte数组</p>
</blockquote>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825174908972.png" alt="image-20220825174908972"></p>
<p>Eden区的使用量增长</p>
<blockquote>
<p>实验4 list中再放入512k的byte数组</p>
</blockquote>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825174927792.png" alt="image-20220825174927792"></p>
<p>新生代的内存空间发生不足，进行了2次GC，有些对象晋升到了老年代。</p>
<blockquote>
<p>实验5 list中放入8M的byte类型数组</p>
</blockquote>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825174943459.png" alt="image-20220825174943459"></p>
<p>没有经过GC的，说明这个8M的内容直接存入到了老年代，大的对象直接晋升到老年代，大的对象在老年代空间足够，但新生代内存不足情况下，会直接晋升到老年代。</p>
<blockquote>
<p>实验6 list中再放入8M的byte类型数组</p>
</blockquote>
<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825174953356.png" alt="image-20220825174953356"></p>
<p>由于新生代和老年代都放不下16MB的对昂，而且这两个对象都被ArrayList引用，无法被会回收，造成内存溢出</p>
<blockquote>
<p>实验7 当内存溢出发生在子线程中，它的内存溢出是否会导致整个主线程结束</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.maclu;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo3</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">_512KB</span> <span class="operator">=</span> <span class="number">512</span> * <span class="number">1024</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">_1MB</span> <span class="operator">=</span> <span class="number">1024</span> * <span class="number">1024</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">_6MB</span> <span class="operator">=</span> <span class="number">6</span> * <span class="number">1024</span> * <span class="number">1024</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">_7MB</span> <span class="operator">=</span> <span class="number">7</span> * <span class="number">1024</span> * <span class="number">1024</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">_8MB</span> <span class="operator">=</span> <span class="number">8</span> * <span class="number">1024</span> * <span class="number">1024</span>;</span><br><span class="line">    <span class="comment">// -Xms20M -Xmx20M -Xmn10M -XX:+UseSerialGC -XX:+PrintGCDetails -verbose:gc</span></span><br><span class="line"><span class="comment">//    public static void main(String[] args) &#123;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//        ArrayList&lt;byte[]&gt; list = new ArrayList&lt;&gt;();</span></span><br><span class="line"><span class="comment">//        list.add(new byte[_8MB]);</span></span><br><span class="line"><span class="comment">//        list.add(new byte[_8MB]);</span></span><br><span class="line"><span class="comment">////        list.add(new byte[_7MB]);</span></span><br><span class="line"><span class="comment">////        list.add(new byte[_512KB]);</span></span><br><span class="line"><span class="comment">////        list.add(new byte[_512KB]);</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">            ArrayList&lt;<span class="type">byte</span>[]&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">            list.add(<span class="keyword">new</span> <span class="title class_">byte</span>[_8MB]);</span><br><span class="line">            list.add(<span class="keyword">new</span> <span class="title class_">byte</span>[_8MB]);</span><br><span class="line">        &#125;).start();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;sleep....&quot;</span>);</span><br><span class="line">        Thread.sleep(<span class="number">5000L</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\黎明\AppData\Roaming\Typora\typora-user-images\image-20220825175022928.png" alt="image-20220825175022928"></p>
<p>结论： 不会，主线程并没有意外结束， 一个线程内的outOfMemory 不会导致整个线程的结束</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://negativefunction.github.io/2023/01/21/Java8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/05.jpg">
      <meta itemprop="name" content="Linyuxuan">
      <meta itemprop="description" content="Hope Sometimes Love Brain">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Welcome To Lin's World">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/01/21/Java8/" class="post-title-link" itemprop="url">Java8</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2023-01-21 07:18:06 / Modified: 07:18:07" itemprop="dateCreated datePublished" datetime="2023-01-21T07:18:06+08:00">2023-01-21</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Java8"><a href="#Java8" class="headerlink" title="Java8"></a>Java8</h1><blockquote>
<p><strong>Java8新特性</strong></p>
</blockquote>
<p>Java8特性增强</p>
<ul>
<li>速度更快 –对于底层的数据结构进行了一定的优化</li>
<li>代码更少 新增加了 lambda表达式语法</li>
<li>新出现了 强大的 Stream API</li>
<li>更便于 并行 –使串行 转换成 并行 更加容易</li>
<li>最大化减少了空指针异常 Optional</li>
</ul>
<p>&#x3D;&#x3D;其中最为核心的为 lambda 表达式 与 Stream API&#x3D;&#x3D;</p>
<p><strong>速度更快体现</strong></p>
<p>HashMap 数组 链表 红黑树 的改变</p>
<p>CAS算法</p>
<p>JVM虚拟机拓展</p>
<p>只有在</p>
<p>Oracle-sun 公司提供的 Hotspot 上才有会在堆内存中 产生一个永久区( <strong>永久区 其中的内容任然会被 垃圾回收机制 回收 只不过 回收的条件比较苛刻</strong>) 来作为方法区 而在其他 定制的 JVM(例如 Oracle JRocket、IBM J9 JVM、Taobao JVM) 中早已<strong>将 永久区剔除 取而代之的是 从堆中剥离出来形成的 MetaSpace 元空间</strong></p>
<p><strong>MetaSpace 元空间</strong></p>
<p>MetaSpace 元空间 直接使用物理内存 即直接使用 电脑的系统内存 而不经过 JVM 分配内存</p>
<p>从而导致 JVM 参数调优 发生改变 </p>
<p>由 PremGenSize 与 MaxPremGenSize 改变为 元空间物理内存 MetaSpaceSize最大元空间物理内存 MaxMetaSpaceSize</p>
<h2 id="1-lambda-表达式"><a href="#1-lambda-表达式" class="headerlink" title="1. lambda 表达式"></a>1. lambda 表达式</h2><p><strong>Lambda</strong> </p>
<p>lambda 是一个 匿名函数 可以将 lambda 表达式理解为一段可以传递的代码(将代码像数据一样进行传递) 而使用lambda 表达式的目的是为了写出 更简洁 更灵活 的代码 这也使得 lambda 表达式 成为一种更紧凑的代码风格 同时使得Java语言的表达能力得到了极大的提升</p>
<blockquote>
<p><strong>lambda表达式简单应用</strong></p>
</blockquote>
<p><strong>lambda表达式 解决匿名内部类繁琐编写</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lambda;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> java.util.Comparator;</span><br><span class="line"><span class="keyword">import</span> java.util.TreeSet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo01</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 匿名内部类</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">Test01</span><span class="params">()</span> &#123;</span><br><span class="line">        Comparator&lt;Integer&gt; com = <span class="keyword">new</span> <span class="title class_">Comparator</span>&lt;Integer&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(Integer o1, Integer o2)</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> Integer.compare(o1, o2);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        TreeSet&lt;Integer&gt; treeSet = <span class="keyword">new</span> <span class="title class_">TreeSet</span>&lt;&gt;(com);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">Test02</span><span class="params">()</span> &#123;</span><br><span class="line">        Comparator&lt;Integer&gt; com = (x, y) -&gt; Integer.compare(x, y);</span><br><span class="line">        Comparator&lt;Integer&gt; com2 = Integer::compare;</span><br><span class="line">        TreeSet&lt;Integer&gt; treeSet = <span class="keyword">new</span> <span class="title class_">TreeSet</span>&lt;&gt;(com);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<blockquote>
<p><strong>lambda表达式应用于代码进阶优化过程</strong></p>
</blockquote>
<p><strong>代码优化进阶 –针对lambda表达式的应用</strong></p>
<p>数据代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Employee&gt; employees = Arrays.asList(</span><br><span class="line">    <span class="comment">// 张三李四王五赵六孙七周八吴九郑十</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;张三&quot;</span>, <span class="number">19</span>, <span class="number">2222.33</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;李四&quot;</span>, <span class="number">29</span>, <span class="number">22552.33</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;王五&quot;</span>, <span class="number">43</span>, <span class="number">3332.33</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;赵六&quot;</span>, <span class="number">59</span>, <span class="number">6255.33</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;孙七&quot;</span>, <span class="number">64</span>, <span class="number">7722.33</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;周八&quot;</span>, <span class="number">25</span>, <span class="number">8822.33</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;吴九&quot;</span>, <span class="number">35</span>, <span class="number">2992.33</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;郑十&quot;</span>, <span class="number">57</span>, <span class="number">4992.33</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>



<p>阶段一：</p>
<p>不断写重复方法代码 –针对不同需求 实现 写不同代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 需求 获取当前公司 员工年龄大于 35 的员工信息</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> List&lt;Employee&gt; <span class="title function_">filterEmployees</span><span class="params">(List&lt;Employee&gt; list)</span> &#123;</span><br><span class="line">    List&lt;Employee&gt; emps = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (Employee emp : list) &#123;</span><br><span class="line">        <span class="keyword">if</span> (emp.getAge() &gt;= <span class="number">35</span>) &#123;</span><br><span class="line">            emps.add(emp);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> emps;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 需求 获取当前公司 员工工资大于 5000 的员工信息</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> List&lt;Employee&gt; <span class="title function_">filterEmployees2</span><span class="params">(List&lt;Employee&gt; list)</span> &#123;</span><br><span class="line">    List&lt;Employee&gt; emps = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (Employee emp : list) &#123;</span><br><span class="line">        <span class="keyword">if</span> (emp.getSalary() &gt;= <span class="number">5000</span>) &#123;</span><br><span class="line">            emps.add(emp);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> emps;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>阶段二：</p>
<p>策略设计模式优化 –优化方式一 使用接口 配合 策略设计模式 </p>
<p>通过 实现接口 MyPredicate 的实例 FilterEmployeeByAge 与 FilterEmployeeBySalary 来控制 需求参数</p>
<p>MyPredicate 接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lambda;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MyPredicate</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">test</span><span class="params">(T t)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>FilterEmployeeBySalary 实现类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lambda;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lambda.pojo.Employee;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FilterEmployeeBySalary</span> <span class="keyword">implements</span> <span class="title class_">MyPredicate</span>&lt;Employee&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">test</span><span class="params">(Employee t)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> t.getSalary() &gt;= <span class="number">5000</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>FilterEmployeeByAge 实现类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lambda;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lambda.pojo.Employee;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FilterEmployeeByAge</span> <span class="keyword">implements</span> <span class="title class_">MyPredicate</span>&lt;Employee&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">test</span><span class="params">(Employee t)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> t.getAge() &gt;= <span class="number">35</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Demo02 测试类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 优化方式一</span></span><br><span class="line"><span class="keyword">public</span> List&lt;Employee&gt; <span class="title function_">filterEmployees</span><span class="params">(List&lt;Employee&gt; list, MyPredicate&lt;Employee&gt; myPredicate)</span> &#123;</span><br><span class="line">    List&lt;Employee&gt; emps = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (Employee employee : list) &#123;</span><br><span class="line">        <span class="keyword">if</span> (myPredicate.test(employee)) &#123;</span><br><span class="line">            emps.add(employee);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> emps;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test02</span><span class="params">()</span> &#123;</span><br><span class="line">    List&lt;Employee&gt; list = filterEmployees(<span class="built_in">this</span>.employees, <span class="keyword">new</span> <span class="title class_">FilterEmployeeByAge</span>());</span><br><span class="line">    <span class="keyword">for</span> (Employee employee : list) &#123;</span><br><span class="line">        System.out.println(employee);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;------------------------------------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">    List&lt;Employee&gt; list2 = filterEmployees(<span class="built_in">this</span>.employees, <span class="keyword">new</span> <span class="title class_">FilterEmployeeBySalary</span>());</span><br><span class="line">    <span class="keyword">for</span> (Employee employee : list2) &#123;</span><br><span class="line">        System.out.println(employee);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>策略设计模式优化优劣：</p>
<p>业务代码方法只需要一个 通过不同实体类 实现接口方法来进行约束 业务逻辑 对比第一阶段 使业务代码更加 松耦合 更加容易更改 缺点在于 会多出很多的实体类</p>
<p>阶段三：</p>
<p>匿名内部类优化 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 优化方式三 --匿名内部类方式</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test03</span><span class="params">()</span> &#123;</span><br><span class="line">    List&lt;Employee&gt; list = filterEmployees(<span class="built_in">this</span>.employees, <span class="keyword">new</span> <span class="title class_">MyPredicate</span>&lt;Employee&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">test</span><span class="params">(Employee employee)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> employee.getAge() &lt; <span class="number">35</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (Employee employee : list) &#123;</span><br><span class="line">        System.out.println(employee);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>匿名内部类优化优劣：</p>
<p>动态new 一个匿名内部类 对比于策略设计模式 减少了 需要编写一个实现接口的实体类 从而减少了代码量 但是代码冗余仍然较大</p>
<p>阶段四：</p>
<p>lambda表达式优化 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 优化方式四 --lambda表达式优化</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test04</span><span class="params">()</span> &#123;</span><br><span class="line">    List&lt;Employee&gt; list = filterEmployees(<span class="built_in">this</span>.employees, (employee) -&gt; employee.getSalary() &lt; <span class="number">5000</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (Employee employee : list) &#123;</span><br><span class="line">        System.out.println(employee);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>阶段五：</p>
<p>Stream API 优化 –高级 –Java8新特性</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 优化方式四 --Stream API 优化</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test05</span><span class="params">()</span> &#123;</span><br><span class="line">    employees.stream()</span><br><span class="line">        .filter(e -&gt; e.getSalary() &gt;= <span class="number">5000</span>)</span><br><span class="line">        .limit(<span class="number">3</span>)</span><br><span class="line">        .forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;------------------------------------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">    employees.stream()</span><br><span class="line">        .map(Employee::getName)</span><br><span class="line">        .forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p><strong>Lambda表达式基础语法</strong></p>
</blockquote>
<p><strong>Lambda表达式基础语法</strong></p>
<p>Java8中引入了一个新的操作符 <code>-&gt;</code> 该操作符 称为 箭头操作符 或 lambda 操作符</p>
<p>箭头操作符 将 lambda 表达式 拆分成 两个部分</p>
<ul>
<li>左侧 lambda 表达式的参数列表</li>
<li>右侧 lambda 表达式中所需执行的功能 即 lambda 体 –若接口存在多个 抽象方法 则需要函数式接口的支持</li>
</ul>
<p>基础语法：</p>
<ol>
<li><p>语法一 – 无参数 无返回值</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test01</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * 匿名内部类 --局部内部类 如果在匿名内部类(局部内部类)中应用了一个 同级别的 局部变量 在 jdk1.7 之前 必须是使用 final 修饰的常量</span></span><br><span class="line"><span class="comment">    * 但是在 jdk1.8 后会默认给 局部内部类 中使用到的局部变量加上 final 关键字修饰 同样不能改变 只是可以在定义的时候 不用写 final 关键字</span></span><br><span class="line"><span class="comment">    * 故而 在 lambda表达式 中 如果使用了 局部变量 同样会被默认加上 final 关键字修饰 使得其不能被改变</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 多线程情况下 对比内部类实现</span></span><br><span class="line">    <span class="type">Runnable</span> <span class="variable">r</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;hello world&quot;</span> + num);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    r.run();</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;------------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">Runnable</span> <span class="variable">r2</span> <span class="operator">=</span> () -&gt; System.out.println(<span class="string">&quot;hello lambda&quot;</span> + num);</span><br><span class="line"></span><br><span class="line">    r2.run();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><em>注意：匿名内部类 –局部内部类 如果在匿名内部类(局部内部类)中应用了一个 同级别的 局部变量 在 jdk1.7 之前 必须是使用 final 修饰的常量 但是在 jdk1.8 后会默认给 局部内部类 中使用到的局部变量加上 final 关键字修饰 同样不能改变 只是可以在定义的时候 不用写 final 关键字 故而 在 lambda表达式 中 如果使用了 局部变量 同样会被默认加上 final 关键字修饰 使得其不能被改变</em></p>
</li>
<li><p>语法二 – 有一个参数 无返回值 <em>若只有一个参数 可省略 左侧参数列表的括号</em></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test02</span><span class="params">()</span> &#123;</span><br><span class="line">    Consumer&lt;String&gt; con = (x) -&gt; System.out.println(x);</span><br><span class="line">    Consumer&lt;String&gt; con3 = x -&gt; System.out.println(x);</span><br><span class="line">    con.accept(<span class="string">&quot;hello lambda&quot;</span>);</span><br><span class="line">    con3.accept(<span class="string">&quot;hello lambda&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法三 – 有两个以上参数 有返回值 且 lambda 体中有多条语句</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test03</span><span class="params">()</span> &#123;</span><br><span class="line">    Comparator&lt;Integer&gt; com = (x, y) -&gt; &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;hello lambda&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> Integer.compare(x, y);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法四 – 有两个以上参数 有返回值 且 lambda 体中只有一条 return 语句 即可省略 <code>&#123;&#125;</code> 与 <code>return</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test04</span><span class="params">()</span> &#123;</span><br><span class="line">    Comparator&lt;Integer&gt; com = (x, y) -&gt; Integer.compare(x, y);</span><br><span class="line">    Comparator&lt;Integer&gt; com2 = Integer::compare;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法五 –关于 lambda 表达式的参数列表 编写参数数据类型 可省略不写 JVM编译器 会通过上下文来推断出数据类型 即 “类型推断”</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test04</span><span class="params">()</span> &#123;</span><br><span class="line">    Comparator&lt;Integer&gt; com = (x, y) -&gt; Integer.compare(x, y);</span><br><span class="line">    Comparator&lt;Integer&gt; com2 = (Integer x, Integer y) -&gt; Integer.compare(x, y);</span><br><span class="line">    Comparator&lt;Integer&gt; com3 = Integer::compare;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>常见”类型推断”还有</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Integer&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">List&lt;Integer&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(Integer);</span><br><span class="line"></span><br><span class="line">String[] str = &#123;<span class="string">&quot;222&quot;</span>, <span class="string">&quot;22d2&quot;</span>, <span class="string">&quot;54363&quot;</span>&#125;;</span><br></pre></td></tr></table></figure>

<p>在java8中 通过上下文来推断出数据类型 得到了很大的升级 举例说明即</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test05</span><span class="params">()</span> &#123;</span><br><span class="line">    show(<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;());	<span class="comment">// 只需要传入 new HashMap&lt;&gt;() 即可 Java8 会根据上下文 推断出需要传入参数的类型</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">show</span><span class="params">(Map&lt;String, Integer&gt; map)</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<p>Java8本质上也会有参数类型检查 由于其语法糖性质 故而会使其看起来更加简洁 代码量更加少 但是可读性相对较差</p>
<p>&#x3D;&#x3D;注意：lambda表达式 需要”函数式接口”的支持 函数式接口 即 只含有一个抽象方法的接口 称之为 函数式接口&#x3D;&#x3D;</p>
<p>函数式接口可以使用 <code>@FunctionalInterface</code> 注解修饰 标注此注解 能检查 此接口 是否满足成为 函数式接口</p>
<p><strong>参考代码：</strong></p>
<p>Employee</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lambda.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Employee</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> salary;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Employee</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Employee</span><span class="params">(String name, <span class="type">int</span> age, <span class="type">double</span> salary)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">        <span class="built_in">this</span>.salary = salary;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Employee&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, age=&quot;</span> + age +</span><br><span class="line">                <span class="string">&quot;, salary=&quot;</span> + salary +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(<span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">getSalary</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> salary;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSalary</span><span class="params">(<span class="type">double</span> salary)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.salary = salary;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Demo01</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lambda;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> java.util.Comparator;</span><br><span class="line"><span class="keyword">import</span> java.util.TreeSet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo01</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 匿名内部类</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">Test01</span><span class="params">()</span> &#123;</span><br><span class="line">        Comparator&lt;Integer&gt; com = <span class="keyword">new</span> <span class="title class_">Comparator</span>&lt;Integer&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(Integer o1, Integer o2)</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> Integer.compare(o1, o2);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        TreeSet&lt;Integer&gt; treeSet = <span class="keyword">new</span> <span class="title class_">TreeSet</span>&lt;&gt;(com);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">Test02</span><span class="params">()</span> &#123;</span><br><span class="line">        Comparator&lt;Integer&gt; com = (x, y) -&gt; Integer.compare(x, y);</span><br><span class="line">        Comparator&lt;Integer&gt; com2 = Integer::compare;</span><br><span class="line">        TreeSet&lt;Integer&gt; treeSet = <span class="keyword">new</span> <span class="title class_">TreeSet</span>&lt;&gt;(com);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Demo02</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lambda;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lambda.pojo.Employee;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo02</span> &#123;</span><br><span class="line"></span><br><span class="line">    List&lt;Employee&gt; employees = Arrays.asList(</span><br><span class="line">            <span class="comment">// 张三李四王五赵六孙七周八吴九郑十</span></span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;张三&quot;</span>, <span class="number">19</span>, <span class="number">2222.33</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;李四&quot;</span>, <span class="number">29</span>, <span class="number">22552.33</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;王五&quot;</span>, <span class="number">43</span>, <span class="number">3332.33</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;赵六&quot;</span>, <span class="number">59</span>, <span class="number">6255.33</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;孙七&quot;</span>, <span class="number">64</span>, <span class="number">7722.33</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;周八&quot;</span>, <span class="number">25</span>, <span class="number">8822.33</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;吴九&quot;</span>, <span class="number">35</span>, <span class="number">2992.33</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;郑十&quot;</span>, <span class="number">57</span>, <span class="number">4992.33</span>)</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test01</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;Employee&gt; list = filterEmployees(<span class="built_in">this</span>.employees);</span><br><span class="line">        <span class="keyword">for</span> (Employee employee : list) &#123;</span><br><span class="line">            System.out.println(employee);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;------------------------------------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        List&lt;Employee&gt; list2 = filterEmployees2(<span class="built_in">this</span>.employees);</span><br><span class="line">        <span class="keyword">for</span> (Employee employee : list2) &#123;</span><br><span class="line">            System.out.println(employee);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test02</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;Employee&gt; list = filterEmployees(<span class="built_in">this</span>.employees, <span class="keyword">new</span> <span class="title class_">FilterEmployeeByAge</span>());</span><br><span class="line">        <span class="keyword">for</span> (Employee employee : list) &#123;</span><br><span class="line">            System.out.println(employee);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;------------------------------------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        List&lt;Employee&gt; list2 = filterEmployees(<span class="built_in">this</span>.employees, <span class="keyword">new</span> <span class="title class_">FilterEmployeeBySalary</span>());</span><br><span class="line">        <span class="keyword">for</span> (Employee employee : list2) &#123;</span><br><span class="line">            System.out.println(employee);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 优化方式一 --策略设计模式</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Employee&gt; <span class="title function_">filterEmployees</span><span class="params">(List&lt;Employee&gt; list, MyPredicate&lt;Employee&gt; myPredicate)</span> &#123;</span><br><span class="line">        List&lt;Employee&gt; emps = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (Employee employee : list) &#123;</span><br><span class="line">            <span class="keyword">if</span> (myPredicate.test(employee)) &#123;</span><br><span class="line">                emps.add(employee);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> emps;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 优化方式二 --匿名内部类方式</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test03</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;Employee&gt; list = filterEmployees(<span class="built_in">this</span>.employees, <span class="keyword">new</span> <span class="title class_">MyPredicate</span>&lt;Employee&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">test</span><span class="params">(Employee employee)</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> employee.getAge() &lt; <span class="number">35</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (Employee employee : list) &#123;</span><br><span class="line">            System.out.println(employee);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 优化方式三 --lambda表达式优化</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test04</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;Employee&gt; list = filterEmployees(<span class="built_in">this</span>.employees, (employee) -&gt; employee.getSalary() &lt; <span class="number">5000</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (Employee employee : list) &#123;</span><br><span class="line">            System.out.println(employee);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 优化方式四 --Stream API 优化</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test05</span><span class="params">()</span> &#123;</span><br><span class="line">        employees.stream()</span><br><span class="line">                .filter(e -&gt; e.getSalary() &gt;= <span class="number">5000</span>)</span><br><span class="line">                .limit(<span class="number">3</span>)</span><br><span class="line">                .forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;------------------------------------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        employees.stream()</span><br><span class="line">                .map(Employee::getName)</span><br><span class="line">                .forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 需求 获取当前公司 员工年龄大于 35 的员工信息</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Employee&gt; <span class="title function_">filterEmployees</span><span class="params">(List&lt;Employee&gt; list)</span> &#123;</span><br><span class="line">        List&lt;Employee&gt; emps = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (Employee emp : list) &#123;</span><br><span class="line">            <span class="keyword">if</span> (emp.getAge() &gt;= <span class="number">35</span>) &#123;</span><br><span class="line">                emps.add(emp);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> emps;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 需求 获取当前公司 员工工资大于 5000 的员工信息</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Employee&gt; <span class="title function_">filterEmployees2</span><span class="params">(List&lt;Employee&gt; list)</span> &#123;</span><br><span class="line">        List&lt;Employee&gt; emps = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (Employee emp : list) &#123;</span><br><span class="line">            <span class="keyword">if</span> (emp.getSalary() &gt;= <span class="number">5000</span>) &#123;</span><br><span class="line">                emps.add(emp);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> emps;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Demo03</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lambda;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lambda.pojo.Employee;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.util.function.Consumer;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Java8中引入了一个新的操作符 `-&gt;` 该操作符 称为 箭头操作符 或 lambda 操作符</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 箭头操作符 将 lambda 表达式 拆分成 两个部分</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * + 左侧 lambda 表达式的参数列表</span></span><br><span class="line"><span class="comment"> * + 右侧 lambda 表达式中所需执行的功能 即 lambda 体 --若接口存在多个 抽象方法 则需要函数式接口的支持</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 语法一: 无参数 无返回值</span></span><br><span class="line"><span class="comment"> *      () -&gt; System.out.println(&quot;Hello lambda&quot;);</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 语法二: 有一个参数 无返回值 --若只有一个参数 可省略 左侧参数列表的括号</span></span><br><span class="line"><span class="comment"> *      con = (x) -&gt; System.out.println(x);</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 语法三: 有两个以上参数 有返回值 且 lambda 体中有多条语句</span></span><br><span class="line"><span class="comment"> *      Comparator&lt;Integer&gt; com = (x, y) -&gt; &#123;</span></span><br><span class="line"><span class="comment"> *             System.out.println(&quot;hello lambda&quot;);</span></span><br><span class="line"><span class="comment"> *             return Integer.compare(x, y);</span></span><br><span class="line"><span class="comment"> *         &#125;;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 语法四: 有两个以上参数 有返回值 且 lambda 体中只有一条 return 语句 即可省略 &#123;&#125; 与 return</span></span><br><span class="line"><span class="comment"> *      Comparator&lt;Integer&gt; com = (x, y) -&gt; Integer.compare(x, y);</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 语法五: 关于 lambda 表达式的参数列表 编写参数数据类型 可省略不写 JVM编译器 会通过上下文来推断出数据类型 即 &quot;类型推断&quot;</span></span><br><span class="line"><span class="comment"> *      Comparator&lt;Integer&gt; com2 = (Integer x, Integer y) -&gt; Integer.compare(x, y);</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo03</span> &#123;</span><br><span class="line"></span><br><span class="line">    List&lt;Integer&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    String[] str = &#123;<span class="string">&quot;222&quot;</span>, <span class="string">&quot;22d2&quot;</span>, <span class="string">&quot;54363&quot;</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test01</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        * 匿名内部类 --局部内部类 如果在匿名内部类(局部内部类)中应用了一个 同级别的 局部变量 在 jdk1.7 之前 必须是使用 final 修饰的常量</span></span><br><span class="line"><span class="comment">        * 但是在 jdk1.8 后会默认给 局部内部类 中使用到的局部变量加上 final 关键字修饰 同样不能改变 只是可以在定义的时候 不用写 final 关键字</span></span><br><span class="line"><span class="comment">        * 故而 在 lambda表达式 中 如果使用了 局部变量 同样会被默认加上 final 关键字修饰 使得其不能被改变</span></span><br><span class="line"><span class="comment">        * */</span></span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 多线程情况下 对比内部类实现</span></span><br><span class="line">        <span class="type">Runnable</span> <span class="variable">r</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;hello world&quot;</span> + num);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        r.run();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;------------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Runnable</span> <span class="variable">r2</span> <span class="operator">=</span> () -&gt; System.out.println(<span class="string">&quot;hello lambda&quot;</span> + num);</span><br><span class="line">        r2.run();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test02</span><span class="params">()</span> &#123;</span><br><span class="line">        Consumer&lt;String&gt; con = (x) -&gt; System.out.println(x);</span><br><span class="line">        Consumer&lt;String&gt; con3 = x -&gt; System.out.println(x);</span><br><span class="line">        con.accept(<span class="string">&quot;hello lambda&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test03</span><span class="params">()</span> &#123;</span><br><span class="line">        Comparator&lt;Integer&gt; com = (x, y) -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;hello lambda&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> Integer.compare(x, y);</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test04</span><span class="params">()</span> &#123;</span><br><span class="line">        Comparator&lt;Integer&gt; com = (x, y) -&gt; Integer.compare(x, y);</span><br><span class="line">        Comparator&lt;Integer&gt; com2 = (Integer x, Integer y) -&gt; Integer.compare(x, y);</span><br><span class="line">        Comparator&lt;Integer&gt; com3 = Integer::compare;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test05</span><span class="params">()</span> &#123;</span><br><span class="line">        show(<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">show</span><span class="params">(Map&lt;String, Integer&gt; map)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>FilterEmployeeByAge</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lambda;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lambda.pojo.Employee;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FilterEmployeeByAge</span> <span class="keyword">implements</span> <span class="title class_">MyPredicate</span>&lt;Employee&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">test</span><span class="params">(Employee t)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> t.getAge() &gt;= <span class="number">35</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>FilterEmployeeBySalary</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lambda;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lambda.pojo.Employee;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FilterEmployeeBySalary</span> <span class="keyword">implements</span> <span class="title class_">MyPredicate</span>&lt;Employee&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">test</span><span class="params">(Employee t)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> t.getSalary() &gt;= <span class="number">5000</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>MyPredicate</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lambda;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MyPredicate</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">test</span><span class="params">(T t)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p><strong>lambda表达式练习</strong></p>
</blockquote>
<p><strong>练习一</strong></p>
<p>数字计算操作</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test01</span><span class="params">()</span> &#123;</span><br><span class="line">    System.out.println(operation(<span class="number">122</span>, x -&gt; x * <span class="number">2</span>));</span><br><span class="line">    System.out.println(operation(<span class="number">122</span>, y -&gt; y - <span class="number">2</span>));</span><br><span class="line">    System.out.println(operation(<span class="number">122</span>, z -&gt; z + <span class="number">233</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> Integer <span class="title function_">operation</span><span class="params">(Integer num, MyFunction mf)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> mf.getValue(num);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>MyFunction 接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lambda;</span><br><span class="line"></span><br><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MyFunction</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getValue</span><span class="params">(Integer num)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>练习二</strong></p>
<p>调用 Collections.sort() 方法 通过定制排序比较两个 Employee(先按年龄比 年龄相同 按姓名比) 使用lambda 作为参数传递</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test02</span><span class="params">()</span> &#123;</span><br><span class="line">    Collections.sort(employees, (e1, e2) -&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> (e1.getAge() == e2.getAge()) &#123;</span><br><span class="line">            <span class="keyword">return</span> e1.getName().compareTo(e2.getName());</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> -Integer.compare(e1.getAge(), e2.getAge());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (Employee employee : employees) &#123;</span><br><span class="line">        System.out.println(employee);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>练习三</strong></p>
<ul>
<li>声明函数式接口 在接口中声明抽象方法 public String getValue(String str);</li>
<li>声明类 Demo04 在类中编写方法使用接口作为参数 将要给字符串转换成大写 并作为方法的返回值</li>
<li>再将一个字符串的 第 2 个 和 第 4 个 索引位置进行截取字串</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test03</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> strHandler(<span class="string">&quot;\t\t\t hello world&quot;</span>, String::trim);</span><br><span class="line">    <span class="type">String</span> <span class="variable">s2</span> <span class="operator">=</span> strHandler(<span class="string">&quot;\t\t\t hello world&quot;</span>, str -&gt; str.trim());</span><br><span class="line">    System.out.println(s);</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">s3</span> <span class="operator">=</span> strHandler(<span class="string">&quot;asdgsd&quot;</span>, String::toUpperCase);</span><br><span class="line">    <span class="type">String</span> <span class="variable">s4</span> <span class="operator">=</span> strHandler(<span class="string">&quot;asdgsd&quot;</span>, str -&gt; str.toUpperCase());</span><br><span class="line">    System.out.println(s4);</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;--------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">s5</span> <span class="operator">=</span> strHandler(<span class="string">&quot;Lineyuxanhan&quot;</span>, str -&gt; str.substring(<span class="number">1</span>, <span class="number">4</span>));</span><br><span class="line">    System.out.println(s5);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">strHandler</span><span class="params">(String str, MyFun mf)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> mf.getValue(str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>MyFun 接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lambda;</span><br><span class="line"></span><br><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MyFun</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getValue</span><span class="params">(String str)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>练习四</strong></p>
<ul>
<li>声明一个带两个泛型的函数式接口 泛型类型为 <code>&lt;T, R&gt;</code> <code>T</code> 为参数 <code>R</code> 为返回值</li>
<li>接口中声明对应抽象方法</li>
<li>在 TestLambda 类中 声明方法 使接口作为参数 计算两个 long 类型 参数的和</li>
<li>再计算两个 long 类型 参数的乘积</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test04</span><span class="params">()</span> &#123;</span><br><span class="line">    operation(<span class="number">100L</span>, <span class="number">200L</span>, (x, y) -&gt; x + y);</span><br><span class="line">    System.out.println(<span class="string">&quot;-------------------&quot;</span>);</span><br><span class="line">    operation(<span class="number">100L</span>, <span class="number">200L</span>, (x, y) -&gt; x - y);</span><br><span class="line">    System.out.println(<span class="string">&quot;-------------------&quot;</span>);</span><br><span class="line">    operation(<span class="number">100L</span>, <span class="number">200L</span>, Long::sum);</span><br><span class="line">    System.out.println(<span class="string">&quot;-------------------&quot;</span>);</span><br><span class="line">    operation(<span class="number">100L</span>, <span class="number">200L</span>, (x, y) -&gt; x * y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">operation</span><span class="params">(Long l1, Long l2, MyFun2&lt;Long, Long&gt; mf)</span> &#123;</span><br><span class="line">    System.out.println(mf.getValue(l1, l2));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>MyFun2</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lambda;</span><br><span class="line"></span><br><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MyFun2</span>&lt;T, R&gt; &#123;</span><br><span class="line">    <span class="keyword">public</span> R <span class="title function_">getValue</span><span class="params">(T t1, T t2)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>参考代码</strong></p>
<p>Demo04</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lambda;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lambda.pojo.Employee;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.Collections;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo04</span> &#123;</span><br><span class="line"></span><br><span class="line">    List&lt;Employee&gt; employees = Arrays.asList(</span><br><span class="line">            <span class="comment">// 张三李四王五赵六孙七周八吴九郑十</span></span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;张三&quot;</span>, <span class="number">19</span>, <span class="number">2222.33</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;王五&quot;</span>, <span class="number">29</span>, <span class="number">22552.33</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;李四&quot;</span>, <span class="number">29</span>, <span class="number">3332.33</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;赵六&quot;</span>, <span class="number">59</span>, <span class="number">6255.33</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;孙七&quot;</span>, <span class="number">64</span>, <span class="number">7722.33</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;周八&quot;</span>, <span class="number">25</span>, <span class="number">8822.33</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;吴九&quot;</span>, <span class="number">35</span>, <span class="number">2992.33</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;郑十&quot;</span>, <span class="number">57</span>, <span class="number">4992.33</span>)</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test01</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(operation(<span class="number">122</span>, x -&gt; x * <span class="number">2</span>));</span><br><span class="line">        System.out.println(operation(<span class="number">122</span>, y -&gt; y - <span class="number">2</span>));</span><br><span class="line">        System.out.println(operation(<span class="number">122</span>, z -&gt; z + <span class="number">233</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">operation</span><span class="params">(Integer num, MyFunction mf)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> mf.getValue(num);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test02</span><span class="params">()</span> &#123;</span><br><span class="line">        Collections.sort(employees, (e1, e2) -&gt; &#123;</span><br><span class="line">            <span class="keyword">if</span> (e1.getAge() == e2.getAge()) &#123;</span><br><span class="line">                <span class="keyword">return</span> e1.getName().compareTo(e2.getName());</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> -Integer.compare(e1.getAge(), e2.getAge());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (Employee employee : employees) &#123;</span><br><span class="line">            System.out.println(employee);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test03</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> strHandler(<span class="string">&quot;\t\t\t hello world&quot;</span>, String::trim);</span><br><span class="line">        <span class="type">String</span> <span class="variable">s2</span> <span class="operator">=</span> strHandler(<span class="string">&quot;\t\t\t hello world&quot;</span>, str -&gt; str.trim());</span><br><span class="line">        System.out.println(s);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;--------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">s3</span> <span class="operator">=</span> strHandler(<span class="string">&quot;asdgsd&quot;</span>, String::toUpperCase);</span><br><span class="line">        <span class="type">String</span> <span class="variable">s4</span> <span class="operator">=</span> strHandler(<span class="string">&quot;asdgsd&quot;</span>, str -&gt; str.toUpperCase());</span><br><span class="line">        System.out.println(s4);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;--------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">s5</span> <span class="operator">=</span> strHandler(<span class="string">&quot;Lineyuxanhan&quot;</span>, str -&gt; str.substring(<span class="number">1</span>, <span class="number">4</span>));</span><br><span class="line">        System.out.println(s5);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 处理字符串</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">strHandler</span><span class="params">(String str, MyFun mf)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> mf.getValue(str);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test04</span><span class="params">()</span> &#123;</span><br><span class="line">        operation(<span class="number">100L</span>, <span class="number">200L</span>, (x, y) -&gt; x + y);</span><br><span class="line">        System.out.println(<span class="string">&quot;-------------------&quot;</span>);</span><br><span class="line">        operation(<span class="number">100L</span>, <span class="number">200L</span>, (x, y) -&gt; x - y);</span><br><span class="line">        System.out.println(<span class="string">&quot;-------------------&quot;</span>);</span><br><span class="line">        operation(<span class="number">100L</span>, <span class="number">200L</span>, Long::sum);</span><br><span class="line">        System.out.println(<span class="string">&quot;-------------------&quot;</span>);</span><br><span class="line">        operation(<span class="number">100L</span>, <span class="number">200L</span>, (x, y) -&gt; x * y);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">operation</span><span class="params">(Long l1, Long l2, MyFun2&lt;Long, Long&gt; mf)</span> &#123;</span><br><span class="line">        System.out.println(mf.getValue(l1, l2));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="2-函数式接口"><a href="#2-函数式接口" class="headerlink" title="2. 函数式接口"></a>2. 函数式接口</h2><blockquote>
<p><strong>Java8 常见四大内置核心函数式接口 –用于lambda表达式</strong></p>
</blockquote>
<p><strong>消费型接口</strong> <code>Consumer&lt;T&gt;</code> </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Consumer&lt;T&gt;</span><br><span class="line"><span class="keyword">void</span> <span class="title function_">accept</span><span class="params">(T t)</span>;</span><br></pre></td></tr></table></figure>



<p><strong>供给型接口</strong> <code>Supplier&lt;T&gt;</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Supplier&lt;T&gt;</span><br><span class="line">T <span class="title function_">get</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure>



<p><strong>函数型接口</strong> <code>Function&lt;T, R&gt;</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Function&lt;T, R&gt;</span><br><span class="line">R <span class="title function_">apply</span><span class="params">(T t)</span>;</span><br></pre></td></tr></table></figure>



<p><strong>断言型接口</strong> <code>Predicate&lt;T&gt;</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Predicate&lt;T&gt;</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">test</span><span class="params">(T t)</span>;</span><br></pre></td></tr></table></figure>



<p><strong>参考代码</strong></p>
<p>Demo05</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lambda;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.function.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Java8 中 四大内置核心函数式接口</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Consumer&lt;T&gt; 消费型接口</span></span><br><span class="line"><span class="comment"> *      void accept(T t);</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Supplier&lt;T&gt; 供给型接口</span></span><br><span class="line"><span class="comment"> *      T get();</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Function&lt;T, R&gt; 函数型接口</span></span><br><span class="line"><span class="comment"> *      R apply(T t);</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Predicate&lt;T&gt; 断言型接口</span></span><br><span class="line"><span class="comment"> *      boolean test(T t);</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo05</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Consumer&lt;T&gt; 消费型接口</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test01</span><span class="params">()</span> &#123;</span><br><span class="line">        happy(<span class="number">10000</span>, m -&gt; System.out.println(<span class="string">&quot;本次消费金额&quot;</span> + m + <span class="string">&quot;元&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 需求 消费多少元</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">happy</span><span class="params">(<span class="type">double</span> money, DoubleConsumer con)</span> &#123;</span><br><span class="line">        con.accept(money);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">happy2</span><span class="params">(<span class="type">double</span> money, Consumer&lt;Double&gt; con)</span> &#123;</span><br><span class="line">        con.accept(money);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Supplier&lt;T&gt; 供给型接口</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test02</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;Integer&gt; numList = getNumList(<span class="number">10</span>, () -&gt; (<span class="type">int</span>)(Math.random() * <span class="number">100</span>));</span><br><span class="line">        <span class="keyword">for</span> (Integer num : numList) &#123;</span><br><span class="line">            System.out.println(num);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 需求 产生指定 n 个整数 并存放到集合中</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Integer&gt; <span class="title function_">getNumList</span><span class="params">(<span class="type">int</span> num, Supplier&lt;Integer&gt; sup)</span> &#123;</span><br><span class="line">        List&lt;Integer&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; num; i++) &#123;</span><br><span class="line">            <span class="type">Integer</span> <span class="variable">n</span> <span class="operator">=</span> sup.get();</span><br><span class="line">            list.add(n);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Function&lt;T, R&gt; 函数型接口</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test03</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(strHandler(<span class="string">&quot;Linyuxuan&quot;</span>, String::toUpperCase));</span><br><span class="line">        System.out.println(<span class="string">&quot;-------------&quot;</span>);</span><br><span class="line">        System.out.println(strHandler(<span class="string">&quot;Kking_Queen&quot;</span>, s -&gt; s.length() + <span class="string">&quot;&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;-------------&quot;</span>);</span><br><span class="line">        System.out.println(strHandler(<span class="string">&quot;Kking_Queen&quot;</span>, s -&gt; &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">s1</span> <span class="operator">=</span> s.toLowerCase();</span><br><span class="line">            s1 += <span class="string">&quot;nihaoya&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> s1.toUpperCase();</span><br><span class="line">        &#125;));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 需求 用于处理字符串</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">strHandler</span><span class="params">(String str, Function&lt;String, String&gt; fun)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> fun.apply(str);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Predicate&lt;T&gt; 断言型接口</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test04</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;String&gt; list = Arrays.asList(<span class="string">&quot;Hello&quot;</span>, <span class="string">&quot;nihao&quot;</span>, <span class="string">&quot;Kking&quot;</span>, <span class="string">&quot;KLus&quot;</span>, <span class="string">&quot;Winas&quot;</span>, <span class="string">&quot;K&amp;K is win&quot;</span>, <span class="string">&quot;Queen&quot;</span>, <span class="string">&quot;LIny&quot;</span>);</span><br><span class="line">        System.out.println(filterStr(list, s -&gt; s.length() &gt; <span class="number">4</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 需求 过滤满足条件的字符串 并存入集合中</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">filterStr</span><span class="params">(List&lt;String&gt; list, Predicate&lt;String&gt; pre)</span> &#123;</span><br><span class="line">        List&lt;String&gt; strList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (String str : list) &#123;</span><br><span class="line">            <span class="keyword">if</span> (pre.test(str)) &#123;</span><br><span class="line">                strList.add(str);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> strList;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>TODO</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20221007212140246.png" alt="image-20221007212140246"></p>
<h2 id="3-方法引用-构造器引用-与-数组引用"><a href="#3-方法引用-构造器引用-与-数组引用" class="headerlink" title="3. 方法引用 构造器引用 与 数组引用"></a>3. 方法引用 构造器引用 与 数组引用</h2><blockquote>
<p><strong>方法引用</strong></p>
</blockquote>
<p>方法引用 即当 lambda 体中的内容 方法已经被实现了 就可以使用  “方法引用” 来直接 编写使用</p>
<p>简单理解即 方法引用是 lambda 表达式的另外一种表现形式</p>
<p><strong>语法格式</strong></p>
<ul>
<li><p>语法格式一 <code>对象::实例方法名</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 对象::实例方法名</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test01</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 使用条件 必须 接口 参数列表 返回值 与 实例方法 参数列表 返回值 类型 一致</span></span><br><span class="line">    Consumer&lt;String&gt; con = x -&gt; System.out.println(x);</span><br><span class="line">    Consumer&lt;String&gt; con2 = System.out::println;</span><br><span class="line"></span><br><span class="line">    <span class="type">PrintStream</span> <span class="variable">ps1</span> <span class="operator">=</span> System.out;</span><br><span class="line">    Consumer&lt;String&gt; con3 = x -&gt; ps1.println(x);</span><br><span class="line"></span><br><span class="line">    <span class="type">PrintStream</span> <span class="variable">ps2</span> <span class="operator">=</span> System.out;</span><br><span class="line">    Consumer&lt;String&gt; con4 = ps2::println;</span><br><span class="line"></span><br><span class="line">    con.accept(<span class="string">&quot;hello world&quot;</span>);</span><br><span class="line">    con2.accept(<span class="string">&quot;hello world2&quot;</span>);</span><br><span class="line">    con3.accept(<span class="string">&quot;hello world3&quot;</span>);</span><br><span class="line">    con4.accept(<span class="string">&quot;hello world4&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test02</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">Employee</span> <span class="variable">emp</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;zhangsan&quot;</span>, <span class="number">18</span>, <span class="number">255</span>);</span><br><span class="line">    Supplier&lt;String&gt; sup = () -&gt; emp.getName();</span><br><span class="line">    <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> sup.get();</span><br><span class="line">    System.out.println(str);</span><br><span class="line"></span><br><span class="line">    Supplier&lt;String&gt; sup2 = emp::getName;</span><br><span class="line">    Supplier&lt;Integer&gt; sup3 = emp::getAge;</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">str2</span> <span class="operator">=</span> sup2.get();</span><br><span class="line">    System.out.println(str2);</span><br><span class="line"></span><br><span class="line">    <span class="type">Integer</span> <span class="variable">num</span> <span class="operator">=</span> sup3.get();</span><br><span class="line">    System.out.println(num);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法格式二 <code>类::静态方法名</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 类::静态方法名</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test03</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 使用条件 必须 接口 参数列表 返回值 与 类的静态方法 参数列表 返回值 类型 一致</span></span><br><span class="line">    Comparator&lt;Integer&gt; com = (x, y) -&gt; Integer.compare(x, y);</span><br><span class="line">    Comparator&lt;Integer&gt; com2 = Integer::compare;</span><br><span class="line"></span><br><span class="line">    System.out.println(com.compare(<span class="number">4</span>, <span class="number">2</span>));</span><br><span class="line">    System.out.println(com2.compare(<span class="number">12</span>, <span class="number">23</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法格式三 <code>类::实例方法名</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 类::实例方法名</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test04</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 使用条件较为苛刻</span></span><br><span class="line">    BiPredicate&lt;String, String&gt; bp = (x, y) -&gt; x.equals(y);</span><br><span class="line">    System.out.println(bp.test(<span class="string">&quot;dddd&quot;</span>, <span class="string">&quot;ffff&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 只有当 类 中的实例方法 包含两个参数 x y 并且 lambda 体中 调用方法为 x.function(y) 才能满足使用要求</span></span><br><span class="line">    BiPredicate&lt;String, String&gt; bp2 = String::equals;</span><br><span class="line">    System.out.println(bp2.test(<span class="string">&quot;dddd&quot;</span>, <span class="string">&quot;dddd&quot;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<blockquote>
<p><strong>构造器引用</strong></p>
</blockquote>
<p>构造器引用</p>
<p>语法 <code>ClassName::new</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test05</span><span class="params">()</span> &#123;</span><br><span class="line">    Supplier&lt;Employee&gt; sup = () -&gt; <span class="keyword">new</span> <span class="title class_">Employee</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 注意 使用条件为 构造器的参数列表 必须与 函数式接口中抽象方法的参数列表保持一致</span></span><br><span class="line">    <span class="comment">// 构造器引用 --调用无参构造</span></span><br><span class="line">    Supplier&lt;Employee&gt; sup2 = Employee::<span class="keyword">new</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 构造器引用 --调用有参构造</span></span><br><span class="line">    Function&lt;String, Employee&gt; fun = (x) -&gt; <span class="keyword">new</span> <span class="title class_">Employee</span>();</span><br><span class="line">    Function&lt;String, Employee&gt; fun2 = Employee::<span class="keyword">new</span>;</span><br><span class="line"></span><br><span class="line">    System.out.println(fun.apply(<span class="string">&quot;zhangsan&quot;</span>));</span><br><span class="line">    System.out.println(fun2.apply(<span class="string">&quot;lisi&quot;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p><strong>数组引用</strong></p>
</blockquote>
<p>语法：<code>Type[]::new</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 数组引用</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test06</span><span class="params">()</span> &#123;</span><br><span class="line">    Function&lt;Integer, String[]&gt; fun = x -&gt; <span class="keyword">new</span> <span class="title class_">String</span>[x];</span><br><span class="line">    String[] strs = fun.apply(<span class="number">10</span>);</span><br><span class="line">    <span class="keyword">for</span> (String str : strs) &#123;</span><br><span class="line">        System.out.println(str);</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.println(strs.length);</span><br><span class="line"></span><br><span class="line">    Function&lt;Integer, String[]&gt; fun2 = String[]::<span class="keyword">new</span>;</span><br><span class="line">    String[] strs2 = fun2.apply(<span class="number">20</span>);</span><br><span class="line">    System.out.println(strs2.length);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>参考代码</strong></p>
<p>Demo06</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lambda;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lambda.pojo.Employee;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.PrintStream;</span><br><span class="line"><span class="keyword">import</span> java.util.Comparator;</span><br><span class="line"><span class="keyword">import</span> java.util.EnumMap;</span><br><span class="line"><span class="keyword">import</span> java.util.function.BiPredicate;</span><br><span class="line"><span class="keyword">import</span> java.util.function.Consumer;</span><br><span class="line"><span class="keyword">import</span> java.util.function.Function;</span><br><span class="line"><span class="keyword">import</span> java.util.function.Supplier;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo06</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 对象::实例方法名</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test01</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 使用条件 必须 接口 参数列表 返回值 与 对象实例方法 参数列表 返回值 类型 一致</span></span><br><span class="line">        Consumer&lt;String&gt; con = x -&gt; System.out.println(x);</span><br><span class="line">        Consumer&lt;String&gt; con2 = System.out::println;</span><br><span class="line"></span><br><span class="line">        <span class="type">PrintStream</span> <span class="variable">ps1</span> <span class="operator">=</span> System.out;</span><br><span class="line">        Consumer&lt;String&gt; con3 = x -&gt; ps1.println(x);</span><br><span class="line"></span><br><span class="line">        <span class="type">PrintStream</span> <span class="variable">ps2</span> <span class="operator">=</span> System.out;</span><br><span class="line">        Consumer&lt;String&gt; con4 = ps2::println;</span><br><span class="line"></span><br><span class="line">        con.accept(<span class="string">&quot;hello world&quot;</span>);</span><br><span class="line">        con2.accept(<span class="string">&quot;hello world2&quot;</span>);</span><br><span class="line">        con3.accept(<span class="string">&quot;hello world3&quot;</span>);</span><br><span class="line">        con4.accept(<span class="string">&quot;hello world4&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test02</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Employee</span> <span class="variable">emp</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;zhangsan&quot;</span>, <span class="number">18</span>, <span class="number">255</span>);</span><br><span class="line">        Supplier&lt;String&gt; sup = () -&gt; emp.getName();</span><br><span class="line">        <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> sup.get();</span><br><span class="line">        System.out.println(str);</span><br><span class="line"></span><br><span class="line">        Supplier&lt;String&gt; sup2 = emp::getName;</span><br><span class="line">        Supplier&lt;Integer&gt; sup3 = emp::getAge;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">str2</span> <span class="operator">=</span> sup2.get();</span><br><span class="line">        System.out.println(str2);</span><br><span class="line"></span><br><span class="line">        <span class="type">Integer</span> <span class="variable">num</span> <span class="operator">=</span> sup3.get();</span><br><span class="line">        System.out.println(num);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 类::静态方法名</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test03</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 使用条件 必须 接口 参数列表 返回值 与 类的静态方法 参数列表 返回值 类型 一致</span></span><br><span class="line">        Comparator&lt;Integer&gt; com = (x, y) -&gt; Integer.compare(x, y);</span><br><span class="line">        Comparator&lt;Integer&gt; com2 = Integer::compare;</span><br><span class="line"></span><br><span class="line">        System.out.println(com.compare(<span class="number">4</span>, <span class="number">2</span>));</span><br><span class="line">        System.out.println(com2.compare(<span class="number">12</span>, <span class="number">23</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 类::实例方法名</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test04</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 使用条件较为苛刻</span></span><br><span class="line">        BiPredicate&lt;String, String&gt; bp = (x, y) -&gt; x.equals(y);</span><br><span class="line">        System.out.println(bp.test(<span class="string">&quot;dddd&quot;</span>, <span class="string">&quot;ffff&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 只有当 类 中的实例方法 包含两个参数 x y 并且 lambda 体中 调用方法为 x.function(y) 才能满足使用要求</span></span><br><span class="line">        BiPredicate&lt;String, String&gt; bp2 = String::equals;</span><br><span class="line">        System.out.println(bp2.test(<span class="string">&quot;dddd&quot;</span>, <span class="string">&quot;dddd&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 构造器引用</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test05</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">        Supplier&lt;Employee&gt; sup = () -&gt; <span class="keyword">new</span> <span class="title class_">Employee</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 注意 使用条件为 构造器的参数列表 必须与 函数式接口中抽象方法的参数列表保持一致</span></span><br><span class="line">        <span class="comment">// 构造器引用 --调用无参构造</span></span><br><span class="line">        Supplier&lt;Employee&gt; sup2 = Employee::<span class="keyword">new</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 构造器引用 --调用有参构造</span></span><br><span class="line">        Function&lt;String, Employee&gt; fun = (x) -&gt; <span class="keyword">new</span> <span class="title class_">Employee</span>();</span><br><span class="line">        Function&lt;String, Employee&gt; fun2 = Employee::<span class="keyword">new</span>;</span><br><span class="line"></span><br><span class="line">        System.out.println(fun.apply(<span class="string">&quot;zhangsan&quot;</span>));</span><br><span class="line">        System.out.println(fun2.apply(<span class="string">&quot;lisi&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 数组引用</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test06</span><span class="params">()</span> &#123;</span><br><span class="line">        Function&lt;Integer, String[]&gt; fun = x -&gt; <span class="keyword">new</span> <span class="title class_">String</span>[x];</span><br><span class="line">        String[] strs = fun.apply(<span class="number">10</span>);</span><br><span class="line">        <span class="keyword">for</span> (String str : strs) &#123;</span><br><span class="line">            System.out.println(str);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(strs.length);</span><br><span class="line"></span><br><span class="line">        Function&lt;Integer, String[]&gt; fun2 = String[]::<span class="keyword">new</span>;</span><br><span class="line">        String[] strs2 = fun2.apply(<span class="number">20</span>);</span><br><span class="line">        System.out.println(strs2.length);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="4-Stream-API"><a href="#4-Stream-API" class="headerlink" title="4. Stream API"></a>4. Stream API</h2><p>Sream 是 Java8 中<strong>处理集合</strong>的<strong>关键抽象概念</strong> 可以指定你希望对集合进行的操作 可以执行<strong>非常复杂的查找 过滤 和 映射数据</strong>等操作 <strong>使用Stream API 对集合数据 进行操作 就类似于 使用SQL执行的数据库查询</strong> 同时 Stream API 也提供并行执行操作 简单来说 Stream API 提供了一种<strong>高效且易于使用</strong>的<strong>数据处理方式</strong></p>
<p><strong>Stream API 工作模式</strong></p>
<p>数据源(集合、数组等….) 通过 进行一系列流水线式的中间操作 形成一个新的数据流 (新 集合、数组….)</p>
<p>&#x3D;&#x3D;注意：数据源是不会发生任何改变的&#x3D;&#x3D;</p>
<p><strong>Sream 流</strong></p>
<p>java8中的 Stream 特指的是 数据渠道 (数据流) 用于操作数据源 (集合、数组等) 所生成的元素列表 –集合讲的是 数据 而流 讲的是计算</p>
<p>&#x3D;&#x3D;注意：&#x3D;&#x3D;</p>
<ul>
<li>Stream <strong>自身不会存储数据</strong></li>
<li>Stream API 存在 <strong>内部迭代</strong> 由 Stream API 自己完成 </li>
<li>Stream <strong>不会改变数据源对象</strong> 相反 经过Stream API 操作后 会返回一个<strong>持有新结果的新Stream</strong></li>
<li>Stream 操作是<strong>延迟执行</strong>的 意味着 他们会<strong>等到需要结果 (执行终止操作时)<strong>的时候才</strong>执行 (中间操作)</strong> (有点类似于 懒加载 –个人理解)</li>
</ul>
<p><strong>Stream具体操作步骤：</strong></p>
<ul>
<li><p>创建 Stream<br>一个数据源 (集合、数组等….) 获取一个流</p>
<p><strong>创建Stream的四种方式</strong></p>
<ol>
<li>通过 Collection 系列集合提供的 <code>stream()</code> 或 <code>parallelStream()</code> 创建Stream</li>
<li>通过 Arrays 工具类中的静态方法 <code>stream()</code> 获取数组流</li>
<li>通过 Stream 类中的静态方法 <code>of()</code> 创建Stream</li>
<li>创建无限流</li>
</ol>
</li>
<li><p>中间操作<br>一个中间操作链 对数据源的数据进行处理<br>多个中间操作可以连接起来 形成一个流水线 <strong>除非流水线上出发终止操作</strong> 否则<strong>中间操作不会执行任何的处理</strong> 而是在<strong>终止操作时一次性全部处理</strong> –称为 “<strong>惰性求值</strong>“</p>
<ul>
<li>筛选与切片</li>
<li>映射</li>
<li>排序</li>
</ul>
</li>
<li><p>终止操作 (终端操作)<br>一个终止操作 执行中间操作的操作链 并产生结果</p>
<ul>
<li>查找与匹配</li>
<li>归约与收集</li>
</ul>
</li>
</ul>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20221008080443921.png" alt="image-20221008080443921"></p>
<p><strong>参考代码</strong></p>
<p>Demo07</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lambda;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lambda.pojo.Employee;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.Collector;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.Collectors;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.Stream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo07</span> &#123;</span><br><span class="line"></span><br><span class="line">    List&lt;Employee&gt; employees = Arrays.asList(</span><br><span class="line">            <span class="comment">// 张三李四王五赵六孙七周八吴九郑十</span></span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;张三&quot;</span>, <span class="number">19</span>, <span class="number">2222.33</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;李四&quot;</span>, <span class="number">29</span>, <span class="number">22552.33</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;王五&quot;</span>, <span class="number">43</span>, <span class="number">3332.33</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;赵六&quot;</span>, <span class="number">59</span>, <span class="number">6255.33</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;孙七&quot;</span>, <span class="number">64</span>, <span class="number">7722.33</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;周八&quot;</span>, <span class="number">25</span>, <span class="number">8822.33</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;吴九&quot;</span>, <span class="number">35</span>, <span class="number">2992.33</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;赵九&quot;</span>, <span class="number">35</span>, <span class="number">2992.33</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;吴九&quot;</span>, <span class="number">35</span>, <span class="number">2992.33</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;郑十&quot;</span>, <span class="number">57</span>, <span class="number">4992.33</span>)</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    List&lt;Employee&gt; employees2 = Arrays.asList(</span><br><span class="line">            <span class="comment">// 张三李四王五赵六孙七周八吴九郑十</span></span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;张三&quot;</span>, <span class="number">19</span>, <span class="number">2222.33</span>, Employee.Status.FREE),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;李四&quot;</span>, <span class="number">29</span>, <span class="number">2552.33</span>, Employee.Status.VOCATION),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;王五&quot;</span>, <span class="number">43</span>, <span class="number">3332.33</span>, Employee.Status.FREE),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;赵六&quot;</span>, <span class="number">59</span>, <span class="number">6255.33</span>, Employee.Status.VOCATION),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;孙七&quot;</span>, <span class="number">64</span>, <span class="number">7722.33</span>, Employee.Status.VOCATION),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;周八&quot;</span>, <span class="number">25</span>, <span class="number">8822.33</span>, Employee.Status.FREE),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;吴九&quot;</span>, <span class="number">35</span>, <span class="number">2992.33</span>, Employee.Status.BUSY),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;赵九&quot;</span>, <span class="number">35</span>, <span class="number">2992.33</span>, Employee.Status.BUSY),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;吴九&quot;</span>, <span class="number">35</span>, <span class="number">2992.33</span>, Employee.Status.BUSY),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;郑十&quot;</span>, <span class="number">57</span>, <span class="number">4992.33</span>, Employee.Status.FREE)</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test01</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 通过 Collection 系列集合提供的 stream() 或 parallelStream()</span></span><br><span class="line">        List&lt;String&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        Stream&lt;String&gt; stream = list.stream();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 通过 Arrays 中的静态方法 stream() 获取 数组流</span></span><br><span class="line">        Employee[] emps = <span class="keyword">new</span> <span class="title class_">Employee</span>[<span class="number">10</span>];</span><br><span class="line">        Stream&lt;Employee&gt; stream2 = Arrays.stream(emps);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 通过 Stream 类中的静态方法 of()</span></span><br><span class="line">        Stream&lt;String&gt; stream3 = Stream.of(<span class="string">&quot;aa&quot;</span>, <span class="string">&quot;bb&quot;</span>, <span class="string">&quot;cc&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 创建 无限流</span></span><br><span class="line">        <span class="comment">// 迭代</span></span><br><span class="line">        Stream&lt;Integer&gt; stream4 = Stream.iterate(<span class="number">0</span>, x -&gt; x + <span class="number">2</span>);</span><br><span class="line">        stream4.limit(<span class="number">50</span>)</span><br><span class="line">                .forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;----------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 生成</span></span><br><span class="line">        Stream.generate(() -&gt; Math.random())</span><br><span class="line">                .limit(<span class="number">30</span>)</span><br><span class="line">                .forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 详解 中间操作 --筛选与切片 --映射 --排序</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 筛选与切片</span></span><br><span class="line"><span class="comment">     * filter --接收 lambda 从流中排除某些元素</span></span><br><span class="line"><span class="comment">     * limit --截断流 使其元素不超过一定数量</span></span><br><span class="line"><span class="comment">     * skip(n) --跳过元素 返回一个 跳过前 n 个元素的流 若流中元素不足 n 个 则返回一个空流 与 limit(n) 互补</span></span><br><span class="line"><span class="comment">     * distinct --筛选 通过流所生成元素的 hashCode() 和 equals() 去除重复元素</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test02</span><span class="params">()</span> &#123;</span><br><span class="line">        Stream&lt;Employee&gt; stream = employees.stream()</span><br><span class="line">                <span class="comment">// 中间操作 过滤</span></span><br><span class="line">                <span class="comment">//.filter(e -&gt; e.getAge() &gt; 30);</span></span><br><span class="line">                <span class="comment">// 使用 limit 仅会找到 迭代到 满足条件的结果后 就会短路不执行下面的跌倒 --一定程度上减低了 时间复杂度</span></span><br><span class="line">                .filter(e -&gt; &#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;中间操作&quot;</span>);</span><br><span class="line">                    <span class="keyword">return</span> e.getAge() &gt; <span class="number">30</span>;</span><br><span class="line">                &#125;)</span><br><span class="line">                .limit(<span class="number">2</span>);</span><br><span class="line">                <span class="comment">/*</span></span><br><span class="line"><span class="comment">                执行结果为:</span></span><br><span class="line"><span class="comment">                中间操作</span></span><br><span class="line"><span class="comment">                中间操作</span></span><br><span class="line"><span class="comment">                中间操作</span></span><br><span class="line"><span class="comment">                Employee&#123;name=&#x27;王五&#x27;, age=43, salary=3332.33&#125;</span></span><br><span class="line"><span class="comment">                中间操作</span></span><br><span class="line"><span class="comment">                Employee&#123;name=&#x27;赵六&#x27;, age=59, salary=6255.33&#125;</span></span><br><span class="line"><span class="comment">                =&gt; 原因: 在迭代到满足结果后 就不会在往下迭代 故而不继续进行操作 --类似于 短路 &amp;&amp; 与 短路 || 用于提高效率</span></span><br><span class="line"><span class="comment">                 */</span></span><br><span class="line">        <span class="comment">// 终止操作 打印结果</span></span><br><span class="line">        stream.forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;----------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 使用终止操作优化</span></span><br><span class="line">        employees.stream()</span><br><span class="line">                .filter(e -&gt; e.getSalary() &gt; <span class="number">3000</span>)</span><br><span class="line">                .limit(<span class="number">2</span>)</span><br><span class="line">                .forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;----------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 实现 skip 与 limit 互补</span></span><br><span class="line">        employees.stream()</span><br><span class="line">                .filter(e -&gt; e.getSalary() &gt; <span class="number">3000</span>)</span><br><span class="line">                <span class="comment">//.limit(3)</span></span><br><span class="line">                .skip(<span class="number">3</span>)</span><br><span class="line">                .forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;----------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        employees.stream()</span><br><span class="line">                <span class="comment">// distinct() 通过 hashCode 与 equals 来进行去重 故而需要重写两个方法</span></span><br><span class="line">                .distinct()</span><br><span class="line">                .forEach(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试 Stream 流的延时性</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test03</span><span class="params">()</span> &#123;</span><br><span class="line">        Stream&lt;Employee&gt; stream = employees.stream()</span><br><span class="line">                <span class="comment">// 中间操作 过滤 --若不进行终止操作 即不会执行任何操作</span></span><br><span class="line">                <span class="comment">// 内部迭代 由 Stream API 自己完成 不需要我们执行</span></span><br><span class="line">                .filter(e -&gt; &#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;你好吖&quot;</span>);</span><br><span class="line">                    <span class="keyword">return</span> e.getSalary() &gt; <span class="number">5000</span>;</span><br><span class="line">                &#125;);</span><br><span class="line">        <span class="comment">// 终止操作 打印结果</span></span><br><span class="line">        <span class="comment">// 不进行终止操作 就不会进行中间操作 故而此 test03 执行没有任何结果 -- &quot;惰性求值&quot;</span></span><br><span class="line">        <span class="comment">//stream.forEach(System.out::println);</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test04</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 测试外部迭代 自主实现迭代 --通过 迭代器 进行迭代</span></span><br><span class="line"></span><br><span class="line">        Iterator&lt;Employee&gt; it = employees.iterator();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (it.hasNext()) &#123;</span><br><span class="line">            System.out.println(it.next());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;--------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (Employee employee : employees) &#123;</span><br><span class="line">            System.out.println(employee);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 映射</span></span><br><span class="line"><span class="comment">     * map --接收 lambda 将元素转换成其他形式 或 提取信息 本质即将一个函数作为参数 该函数会被应用到每个元素上 并将其映射成一个新的元素</span></span><br><span class="line"><span class="comment">     * flatMap --接收一个函数作为参数 将流中的每个值都转换成另一个流 然后将所有流连接起来</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test05</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;String&gt; list = Arrays.asList(<span class="string">&quot;aaa&quot;</span>, <span class="string">&quot;bbb&quot;</span>, <span class="string">&quot;ccc&quot;</span>, <span class="string">&quot;ddd&quot;</span>, <span class="string">&quot;eee&quot;</span>, <span class="string">&quot;fff&quot;</span>, <span class="string">&quot;ggg&quot;</span>);</span><br><span class="line"></span><br><span class="line">        list.stream()</span><br><span class="line">                .map(str -&gt; str.toUpperCase())</span><br><span class="line">                .forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        list.stream()</span><br><span class="line">                .map(String::toUpperCase)</span><br><span class="line">                .forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        employees.stream()</span><br><span class="line">                .map(Employee::getName)</span><br><span class="line">                .forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        Stream&lt;Stream&lt;Character&gt;&gt; stream = list.stream()</span><br><span class="line">                .map(Demo07::filterCharacter);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//System.out.println(stream);</span></span><br><span class="line">        stream.forEach(sm -&gt; sm.forEach(System.out::println));</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 循环遍历嵌套流 较为复杂繁琐 引入 flatMap 将流合并返回</span></span><br><span class="line">        <span class="comment">// 表现形式 类似于 add(Object obj) 与 addAll(Collection col)</span></span><br><span class="line">        list.stream()</span><br><span class="line">                .flatMap(Demo07::filterCharacter)</span><br><span class="line">                .forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 需求 将字符串中的字符提取出来 并存储到列表 以 Stream 流形式返回</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Stream&lt;Character&gt; <span class="title function_">filterCharacter</span><span class="params">(String str)</span> &#123;</span><br><span class="line">        List&lt;Character&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (Character ch : str.toCharArray()) &#123;</span><br><span class="line">            list.add(ch);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> list.stream();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 佐证 add(Object obj) 与 addAll(Collection col)</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test06</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;String&gt; list = Arrays.asList(<span class="string">&quot;aaa&quot;</span>, <span class="string">&quot;bbb&quot;</span>, <span class="string">&quot;ccc&quot;</span>, <span class="string">&quot;ddd&quot;</span>, <span class="string">&quot;eee&quot;</span>, <span class="string">&quot;fff&quot;</span>, <span class="string">&quot;ggg&quot;</span>);</span><br><span class="line">        List&lt;Object&gt; list2 = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        list2.add(<span class="string">&quot;nihaoya&quot;</span>);</span><br><span class="line">        list2.add(list);</span><br><span class="line">        list2.addAll(list);</span><br><span class="line">        list2.add(<span class="string">&quot;xiaokuangshen&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(list2);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 排序</span></span><br><span class="line"><span class="comment">     * sorted() --自然排序 (Comparable)</span></span><br><span class="line"><span class="comment">     * sorted(Comparator com) --定制排序 (Comparator)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test07</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;String&gt; list = Arrays.asList(<span class="string">&quot;ccc&quot;</span>, <span class="string">&quot;fff&quot;</span>, <span class="string">&quot;bbb&quot;</span>, <span class="string">&quot;ddd&quot;</span>, <span class="string">&quot;aaa&quot;</span>, <span class="string">&quot;eee&quot;</span>, <span class="string">&quot;ggg&quot;</span>);</span><br><span class="line">        list.stream()</span><br><span class="line">                .sorted()</span><br><span class="line">                .forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        employees.stream()</span><br><span class="line">                .sorted((e1, e2) -&gt; &#123;</span><br><span class="line">                    <span class="keyword">if</span> (e1.getAge() == e2.getAge()) &#123;</span><br><span class="line">                        <span class="keyword">return</span> -e1.getName().compareTo(e2.getName());</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">return</span> -Integer.compare(e1.getAge(), e2.getAge());</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;).forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 详解 终止操作 --查找与匹配</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查找与匹配</span></span><br><span class="line"><span class="comment">     * allMatch --检查是否匹配所有元素</span></span><br><span class="line"><span class="comment">     * anyMatch --检查是否至少匹配一个元素</span></span><br><span class="line"><span class="comment">     * noneMatch --检查是否没有匹配所有元素 -遍历结束一个都没有匹配上</span></span><br><span class="line"><span class="comment">     * findFirst --返回第一个元素</span></span><br><span class="line"><span class="comment">     * findAny --返回当前流中的任意元素</span></span><br><span class="line"><span class="comment">     * count --返回流中元素的总个数</span></span><br><span class="line"><span class="comment">     * max --返回流中最大值</span></span><br><span class="line"><span class="comment">     * min --返回流中最小值</span></span><br><span class="line"><span class="comment">     * forEach --内部迭代 StreamAPI 使用内部迭代 会将 Stream 流中的数据 自己进行迭代运算</span></span><br><span class="line"><span class="comment">     *           而 使用 Collection 接口则需要用户自己去做迭代 称为 外部迭代</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test08</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">r1</span> <span class="operator">=</span> employees2.stream()</span><br><span class="line">                .allMatch(e -&gt; e.getStatus().equals(Employee.Status.BUSY));</span><br><span class="line"></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">r2</span> <span class="operator">=</span> employees2.stream()</span><br><span class="line">                .anyMatch(e -&gt; e.getStatus().equals(Employee.Status.BUSY));</span><br><span class="line"></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">r3</span> <span class="operator">=</span> employees2.stream()</span><br><span class="line">                .noneMatch(e -&gt; e.getStatus().equals(Employee.Status.BUSY));</span><br><span class="line"></span><br><span class="line">        System.out.println(r1);</span><br><span class="line">        System.out.println(r2);</span><br><span class="line">        System.out.println(r3);</span><br><span class="line">        System.out.println(<span class="string">&quot;-------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        Optional&lt;Employee&gt; o1 = employees2.stream()</span><br><span class="line">                .sorted(Comparator.comparingDouble(Employee::getSalary))</span><br><span class="line">                .findFirst();</span><br><span class="line"></span><br><span class="line">        Optional&lt;Employee&gt; o2 = employees2.stream()</span><br><span class="line">                .sorted((e1, e2) -&gt; -Double.compare(e1.getSalary(), e2.getSalary()))</span><br><span class="line">                .findFirst();</span><br><span class="line"></span><br><span class="line">        Optional&lt;Employee&gt; o3 = employees2.stream().min(Comparator.comparingDouble(Employee::getSalary));</span><br><span class="line"></span><br><span class="line">        Optional&lt;Employee&gt; o4 = employees2.stream()</span><br><span class="line">                .filter(e -&gt; e.getStatus().equals(Employee.Status.FREE))</span><br><span class="line">                .findAny();</span><br><span class="line"></span><br><span class="line">        Optional&lt;Employee&gt; o5 = employees2.parallelStream()</span><br><span class="line">                .filter(e -&gt; e.getStatus().equals(Employee.Status.FREE))</span><br><span class="line">                .findAny();</span><br><span class="line"></span><br><span class="line">        System.out.println(o1.get());</span><br><span class="line">        System.out.println(o2);</span><br><span class="line">        System.out.println(o3);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;-------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(o4.get());</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;-------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 串行流 与 并行流 串行流是通过迭代 依次寻找 而并行流是通过 多线程 同时寻找</span></span><br><span class="line">        System.out.println(o5.get());</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;-------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">long</span> <span class="variable">count</span> <span class="operator">=</span> employees2.stream()</span><br><span class="line">                .count();</span><br><span class="line">        <span class="type">long</span> <span class="variable">count2</span> <span class="operator">=</span> employees2.size();</span><br><span class="line"></span><br><span class="line">        System.out.println(count);</span><br><span class="line">        System.out.println(count2);</span><br><span class="line"></span><br><span class="line">        Optional&lt;Employee&gt; o6 = employees2.stream()</span><br><span class="line">                .max((e1, e2) -&gt; Double.compare(e1.getSalary(), e2.getSalary()));</span><br><span class="line"></span><br><span class="line">        Optional&lt;Employee&gt; o7 = employees2.stream()</span><br><span class="line">                .min((e1, e2) -&gt; Double.compare(e1.getSalary(), e2.getSalary()));</span><br><span class="line"></span><br><span class="line">        System.out.println(o6.get());</span><br><span class="line">        System.out.println(o7.get());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 对比 直接 映射 工资 比较工资大小</span></span><br><span class="line">        Optional&lt;Double&gt; o8 = employees2.stream()</span><br><span class="line">                .map(Employee::getSalary)</span><br><span class="line">                .max(Double::compare);</span><br><span class="line"></span><br><span class="line">        System.out.println(o8);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 归约</span></span><br><span class="line"><span class="comment">     * reduce(T identity, BinaryOperator)</span></span><br><span class="line"><span class="comment">     * reduce(BinaryOperator) --可以将流中元素反复结合起来 得到一个值</span></span><br><span class="line"><span class="comment">     * map 和 reduce 的连接 通常称为 map-reduce 模式 因 Google 用它来进行网络搜索而出名</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test09</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;Integer&gt; list = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>);</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">r1</span> <span class="operator">=</span> list.stream()</span><br><span class="line">                .reduce(<span class="number">0</span>, (x, y) -&gt; x + y);</span><br><span class="line">        System.out.println(r1);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 由于 给定 identity 值 故而 Stream流返回值 不可能为空 所以使用 Integer 接就行</span></span><br><span class="line">        <span class="type">Integer</span> <span class="variable">r2</span> <span class="operator">=</span> list.stream()</span><br><span class="line">                .reduce(<span class="number">0</span>, Integer::sum); <span class="comment">// 先将 0 作为 x 将 1 作为 y 进行相加后 赋值到 x 再 将 2 作为 y 依次累加</span></span><br><span class="line">        System.out.println(r2);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;reduce(T identity, BinaryOperator) 对比学习 reduce(BinaryOperator)&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 由于 不给定 identity 值 故而 Stream流返回值 可能为空 故而需要使用 Optional 来接返回值 达到避免 OPE 的优化</span></span><br><span class="line">        Optional&lt;Double&gt; o1 = employees2.stream()</span><br><span class="line">                <span class="comment">// map-reduce 模式 用来检索</span></span><br><span class="line">                .map(Employee::getSalary)</span><br><span class="line">                .reduce(Double::sum);</span><br><span class="line"></span><br><span class="line">        System.out.println(o1.get());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 收集</span></span><br><span class="line"><span class="comment">     * collect 将流转换为其他形式 接收一个 Collector 接口的实现 用于给 Stream 中元素做汇总的方法</span></span><br><span class="line"><span class="comment">     * Collector 接口中方法的实现决定了如何对 流 执行收集操作 (如收集到 List、Set、Map) 但是 Collectors 实用工具类 提供了很多静态方法</span></span><br><span class="line"><span class="comment">     * 来方便我们创建常用的收集器实例 具体方法</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test10</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;String&gt; collect1 = employees2.stream()</span><br><span class="line">                .map(Employee::getName)</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line">        System.out.println(collect1);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;---------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        Set&lt;String&gt; collect2 = employees2.stream()</span><br><span class="line">                .map(Employee::getName)</span><br><span class="line">                .collect(Collectors.toSet());</span><br><span class="line">        System.out.println(collect2);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;---------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        Set&lt;String&gt; collect3 = employees2.stream()</span><br><span class="line">                .map(Employee::getName)</span><br><span class="line">                .collect(Collectors.toCollection(HashSet::<span class="keyword">new</span>));</span><br><span class="line">        System.out.println(collect3);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;---------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 计算总数</span></span><br><span class="line">        <span class="type">Long</span> <span class="variable">collect4</span> <span class="operator">=</span> employees2.stream()</span><br><span class="line">                .collect(Collectors.counting());</span><br><span class="line">        System.out.println(collect4);</span><br><span class="line">        System.out.println(<span class="string">&quot;---------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 平均数</span></span><br><span class="line">        <span class="type">Double</span> <span class="variable">collect5</span> <span class="operator">=</span> employees2.stream()</span><br><span class="line">                .collect(Collectors.averagingDouble(Employee::getSalary));</span><br><span class="line">        System.out.println(collect5);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 总和</span></span><br><span class="line">        <span class="type">Double</span> <span class="variable">collect6</span> <span class="operator">=</span> employees2.stream()</span><br><span class="line">                .collect(Collectors.summingDouble(Employee::getSalary));</span><br><span class="line">        <span class="type">Double</span> <span class="variable">collect7</span> <span class="operator">=</span> employees2.stream().mapToDouble(Employee::getSalary).sum();</span><br><span class="line">        System.out.println(collect6);</span><br><span class="line">        System.out.println(collect7);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 工资最大值</span></span><br><span class="line">        Optional&lt;Employee&gt; collect8 = employees2.stream()</span><br><span class="line">                .collect(Collectors.maxBy((e1, e2) -&gt; Double.compare(e1.getSalary(), e2.getSalary())));</span><br><span class="line">        System.out.println(collect8.get());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 工资最小值</span></span><br><span class="line">        Optional&lt;Employee&gt; collect9 = employees2.stream()</span><br><span class="line">                .collect(Collectors.minBy((e1, e2) -&gt; Double.compare(e1.getSalary(), e2.getSalary())));</span><br><span class="line">        System.out.println(collect9.get());</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;--------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 分组</span></span><br><span class="line">        Map&lt;Employee.Status, List&lt;Employee&gt;&gt; collect10 = employees2.stream()</span><br><span class="line">                .collect(Collectors.groupingBy(Employee::getStatus));</span><br><span class="line">        System.out.println(collect10);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;--------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 多级分组</span></span><br><span class="line">        Map&lt;Employee.Status, Map&lt;String, List&lt;Employee&gt;&gt;&gt; collect11 = employees2.stream()</span><br><span class="line">                .collect(Collectors.groupingBy(Employee::getStatus, Collectors.groupingBy(e -&gt; &#123;</span><br><span class="line">                    <span class="keyword">if</span> (e.getAge() &lt;= <span class="number">30</span>) &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="string">&quot;青年&quot;</span>;</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (e.getAge() &lt;= <span class="number">50</span>) &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="string">&quot;中年&quot;</span>;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="string">&quot;老年&quot;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)));</span><br><span class="line"></span><br><span class="line">        System.out.println(collect11);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;----------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 分区</span></span><br><span class="line">        Map&lt;Boolean, List&lt;Employee&gt;&gt; collect12 = employees2.stream()</span><br><span class="line">                .collect(Collectors.partitioningBy(e -&gt; e.getSalary() &gt; <span class="number">5000</span>));</span><br><span class="line">        System.out.println(collect12);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// summarizingDouble 应用</span></span><br><span class="line">        <span class="type">DoubleSummaryStatistics</span> <span class="variable">collect13</span> <span class="operator">=</span> employees2.stream()</span><br><span class="line">                .collect(Collectors.summarizingDouble(Employee::getSalary));</span><br><span class="line">        System.out.println(collect13.getAverage());</span><br><span class="line">        System.out.println(collect13.getCount());</span><br><span class="line">        System.out.println(collect13.getSum());</span><br><span class="line">        System.out.println(collect13.getMax());</span><br><span class="line">        System.out.println(collect13.getMin());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 连接字符串</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">collect14</span> <span class="operator">=</span> employees2.stream()</span><br><span class="line">                .map(Employee::getName)</span><br><span class="line">                .collect(Collectors.joining(<span class="string">&quot;-&quot;</span>, <span class="string">&quot;first&quot;</span>, <span class="string">&quot;end&quot;</span>));</span><br><span class="line">        System.out.println(collect14);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p><strong>简单练习</strong></p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lambda;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lambda.pojo.Employee;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Optional;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.Collectors;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo08</span> &#123;</span><br><span class="line"></span><br><span class="line">    List&lt;Employee&gt; employees = Arrays.asList(</span><br><span class="line">            <span class="comment">// 张三李四王五赵六孙七周八吴九郑十</span></span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;张三&quot;</span>, <span class="number">19</span>, <span class="number">2222.33</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;李四&quot;</span>, <span class="number">29</span>, <span class="number">22552.33</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;王五&quot;</span>, <span class="number">43</span>, <span class="number">3332.33</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;赵六&quot;</span>, <span class="number">59</span>, <span class="number">6255.33</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;孙七&quot;</span>, <span class="number">64</span>, <span class="number">7722.33</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;周八&quot;</span>, <span class="number">25</span>, <span class="number">8822.33</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;吴九&quot;</span>, <span class="number">35</span>, <span class="number">2992.33</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;赵九&quot;</span>, <span class="number">35</span>, <span class="number">2992.33</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;吴九&quot;</span>, <span class="number">35</span>, <span class="number">2992.33</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;郑十&quot;</span>, <span class="number">57</span>, <span class="number">4992.33</span>)</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Stream API 练习</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        1. 给定一个数字列表 返回一个由每个数字平方构成的列表</span></span><br><span class="line"><span class="comment">        [1, 2, 3, 4, 5, 6] --&gt; [1, 4, 9, 16, 25, 36]</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test01</span><span class="params">()</span> &#123;</span><br><span class="line">        Integer[] arr = <span class="keyword">new</span> <span class="title class_">Integer</span>[]&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>&#125;;</span><br><span class="line">        List&lt;Integer&gt; collect01 = Arrays.stream(arr)</span><br><span class="line">                .map(x -&gt; x * x)</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line">        System.out.println(collect01);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        2. 使用 map 和 reduce 方法来数一数 流 中有多少个Employee</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test02</span><span class="params">()</span> &#123;</span><br><span class="line">        Optional&lt;Integer&gt; collect01 = employees.stream()</span><br><span class="line">                .map(e -&gt; <span class="number">1</span>)</span><br><span class="line">                .reduce(Integer::sum);</span><br><span class="line">        System.out.println(collect01.get());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p><strong>并行流 与 顺序流</strong></p>
</blockquote>
<p>并行流 就是将一块数据内容分成多个数据块 并用不同的线程分别处理每个数据块的流</p>
<p>Java8 中将并行流进行优化 使对数据进行并行操作更加便捷 同时StreamAPI 可以声明性的通过 <code>parallel()</code> 与 <code>sequential()</code> 在并行流 与 顺序流之间进行切换</p>
<p><strong>理解 Fork &#x2F; Join 框架</strong> </p>
<p>理解 Fork &#x2F; Join 框架 本质就是在必要情况下 将一个 大任务 进行拆分 (fork) 成若干个 小任务 (拆到不可再拆时) 再将一个个小任务运算的结果进行 join 汇总</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20221009111101244.png" alt="image-20221009111101244"></p>
<p><em>早在 jdk 1.7 这种  fork&#x2F;join 框架处理问题的方式就已经诞生 但是当时使用这种方式处理问题 较为的复杂 应用不是非常广泛 到 jkd 1.8 才真正简化了其中的应用过程</em></p>
<blockquote>
<p> <strong>fork&#x2F;join 框架 与 多线程 的区别</strong></p>
</blockquote>
<p>传统多线程 是将 多个线程任务 通过算法合理分配给 CPU 的多个内核去完成计算 传统多线程 会出现阻塞等一系列问题 通过锁 等机制来进行优化 导致存在问题 一旦一个内核上的线程存在 长时间阻塞 而其他内核完成工作 处于空闲状态 当前内核的 阻塞任务 不仅阻塞了当前内核上正在运行的线程 也导致 其他线程处于排队状态 而此时的其他内核又处于空闲状态 从而造成资源浪费 </p>
<p><strong>使用 fork&#x2F;join 框架</strong></p>
<p>fork&#x2F;join 框架采用 “工作窃取” 模式 (work - stealing) </p>
<p>当执行新的任务时 它可以将其拆分成更小的任务执行 并将小任务加载到线程队列中 如果当前 内核的线程队列中没有线程任务 它就会从一个随机线程的队列中偷一个将其放到自己队列中 –此线程队列是<strong>双端队列</strong></p>
<p>相较于一般的线程池实现 fork&#x2F;join 框架的优势体现在 对其中包含任务的处理方式上 </p>
<p>在一般的线程池中 如果一个线程正在执行任务 <strong>由于某些原因 (线程任务队列耗尽) 无法继续运行</strong> 那么该线程会处于等待装填 而在 fork&#x2F;join 框架 实现中 如果因为 某个子问题等待另一个子问题的完成 而无法继续运行 那么处理该子问题的线程 就会<strong>主动寻找其他尚未运行的子问题来执行</strong> 通过这种方式减少了线程的等待时间 提高的并行工作效率 从而提高了性能</p>
<p>并行流就是将一个内容 分成多个数据块 并用不同的线程分别处理每个数据块的流</p>
<p>Java8中 对其进行了优化 使开发者可以很容易的对数据进行并行流操作 StreamAPI 可以声明性的通过 <code>parallel()</code> 与 <code>sequential()</code></p>
<p>在并行流与顺序流中 进行切换</p>
<p><strong>参考代码</strong></p>
<p>Demo01</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Java8.ForkJoinWorkMode;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.RecursiveTask;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo01</span> <span class="keyword">extends</span> <span class="title class_">RecursiveTask</span>&lt;Long&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 实现 序列化</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> -<span class="number">2723274113476143585L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> start;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> end;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">THRESHOLD</span> <span class="operator">=</span> <span class="number">10000</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Demo01</span><span class="params">(<span class="type">long</span> start, <span class="type">long</span> end)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.start = start;</span><br><span class="line">        <span class="built_in">this</span>.end = end;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> Long <span class="title function_">compute</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">length</span> <span class="operator">=</span> end - start;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (length &lt;= THRESHOLD) &#123;</span><br><span class="line">            <span class="type">long</span> <span class="variable">sum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">long</span> <span class="variable">i</span> <span class="operator">=</span> start; i &lt;= end; i++) &#123;</span><br><span class="line">                sum += i;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> sum;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">long</span> <span class="variable">middle</span> <span class="operator">=</span> (start + end) / <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">            <span class="type">Demo01</span> <span class="variable">left</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Demo01</span>(start, middle);</span><br><span class="line">            left.fork();    <span class="comment">// 拆分子任务 同时 压入线程队列</span></span><br><span class="line"></span><br><span class="line">            <span class="type">Demo01</span> <span class="variable">right</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Demo01</span>(middle + <span class="number">1</span>, end);</span><br><span class="line">            right.fork();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> left.join() + right.join();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>MyTest01</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Java8.ForkJoinWorkMode;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> Java8.ForkJoinWorkMode.Demo01;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.time.Duration;</span><br><span class="line"><span class="keyword">import</span> java.time.Instant;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ForkJoinPool;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ForkJoinTask;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.LongStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyTest01</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 传统使用 并行流 方式</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test01</span><span class="params">()</span> &#123; <span class="comment">// 33</span></span><br><span class="line">        <span class="type">Instant</span> <span class="variable">now1</span> <span class="operator">=</span> Instant.now();</span><br><span class="line">        <span class="type">long</span> <span class="variable">start</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="type">ForkJoinPool</span> <span class="variable">pool</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ForkJoinPool</span>();</span><br><span class="line">        ForkJoinTask&lt;Long&gt; task = <span class="keyword">new</span> <span class="title class_">Demo01</span>(<span class="number">0</span>, <span class="number">100000000L</span>);</span><br><span class="line">        <span class="type">Long</span> <span class="variable">sum</span> <span class="operator">=</span> pool.invoke(task);</span><br><span class="line">        <span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="type">Instant</span> <span class="variable">now2</span> <span class="operator">=</span> Instant.now();</span><br><span class="line">        <span class="type">long</span> <span class="variable">time</span> <span class="operator">=</span> end - start;</span><br><span class="line">        <span class="comment">// TODO 探究为什么创建 对象不消耗时间</span></span><br><span class="line">        System.out.println(sum);</span><br><span class="line">        System.out.println(<span class="string">&quot;It takes &quot;</span> + Duration.between(now1, now2).getNano());</span><br><span class="line">        System.out.println(<span class="string">&quot;It takes &quot;</span> + Duration.between(now1, now2).toMillis());</span><br><span class="line">        System.out.println(time);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 对比 不使用 FORK JOIN 框架</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test02</span><span class="params">()</span> &#123; <span class="comment">// 410</span></span><br><span class="line">        <span class="type">Instant</span> <span class="variable">now1</span> <span class="operator">=</span> Instant.now();</span><br><span class="line">        <span class="type">Long</span> <span class="variable">sum</span> <span class="operator">=</span> <span class="number">0L</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= <span class="number">100000000L</span>; i++) &#123;</span><br><span class="line">            sum += i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Instant</span> <span class="variable">now2</span> <span class="operator">=</span> Instant.now();</span><br><span class="line">        System.out.println(sum);</span><br><span class="line">        System.out.println(<span class="string">&quot;It takes &quot;</span> + Duration.between(now1, now2).toMillis());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Java8 使用并行流 方式</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test03</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Instant</span> <span class="variable">now1</span> <span class="operator">=</span> Instant.now();</span><br><span class="line">        <span class="type">long</span> <span class="variable">sum</span> <span class="operator">=</span> LongStream.rangeClosed(<span class="number">0</span>, <span class="number">100000000L</span>)</span><br><span class="line">                .parallel()</span><br><span class="line">                .reduce(<span class="number">0</span>, Long::sum);</span><br><span class="line">        <span class="type">Instant</span> <span class="variable">now2</span> <span class="operator">=</span> Instant.now();</span><br><span class="line">        System.out.println(sum);</span><br><span class="line">        System.out.println(<span class="string">&quot;It takes &quot;</span> + Duration.between(now1, now2).toMillis());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="5-Optional-类"><a href="#5-Optional-类" class="headerlink" title="5. Optional 类"></a>5. Optional 类</h2><p><code>Optional&lt;T&gt;</code> 类 (<code>java.util.Optional</code>) 是一个容器类 代表一个值存在 或 不存在 原来使用 <code>null</code> 表示一个值不存在 现在使用 Optional 可以更好的表达这个概念 并且可以避免空指针异常</p>
<p><strong>常用方法：</strong></p>
<ul>
<li><code>Optional.of(T t)</code> 创建一个 Optional 实例</li>
<li><code>Optional.empty()</code>  创建一个空的 Optional 实例</li>
<li><code>Optional.ofNullable(T t)</code> 若 t 不为 null 则创建 Optional 实例 否则创建空实例</li>
<li><code>isPresent()</code> 判断是否包含值</li>
<li><code>orElse(T t)</code> 如果调用对象包含值 则返回该值 否则返回 t</li>
<li><code>orElseGet(Supplier s)</code> 如果调用对象包含值 则返回该值 否则返回 s 获取的值</li>
<li><code>map(Function f)</code> 如果有值 则对其处理 并返回处理后的 Optional 否则 返回 <code>Optional.empty()</code></li>
<li><code>flatMap(Function mapper)</code> 与 map 类似 要求 返回值必须是 Optional</li>
</ul>
<p><strong>参考代码</strong></p>
<p>Demo01</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Optional;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lambda.pojo.Employee;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Optional;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo01</span> &#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    + `Optional.of(T t)` 创建一个 Optional 实例</span></span><br><span class="line"><span class="comment">    + `Optional.empty()`  创建一个空的 Optional 实例</span></span><br><span class="line"><span class="comment">    + `Optional.ofNullable(T t)` 若 t 不为 null 则创建 Optional 实例 否则创建空实例</span></span><br><span class="line"><span class="comment">    + `isPresent()` 判断是否包含值</span></span><br><span class="line"><span class="comment">    + `orElse(T t)` 如果调用对象包含值 则返回该值 否则返回 t</span></span><br><span class="line"><span class="comment">    + `orElseGet(Supplier s)` 如果调用对象包含值 则返回该值 否则返回 s 获取的值</span></span><br><span class="line"><span class="comment">    + `map(Function f)` 如果有值 则对其处理 并返回处理后的 Optional 否则 返回 `Optional.empty()`</span></span><br><span class="line"><span class="comment">    + `flatMap(Function mapper)` 与 map 类似 要求 返回值必须是 Optional</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test01</span><span class="params">()</span> &#123;</span><br><span class="line">        Optional&lt;Employee&gt; op = Optional.of(<span class="keyword">new</span> <span class="title class_">Employee</span>());</span><br><span class="line">        <span class="type">Employee</span> <span class="variable">emp</span> <span class="operator">=</span> op.get();</span><br><span class="line">        System.out.println(emp);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test02</span><span class="params">()</span> &#123;</span><br><span class="line">        Optional&lt;Employee&gt; op = Optional.empty();</span><br><span class="line">        System.out.println(op.get());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test03</span><span class="params">()</span> &#123;</span><br><span class="line">        Optional&lt;Employee&gt; op = Optional.ofNullable(<span class="literal">null</span>);</span><br><span class="line">        <span class="keyword">if</span> (op.isPresent()) &#123;</span><br><span class="line">            System.out.println(op.get());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Employee</span> <span class="variable">emoZhangsan</span> <span class="operator">=</span> op.orElse(<span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;张三&quot;</span>, <span class="number">19</span>, <span class="number">9000</span>, Employee.Status.VOCATION));</span><br><span class="line">        <span class="type">Employee</span> <span class="variable">empLisi</span> <span class="operator">=</span> op.orElseGet(() -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;hanshushijiekou&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;李四&quot;</span>, <span class="number">14</span>, <span class="number">8000</span>, Employee.Status.FREE);</span><br><span class="line">        &#125;);</span><br><span class="line"><span class="comment">//        System.out.println(op.get());</span></span><br><span class="line">        System.out.println(emoZhangsan);</span><br><span class="line">        System.out.println(empLisi);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test04</span><span class="params">()</span> &#123;</span><br><span class="line">        Optional&lt;Employee&gt; op = Optional.of(<span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;张三&quot;</span>, <span class="number">19</span>, <span class="number">3000</span>, Employee.Status.VOCATION));</span><br><span class="line">        Optional&lt;String&gt; ret = op.map(Employee::getName);</span><br><span class="line">        <span class="keyword">if</span> (ret.isPresent()) &#123;</span><br><span class="line">            System.out.println(ret.get());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 代码优化后</span></span><br><span class="line">        ret.ifPresent(System.out::println);</span><br><span class="line">        <span class="comment">// 进一步防止 NPE</span></span><br><span class="line">        Optional&lt;String&gt; ret2 = op.flatMap(e -&gt; Optional.of(e.getName()));</span><br><span class="line">        System.out.println(ret2.get());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="6-接口的默认方法与静态方法"><a href="#6-接口的默认方法与静态方法" class="headerlink" title="6. 接口的默认方法与静态方法"></a>6. 接口的默认方法与静态方法</h2><blockquote>
<p><strong>默认方法</strong></p>
</blockquote>
<p>在Java8 之前 接口中只允许存在 <strong>常量</strong> 和 <strong>抽象方法</strong></p>
<p>Java8 后 允许定义 使用 <code>default</code> 修饰的默认方法 而默认方法不是抽象方法 不强制要求重写 但是重写时 必须去掉 <code>default</code> 关键字 </p>
<p><em>编写默认方法时 注意 <code>public</code> 可以省略 但 <code>default</code> 不能省略</em></p>
<p><span style="color: blue">注意 如果有多个接口 接口中存在相同的方法声明 那么子类 必须重写此方法</span></p>
<p><strong>注意 接口默认方法的 “类优先” 原则</strong></p>
<p><strong>若一个接口定义了一个默认方法 而另一个 父类 或 接口 中又定义了一个同名的方法时 –&#x3D;&#x3D;多接口 继承 冲突问题&#x3D;&#x3D;</strong></p>
<ul>
<li><strong>选择父类方法 –&#x3D;&#x3D;一个父类 与 一个接口&#x3D;&#x3D; 提供了 相同名称 参数列表的方法 如果&#x3D;&#x3D;父类&#x3D;&#x3D;提供了具体的实现 那么接口中具有相同名称和参数的默认方法会被&#x3D;&#x3D;忽略&#x3D;&#x3D;</strong></li>
<li><strong>接口冲突 (接口多实现) –如果同时&#x3D;&#x3D;两个接口的方法&#x3D;&#x3D; 相同名称 相同参数列表 (不管方法是否为默认方法) 都必须覆盖该接口 &#x3D;&#x3D;重写方法&#x3D;&#x3D;来解决冲突问题</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Optional;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MyInterface</span> &#123;</span><br><span class="line">    <span class="keyword">default</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hahaha&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p><strong>静态方法</strong></p>
</blockquote>
<p>同时 在 Java8 后允许定义 static 静态方法 使用 <code>static</code> 关键字创建</p>
<p><strong>注意：使用 <code>static</code> 创建的静态方法 只能通过接口名调用 不能通过 类名 或 对象名 调用 同样 创建时 <code>public</code> 可省略 <code>static</code> 不可省略</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Optional;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MyInterface</span> &#123;</span><br><span class="line">    <span class="keyword">default</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hahaha&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">show</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;static hahaha&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="7-新时间日期-API"><a href="#7-新时间日期-API" class="headerlink" title="7. 新时间日期 API"></a>7. 新时间日期 API</h2><p>传统时间API</p>
<p>Date</p>
<p>Calendar</p>
<p>TimeZone</p>
<p>SimpleDateFormat</p>
<blockquote>
<p><strong>Java8 新时间日期API</strong></p>
</blockquote>
<p>使用 LocalDate LocalTime LocalDateTIme 三种新 Java8 提供的时间日期API</p>
<ul>
<li>LocalDate LocalTime LocalDateTIme 类的实例 是不可变的对象 分别表示使用 ISO-8601 日历系统的日期 时间 日期和时间 它们提供简单的日期或时间 并不包含当前的时间信息 也不包含于时区相关的信息<br><em>ISO-8601 日历系统是国际化标准组织制定的现代公民的日期和时间标识法</em></li>
</ul>
<p><strong>参考代码</strong></p>
<p>DateFormatThreadLocal</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Date;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.text.DateFormat;</span><br><span class="line"><span class="keyword">import</span> java.text.ParseException;</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DateFormatThreadLocal</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> ThreadLocal&lt;DateFormat&gt; df = <span class="keyword">new</span> <span class="title class_">ThreadLocal</span>&lt;DateFormat&gt;() &#123;</span><br><span class="line">        <span class="keyword">protected</span> DateFormat <span class="title function_">initialValue</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="string">&quot;yyyyMMdd&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title function_">convert</span><span class="params">(String source)</span> <span class="keyword">throws</span> ParseException &#123;</span><br><span class="line">        <span class="keyword">return</span> df.get().parse(source);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>TestSimpleDateFormat</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Date;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.time.LocalDate;</span><br><span class="line"><span class="keyword">import</span> java.time.format.DateTimeFormatter;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.*;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">传统时间 API 使用 锁机制 解决 时间API 线程不安全问题</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestSimpleDateFormat</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 传统时间 API 不使用 锁机制 导致线程安全问题</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test01</span><span class="params">()</span> <span class="keyword">throws</span> ExecutionException, InterruptedException &#123;</span><br><span class="line">        <span class="type">SimpleDateFormat</span> <span class="variable">sdf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="string">&quot;yyyyMMdd&quot;</span>);</span><br><span class="line">        Callable&lt;Date&gt; tast = <span class="keyword">new</span> <span class="title class_">Callable</span>&lt;Date&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> Date <span class="title function_">call</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                <span class="keyword">return</span> sdf.parse(<span class="string">&quot;20221224&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">ExecutorService</span> <span class="variable">pool</span> <span class="operator">=</span> Executors.newFixedThreadPool(<span class="number">10</span>);</span><br><span class="line">        List&lt;Future&lt;Date&gt;&gt; results = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            results.add(pool.submit(tast));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (Future&lt;Date&gt; result : results) &#123;</span><br><span class="line">            System.out.println(result.get());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 传统时间 API 使用锁机制 解决线程不安全问题</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test02</span><span class="params">()</span> <span class="keyword">throws</span> ExecutionException, InterruptedException &#123;</span><br><span class="line">        Callable&lt;Date&gt; tast = <span class="keyword">new</span> <span class="title class_">Callable</span>&lt;Date&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> Date <span class="title function_">call</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                <span class="keyword">return</span> DateFormatThreadLocal.convert(<span class="string">&quot;20221224&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">ExecutorService</span> <span class="variable">pool</span> <span class="operator">=</span> Executors.newFixedThreadPool(<span class="number">10</span>);</span><br><span class="line">        List&lt;Future&lt;Date&gt;&gt; results = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            results.add(pool.submit(tast));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (Future&lt;Date&gt; result : results) &#123;</span><br><span class="line">            System.out.println(result.get());</span><br><span class="line">        &#125;</span><br><span class="line">        pool.shutdown();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Java8 新时间 API 处理 线程不安全问题 --不存在线程安全问题 因为 Java8 中对时间API的操作都会创建新的实例</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test03</span><span class="params">()</span> <span class="keyword">throws</span> ExecutionException, InterruptedException &#123;</span><br><span class="line">        <span class="type">DateTimeFormatter</span> <span class="variable">dtf</span> <span class="operator">=</span> DateTimeFormatter.ofPattern(<span class="string">&quot;yyyyMMdd&quot;</span>);</span><br><span class="line">        Callable&lt;LocalDate&gt; tast = <span class="keyword">new</span> <span class="title class_">Callable</span>&lt;LocalDate&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> LocalDate <span class="title function_">call</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                <span class="keyword">return</span> LocalDate.parse(<span class="string">&quot;20221224&quot;</span>, dtf);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">ExecutorService</span> <span class="variable">pool</span> <span class="operator">=</span> Executors.newFixedThreadPool(<span class="number">10</span>);</span><br><span class="line">        List&lt;Future&lt;LocalDate&gt;&gt; results = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            results.add(pool.submit(tast));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (Future&lt;LocalDate&gt; result : results) &#123;</span><br><span class="line">            System.out.println(result.get());</span><br><span class="line">        &#125;</span><br><span class="line">        pool.shutdown();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>TestLocalDateTime</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Date;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.time.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestLocalDateTime</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// LocalDate LocalTime LocalDateTIme</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test01</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">LocalDateTime</span> <span class="variable">time</span> <span class="operator">=</span> LocalDateTime.now();</span><br><span class="line">        System.out.println(time);</span><br><span class="line"></span><br><span class="line">        <span class="type">LocalDateTime</span> <span class="variable">time2</span> <span class="operator">=</span> LocalDateTime.of(<span class="number">2024</span>, <span class="number">6</span>, <span class="number">30</span>, <span class="number">9</span>, <span class="number">30</span>, <span class="number">13</span>, <span class="number">140000</span>);</span><br><span class="line">        System.out.println(time2);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 产生新的实例 --处理线程安全问题</span></span><br><span class="line">        <span class="type">LocalDateTime</span> <span class="variable">time3</span> <span class="operator">=</span> time.plusYears(<span class="number">2</span>);</span><br><span class="line">        System.out.println(time3);</span><br><span class="line"></span><br><span class="line">        <span class="type">LocalDateTime</span> <span class="variable">time4</span> <span class="operator">=</span> time.minusMonths(<span class="number">2</span>);</span><br><span class="line">        System.out.println(time4);</span><br><span class="line"></span><br><span class="line">        System.out.println(time4.getDayOfMonth());</span><br><span class="line">        System.out.println(time4.getDayOfWeek());</span><br><span class="line">        System.out.println(time4.getDayOfYear());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Instant: 时间戳 (以 Unix 元年: 1970年1月1日 00:00:00 到 某个时间 --or now 为止的毫秒值)</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test02</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Instant</span> <span class="variable">now</span> <span class="operator">=</span> Instant.now();    <span class="comment">// 默认获取 UTC 时区</span></span><br><span class="line">        System.out.println(now);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取 东8区 时间</span></span><br><span class="line">        <span class="type">OffsetDateTime</span> <span class="variable">time</span> <span class="operator">=</span> now.atOffset(ZoneOffset.ofHours(<span class="number">8</span>));</span><br><span class="line">        System.out.println(time);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 转成毫秒值 时间戳</span></span><br><span class="line">        System.out.println(now.toEpochMilli());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 将 毫秒时间戳 转换成 Unix 元年时间</span></span><br><span class="line">        <span class="type">Instant</span> <span class="variable">time2</span> <span class="operator">=</span> Instant.ofEpochSecond(<span class="number">10000</span>);</span><br><span class="line">        System.out.println(time2);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    Duration: 计算两个 &quot;时间&quot; 的间隔</span></span><br><span class="line"><span class="comment">    Period: 计算两个 &quot;日期&quot; 的</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test03</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Instant</span> <span class="variable">now1</span> <span class="operator">=</span> Instant.now();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Instant</span> <span class="variable">now2</span> <span class="operator">=</span> Instant.now();</span><br><span class="line">        <span class="type">Duration</span> <span class="variable">duration</span> <span class="operator">=</span> Duration.between(now1, now2);</span><br><span class="line">        </span><br><span class="line">        System.out.println(duration.toMillis());</span><br><span class="line">        System.out.println(<span class="string">&quot;-----------------------------&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="type">LocalTime</span> <span class="variable">now3</span> <span class="operator">=</span> LocalTime.now();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">LocalTime</span> <span class="variable">now4</span> <span class="operator">=</span> LocalTime.now();</span><br><span class="line"></span><br><span class="line">        System.out.println(Duration.between(now3, now4).toMillis());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test04</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">LocalDate</span> <span class="variable">now</span> <span class="operator">=</span> LocalDate.of(<span class="number">2015</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">        <span class="type">LocalDate</span> <span class="variable">now2</span> <span class="operator">=</span> LocalDate.of(<span class="number">2016</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">        <span class="type">Period</span> <span class="variable">period</span> <span class="operator">=</span> Period.between(now, now2);</span><br><span class="line">        System.out.println(period.toTotalMonths());</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;-------------------------&quot;</span>);</span><br><span class="line">        <span class="comment">// 需求 --计算 两个日期时间之间的天数 --Java8新特性 牛批</span></span><br><span class="line">        <span class="type">LocalDateTime</span> <span class="variable">time</span> <span class="operator">=</span> LocalDateTime.of(<span class="number">2015</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="type">LocalDateTime</span> <span class="variable">time2</span> <span class="operator">=</span> LocalDateTime.of(<span class="number">2019</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="type">Duration</span> <span class="variable">duration</span> <span class="operator">=</span> Duration.between(time, time2);</span><br><span class="line">        System.out.println(duration.toDays());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p><strong>操纵日期</strong></p>
</blockquote>
<p>时间日期校正器</p>
<ul>
<li>TemporalAdjuster: 时间校正器 在开发人员 需要获取例如: 将日期 校正调整到 “下个周日” 等操作</li>
<li>TemporalAdjusters: 该类 通过静态方法 提供了大量的常用 TemporalAdjuster 的实现</li>
</ul>
<p>时间日期格式化</p>
<p>参考代码</p>
<p>时区处理</p>
<p>Java8 中加入了对时区的支持 带时区的时间分别为</p>
<ul>
<li>ZonedDate</li>
<li>ZonedTime</li>
<li>ZonedDateTime</li>
</ul>
<p>每个时区都对应着 ID 地区ID都为 “{区域}&#x2F;{城市}” 的格式</p>
<p>例如 Asia&#x2F;Shanghai 等</p>
<p><code>ZoneId</code> 该类中包含了所有的时区信息</p>
<ul>
<li><code>getAvailableZoneIds()</code> 可以获取所有时区信息</li>
<li><code>of()</code> 用指定时区信息 获取 <code>ZoneId</code> 对象</li>
</ul>
<p><strong>参考代码</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Date;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.time.*;</span><br><span class="line"><span class="keyword">import</span> java.time.format.DateTimeFormatter;</span><br><span class="line"><span class="keyword">import</span> java.time.temporal.TemporalAdjusters;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.Collectors;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.Stream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestTemporalAdjuster</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// TemporalAdjuster 时间校准器</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test01</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">LocalDate</span> <span class="variable">nextSunday</span> <span class="operator">=</span> LocalDate.now().with(</span><br><span class="line">                TemporalAdjusters.next(DayOfWeek.SUNDAY)</span><br><span class="line">        );</span><br><span class="line">        System.out.println(nextSunday);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;---------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">LocalDateTime</span> <span class="variable">now</span> <span class="operator">=</span> LocalDateTime.now();</span><br><span class="line">        System.out.println(now);</span><br><span class="line">        <span class="type">LocalDateTime</span> <span class="variable">time</span> <span class="operator">=</span> now.withDayOfMonth(<span class="number">10</span>);</span><br><span class="line">        System.out.println(time);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;---------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">LocalDateTime</span> <span class="variable">time2</span> <span class="operator">=</span> now.with(TemporalAdjusters.next(DayOfWeek.WEDNESDAY));</span><br><span class="line">        System.out.println(time2);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;---------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 需求 获取 下一个工作日</span></span><br><span class="line">        <span class="type">LocalDateTime</span> <span class="variable">time4</span> <span class="operator">=</span> now.with(l -&gt; &#123;</span><br><span class="line">            <span class="type">LocalDateTime</span> <span class="variable">time3</span> <span class="operator">=</span> (LocalDateTime) l;</span><br><span class="line">            <span class="type">DayOfWeek</span> <span class="variable">dayOfWeek</span> <span class="operator">=</span> time3.getDayOfWeek();</span><br><span class="line">            <span class="keyword">if</span> (dayOfWeek.equals(DayOfWeek.FRIDAY)) &#123;</span><br><span class="line">                <span class="keyword">return</span> time3.plusDays(<span class="number">3</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (dayOfWeek.equals(DayOfWeek.SATURDAY)) &#123;</span><br><span class="line">                <span class="keyword">return</span> time3.plusDays(<span class="number">2</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> time3.plusDays(<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        System.out.println(time4);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// DateTimeFormatter 格式化 时间 日期</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test02</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">DateTimeFormatter</span> <span class="variable">time</span> <span class="operator">=</span> DateTimeFormatter.ISO_DATE_TIME;</span><br><span class="line">        <span class="type">LocalDateTime</span> <span class="variable">now</span> <span class="operator">=</span> LocalDateTime.now();</span><br><span class="line">        <span class="type">String</span> <span class="variable">newTime</span> <span class="operator">=</span> now.format(time);</span><br><span class="line">        System.out.println(newTime);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">DateTimeFormatter</span> <span class="variable">time2</span> <span class="operator">=</span> DateTimeFormatter.ofPattern(<span class="string">&quot;yyyy年MM月dd日 HH:mm:ss&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">newTime2</span> <span class="operator">=</span> now.format(time2);</span><br><span class="line">        System.out.println(newTime2);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">LocalDateTime</span> <span class="variable">newDate3</span> <span class="operator">=</span> now.parse(newTime2, time2);</span><br><span class="line">        System.out.println(newDate3);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 时区处理 + ZonedDate + ZonedTime + ZonedDateTime</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test03</span><span class="params">()</span> &#123;</span><br><span class="line">        Set&lt;String&gt; zoneIds = ZoneId.getAvailableZoneIds();</span><br><span class="line">        zoneIds.forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;----------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">LocalDateTime</span> <span class="variable">now</span> <span class="operator">=</span> LocalDateTime.now(ZoneId.of(<span class="string">&quot;Asia/Aden&quot;</span>));</span><br><span class="line">        System.out.println(now);</span><br><span class="line"></span><br><span class="line">        <span class="type">LocalDateTime</span> <span class="variable">now2</span> <span class="operator">=</span> LocalDateTime.now();</span><br><span class="line">        <span class="type">LocalDateTime</span> <span class="variable">now3</span> <span class="operator">=</span> LocalDateTime.now(ZoneId.of(<span class="string">&quot;Asia/Aden&quot;</span>));</span><br><span class="line">        <span class="type">ZonedDateTime</span> <span class="variable">time</span> <span class="operator">=</span> now2.atZone(ZoneId.of(<span class="string">&quot;Asia/Aden&quot;</span>));</span><br><span class="line">        <span class="type">ZonedDateTime</span> <span class="variable">time2</span> <span class="operator">=</span> now3.atZone(ZoneId.of(<span class="string">&quot;Asia/Shanghai&quot;</span>));</span><br><span class="line">        System.out.println(time);</span><br><span class="line">        System.out.println(time2);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="8-重复注解-与-类型注解"><a href="#8-重复注解-与-类型注解" class="headerlink" title="8. 重复注解 与 类型注解"></a>8. 重复注解 与 类型注解</h2><p>重复注解 与 类型注解</p>
<p><strong>参考代码</strong></p>
<p>MyAnnotation</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Java8.Anno;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Repeatable;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.annotation.ElementType.*;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.annotation.ElementType.LOCAL_VARIABLE;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Repeatable(MyAnnotations.class)</span></span><br><span class="line"><span class="meta">@Target(&#123;TYPE, FIELD, METHOD, PARAMETER, CONSTRUCTOR, LOCAL_VARIABLE, TYPE_PARAMETER&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> MyAnnotation &#123;</span><br><span class="line">    String <span class="title function_">value</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;line&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>MyAnnotations</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Java8.Anno;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.annotation.ElementType.*;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.annotation.ElementType.LOCAL_VARIABLE;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Target(&#123;TYPE, FIELD, METHOD, PARAMETER, CONSTRUCTOR, LOCAL_VARIABLE&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> MyAnnotations &#123;</span><br><span class="line">    MyAnnotation[] value();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>TestAnnotation</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Java8.Anno;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 重复注解 与 类型注解</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestAnnotation</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// check framework</span></span><br><span class="line">    <span class="keyword">private</span> <span class="comment">/*@NotNull*/</span> <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test01</span><span class="params">()</span> <span class="keyword">throws</span> NoSuchMethodException &#123;</span><br><span class="line">        Class&lt;TestAnnotation&gt; clazz = TestAnnotation.class;</span><br><span class="line">        <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> clazz.getMethod(<span class="string">&quot;show&quot;</span>);</span><br><span class="line"></span><br><span class="line">        MyAnnotation[] ma = method.getAnnotationsByType(MyAnnotation.class);</span><br><span class="line">        <span class="keyword">for</span> (MyAnnotation myAnnotation : ma) &#123;</span><br><span class="line">            System.out.println(myAnnotation.value());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@MyAnnotation(&quot;Hello&quot;)</span></span><br><span class="line">    <span class="meta">@MyAnnotation(&quot;33&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">show</span><span class="params">(<span class="meta">@MyAnnotation(&quot;abc&quot;)</span> String str)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="9-其他新特性"><a href="#9-其他新特性" class="headerlink" title="9. 其他新特性"></a>9. 其他新特性</h2><p><strong>….</strong></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://negativefunction.github.io/2023/01/21/Git/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/05.jpg">
      <meta itemprop="name" content="Linyuxuan">
      <meta itemprop="description" content="Hope Sometimes Love Brain">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Welcome To Lin's World">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/01/21/Git/" class="post-title-link" itemprop="url">Git</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2023-01-21 07:17:39 / Modified: 07:17:40" itemprop="dateCreated datePublished" datetime="2023-01-21T07:17:39+08:00">2023-01-21</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Git"><a href="#Git" class="headerlink" title="Git"></a>Git</h1><h2 id="1-Git概述"><a href="#1-Git概述" class="headerlink" title="1. Git概述"></a>1. Git概述</h2><blockquote>
<p><strong>版本控制</strong></p>
</blockquote>
<p>版本控制（Revision control）是一种在开发的过程中用于管理我们对文件、目录或工程等内容的修改历史，方便查看更改历史记录，备份以便恢复以前的版本的软件工程技术。</p>
<ul>
<li>实现跨区域多人协同开发</li>
<li>追踪和记载一个或者多个文件的历史记录</li>
<li>组织和保护你的源代码和文档</li>
<li>统计工作量</li>
<li>并行开发、提高开发效率</li>
<li>跟踪记录整个软件的开发过程</li>
<li>减轻开发人员的负担，节省时间，同时降低人为错误</li>
</ul>
<p>简单说就是用于管理多人协同开发项目的技术。</p>
<p>没有进行版本控制或者版本控制本身缺乏正确的流程管理，在软件开发过程中将会引入很多问题，如软件代码的一致性、软件内容的冗余、软件过程的事物性、软件开发过程中的并发性、软件源代码的安全性，以及软件的整合等问题。</p>
<p>无论是工作还是学习，或者是自己做笔记，都经历过这样一个阶段！我们就迫切需要一个版本控制工具！</p>
<p>多人开发就必须要使用版本控制</p>
<p><strong>通常公司会使用 Git SVN 或者 自己搭建 GitLab 来解决版本控制问题</strong></p>
<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20221116221213573.png" alt="image-20221116221213573" style="zoom:67%;margin-left:0" />



<blockquote>
<p><strong>常见版本控制工具</strong></p>
</blockquote>
<p>主流的版本控制器有如下这些：</p>
<ul>
<li><strong>Git</strong></li>
<li><strong>SVN</strong>（Subversion）</li>
<li>CVS（Concurrent Versions System）</li>
<li>VSS（Micorosoft Visual SourceSafe）</li>
<li>TFS（Team Foundation Server）</li>
<li>Visual Studio Online</li>
</ul>
<p>版本控制产品非常的多（Perforce、Rational ClearCase、RCS（GNU Revision Control System）、Serena Dimention、SVK、BitKeeper、Monotone、Bazaar、Mercurial、SourceGear Vault），现在影响力最大且使用最广泛的是Git与SVN</p>
<blockquote>
<p><strong>版本控制分类</strong></p>
</blockquote>
<p><strong>1、本地版本控制</strong></p>
<p>记录文件每次的更新，可以对每个版本做一个快照，或是记录补丁文件，适合个人用，如RCS。</p>
<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20221116221450626.png" alt="image-20221116221450626" style="zoom:67%;margin-left:0" />

<p><strong>2、集中版本控制 SVN</strong></p>
<p>所有的版本数据都保存在服务器上，协同开发者从服务器上同步更新或上传自己的修改</p>
<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20221116221749679.png" alt="image-20221116221749679" style="zoom:67%;margin-left:0" />

<p>所有的版本数据都存在服务器上，用户的本地只有自己以前所同步的版本，如果不连网的话，用户就看不到历史版本，也无法切换版本验证问题，或在不同分支工作。而且，所有数据都保存在单一的服务器上，有很大的风险这个服务器会损坏，这样就会丢失所有的数据，当然可以定期备份。代表产品：SVN、CVS、VSS</p>
<p><strong>3、分布式版本控制 Git</strong></p>
<p>每个人都拥有全部的代码！安全隐患！</p>
<p>所有版本信息仓库全部同步到本地的每个用户，这样就可以在本地查看所有版本历史，可以离线在本地提交，只需在连网时push到相应的服务器或其他用户那里。由于每个用户那里保存的都是所有的版本数据，只要有一个用户的设备没有问题就可以恢复所有的数据，但这增加了本地存储空间的占用。</p>
<p>不会因为服务器损坏或者网络问题，造成不能工作的情况！</p>
<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20221116221842884.png" alt="image-20221116221842884" style="zoom:67%;margin-left:0" />



<blockquote>
<p><strong>Git与SVN的主要区别</strong></p>
</blockquote>
<p>SVN是集中式版本控制系统，版本库是集中放在中央服务器的，而工作的时候，用的都是自己的电脑，所以首先要从中央服务器得到最新的版本，然后工作，完成工作后，需要把自己做完的活推送到中央服务器。集中式版本控制系统是必须联网才能工作，对网络带宽要求较高。</p>
<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20221116222008894.png" alt="image-20221116222008894" style="zoom:67%;margin-left:0" />

<p>Git是分布式版本控制系统，没有中央服务器，每个人的电脑就是一个完整的版本库，工作的时候不需要联网了，因为版本都在自己电脑上。协同的方法是这样的：比如说自己在电脑上改了文件A，其他人也在电脑上改了文件A，这时，你们两之间只需把各自的修改推送给对方，就可以互相看到对方的修改了。Git可以直接看到更新了哪些代码和文件</p>
<p><strong>Git是目前世界上最先进的分布式版本控制系统</strong></p>
<blockquote>
<p><strong>Git的历史</strong></p>
</blockquote>
<p>同生活中的许多伟大事物一样，Git 诞生于一个极富纷争大举创新的年代。</p>
<p>Linux 内核开源项目有着为数众广的参与者。绝大多数的 Linux 内核维护工作都花在了提交补丁和保存归档的繁琐事务上(1991－2002年间)。到 2002 年，整个项目组开始启用一个专有的分布式版本控制系统 BitKeeper 来管理和维护代码。</p>
<p>Linux社区中存在很多的大佬！破解研究 <strong>BitKeeper</strong> ！逆向反破解</p>
<p>到了 2005 年，开发 BitKeeper 的商业公司同 Linux 内核开源社区的合作关系结束，他们收回了 Linux 内核社区免费使用 BitKeeper 的权力。这就迫使 Linux 开源社区(特别是 Linux 的缔造者 Linus Torvalds)基于使用 BitKeeper 时的经验教训，开发出自己的版本系统。（2周左右！） 也就是后来的 Git！</p>
<p>Git是目前世界上最先进的分布式版本控制系统。</p>
<p>Git是免费、开源的，最初Git是为辅助 Linux 内核开发的，来替代 BitKeeper！</p>
<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20221116222156709.png" alt="image-20221116222156709" style="zoom:67%;margin-left:0" />

<p>Linux和Git之父李纳斯·托沃兹（Linus Benedic Torvalds）1969、芬兰</p>
<h2 id="2-Git安装"><a href="#2-Git安装" class="headerlink" title="2. Git安装"></a>2. Git安装</h2><p>Git官网下载特别慢 <a target="_blank" rel="noopener" href="https://git-scm.com/">https://git-scm.com/</a></p>
<p>所有东西下载慢的话就可以去找镜像！</p>
<p>官网下载太慢，我们可以使用淘宝镜像下载：<a target="_blank" rel="noopener" href="http://npm.taobao.org/mirrors/git-for-windows/">http://npm.taobao.org/mirrors/git-for-windows/</a></p>
<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20221116224431262.png" alt="image-20221116224431262" style="zoom:67%;margin-left:0" />



<p>Git官网上有对应版本</p>
<p>windows版本</p>
<p>linux系统包管理器中也有 Git安装包 在linux中 使用 yum 源即可安装</p>
<blockquote>
<p><strong>Git安装与卸载</strong></p>
</blockquote>
<p><strong>卸载</strong></p>
<ol>
<li>反安装</li>
<li>清理环境变量</li>
</ol>
<p><strong>安装</strong></p>
<p>无脑下一步</p>
<p>环境变量只是为了<strong>全局使用</strong></p>
<p>使用 msi 等 安装包一键式安装都会自动配置环境变量</p>
<h2 id="3-Git基本操作"><a href="#3-Git基本操作" class="headerlink" title="3. Git基本操作"></a>3. Git基本操作</h2><p><strong>Git Bash</strong></p>
<p>Git GUI –基本不使用</p>
<p>Git Bash 支持常用 Linux 命令</p>
<blockquote>
<p><strong>Git配置</strong></p>
</blockquote>
<p>所有的配置文件，其实都保存在本地</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># git 配置清单</span></span><br><span class="line">git config -l</span><br><span class="line"><span class="comment"># 显示系统配置</span></span><br><span class="line">git config --system --list</span><br><span class="line"><span class="comment"># 显示本地全局配置</span></span><br><span class="line">git config --global --list</span><br><span class="line"><span class="comment"># 注意 用户名 与 密码 是一定要配置的</span></span><br><span class="line">git config --global user.name <span class="string">&quot;kuangshen&quot;</span>  <span class="comment">#名称</span></span><br><span class="line">git config --global user.email 24736743@qq.com   <span class="comment">#邮箱</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>当你安装Git后首先要做的事情是设置你的用户名称和e-mail地址。这是非常重要的，因为每次Git提交都会使用该信息。它被永远的嵌入到了你的提交中</p>
<p>只需要做一次这个设置，如果你传递了–global 选项，因为Git将总是会使用该信息来处理你在系统中所做的一切操作。如果你希望在一个特定的项目中使用不同的名称或e-mail地址，你可以在该项目中运行该命令而不要–global选项。总之–global为全局配置，不加为某个项目的特定配置</p>
<p><strong>Git相关的配置目录与文件：</strong></p>
<ol>
<li>Git\etc\gitconfig ：Git 安装目录下的 gitconfig –system 系统级</li>
<li>C:\Users\Administrator\ .gitconfig 只适用于当前登录用户的配置 –global 全局</li>
<li>mingw64 –Git的执行目录</li>
</ol>
<h2 id="4-Git基本理论"><a href="#4-Git基本理论" class="headerlink" title="4. Git基本理论"></a>4. Git基本理论</h2><p>&#x3D;&#x3D;CORE&#x3D;&#x3D; 所有 Git 实操都基于 Git 理论基础</p>
<blockquote>
<p><strong>工作区域</strong></p>
</blockquote>
<p>Git本地有三个工作区域：</p>
<ul>
<li>工作目录（Working Directory）</li>
<li>暂存区(Stage&#x2F;Index) –并不存在 本质是一个文件</li>
<li>资源库(Repository或Git Directory)</li>
</ul>
<p>如果在加上远程的git仓库(Remote Directory)就可以分为四个工作区域</p>
<ul>
<li>远程的git仓库(Remote Directory)</li>
</ul>
<p>文件在这四个区域之间的转换关系如下：</p>
<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20221116230959205.png" style="zoom:67%;margin-left:0" />



<p><strong>详解：</strong></p>
<ul>
<li>Workspace：工作区，就是你平时存放项目代码的地方 –<strong>本地项目目录</strong> .idea</li>
<li>Index &#x2F; Stage：暂存区，用于临时存放你的改动，<strong>事实上它只是一个文件</strong>，保存即将提交到文件列表信息</li>
<li>Repository：仓库区（或本地仓库），就是安全存放数据的位置，这里面有你提交到所有版本的数据。其中<strong>HEAD指向最新放入仓库的版本</strong> 本质上是存放在 <code>.git</code> 目录中 使用文件约束 <code>.git</code> 目录为隐藏文件夹</li>
<li>Remote：远程仓库，托管代码的服务器，可以简单的认为是你项目组中的一台电脑用于远程数据交换</li>
</ul>
<p>本地的三个区域确切的说应该是git仓库中HEAD指向的版本：</p>
<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20221116232143548.png" alt="image-20221116232143548" style="zoom:67%;margin-left:0" />

<p><strong>文件详解</strong></p>
<ul>
<li>Directory：使用Git管理的一个目录，也就是一个仓库，包含我们的工作空间和Git的管理空间。</li>
<li>WorkSpace：需要通过Git进行版本控制的目录和文件，这些目录和文件组成了工作空间。</li>
<li>.git：存放Git管理信息的目录，初始化仓库的时候自动创建。</li>
<li>Index&#x2F;Stage：暂存区，或者叫待提交更新区，在提交进入repo之前，我们可以把所有的更新放在暂存区。</li>
<li>Local Repo：本地仓库，一个存放在本地的版本库；HEAD会只是当前的开发分支（branch）。</li>
<li>Stash：隐藏，是一个工作状态保存栈，用于保存&#x2F;恢复WorkSpace中的临时状态。</li>
</ul>
<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20221116233748372.png" alt="image-20221116233748372" style="zoom:67%;margin-left:0" />

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># HEAD 指向主分支</span></span><br><span class="line">reg: refs/heads/master</span><br></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git push</span><br><span class="line">git commit</span><br><span class="line">git add files</span><br><span class="line">git pull</span><br><span class="line">git reset</span><br><span class="line">git checkout</span><br></pre></td></tr></table></figure>

<p><strong>gti commit 后</strong></p>
<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20221117005337861.png" style="zoom:67%;margin-left:0" />





<blockquote>
<p><strong>Git工作流程</strong></p>
</blockquote>
<p><strong>git的工作流程</strong></p>
<ol>
<li>在工作目录中添加、修改文件；<code>UserMapper.xml</code></li>
<li>将需要进行版本管理的文件放入暂存区域；<code>git add</code></li>
<li>将暂存区域的文件提交到git仓库。<code>git commit</code></li>
</ol>
<p>因此，git管理的文件有三种状态：已修改（modified）已暂存（staged）已提交(committed)</p>
<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20221116232436687.png" alt="image-20221116232436687" style="zoom:67%;margin-left:0" />



<h2 id="5-Git实操"><a href="#5-Git实操" class="headerlink" title="5. Git实操"></a>5. Git实操</h2><blockquote>
<p><strong>Git实操</strong></p>
</blockquote>
<p><strong>搭建项目</strong></p>
<ul>
<li>本地新建项目</li>
<li>从远程 clone 项目</li>
</ul>
<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20221116232859780.png" alt="image-20221116232859780" style="zoom:67%;margin-left:0" />

<p>工作目录（WorkSpace)一般就是你希望Git帮助你管理的文件夹，可以是你项目的目录，也可以是一个空目录，建议不要有中文。日常使用只要记住图中6个命令</p>
<p><strong>本地仓库搭建</strong></p>
<ol>
<li>选择项目目录</li>
<li>执行命令</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git init</span><br><span class="line">Initialized empty Git repository <span class="keyword">in</span> E:/tmp/Git-<span class="built_in">test</span>/.git/</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><strong>clone远程仓库</strong></p>
<ol>
<li>选择项目目录</li>
<li>执行命令</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://gitee.com/kuangstudy/kuang_livenote.git</span><br></pre></td></tr></table></figure>



<blockquote>
<p><strong>Git文件操作</strong></p>
</blockquote>
<p><strong>文件的4种状态</strong></p>
<p>版本控制就是对文件的版本控制，要对文件进行修改、提交等操作，首先要知道文件当前在什么状态，不然可能会提交了现在还不想提交的文件，或者要提交的文件没提交上</p>
<ul>
<li><strong>Untracked</strong>: 未跟踪，此文件在文件夹中，但并没有加入到git库，不参与版本控制。通过 <code>git add</code> 状态变为Staged</li>
<li><strong>Unmodify</strong>: 文件已经入库，未修改，即版本库中的文件快照内容与文件夹中完全一致。这种类型的文件有两种去处，如果它被修改，而变为Modified。如果使用 <code>git rm</code> 移出版本库，则成为Untracked文件</li>
<li><strong>Modified</strong>: 文件已修改，仅仅是修改，并没有进行其他的操作。这个文件也有两个去处，通过 <code>git add</code> 可进入暂存staged状态，使用 <code>git checkout</code> 则丢弃修改过，返回到unmodify状态，这个 <code>git checkout</code> 即从库中取出文件，覆盖当前修改 </li>
<li><strong>Staged</strong>: 暂存状态。执行 <code>git commit</code> 则将修改同步到库中，这时库中的文件和本地文件又变为一致，文件为Unmodify状态。执行 <code>git reset HEAD filename</code> 取消暂存，文件状态为Modified</li>
</ul>
<p><strong>查看文件状态</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看当前项目文件跟踪</span></span><br><span class="line">git status</span><br><span class="line"></span><br><span class="line">On branch master</span><br><span class="line"></span><br><span class="line">No commits yet</span><br><span class="line"></span><br><span class="line">Untracked files:</span><br><span class="line">  (use <span class="string">&quot;git add &lt;file&gt;...&quot;</span> to include <span class="keyword">in</span> what will be committed)</span><br><span class="line">        kuang_livenote/</span><br><span class="line">        project-frontend/</span><br><span class="line"></span><br><span class="line">nothing added to commit but untracked files present (use <span class="string">&quot;git add&quot;</span> to track)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将当前目录下文件提交到暂存区</span></span><br><span class="line">git add .</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提交暂存区内容到本地仓库 -m 提交信息</span></span><br><span class="line">git commit -m</span><br></pre></td></tr></table></figure>



<p><strong>gitignore 文件</strong></p>
<p>有些时候我们不想把某些文件纳入版本控制中，比如数据库文件，临时文件，设计文件等</p>
<p><code>.gitignore</code> 文件 在主目录下建立”.gitignore”文件，此文件有如下规则：</p>
<ul>
<li>git 配置哪些文件忽略 不提交到暂存区中</li>
<li>忽略文件中的空行或以井号（#）开始的行将会被忽略</li>
<li>可以使用Linux通配符。例如：星号（*）代表任意多个字符，问号（？）代表一个字符，方括号（[abc]）代表可选字符范围，大括号（{string1,string2,…}）代表可选的字符串等</li>
<li>如果名称的最前面有一个感叹号（!），表示例外规则，将不被忽略</li>
<li>如果名称的最前面是一个路径分隔符（&#x2F;），表示要忽略的文件在此目录下，而子目录中的文件不忽略</li>
<li>如果名称的最后面是一个路径分隔符（&#x2F;），表示要忽略的是此目录下该名称的子目录，而非文件（默认文件或目录都忽略）</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 为注释</span></span><br><span class="line">*.txt        <span class="comment"># 忽略所有 .txt结尾的文件,这样的话上传就不会被选中</span></span><br><span class="line">!lib.txt     <span class="comment"># 但lib.txt除外</span></span><br><span class="line">/temp        <span class="comment"># 仅忽略项目根目录下的TODO文件,不包括其它目录temp</span></span><br><span class="line">build/       <span class="comment"># 忽略build/目录下的所有文件</span></span><br><span class="line">doc/*.txt    <span class="comment"># 会忽略 doc/notes.txt 但不包括 doc/server/arch.txt</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<blockquote>
<p><strong>远程仓库使用</strong></p>
</blockquote>
<p>github 是有墙的，比较慢，在国内的话，我们一般使用 gitee ，公司中有时候会搭建自己的gitlab服务器</p>
<ol>
<li>注册登录平台 gitee github，完善个人信息</li>
<li><strong>设置本机密钥 SSH 公钥 实现免密码登录 –免登录</strong><ol>
<li>在目录 <code>C:\Users\黎明\.ssh</code> 下打开 Git Bash</li>
<li>使用命令 <code>ssh-keygen</code> 生成密钥 或 <code>ssh-keygen -t rsa</code> rsa 为加密算法</li>
</ol>
</li>
<li>将 id_rsa.pub 中公钥信息public key 添加到平台账户中即可</li>
<li>使用 平台 创建仓库 –研究开源协议</li>
</ol>
<blockquote>
<p><strong>IDEA 集成 Git</strong></p>
</blockquote>
<ul>
<li>pull</li>
<li>commit</li>
<li>push</li>
</ul>
<p>push到远程仓库</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git push origin master</span><br><span class="line">git push</span><br></pre></td></tr></table></figure>



<blockquote>
<p><strong>Git 分支</strong></p>
</blockquote>
<p>分支在 Git 中相对较难，分支就是科幻电影里面的平行宇宙，如果两个平行宇宙互不干扰，那对现在的你也没啥影响。不过，在某个时间点，两个平行宇宙合并了，我们就需要处理一些问题</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看分支</span></span><br><span class="line">git branch</span><br><span class="line"><span class="comment"># 新建 dev 分支</span></span><br><span class="line">git branch dev</span><br><span class="line"></span><br><span class="line"><span class="comment"># 列出所有本地分支</span></span><br><span class="line">git branch</span><br><span class="line"><span class="comment"># 列出所有远程分支</span></span><br><span class="line">git branch -r</span><br><span class="line"><span class="comment"># 新建一个分支，但依然停留在当前分支</span></span><br><span class="line">git branch [branch-name]</span><br><span class="line"><span class="comment"># 新建一个分支，并切换到该分支</span></span><br><span class="line">git checkout -b [branch]</span><br><span class="line"><span class="comment"># 合并指定分支到当前分支</span></span><br><span class="line">git merge [branch]</span><br><span class="line"><span class="comment"># 删除分支</span></span><br><span class="line">git branch -d [branch-name]</span><br><span class="line"><span class="comment"># 删除远程分支</span></span><br><span class="line">git push origin --delete [branch-name]$ git branch -dr [remote/branch]</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><strong>IDEA中操作</strong></p>
<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20221117012929124.png" alt="image-20221117012929124" style="zoom:67%;margin-left:0" />

<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20221117012952558.png" alt="image-20221117012952558" style="zoom:67%;margin-left:0" />



<p><strong>冲突问题</strong></p>
<p>如果同一个文件在合并分支时都被修改了则会引起冲突：解决的办法是我们可以修改冲突文件后重新提交！选择要保留他的代码还是你的代码</p>
<p>master主分支应该非常稳定，用来发布新版本，一般情况下不允许在上面工作，工作一般情况下在新建的dev分支上工作，工作完后，比如上要发布，或者说dev分支代码稳定后可以合并到主分支master上来</p>
<h2 id="6-细节强化"><a href="#6-细节强化" class="headerlink" title="6. 细节强化"></a>6. 细节强化</h2><p>三种级别的配置</p>
<ul>
<li>local 配置在当前项目的 .git 目录下</li>
<li>global 配置在 用户目录的 .gitconfig 文件中</li>
<li>system 配置在 git安装目录 &#x2F;etc&#x2F;gitconfig 文件中</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name zhangsan</span><br><span class="line">git config --global user.email 1031282691@qq.com</span><br><span class="line">git config --<span class="built_in">unset</span> user.name <span class="comment">#默认删除 local 级别下的</span></span><br><span class="line">git config --global --<span class="built_in">unset</span> user.name</span><br><span class="line">git config --list</span><br><span class="line">git <span class="built_in">help</span></span><br></pre></td></tr></table></figure>

<p>git文件的四种状态</p>
<ul>
<li>unstaged 历史仓库中没有文件记录</li>
<li>modified 历史仓库中存在文件记录 但未被修改过</li>
<li>staged 文件被保存到暂存区 但未提交到仓库</li>
<li>commited 文件被提交到历史仓库</li>
</ul>
<p>.git 目录中</p>
<ul>
<li>head git项目当前处于的分支</li>
<li>config 项目配置信息 –<code>git config --local</code> </li>
<li>description 项目描述信息</li>
<li>index 索引文件</li>
<li>hooks&#x2F; 系统默认钩子脚本目录</li>
<li>logs&#x2F; 各refs的历史信息</li>
<li>objects&#x2F; git仓库的所有对象 –commit提交&#x2F;快照 tree目录&#x2F;指针 tag固定的提交 blob二进制文件<br>git 本质是使用了 40 个 16进制的SHA-1 Hash 来 唯一标识对象 tag –&gt; commit –&gt; tree –&gt; tree *** –&gt; blob</li>
<li>refs&#x2F; 标识目录中每个分支指向哪个commit</li>
</ul>
<p>常用命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">add 添加文件内容至索引 --暂存区</span><br><span class="line">bisect 通过二分查找定位引入 bug 的变更</span><br><span class="line">branch 列出、创建或删除分支</span><br><span class="line">git branch <span class="built_in">test</span> 创建测试分支</span><br><span class="line">git checkout <span class="built_in">test</span> 切换到<span class="built_in">test</span>分支</span><br><span class="line">合并分支步骤</span><br><span class="line">git checkout master 合并分支到主分支</span><br><span class="line">git merge <span class="built_in">test</span> 将<span class="built_in">test</span>分支合并到主分支</span><br><span class="line">合并失败-查资料</span><br><span class="line"></span><br><span class="line">checkout 检出一个分支或路径到工作区 恢复到分支</span><br><span class="line">git checkout 查资料</span><br><span class="line"><span class="built_in">clone</span> 克隆一个版本库到一个新目录</span><br><span class="line">commit 提交变更到版本库</span><br><span class="line">diff 显示提交之前、提交和工作区之间的差异 查资料</span><br><span class="line">fetch 从另一个版本库下载对象和引用</span><br><span class="line">grep 输出和模式匹配的行 -过滤</span><br><span class="line">init 创建一个空的git项目 git初始化</span><br><span class="line">git 版本库或重新初始化一个已存在的版本库</span><br><span class="line"><span class="built_in">log</span> 显示提交日志</span><br><span class="line">merge 合并两个或多个开发历史</span><br><span class="line"><span class="built_in">mv</span> 移动或重命名</span><br><span class="line">pull</span><br><span class="line">push</span><br><span class="line">rebase 本地提交转移至更新后的上游分支中</span><br><span class="line">reset 重置当前<span class="built_in">head</span>到指定状态</span><br><span class="line"><span class="built_in">rm</span> 删除</span><br><span class="line">git <span class="built_in">rm</span> -f hello.java 删除工作区 暂存区文件 最终历史仓库中文件也会被删除</span><br><span class="line">git <span class="built_in">rm</span> --cached hello.java 仅删除缓存区中文件 不删除工作区中文件</span><br><span class="line">show 显示各种类型的对象 查看最后一次提交</span><br><span class="line">git show</span><br><span class="line">git show <span class="built_in">head</span></span><br><span class="line">git show e0783 根据<span class="built_in">hash</span>查看内容</span><br><span class="line">git show --pretty=raw e0783 根据<span class="built_in">hash</span>参数查看对应</span><br><span class="line">git ls-tree 5fb56</span><br><span class="line">staus 显示工作区状态</span><br><span class="line">tag 创建 列出 删除 或 校验 一个 GPG 签名的 tag 对象</span><br><span class="line">打标签，标签使用</span><br><span class="line">git tag <span class="string">&quot;v-0.0.1&quot;</span></span><br><span class="line">git tag -a <span class="string">&quot;v-0.0.2&quot;</span> -m <span class="string">&quot;project released on v-0.0.02&quot;</span> 具体使用查资料</span><br><span class="line">git remote add s 远程库url</span><br><span class="line">创建一个远程库 简称为s</span><br><span class="line">git fetch s master 不自动合并</span><br><span class="line">git pull s master 自动合并</span><br><span class="line">git push s master 提交</span><br><span class="line">git <span class="built_in">clone</span> url 拷贝</span><br><span class="line"></span><br><span class="line">git commit -m 项目提交描述</span><br></pre></td></tr></table></figure>



<p>重点配置SSH密钥</p>
<p>步骤：</p>
<ol>
<li><p>生成密钥</p>
<ul>
<li>在目录 <code>C:\Users\黎明\.ssh</code> 下打开 Git Bash</li>
<li>使用命令 <code>ssh-keygen</code> 生成密钥 或 <code>ssh-keygen -t rsa</code> rsa 为加密算法</li>
</ul>
</li>
<li><p>配置到代码托管平台</p>
</li>
<li><p>测试</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -T git@github.com</span><br><span class="line">Hi NegativeFunction! You<span class="string">&#x27;ve successfully authenticated, but GitHub does not provide shell access.</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="7-拓展知识"><a href="#7-拓展知识" class="headerlink" title="7. 拓展知识"></a>7. 拓展知识</h2><blockquote>
<p><strong>GitLab搭建</strong></p>
</blockquote>
<p>GitLab是自建的一个非官方自有版本仓库，提供给公司内部使用</p>
<p>官网：<a target="_blank" rel="noopener" href="https://about.gitlab.com/downloads">https://about.gitlab.com/downloads</a></p>
<p>清华镜像：<a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/gitlab-ce/yum/el7">https://mirrors.tuna.tsinghua.edu.cn/gitlab-ce/yum/el7</a></p>
<p>centOS安装</p>
<ol>
<li>安装</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install https://mirrors.tuna.tsinghua.edu.cn/gitlab-ce/yum/el7/gitlab-ce-10.0.0-ce.0.el7.x86_64.rpm</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>配置</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/gitlab/gitlab.rb</span><br><span class="line">将external_url变量的地址修改为 gitlab 所在centOS 的ip</span><br><span class="line">因为修改了配置文件，所以重新加载配置内容</span><br><span class="line">gitlab-ctl reconfigure</span><br><span class="line">gitlab-ctl restart</span><br><span class="line">查看日志</span><br><span class="line">gitlab-ctl <span class="built_in">tail</span></span><br></pre></td></tr></table></figure>

<p>注意 gitlab 本身还需要启动 jdk tomcat war包安装 所以 建议安装 gitlab 的机器内存 &gt;&#x3D; 4G</p>
<p><strong>GitLab命令</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">gitlab-ctl command(subcommand)</span><br><span class="line">gitlab-ctl start 启动所有服务</span><br><span class="line">gitlab-ctl stop 关闭所有服务</span><br><span class="line">gitlab-ctl restart 重启所有服务</span><br><span class="line">gitlab-ctl status 查看所有服务状态</span><br><span class="line">gitlab-ctl tail 查看日志信息</span><br><span class="line">gitlab-ctl service-list 列举所有启动服务</span><br><span class="line">gitlab-ctl graceful-kill 平稳停止一个服务</span><br><span class="line">gitlab-ctl help</span><br><span class="line"></span><br><span class="line">gitlab-ctl reconfigure 修改配置文件后 重新加载配置文件</span><br><span class="line">gitlab-ctl show-config 验证配置文件</span><br><span class="line">gitlab-ctl restart 重启所有服务</span><br><span class="line"></span><br><span class="line">gitlab-ctl show-config 查看所有服务配置文件信息</span><br><span class="line">gitlab-ctl uninstall 卸载这个软件</span><br><span class="line">gitlab-ctl cleanse 删除gitlab所有数据</span><br></pre></td></tr></table></figure>

<p><strong>GitLab携带组件</strong></p>
<p>nginx –静态web服务器</p>
<p>gitlab-shell –用于处理Git命令和修改 authorized keys 列表</p>
<p>gitlab-workhorse –轻量级反向代理服务器</p>
<p>logrotate –日志文件管理工具</p>
<p>postgresql –数据库</p>
<p>redis –缓存数据库</p>
<p>sidekiq –用于后台执行队列任务（异步执行操作）</p>
<p>unicorn –HTTP服务 Gitlab Rails 应用是托管在这个服务器上的</p>
<p><strong>GitLab目录作用</strong></p>
<p>配置文件目录 &#x2F;etc&#x2F;gitlab</p>
<p>主配置文件: &#x2F;etc&#x2F;gitlab&#x2F;gitlab.rb –修改配置文件</p>
<p>文档根目录&#x2F;应用代码和相应的依赖程序: &#x2F;var&#x2F;opt&#x2F;gitlab –存储gitlab-ctl reconfigure 命令编译后的应用数据与配置文件，不需要人为修改配置</p>
<p>默认存储库位置: &#x2F;var&#x2F;opt&#x2F;gitlab&#x2F;git-data&#x2F;repositories</p>
<p>Nginx配置文件: &#x2F;var&#x2F;opt&#x2F;gitlab&#x2F;nginx&#x2F;conf&#x2F;gitlab-http.conf</p>
<p>Postgresql数据目录: &#x2F;var&#x2F;opt&#x2F;gitlab&#x2F;postgresql&#x2F;data</p>
<p>gitlab各组件日志 &#x2F;var&#x2F;log&#x2F;gitlab</p>
<p>备份生成的目录 &#x2F;var&#x2F;opt&#x2F;gitlab&#x2F;backups&#x2F;</p>
<h2 id="8-实操案例"><a href="#8-实操案例" class="headerlink" title="8. 实操案例"></a>8. 实操案例</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git init</span><br><span class="line">git status</span><br><span class="line">git add .</span><br><span class="line">git commit -m 项目初始化</span><br><span class="line">git commit -m 增加用户登录功能</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://negativefunction.github.io/2023/01/21/DataStructure/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/05.jpg">
      <meta itemprop="name" content="Linyuxuan">
      <meta itemprop="description" content="Hope Sometimes Love Brain">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Welcome To Lin's World">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/01/21/DataStructure/" class="post-title-link" itemprop="url">DataStructureAlgorithm</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2023-01-21 07:14:37 / Modified: 07:15:38" itemprop="dateCreated datePublished" datetime="2023-01-21T07:14:37+08:00">2023-01-21</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="DataStructure"><a href="#DataStructure" class="headerlink" title="DataStructure"></a>DataStructure</h1><blockquote>
<p><strong>预科知识</strong></p>
</blockquote>
<p><strong>ArrayList继承树</strong></p>
<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20221105021446746.png" alt="image-20221105021446746" style="zoom:67%;margin-left:0" />

<p><strong>Collection</strong></p>
<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20221105021854725.png" style="zoom:67%;margin-left:0" />







<h2 id="线性结构"><a href="#线性结构" class="headerlink" title="线性结构"></a>线性结构</h2><h3 id="顺序结构"><a href="#顺序结构" class="headerlink" title="顺序结构"></a>顺序结构</h3><h4 id="静态数组"><a href="#静态数组" class="headerlink" title="静态数组"></a>静态数组</h4><blockquote>
<p><strong>特点</strong></p>
</blockquote>
<ol>
<li>数组长度一旦确定不可改变</li>
<li>数组只能存储同一类型数据</li>
<li>数组中每个存储空间地址连续且相等</li>
<li>数组使用索引方式调用访问元素</li>
</ol>
<h4 id="线性表-动态数组"><a href="#线性表-动态数组" class="headerlink" title="线性表 ( 动态数组 )"></a>线性表 ( 动态数组 )</h4><blockquote>
<p><strong>底层数据结构</strong></p>
</blockquote>
<ul>
<li>静态数组</li>
</ul>
<blockquote>
<p><strong>核心操作</strong></p>
</blockquote>
<ul>
<li>扩缩容 <ul>
<li><code>int newCapacity = oldCapacity + (oldCapacity &gt;&gt; 1);</code> <strong>–扩容至 1.5 倍</strong></li>
<li>ArrayList没有自动缩容机制。无论是remove方法还是clear方法，它们都不会改变现有数组elementData的长度。但是它们都会把相应位置的元素设置为null，以便垃圾收集器回收掉不使用的元素，节省内存。ArrayList的缩容，需要我们自己手动去调用trimToSize()方法，达到缩容的目的</li>
<li>我们 设计 自动缩容 满足合理性 当 ArrayList 的 size &#x3D;&#x3D; length &#x2F; 4 的时候 进行缩容 缩容至 length &#x2F; 2</li>
</ul>
</li>
<li>增删</li>
<li>排序 –插入排序</li>
</ul>
<blockquote>
<p><strong>手写代码实现</strong></p>
</blockquote>
<p>List</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P1.Interface;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Comparator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">List</span>&lt;E&gt; <span class="keyword">extends</span> <span class="title class_">Iterable</span>&lt;E&gt; &#123;</span><br><span class="line">    <span class="comment">//默认在表尾添加一个元素</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(E element)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//在指定索引处添加元素</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> index, E element)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//删除指定元素</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">remove</span><span class="params">(E element)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//删除指定索引处的元素，并返回原先值</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">remove</span><span class="params">(<span class="type">int</span> index)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取指定索引处的元素</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">get</span><span class="params">(<span class="type">int</span> index)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//修改指定索引index处的值为element 并返回原先的值</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">set</span><span class="params">(<span class="type">int</span> index, E element)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取线性表中的元素个数</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//查看元素第一次出现的索引位置（从左到右）</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">indexOf</span><span class="params">(E element)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//判断是否包含元素</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">contains</span><span class="params">(E element)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//判断线性表是否为空</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//清空线性表</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">clear</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//按照比较器的内容进行排序</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sort</span><span class="params">(Comparator&lt;E&gt; c)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取子线性表 原线性表中[fromIndex, toIndex)这个部分</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;E&gt; <span class="title function_">subList</span><span class="params">(<span class="type">int</span> fromIndex, <span class="type">int</span> toIndex)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>ArrayList</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P2.linearStructure;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> P1.Interface.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Comparator;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="comment">//自定义的线性表的顺序存储结构</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ArrayList</span>&lt;E&gt; <span class="keyword">implements</span> <span class="title class_">List</span>&lt;E&gt; &#123;</span><br><span class="line">    <span class="comment">//数组的容器 data.length 指的就是当前数组的容量</span></span><br><span class="line">    <span class="keyword">private</span> E[] data;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//元素的个数 size == 0 表示线性表为空表 size == data.length 表示线性表满了</span></span><br><span class="line">    <span class="comment">//size 还表示新元素默认尾部添加是所存储的索引</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> size;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//默认容量</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">DEFAULT_CAPACITY</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//默认构造函数：创建一个默认容量为10 的线性表</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ArrayList</span><span class="params">()</span> &#123;</span><br><span class="line">        data = (E[]) <span class="keyword">new</span> <span class="title class_">Object</span>[DEFAULT_CAPACITY];</span><br><span class="line">        size = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//指定默认容量的构造函数：创建一个指定容量的线性表</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ArrayList</span><span class="params">(<span class="type">int</span> capacity)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (capacity &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">this</span>.data = (E[]) <span class="keyword">new</span> <span class="title class_">Object</span>[capacity];</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (capacity == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">this</span>.data = (E[]) <span class="keyword">new</span> <span class="title class_">Object</span>[capacity];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;Illegal Capacity: &quot;</span>+</span><br><span class="line">                    capacity);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//指定数组的构造函数：传入一个数组将该数组封装称为一个线性表</span></span><br><span class="line">    <span class="comment">//[1 2 3 4 5 6 7 8 9 10 11 12 13 14 15]</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ArrayList</span><span class="params">(E[] arr)</span> &#123;</span><br><span class="line">        <span class="comment">//data不能直接引用外部传入的数组arr</span></span><br><span class="line">        <span class="comment">//否则外部对arr的修改会引起ArrayList内部的一些问题</span></span><br><span class="line">        <span class="comment">//data是ArrayList内部的数据</span></span><br><span class="line">        <span class="keyword">if</span> (arr == <span class="literal">null</span> || arr.length == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;arr can not be null&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        data = (E[]) <span class="keyword">new</span> <span class="title class_">Object</span>[DEFAULT_CAPACITY];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">            add(arr[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(E element)</span> &#123;</span><br><span class="line">        add(size, element);         <span class="comment">//复用add</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> index, E element)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (index &lt; <span class="number">0</span> || index &gt; size) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;add index cross the border&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//判断线性表是否是满状态</span></span><br><span class="line">        <span class="keyword">if</span> (size == data.length) &#123;</span><br><span class="line">            resize(<span class="number">2</span> * data.length);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//设置i从size-1开始到index，逐一向后移动元素</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> size - <span class="number">1</span>; i &gt;= index; i--) &#123;</span><br><span class="line">            data[i + <span class="number">1</span>] = data[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//将新元素插入到指定位置</span></span><br><span class="line">        data[index] = element;</span><br><span class="line">        <span class="comment">//最大长度+1</span></span><br><span class="line">        size++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//扩容或缩容 操作 不应该向外界提供</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">resize</span><span class="params">(<span class="type">int</span> newLen)</span> &#123;</span><br><span class="line">        E[] newData = (E[]) <span class="keyword">new</span> <span class="title class_">Object</span>[newLen];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">            newData[i] = data[i];</span><br><span class="line">        &#125;</span><br><span class="line">        data = newData;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">remove</span><span class="params">(E element)</span> &#123;<span class="comment">//删除指定元素 仅删除第一次出现的 E or// 删除所有指定元素</span></span><br><span class="line">        <span class="comment">// 仅删除第一次出现的 E</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> indexOf(element);</span><br><span class="line">        <span class="keyword">if</span> (index != -<span class="number">1</span>) &#123;</span><br><span class="line">            remove(index);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">remove</span><span class="params">(<span class="type">int</span> index)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (index &lt; <span class="number">0</span> || index &gt;= size) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;remove index out of range&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//先保存要删除的值</span></span><br><span class="line">        <span class="type">E</span> <span class="variable">ret</span> <span class="operator">=</span> data[index];</span><br><span class="line"></span><br><span class="line">        <span class="comment">//移动元素</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> index + <span class="number">1</span>; i &lt; size; i++) &#123;</span><br><span class="line">            data[i - <span class="number">1</span>] = data[i];</span><br><span class="line">        &#125;</span><br><span class="line">        size--;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//什么时候去缩容  当容量到达默认容量则缩容的意义就变得很小</span></span><br><span class="line">        <span class="comment">//当小宇等于默认容量时，就不需要缩容了</span></span><br><span class="line">        <span class="comment">//条件1、当前有效元素是容量的1/4</span></span><br><span class="line">        <span class="comment">//条件2、当前容量不得小于等于默认容量</span></span><br><span class="line">        <span class="keyword">if</span> (size == data.length / <span class="number">4</span> &amp;&amp; data.length &gt; DEFAULT_CAPACITY) &#123;</span><br><span class="line">            resize(data.length / <span class="number">2</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">get</span><span class="params">(<span class="type">int</span> index)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (index &lt; <span class="number">0</span> || index &gt;= size) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;get index out of range &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> data[index];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">set</span><span class="params">(<span class="type">int</span> index, E element)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (index &lt; <span class="number">0</span> || index &gt;= size) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;set index out of range &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">E</span> <span class="variable">ret</span> <span class="operator">=</span> data[index];</span><br><span class="line">        data[index] = element;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.size;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//额外添加函数：获取当前线性表的容量</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="title function_">getCapacity</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> data.length;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">indexOf</span><span class="params">(E element)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        == 比较的是，主要看等号两边是什么</span></span><br><span class="line"><span class="comment">        == 两边是基本数据类型，比较的是值</span></span><br><span class="line"><span class="comment">            byte short int long</span></span><br><span class="line"><span class="comment">            float double</span></span><br><span class="line"><span class="comment">            char boolean</span></span><br><span class="line"><span class="comment">        == 两边是引用数据类型，比较的是地址</span></span><br><span class="line"><span class="comment">            数组 字符串 其他类对象</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (data[i].equals(element)) &#123;</span><br><span class="line">                <span class="keyword">return</span> i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">contains</span><span class="params">(E element)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> indexOf(element) != -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> size == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">clear</span><span class="params">()</span> &#123;</span><br><span class="line">        data = (E[]) <span class="keyword">new</span> <span class="title class_">Object</span>[DEFAULT_CAPACITY];</span><br><span class="line">        size = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sort</span><span class="params">(Comparator&lt;E&gt; c)</span> &#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        list.sort((o1, o2) -&gt; o1 - o2);</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">if</span> (c == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;comparator can not be null&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; size; i++) &#123;</span><br><span class="line">            <span class="type">E</span> <span class="variable">e</span> <span class="operator">=</span> data[i];</span><br><span class="line">            <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i;</span><br><span class="line">            <span class="keyword">for</span> (   j = i; j &gt; <span class="number">0</span> &amp;&amp; c.compare(data[j - <span class="number">1</span>], e) &gt; <span class="number">0</span>; j--) &#123;</span><br><span class="line">                data[j] = data[j - <span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">            data[j] = e;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;E&gt; <span class="title function_">subList</span><span class="params">(<span class="type">int</span> fromIndex, <span class="type">int</span> toIndex)</span> &#123;</span><br><span class="line">        <span class="comment">// [fromIndex, toIndex)</span></span><br><span class="line">        <span class="keyword">if</span> (fromIndex &lt; <span class="number">0</span> || toIndex &gt;= size ||fromIndex &gt; toIndex) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;must 0 &lt;= fromIndex &lt;= toIndex &lt;= size&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        List&lt;E&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> fromIndex; i &lt;= toIndex; i++) &#123;</span><br><span class="line">            <span class="comment">// 考虑深浅拷贝问题</span></span><br><span class="line">            list.add(data[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="comment">//equals比较两个ArrayList是否相等</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">equals</span><span class="params">(Object o)</span> &#123;</span><br><span class="line">        <span class="comment">//条件1、判空</span></span><br><span class="line">        <span class="keyword">if</span> (o == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//条件2、判断是否为自己</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span> == o) &#123;</span><br><span class="line">            <span class="keyword">return</span>  <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//条件3、判断类型是否相同</span></span><br><span class="line">        <span class="keyword">if</span> (o <span class="keyword">instanceof</span> ArrayList) &#123;</span><br><span class="line">            <span class="comment">//条件4、按照自己的逻辑进行比较</span></span><br><span class="line">            ArrayList&lt;E&gt; other = (ArrayList&lt;E&gt;) o;</span><br><span class="line">            <span class="comment">//条件5、先比较有效元素个数</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">this</span>.size != other.size) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//条件6、有效元素个数相等，逐个比较元素</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">                <span class="comment">// 考虑 判空</span></span><br><span class="line">                <span class="keyword">if</span> (!data[i].equals(other.data[i])) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    [1, 2, 3, 4, 5, 6]</span></span><br><span class="line"><span class="comment">    Arrays.toString(arr); Arrays 类的一个静态方法</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//为什么用stringbuilder拼接，因为用string拼接会产生不必要的字符类</span></span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        sb.append(<span class="string">&#x27;[&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (isEmpty()) &#123;</span><br><span class="line">            sb.append(<span class="string">&#x27;]&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size; i ++) &#123;</span><br><span class="line">                sb.append(data[i]);</span><br><span class="line">                <span class="keyword">if</span> (i == size - <span class="number">1</span>) &#123;</span><br><span class="line">                    sb.append(<span class="string">&#x27;]&#x27;</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    sb.append(<span class="string">&#x27;,&#x27;</span>);</span><br><span class="line">                    sb.append(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="comment">//迭代器的作用，不论底层是什么逻辑结构，讲其中元素逐个提取出</span></span><br><span class="line">    <span class="comment">//获取当前数据结构/容器 的 迭代器</span></span><br><span class="line">    <span class="comment">//通过迭代器 我们能更方便的挨个取出 每个元素</span></span><br><span class="line">    <span class="comment">//同时 Arraylist实现Iterator 接口可以使当前的 数据结构/容器 被foreach循环遍历</span></span><br><span class="line">    <span class="keyword">public</span> Iterator&lt;E&gt; <span class="title function_">iterator</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ArraylistIterator</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建一个属于ArrayList的迭代器</span></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">ArraylistIterator</span> <span class="keyword">implements</span> <span class="title class_">Iterator</span>&lt;E&gt; &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> <span class="variable">cur</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">hasNext</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> cur &lt; size;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> E <span class="title function_">next</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> data[cur++];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">swap</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> j)</span> &#123;</span><br><span class="line">        <span class="type">E</span> <span class="variable">tmp</span> <span class="operator">=</span> data[i];</span><br><span class="line">        data[i] = data[j];</span><br><span class="line">        data[j] = tmp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>注意 </p>
<ul>
<li>如果数组为 null 则不能调用 arr.length –&gt; NPE</li>
<li>数组的地址存储 –Java中只能获取 数组的</li>
<li><strong>集合泛型必须是引用类型，不能是基本类型</strong> –存储基本数据，那么就要使用基本数据类型对应的“包装类”（全都位于java.lang下，有8种）–自动拆装箱机制<br>2^31 –2147483648</li>
<li>排序使用 插入排序 插入排序 保证 <strong>左边有序</strong> 新值不断插入左边<strong>正确位置</strong></li>
<li>内部类 与 匿名内部类 –在一个java文件中，<strong>可以有多个平级的类</strong>。内部类的定义是：在一个类的内部再定义一个类，那么此时这个类就称之为内部类，可以理解为成员内部类。<strong>内部类可以直接访问外部类的成员，包括私有成员</strong>。外部类要访问内部类的成员（成员变量，成员方法），<strong>必须要建立内部类的对象</strong>（定义内部类方法，访问内部类成员）。</li>
<li>函数定义传入一个<strong>比较器 ——接口定义形式</strong> 可传入的形式有 &#x3D;&#x3D;匿名内部类 lambda表达式 函数式方法&#x3D;&#x3D; 三种方式</li>
</ul>
<h4 id="栈"><a href="#栈" class="headerlink" title="栈"></a>栈</h4><blockquote>
<p><strong>栈性质</strong></p>
</blockquote>
<ul>
<li>只能在表尾 –栈顶 进行增删操作</li>
<li>FILO</li>
</ul>
<blockquote>
<p><strong>底层数据结构</strong></p>
</blockquote>
<ul>
<li>线性表 ArrayList</li>
</ul>
<blockquote>
<p><strong>手写代码实现</strong></p>
</blockquote>
<p>Stack</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P1.Interface;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Stack</span>&lt;E&gt; <span class="keyword">extends</span> <span class="title class_">Iterable</span>&lt;E&gt; &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span>;</span><br><span class="line">    <span class="comment">//入栈 进栈 一个元素 在线性表的表尾添加一个元素</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">push</span><span class="params">(E element)</span>;</span><br><span class="line">    <span class="comment">//出栈 弹出 一个元素 在线性表的表尾删除一个元素</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">pop</span><span class="params">()</span>;</span><br><span class="line">    <span class="comment">//查看当前栈顶元素</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">peek</span><span class="params">()</span>;</span><br><span class="line">    <span class="comment">//清空栈</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">clear</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>ArrayStack</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P2.linearStructure;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> P1.Interface.Stack;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ArrayStack</span>&lt;E&gt; <span class="keyword">implements</span> <span class="title class_">Stack</span>&lt;E&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> ArrayList&lt;E&gt; list;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ArrayStack</span><span class="params">()</span> &#123;</span><br><span class="line">        list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ArrayStack</span><span class="params">(<span class="type">int</span> capacity)</span> &#123;</span><br><span class="line">        list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(capacity);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> list.size();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> list.isEmpty();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">push</span><span class="params">(E element)</span> &#123;</span><br><span class="line">        list.add(element);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">pop</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> list.remove(list.size() - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">peek</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> list.get(list.size() - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">clear</span><span class="params">()</span> &#123;</span><br><span class="line">        list.clear();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Iterator&lt;E&gt; <span class="title function_">iterator</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> list.iterator();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> list.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">equals</span><span class="params">(Object o)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (o == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span> == o) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (o <span class="keyword">instanceof</span> ArrayStack) &#123;</span><br><span class="line">            <span class="type">ArrayStack</span> <span class="variable">other</span> <span class="operator">=</span> (ArrayStack) o;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>.list.equals(other.list);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意：</p>
<ul>
<li>栈底层由 ArrayList 实现</li>
</ul>
<blockquote>
<p><strong>栈的相关应用</strong></p>
</blockquote>
<ul>
<li>进制转换<ul>
<li>十进制转十六进制</li>
<li>十六进制转十进制</li>
</ul>
</li>
<li>括号匹配问题</li>
<li>中缀表达式 中缀计算器</li>
<li>后缀表达式 后缀计算器</li>
<li>判断回文</li>
</ul>
<p>DecToHex</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P2.linearStructure;</span><br><span class="line"></span><br><span class="line"><span class="comment">//十进制转十六进制</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DecToHex</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> <span class="number">654321</span>;</span><br><span class="line">        ArrayStack&lt;String&gt; stack = <span class="keyword">new</span> <span class="title class_">ArrayStack</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">while</span> (num != <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> num % <span class="number">16</span>;</span><br><span class="line">            <span class="keyword">if</span> (a &lt; <span class="number">10</span>) &#123;</span><br><span class="line">                stack.push(a + <span class="string">&quot;&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">//10 - A 11 - B 12 - C 13 - D 14 - E 15 - F</span></span><br><span class="line">                <span class="comment">//     65     66     67     68     69     70</span></span><br><span class="line">                stack.push((<span class="type">char</span>)(a + <span class="number">55</span>) + <span class="string">&quot;&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            num /= <span class="number">16</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="keyword">while</span> (!stack.isEmpty()) &#123;</span><br><span class="line">            sb.append(stack.pop());</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(sb.toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>HexToDec</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P2.linearStructure;</span><br><span class="line"></span><br><span class="line"><span class="comment">//十六进制 转 十进制</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HexToDec</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">hex</span> <span class="operator">=</span> <span class="string">&quot;9FBF1&quot;</span>;</span><br><span class="line">        ArrayStack&lt;Character&gt; stack = <span class="keyword">new</span> <span class="title class_">ArrayStack</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; hex.length(); i++) &#123;</span><br><span class="line">            stack.push(hex.charAt(i));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">sum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">mi</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (!stack.isEmpty()) &#123;</span><br><span class="line">            <span class="comment">//9 F B F 1</span></span><br><span class="line">            <span class="comment">// 可以使用 Character.isDigit 方法 判断是否是 数字</span></span><br><span class="line">            <span class="type">char</span> <span class="variable">c</span> <span class="operator">=</span> stack.pop();   <span class="comment">// &#x27;1&#x27;</span></span><br><span class="line">            sum += getNumber(c) * Math.pow(<span class="number">16</span>, mi);</span><br><span class="line">            mi++;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(sum);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">getNumber</span><span class="params">(<span class="type">char</span> c)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!(c &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; c &lt;= <span class="string">&#x27;9&#x27;</span> || c &gt;= <span class="string">&#x27;A&#x27;</span> &amp;&amp; c &lt;= <span class="string">&#x27;Z&#x27;</span>)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;Wrong char !&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (c &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; c &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> c - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> c - <span class="string">&#x27;A&#x27;</span> + <span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ParenthesisMatching</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P2.linearStructure;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="comment">//括号匹配问题</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ParenthesisMatching</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        solution01();</span><br><span class="line">        solution02();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用 HashMap 匹配</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">solution02</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> <span class="string">&quot;&#123;&#125;&quot;</span>;</span><br><span class="line">        HashMap&lt;Character,Character&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        map.put(<span class="string">&#x27;[&#x27;</span>,<span class="string">&#x27;]&#x27;</span>);</span><br><span class="line">        map.put(<span class="string">&#x27;&lt;&#x27;</span>,<span class="string">&#x27;&gt;&#x27;</span>);</span><br><span class="line">        map.put(<span class="string">&#x27;(&#x27;</span>,<span class="string">&#x27;)&#x27;</span>);</span><br><span class="line">        map.put(<span class="string">&#x27;&#123;&#x27;</span>,<span class="string">&#x27;&#125;&#x27;</span>);</span><br><span class="line">        ArrayStack&lt;Character&gt; stack = <span class="keyword">new</span> <span class="title class_">ArrayStack</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; str.length(); i++) &#123;</span><br><span class="line">            <span class="type">char</span> <span class="variable">c</span> <span class="operator">=</span> str.charAt(i);</span><br><span class="line">            <span class="keyword">if</span> (stack.isEmpty()) &#123;</span><br><span class="line">                stack.push(c);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="type">char</span> <span class="variable">top</span> <span class="operator">=</span> stack.peek();</span><br><span class="line">                <span class="keyword">if</span> (map.containsKey(top) &amp;&amp; c == map.get(top)) &#123;</span><br><span class="line">                    stack.pop();</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    stack.push(c);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(stack.isEmpty());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">solution01</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> <span class="string">&quot;&#123;()[[()]]&lt;&gt;&#123;&#125;()&lt;&gt;&#125;()&quot;</span>;</span><br><span class="line">        ArrayStack&lt;Character&gt; stack = <span class="keyword">new</span> <span class="title class_">ArrayStack</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; str.length(); i++) &#123;</span><br><span class="line">            <span class="type">char</span> <span class="variable">c</span> <span class="operator">=</span> str.charAt(i);</span><br><span class="line">            <span class="keyword">if</span> (stack.isEmpty()) &#123;</span><br><span class="line">                stack.push(c);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="type">char</span> <span class="variable">top</span> <span class="operator">=</span> stack.peek();</span><br><span class="line">                <span class="keyword">if</span> (top - c == -<span class="number">1</span> || top - c == -<span class="number">2</span>) &#123;</span><br><span class="line">                    stack.pop();</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    stack.push(c);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(stack.isEmpty());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>InfixToSuffix</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P2.linearStructure;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">InfixToSuffix</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">expression</span> <span class="operator">=</span> <span class="string">&quot;(10+20/2*3)/2+8&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">suffixExpression</span> <span class="operator">=</span> infixToSuffix(expression);</span><br><span class="line">        System.out.println(suffixExpression);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">infixToSuffix</span><span class="params">(String expression)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//操作符栈</span></span><br><span class="line">        ArrayStack&lt;String&gt; opStack = <span class="keyword">new</span> <span class="title class_">ArrayStack</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//后缀表达的线性表</span></span><br><span class="line">        ArrayList&lt;String&gt; suffixList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//格式化字符串</span></span><br><span class="line">        expression = insertBlanks(expression);</span><br><span class="line">        String[] tokens = expression.split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (String token : tokens) &#123;</span><br><span class="line">            <span class="keyword">if</span> (token.length() == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//判断操作符+-*/</span></span><br><span class="line">            <span class="keyword">if</span> (isOperator(token)) &#123;</span><br><span class="line">                <span class="comment">/*</span></span><br><span class="line"><span class="comment">                什么时候操作符进栈？</span></span><br><span class="line"><span class="comment">                1、栈为空</span></span><br><span class="line"><span class="comment">                2、栈顶是（</span></span><br><span class="line"><span class="comment">                3、栈顶是操作符 且优先级比当前token小</span></span><br><span class="line"><span class="comment">                什么时候需要出栈？</span></span><br><span class="line"><span class="comment">                1、栈顶操作符的优先级 &gt;= 当前token</span></span><br><span class="line"><span class="comment">                2、</span></span><br><span class="line"><span class="comment">                 */</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (opStack.isEmpty() || opStack.peek().equals(<span class="string">&quot;(&quot;</span>) || priority(opStack.peek()) &lt; priority(token)) &#123;</span><br><span class="line">                        opStack.push(token);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    suffixList.add(opStack.pop());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (token.equals(<span class="string">&quot;(&quot;</span>)) &#123;</span><br><span class="line">                opStack.push(token);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (token.equals(<span class="string">&quot;)&quot;</span>)) &#123;</span><br><span class="line">                <span class="keyword">while</span> (!opStack.peek().equals(<span class="string">&quot;(&quot;</span>)) &#123;</span><br><span class="line">                    suffixList.add(opStack.pop());</span><br><span class="line">                &#125;</span><br><span class="line">                opStack.pop();</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isNumber(token)) &#123;</span><br><span class="line">                suffixList.add(token);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;Wrong char!&quot;</span> + expression);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (!opStack.isEmpty()) &#123;</span><br><span class="line">            suffixList.add(opStack.pop());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//将数字元素和操作符元素进行拼接</span></span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i&lt; suffixList.size(); i ++) &#123;</span><br><span class="line">            sb.append(suffixList.get(i));</span><br><span class="line">            sb.append(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">priority</span><span class="params">(String token)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (token.equals(<span class="string">&quot;+&quot;</span>) || token.equals(<span class="string">&quot;-&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (token.equals(<span class="string">&quot;*&quot;</span>) || token.equals(<span class="string">&quot;/&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isNumber</span><span class="params">(String token)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> token.matches(<span class="string">&quot;\\d+&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isOperator</span><span class="params">(String token)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> token.equals(<span class="string">&quot;+&quot;</span>) || token.equals(<span class="string">&quot;-&quot;</span>) || token.equals(<span class="string">&quot;*&quot;</span>) ||  token.equals(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">insertBlanks</span><span class="params">(String expression)</span> &#123;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; expression.length(); i++) &#123;</span><br><span class="line">            <span class="type">char</span> <span class="variable">c</span> <span class="operator">=</span> expression.charAt(i);</span><br><span class="line">            <span class="keyword">if</span> (c == <span class="string">&#x27;(&#x27;</span> || c == <span class="string">&#x27;)&#x27;</span> || c == <span class="string">&#x27;+&#x27;</span> || c == <span class="string">&#x27;-&#x27;</span> || c == <span class="string">&#x27;*&#x27;</span> || c == <span class="string">&#x27;/&#x27;</span> ) &#123;</span><br><span class="line">                sb.append(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">                sb.append(c);</span><br><span class="line">                sb.append(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                sb.append(c);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>JudgingPalindrome</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P2.linearStructure;</span><br><span class="line"></span><br><span class="line"><span class="comment">//判断回文</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JudgingPalindrome</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        solution01();</span><br><span class="line">        System.out.println(solution02());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">solution02</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">text</span> <span class="operator">=</span> <span class="string">&quot;上海自来水来自海上&quot;</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> text.length() - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (text.charAt(i) == text.charAt(j)) &#123;</span><br><span class="line">                i++;</span><br><span class="line">                j--;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (j &lt;= i) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">solution01</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">text</span> <span class="operator">=</span> <span class="string">&quot;上海自来水来自海上&quot;</span>;</span><br><span class="line">        ArrayStack&lt;Character&gt; stack = <span class="keyword">new</span> <span class="title class_">ArrayStack</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; text.length(); i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (text.length() % <span class="number">2</span> == <span class="number">1</span> &amp;&amp; i == text.length() / <span class="number">2</span>) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">char</span> <span class="variable">c</span> <span class="operator">=</span> text.charAt(i);</span><br><span class="line">            <span class="keyword">if</span> (stack.isEmpty()) &#123;</span><br><span class="line">                stack.push(c);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (c != stack.peek()) &#123;</span><br><span class="line">                    stack.push(c);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    stack.pop();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(stack.isEmpty());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h4 id="双端栈"><a href="#双端栈" class="headerlink" title="双端栈"></a>双端栈</h4><blockquote>
<p><strong>双端栈性质</strong></p>
</blockquote>
<ul>
<li>FIFO</li>
<li>使用<strong>两个栈顶指针辅助操作</strong></li>
<li>两端都是栈底 两端填充数据不断向中间填充 直至填满扩容</li>
<li><strong>入栈与出栈的时间复杂度都为 O(1)</strong></li>
</ul>
<blockquote>
<p><strong>底层数据结构</strong></p>
</blockquote>
<ul>
<li>静态数组</li>
</ul>
<blockquote>
<p><strong>手写代码实现</strong></p>
</blockquote>
<p>ArrayDoubleEndStack</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P2.linearStructure;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="comment">//双端栈</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ArrayDoubleEndStack</span>&lt;E&gt; <span class="keyword">implements</span> <span class="title class_">Iterable</span>&lt;E&gt; &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//左端栈的栈顶</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> ltop;</span><br><span class="line">    <span class="comment">//右端栈的栈顶</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> rtop;</span><br><span class="line">    <span class="comment">//存储数据的容器</span></span><br><span class="line">    <span class="keyword">private</span> E[] data;</span><br><span class="line">    <span class="comment">//数组容器的默认容量</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">DEFAULT_CAPACITY</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ArrayDoubleEndStack</span><span class="params">()</span> &#123;</span><br><span class="line">        data = (E[]) <span class="keyword">new</span> <span class="title class_">Object</span>[DEFAULT_CAPACITY];</span><br><span class="line">        ltop = -<span class="number">1</span>;</span><br><span class="line">        rtop = data.length;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">pushLeft</span><span class="params">(E element)</span> &#123;</span><br><span class="line">        <span class="comment">//判断双端栈是否满栈</span></span><br><span class="line">        <span class="keyword">if</span> (ltop + <span class="number">1</span> == rtop) &#123;</span><br><span class="line">            resize(data.length * <span class="number">2</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        data[++ltop] = element;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">pushRight</span><span class="params">(E element)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (ltop + <span class="number">1</span> == rtop) &#123;</span><br><span class="line">            resize(data.length * <span class="number">2</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        data[--rtop] = element;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">resize</span><span class="params">(<span class="type">int</span> newLen)</span> &#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        关于双端栈的 扩容 和 缩容</span></span><br><span class="line"><span class="comment">        遍历左边索引不变</span></span><br><span class="line"><span class="comment">        遍历右边索引增加 扩容个长度</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        E[] newData = (E[]) <span class="keyword">new</span> <span class="title class_">Object</span>[newLen];</span><br><span class="line">        <span class="comment">//复制左端栈元素</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt;= ltop; i++) &#123;</span><br><span class="line">            newData[i] = data[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//复制右端栈元素</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> rtop;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> newLen - sizeRight(); i &lt; newLen; i++) &#123;</span><br><span class="line">            newData[i] = data[index++];</span><br><span class="line">        &#125;</span><br><span class="line">        rtop = newLen - sizeRight();</span><br><span class="line">        data = newData;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">popLeft</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (isLeftEmpty()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;left stack is null&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">E</span> <span class="variable">ret</span> <span class="operator">=</span> data[ltop--];</span><br><span class="line">        <span class="keyword">if</span> (sizeLeft() + sizeRight() &lt;= data.length / <span class="number">4</span> &amp;&amp; data.length &gt; DEFAULT_CAPACITY) &#123;</span><br><span class="line">            resize(data.length / <span class="number">2</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">popRight</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (isRightEmpty()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;right stack is null&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">E</span> <span class="variable">ret</span> <span class="operator">=</span> data[rtop++];</span><br><span class="line">        <span class="keyword">if</span> (sizeLeft() + sizeRight() &lt;= data.length / <span class="number">4</span> &amp;&amp; data.length &gt; DEFAULT_CAPACITY) &#123;</span><br><span class="line">            resize(data.length / <span class="number">2</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">peekLeft</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (isLeftEmpty()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;left stack is null&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> data[ltop];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">peekRight</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (isRightEmpty()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;right stack is null&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> data[rtop];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isLeftEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> ltop == -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isRightEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> rtop == data.length;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">sizeLeft</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> ltop + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">sizeRight</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> data.length - rtop;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//1 2 3     7 8 9</span></span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        sb.append(<span class="string">&#x27;[&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (isLeftEmpty() &amp;&amp; isRightEmpty()) &#123;</span><br><span class="line">            sb.append(<span class="string">&#x27;]&#x27;</span>);</span><br><span class="line">            <span class="keyword">return</span> sb.toString();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//先解决左边</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt;= ltop; i++) &#123;</span><br><span class="line">            sb.append(data[i]);</span><br><span class="line">            <span class="keyword">if</span> (i == ltop &amp;&amp; isRightEmpty()) &#123;</span><br><span class="line">                sb.append(<span class="string">&#x27;]&#x27;</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                sb.append(<span class="string">&#x27;,&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//再解决右边</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> rtop; i &lt; data.length; i++) &#123;</span><br><span class="line">            sb.append(data[i]);</span><br><span class="line">            <span class="keyword">if</span> (i == data.length - <span class="number">1</span>) &#123;</span><br><span class="line">                sb.append(<span class="string">&#x27;]&#x27;</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                sb.append(<span class="string">&#x27;,&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Iterator&lt;E&gt; <span class="title function_">iterator</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ArrayDoubleEndStackIterator</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">ArrayDoubleEndStackIterator</span> <span class="keyword">implements</span> <span class="title class_">Iterator</span>&lt;E&gt; &#123;</span><br><span class="line">        <span class="keyword">private</span> ArrayList&lt;E&gt; list;</span><br><span class="line">        <span class="keyword">private</span> Iterator&lt;E&gt; it;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">ArrayDoubleEndStackIterator</span><span class="params">()</span> &#123;</span><br><span class="line">            list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt;= ltop; i++) &#123;</span><br><span class="line">                list.add(data[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> rtop; i &lt; data.length; i++) &#123;</span><br><span class="line">                list.add(data[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            it = list.iterator();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">hasNext</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> it.hasNext();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> E <span class="title function_">next</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> it.next();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h4 id="队列"><a href="#队列" class="headerlink" title="队列"></a>队列</h4><blockquote>
<p><strong>队列性质</strong></p>
</blockquote>
<ul>
<li>FIFO</li>
<li>队列的<strong>入队时间复杂度为 O(1) 出队时间复杂度为O(n)</strong></li>
</ul>
<blockquote>
<p><strong>底层数据结构</strong></p>
</blockquote>
<ul>
<li>线性表 ArrayList</li>
</ul>
<blockquote>
<p><strong>手写代码实现</strong></p>
</blockquote>
<p>Queue</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P1.Interface;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Queue</span>&lt;E&gt; <span class="keyword">extends</span> <span class="title class_">Iterable</span>&lt;E&gt;&#123;</span><br><span class="line">    <span class="comment">//入队</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">offer</span><span class="params">(E element)</span>;</span><br><span class="line">    <span class="comment">//出队</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">poll</span><span class="params">()</span>;</span><br><span class="line">    <span class="comment">//查看队首元素</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">element</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">clear</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ArrayQueue</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P2.linearStructure;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> P1.Interface.Queue;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ArrayQueue</span>&lt;E&gt; <span class="keyword">implements</span> <span class="title class_">Queue</span>&lt;E&gt; &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> ArrayList&lt;E&gt; list;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ArrayQueue</span><span class="params">()</span> &#123;</span><br><span class="line">        list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">offer</span><span class="params">(E element)</span> &#123;</span><br><span class="line">        list.add(list.size(), element);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">poll</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> list.remove(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">element</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> list.get(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> list.isEmpty();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">clear</span><span class="params">()</span> &#123;</span><br><span class="line">        list.clear();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> list.size();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Iterator&lt;E&gt; <span class="title function_">iterator</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> list.iterator();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> list.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">equals</span><span class="params">(Object o)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (o == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span> == o) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (o <span class="keyword">instanceof</span> ArrayQueue) &#123;</span><br><span class="line">            <span class="type">ArrayQueue</span> <span class="variable">other</span> <span class="operator">=</span> (ArrayQueue) o;</span><br><span class="line">            <span class="keyword">return</span> list.equals(other.list);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p><strong>队列的相关应用</strong></p>
</blockquote>
<ul>
<li>队列实现栈</li>
<li>栈实现队列</li>
</ul>
<p>QueueToStack.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P2.linearStructure;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> P1.Interface.Stack;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="comment">//队列实现栈</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">QueueToStack</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        StackImplByQueue&lt;Integer&gt; stack = <span class="keyword">new</span> <span class="title class_">StackImplByQueue</span>&lt;&gt;();</span><br><span class="line">        System.out.println(stack);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= <span class="number">5</span>; i++) &#123;</span><br><span class="line">            stack.push(i);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(stack);</span><br><span class="line">        System.out.println(stack.peek());</span><br><span class="line">        System.out.println(stack.pop());</span><br><span class="line">        System.out.println(stack);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">StackImplByQueue</span>&lt;E&gt; <span class="keyword">implements</span> <span class="title class_">Stack</span>&lt;E&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ArrayQueue&lt;E&gt; queueA;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">StackImplByQueue</span><span class="params">()</span> &#123;</span><br><span class="line">        queueA = <span class="keyword">new</span> <span class="title class_">ArrayQueue</span>&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> queueA.size();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> queueA.isEmpty();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">push</span><span class="params">(E element)</span> &#123;</span><br><span class="line">        queueA.offer(element);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">pop</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;stack is null&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; queueA.size() - <span class="number">1</span>; i++) &#123;</span><br><span class="line">            <span class="type">E</span> <span class="variable">tmp</span> <span class="operator">=</span> queueA.poll();</span><br><span class="line">            queueA.offer(tmp);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> queueA.poll();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">peek</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;stack is null&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; queueA.size() - <span class="number">1</span>; i++) &#123;</span><br><span class="line">            <span class="type">E</span> <span class="variable">tmp</span> <span class="operator">=</span> queueA.poll();</span><br><span class="line">            queueA.offer(tmp);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">E</span> <span class="variable">tmp</span> <span class="operator">=</span> queueA.poll();</span><br><span class="line">        queueA.offer(tmp);</span><br><span class="line">        <span class="keyword">return</span> tmp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">clear</span><span class="params">()</span> &#123;</span><br><span class="line">        queueA.clear();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Iterator&lt;E&gt; <span class="title function_">iterator</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> queueA.iterator();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> queueA.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>StackToQueue.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P2.linearStructure;</span><br><span class="line"></span><br><span class="line"><span class="comment">//栈实现队列</span></span><br><span class="line"><span class="keyword">import</span> P1.Interface.Queue;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">理论：</span></span><br><span class="line"><span class="comment">使用两个栈</span></span><br><span class="line"><span class="comment">stackA</span></span><br><span class="line"><span class="comment">stackB</span></span><br><span class="line"><span class="comment">入队操作：</span></span><br><span class="line"><span class="comment">    所有入队操作直接进入A</span></span><br><span class="line"><span class="comment">出队操作：</span></span><br><span class="line"><span class="comment">    将A中所求元素向后所有元素弹出进入B</span></span><br><span class="line"><span class="comment">    取出所求元素</span></span><br><span class="line"><span class="comment">    再将B中元素进去A</span></span><br><span class="line"><span class="comment">先进后出 后进先出</span></span><br><span class="line"><span class="comment">逻辑相消 --&gt; 先进先出</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StackToQueue</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        QueueImplByStack&lt;Integer&gt; queue = <span class="keyword">new</span> <span class="title class_">QueueImplByStack</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= <span class="number">5</span>; i++) &#123;</span><br><span class="line">            queue.offer(i);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(queue);</span><br><span class="line">        System.out.println(queue.poll());</span><br><span class="line">        System.out.println(queue);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">QueueImplByStack</span>&lt;E&gt; <span class="keyword">implements</span> <span class="title class_">Queue</span>&lt;E&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> ArrayStack&lt;E&gt; stackA;</span><br><span class="line">    <span class="keyword">private</span> ArrayStack&lt;E&gt; stackB;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">QueueImplByStack</span><span class="params">()</span> &#123;</span><br><span class="line">        stackA = <span class="keyword">new</span> <span class="title class_">ArrayStack</span>&lt;&gt;();</span><br><span class="line">        stackB = <span class="keyword">new</span> <span class="title class_">ArrayStack</span>&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">offer</span><span class="params">(E element)</span> &#123;</span><br><span class="line">        stackA.push(element);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">poll</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;queue is null&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (stackA.size() != <span class="number">1</span>) &#123;</span><br><span class="line">            stackB.push(stackA.pop());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">E</span> <span class="variable">ret</span> <span class="operator">=</span> stackA.pop();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (!stackB.isEmpty()) &#123;</span><br><span class="line">            stackA.push(stackB.pop());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">element</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;queue is null&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (stackA.size() != <span class="number">1</span>) &#123;</span><br><span class="line">            stackB.push(stackA.pop());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">E</span> <span class="variable">ret</span> <span class="operator">=</span> stackA.peek();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (!stackB.isEmpty()) &#123;</span><br><span class="line">            stackA.push(stackB.pop());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stackA.isEmpty();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">clear</span><span class="params">()</span> &#123;</span><br><span class="line">        stackA.clear();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stackA.size();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Iterator&lt;E&gt; <span class="title function_">iterator</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stackA.iterator();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stackA.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h4 id="循环队列"><a href="#循环队列" class="headerlink" title="循环队列"></a>循环队列</h4><blockquote>
<p><strong>循环队列性质</strong></p>
</blockquote>
<ul>
<li>使用 <strong>队首</strong> 与 <strong>队尾</strong> 指针辅助操作</li>
<li>对比 <strong>普通队列 入队时间复杂度为 O(1) 出队时间复杂度为O(n) 循环队列的&#x3D;&#x3D;出队时间复杂度同样为 O(1)&#x3D;&#x3D;</strong></li>
<li>循环队列本质上的是 出队时 队首元素 被取出 同时 Front 指针直接后移一位</li>
</ul>
<blockquote>
<p><strong>底层数据结构</strong></p>
</blockquote>
<ul>
<li>静态数组</li>
</ul>
<blockquote>
<p><strong>手写代码实现</strong></p>
</blockquote>
<p>ArrayLoopQueue</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P2.linearStructure;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> P1.Interface.Queue;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="comment">//循环队列</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ArrayLoopQueue</span>&lt;E&gt; <span class="keyword">implements</span> <span class="title class_">Queue</span>&lt;E&gt; &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> E[] data;   <span class="comment">//存储数据的容器</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> front;  <span class="comment">//队首指针(实际上就是数组中的索引角标)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> rear;   <span class="comment">//队尾指针</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> size;   <span class="comment">//元素的个数 (f &lt; r  r-f ; r &lt; f  r+L-f)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">DEFAULT_CAPACITY</span> <span class="operator">=</span> <span class="number">10</span>;   <span class="comment">//默认容量</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ArrayLoopQueue</span><span class="params">()</span> &#123;</span><br><span class="line">        data = (E[]) <span class="keyword">new</span> <span class="title class_">Object</span>[DEFAULT_CAPACITY + <span class="number">1</span>];</span><br><span class="line">        front = <span class="number">0</span>;</span><br><span class="line">        rear = <span class="number">0</span>;</span><br><span class="line">        size = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">offer</span><span class="params">(E element)</span> &#123;</span><br><span class="line">        <span class="comment">//满了没</span></span><br><span class="line">        <span class="keyword">if</span> ((rear + <span class="number">1</span>) % data.length == front) &#123;</span><br><span class="line">            resize(data.length * <span class="number">2</span> - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        data[rear] = element;</span><br><span class="line">        rear = (rear + <span class="number">1</span>) % data.length;</span><br><span class="line">        size++;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">poll</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//空不空</span></span><br><span class="line">        <span class="keyword">if</span> (isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;queue is null&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">E</span> <span class="variable">ret</span> <span class="operator">=</span> data[front];</span><br><span class="line">        front = (front + <span class="number">1</span>) % data.length;</span><br><span class="line">        size--;</span><br><span class="line">        <span class="keyword">if</span> (size &lt;= (data.length - <span class="number">1</span>) / <span class="number">4</span> &amp;&amp; data.length - <span class="number">1</span> &gt; DEFAULT_CAPACITY) &#123;</span><br><span class="line">            resize(data.length / <span class="number">2</span> + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">resize</span><span class="params">(<span class="type">int</span> newLen)</span> &#123;</span><br><span class="line">        E[] newData = (E[]) <span class="keyword">new</span> <span class="title class_">Object</span>[newLen];</span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> front; i != rear; i = (i + <span class="number">1</span>) % data.length) &#123;</span><br><span class="line">            newData[index++] = data[i];</span><br><span class="line">        &#125;</span><br><span class="line">        data = newData;</span><br><span class="line">        front = <span class="number">0</span>;</span><br><span class="line">        rear = index;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">element</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;queue is null&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> data[front];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> front == rear;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">clear</span><span class="params">()</span> &#123;</span><br><span class="line">        data = (E[]) <span class="keyword">new</span> <span class="title class_">Object</span>[DEFAULT_CAPACITY];</span><br><span class="line">        size = <span class="number">0</span>;</span><br><span class="line">        front = <span class="number">0</span>;</span><br><span class="line">        rear = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> size;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        sb.append(<span class="string">&#x27;[&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (isEmpty()) &#123;</span><br><span class="line">            sb.append(<span class="string">&#x27;]&#x27;</span>);</span><br><span class="line">            <span class="keyword">return</span> sb.toString();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> front; i != rear; i = (i + <span class="number">1</span>) % data.length) &#123;</span><br><span class="line">            sb.append(data[i]); <span class="comment">//相当于加如data[i] 的toString方法</span></span><br><span class="line">            <span class="keyword">if</span> ((i + <span class="number">1</span>) % data.length == rear) &#123;</span><br><span class="line">                sb.append(<span class="string">&#x27;]&#x27;</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                sb.append(<span class="string">&#x27;,&#x27;</span>);</span><br><span class="line">                sb.append(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">equals</span><span class="params">(Object o)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (o == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span> == o) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (o <span class="keyword">instanceof</span> ArrayLoopQueue) &#123;</span><br><span class="line">            ArrayLoopQueue&lt;E&gt; other = (ArrayLoopQueue&lt;E&gt;) o;</span><br><span class="line">            <span class="keyword">if</span> (size != other.size) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> front;</span><br><span class="line">            <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> other.front;</span><br><span class="line">            <span class="keyword">while</span> (i != rear) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!data[i].equals(other.data[j])) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                i = (i + <span class="number">1</span>) % data.length;</span><br><span class="line">                j = (j + <span class="number">1</span>) % other.data.length;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Iterator&lt;E&gt; <span class="title function_">iterator</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ArrayLoopQueueIterator</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">ArrayLoopQueueIterator</span> <span class="keyword">implements</span> <span class="title class_">Iterator</span>&lt;E&gt; &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> <span class="variable">cur</span> <span class="operator">=</span> front;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">hasNext</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> cur != rear;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> E <span class="title function_">next</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="type">E</span> <span class="variable">ret</span> <span class="operator">=</span> data[cur];</span><br><span class="line">            cur = (cur + <span class="number">1</span>) % data.length;</span><br><span class="line">            <span class="keyword">return</span> ret;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意</p>
<ul>
<li>底层实现的循环逻辑 当 Rear 到队尾时 进行循环至队首 解决空间浪费问题</li>
<li>注意 队列满足的判空判满条件同为 <code>(Rear + 1) % n == Front</code> 导致歧义 模糊定义 故而需要定义 Rear 尾指针始终指向null 从而解决歧义问题 <strong>此时判满条件为</strong> <code>(Rear + 1) % n == Front</code> <strong>判满条件为</strong> <code>Rear == Front</code></li>
</ul>
<h4 id="双端队列"><a href="#双端队列" class="headerlink" title="双端队列"></a>双端队列</h4><blockquote>
<p><strong>双端队列性质</strong></p>
</blockquote>
<ul>
<li>使用<strong>头尾指针</strong>辅助操作队列</li>
<li>限定<strong>插入和删除</strong>操作在<strong>表两端</strong>进行操作的<strong>线性表</strong> –表头和表尾都可以进行插入和删除</li>
<li><strong>同时具有队列和栈性质</strong>的一种数据结构</li>
<li>本质上是<strong>循环队列</strong>的一种<strong>升级</strong></li>
<li><strong>插入</strong>与<strong>删除</strong>的时间复杂度都是 <strong>O(1)</strong></li>
</ul>
<blockquote>
<p><strong>手写代码实现</strong></p>
</blockquote>
<p>Dequeue</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P1.Interface;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Dequeue</span>&lt;E&gt; <span class="keyword">extends</span> <span class="title class_">Queue</span>&lt;E&gt; &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//表首添加</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addFirst</span><span class="params">(E element)</span>;</span><br><span class="line">    <span class="comment">//表尾添加</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addLast</span><span class="params">(E element)</span>;</span><br><span class="line">    <span class="comment">//表首删除</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">removeFirst</span><span class="params">()</span>;</span><br><span class="line">    <span class="comment">//表尾删除</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">reomveLast</span><span class="params">()</span>;</span><br><span class="line">    <span class="comment">//查看表首</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">getFirst</span><span class="params">()</span>;</span><br><span class="line">    <span class="comment">//查看表尾</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">getLast</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ArrayDequeue</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P2.linearStructure;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> P1.Interface.Dequeue;</span><br><span class="line"><span class="keyword">import</span> P1.Interface.Stack;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ArrayDequeue</span>&lt;E&gt; <span class="keyword">implements</span> <span class="title class_">Dequeue</span>&lt;E&gt;, Stack&lt;E&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> E[] data;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> front;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> rear;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> size;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">DEFAULT_CAPACITY</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ArrayDequeue</span><span class="params">()</span> &#123;</span><br><span class="line">        data = (E[]) <span class="keyword">new</span> <span class="title class_">Object</span>[DEFAULT_CAPACITY + <span class="number">1</span>];</span><br><span class="line">        front = <span class="number">0</span>;</span><br><span class="line">        rear = <span class="number">0</span>;</span><br><span class="line">        size = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addFirst</span><span class="params">(E element)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> ((rear + <span class="number">1</span>) % data.length == front ) &#123;</span><br><span class="line">            resize(data.length * <span class="number">2</span> - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        front = (front - <span class="number">1</span> + data.length) % data.length;</span><br><span class="line">        data[front] = element;</span><br><span class="line">        size++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addLast</span><span class="params">(E element)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> ((rear + <span class="number">1</span>) % data.length == front ) &#123;</span><br><span class="line">            resize(data.length * <span class="number">2</span> - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        data[rear] = element;</span><br><span class="line">        rear = (rear + <span class="number">1</span>) % data.length;</span><br><span class="line">        size++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">resize</span><span class="params">(<span class="type">int</span> newLen)</span> &#123;</span><br><span class="line">        E[] newData = (E[]) <span class="keyword">new</span> <span class="title class_">Object</span>[newLen];</span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> front; i != rear; i = (i + <span class="number">1</span>) % data.length) &#123;</span><br><span class="line">            newData[index++] = data[i];</span><br><span class="line">        &#125;</span><br><span class="line">        data = newData;</span><br><span class="line">        front = <span class="number">0</span>;</span><br><span class="line">        rear = index;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">removeFirst</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;queue is null&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">E</span> <span class="variable">ret</span> <span class="operator">=</span> data[front];</span><br><span class="line">        front = (front + <span class="number">1</span>) % data.length;</span><br><span class="line">        size--;</span><br><span class="line">        <span class="keyword">if</span> (size &lt;= (data.length - <span class="number">1</span>) / <span class="number">4</span> &amp;&amp; data.length - <span class="number">1</span> &gt; DEFAULT_CAPACITY) &#123;</span><br><span class="line">            resize(data.length / <span class="number">2</span> +<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">reomveLast</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;queue is null&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        rear = (rear -<span class="number">1</span> + data.length) % data.length;</span><br><span class="line">        <span class="type">E</span> <span class="variable">ret</span> <span class="operator">=</span> data[rear];</span><br><span class="line">        size--;</span><br><span class="line">        <span class="keyword">if</span> (size &lt;= (data.length - <span class="number">1</span>) / <span class="number">4</span> &amp;&amp; data.length - <span class="number">1</span> &gt; DEFAULT_CAPACITY) &#123;</span><br><span class="line">            resize(data.length / <span class="number">2</span> +<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">getFirst</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;queue is null&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> data[front];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">getLast</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;queue is null&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> data[(rear - <span class="number">1</span> + data.length) % data.length];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">offer</span><span class="params">(E element)</span> &#123;</span><br><span class="line">        addLast(element);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">poll</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> removeFirst();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">element</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> getFirst();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">peek</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> getLast();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> size == <span class="number">0</span> &amp;&amp; front == rear;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">push</span><span class="params">(E element)</span> &#123;</span><br><span class="line">        addLast(element);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">pop</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> reomveLast();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">clear</span><span class="params">()</span> &#123;</span><br><span class="line">        E[] data = (E[]) <span class="keyword">new</span> <span class="title class_">Object</span>[DEFAULT_CAPACITY];</span><br><span class="line">        front = <span class="number">0</span>;</span><br><span class="line">        rear = <span class="number">0</span>;</span><br><span class="line">        size = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> size;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        sb.append(<span class="string">&#x27;[&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (isEmpty()) &#123;</span><br><span class="line">            sb.append(<span class="string">&#x27;]&#x27;</span>);</span><br><span class="line">            <span class="keyword">return</span> sb.toString();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> front; i != rear; i = (i + <span class="number">1</span>) % data.length) &#123;</span><br><span class="line">            sb.append(data[i]);</span><br><span class="line">            <span class="keyword">if</span> ((i + <span class="number">1</span>) % data.length == rear) &#123;</span><br><span class="line">                sb.append(<span class="string">&#x27;]&#x27;</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                sb.append(<span class="string">&#x27;,&#x27;</span>);</span><br><span class="line">                sb.append(<span class="string">&#x27;]&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Iterator <span class="title function_">iterator</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ArrayDequequeTterator</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">ArrayDequequeTterator</span> <span class="keyword">implements</span> <span class="title class_">Iterator</span>&lt;E&gt; &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> <span class="variable">cur</span> <span class="operator">=</span> front;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">hasNext</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> cur != rear;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> E <span class="title function_">next</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="type">E</span> <span class="variable">ret</span> <span class="operator">=</span> data[cur];</span><br><span class="line">            cur = (cur + <span class="number">1</span>) % data.length;</span><br><span class="line">            <span class="keyword">return</span> ret;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="链式结构"><a href="#链式结构" class="headerlink" title="链式结构"></a>链式结构</h3><blockquote>
<p><strong>链表性质</strong></p>
</blockquote>
<ul>
<li>由 <strong>数据域</strong> 与 <strong>指针域</strong> 构成</li>
<li><strong>头节点</strong> 区分 为 <strong>虚拟头节点</strong> 与 <strong>真实头节点</strong> 头节点的不同 相对应的 <strong>头插法</strong> 也不同</li>
<li>每个节点存储的数据类型相同</li>
<li><strong>头指针</strong> 与 <strong>尾指针</strong> 仅仅是一个<strong>引用变量</strong> 是存储头节点与尾节点地址的指针</li>
</ul>
<h4 id="单向链表"><a href="#单向链表" class="headerlink" title="单向链表"></a>单向链表</h4><blockquote>
<p><strong>底层数据结构</strong></p>
</blockquote>
<ul>
<li>链表结构</li>
<li>指针 引用地址的应用</li>
</ul>
<blockquote>
<p><strong>核心</strong></p>
</blockquote>
<ul>
<li>定义<strong>内部节点</strong>内部类 存储 <strong>数据域</strong> 与 <strong>指针域</strong></li>
<li>定义<strong>头指针</strong>与<strong>尾指针</strong> –辅助操作链表</li>
<li>增删 –实现按位插入</li>
<li><strong>插入的时间复杂度 O(1) 删除的时间复杂度 O(n)</strong></li>
<li>节点<strong>比较的是引用变量存储的地址</strong> 而不是内容 所以 节点的比较用 <code>==</code></li>
<li>排序 –冒泡排序 或 选择排序 由于 <em>单向链表无法向前获取元素位置</em></li>
</ul>
<blockquote>
<p><strong>手写代码实现</strong></p>
</blockquote>
<p>LinkedSinglyList</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P3.chainStructure;</span><br><span class="line"></span><br><span class="line"><span class="comment">//单向链表</span></span><br><span class="line"><span class="keyword">import</span> P1.Interface.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Comparator;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LinkedSinglyList</span>&lt;E&gt; <span class="keyword">implements</span> <span class="title class_">List</span>&lt;E&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//定义结点类 内部类</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">class</span> <span class="title class_">Node</span> &#123;</span><br><span class="line">        <span class="comment">//数据域</span></span><br><span class="line">        E data;</span><br><span class="line">        <span class="comment">//结点域</span></span><br><span class="line">        Node next;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//构造函数</span></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">()</span> &#123;</span><br><span class="line">            data = <span class="literal">null</span>;</span><br><span class="line">            next = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">(E data)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.data = data;</span><br><span class="line">            next = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">(E data, Node next)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.data = data;</span><br><span class="line">            <span class="built_in">this</span>.next = next;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> data.toString();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Node head;  <span class="comment">//头指针</span></span><br><span class="line">    <span class="keyword">private</span> Node tail;  <span class="comment">//尾指针</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> size;   <span class="comment">//链表元素个数 同时元素个数也是结点个数</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//构造函数 空链表</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">LinkedSinglyList</span><span class="params">()</span> &#123;</span><br><span class="line">        head = <span class="literal">null</span>;</span><br><span class="line">        tail = <span class="literal">null</span>;</span><br><span class="line">        size = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//构造函数 传入数组 将数组封装成链表</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">LinkedSinglyList</span><span class="params">(E[] arr)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (arr == <span class="literal">null</span> || arr.length == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;arr is null&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">            add(arr[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(E element)</span> &#123;</span><br><span class="line">        add(size, element);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> index, E element)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (index &lt; <span class="number">0</span> || index &gt; size) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;add index out of range&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">n</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Node</span>(element);</span><br><span class="line">        <span class="keyword">if</span> (size == <span class="number">0</span>) &#123;</span><br><span class="line">            head = n;</span><br><span class="line">            tail = n;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (index == <span class="number">0</span>) &#123;</span><br><span class="line">            n.next = head;</span><br><span class="line">            head = n;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (index == size) &#123;</span><br><span class="line">            tail.next = n;</span><br><span class="line">            tail = n;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">p</span> <span class="operator">=</span> head;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; index - <span class="number">1</span>; i++) &#123;</span><br><span class="line">                p = p.next;</span><br><span class="line">            &#125;</span><br><span class="line">            n.next = p.next;</span><br><span class="line">            p.next = n;</span><br><span class="line">        &#125;</span><br><span class="line">        size++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">remove</span><span class="params">(E element)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> indexOf(element);</span><br><span class="line">        <span class="keyword">if</span> (index != -<span class="number">1</span>) &#123;</span><br><span class="line">            remove(index);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">remove</span><span class="params">(<span class="type">int</span> index)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (index &lt; <span class="number">0</span> || index &gt;= size) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;index is out of range&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">E</span> <span class="variable">ret</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (size == <span class="number">1</span>) &#123;</span><br><span class="line">            ret = head.data;</span><br><span class="line">            head = <span class="literal">null</span>;</span><br><span class="line">            tail = <span class="literal">null</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (index == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">n</span> <span class="operator">=</span> head;</span><br><span class="line">            ret = n.data;</span><br><span class="line">            head = n.next;</span><br><span class="line">            n.next = <span class="literal">null</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (index == size - <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">p</span> <span class="operator">=</span> head;</span><br><span class="line">            <span class="keyword">while</span> (p.next != tail) &#123;</span><br><span class="line">                p = p.next;</span><br><span class="line">            &#125;</span><br><span class="line">            ret = tail.data;</span><br><span class="line">            p.next = <span class="literal">null</span>;</span><br><span class="line">            tail = p;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">p</span> <span class="operator">=</span> head;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; index - <span class="number">1</span>; i++) &#123;</span><br><span class="line">                p = p.next;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">n</span> <span class="operator">=</span> p.next;</span><br><span class="line">            ret = n.data;</span><br><span class="line">            p.next = n.next;</span><br><span class="line">            n.next = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        size--;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">get</span><span class="params">(<span class="type">int</span> index)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (index &lt; <span class="number">0</span> || index &gt;= size) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;get index out of range&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (index == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> head.data;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (index == size - <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> tail.data;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">p</span> <span class="operator">=</span> head;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; index; i++) &#123;</span><br><span class="line">                p = p.next;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> p.data;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">set</span><span class="params">(<span class="type">int</span> index, E element)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (index &lt; <span class="number">0</span> || index &gt;= size) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;get index out of range&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">E</span> <span class="variable">ret</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (index == <span class="number">0</span>) &#123;</span><br><span class="line">            ret = head.data;;</span><br><span class="line">            head.data = element;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (index == size - <span class="number">1</span>) &#123;</span><br><span class="line">            tail.data = element;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">p</span> <span class="operator">=</span> head;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; index; i++) &#123;</span><br><span class="line">                p = p.next;</span><br><span class="line">            &#125;</span><br><span class="line">            ret = p.data;</span><br><span class="line">            p.data = element;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> size;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">indexOf</span><span class="params">(E element)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="type">Node</span> <span class="variable">p</span> <span class="operator">=</span> head;</span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (!p.data.equals(element)) &#123;</span><br><span class="line">            p = p.next;</span><br><span class="line">            index++;</span><br><span class="line">            <span class="keyword">if</span> (p == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> index;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">contains</span><span class="params">(E element)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> indexOf(element) != -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> size == <span class="number">0</span> &amp;&amp; head == <span class="literal">null</span> &amp;&amp; tail == <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">clear</span><span class="params">()</span> &#123;</span><br><span class="line">        head = <span class="literal">null</span>;</span><br><span class="line">        tail = <span class="literal">null</span>;</span><br><span class="line">        size = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sort</span><span class="params">(Comparator&lt;E&gt; c)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (c == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;comparator can not be null&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//        插入排序进行 链表的排序</span></span><br><span class="line"><span class="comment">//        此处的出入排序的时间复杂度为O(n^3) 故而用插入排序不合适</span></span><br><span class="line"><span class="comment">//        for (int i = 0; i &lt; size; i++) &#123;</span></span><br><span class="line"><span class="comment">//            E e = get(i);</span></span><br><span class="line"><span class="comment">//            int j = 0;</span></span><br><span class="line"><span class="comment">//            for (j = i; j &gt; 0 &amp;&amp; c.compare(get(j - 1), e) &gt; 0; j--) &#123;</span></span><br><span class="line"><span class="comment">//                set(j, get(j - 1));</span></span><br><span class="line"><span class="comment">//            &#125;</span></span><br><span class="line"><span class="comment">//            set(j, e);</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//故而借助于选择排序来进行排序</span></span><br><span class="line">        <span class="comment">//选择 选择排序的原因是因为 选择排序和冒泡排序 的整体数据向后 后移</span></span><br><span class="line">        <span class="comment">//时间复杂度为O(n^2)</span></span><br><span class="line">        <span class="keyword">if</span> (size == <span class="number">0</span> || size == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">nodeA</span> <span class="operator">=</span> head;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">nodeB</span> <span class="operator">=</span> nodeA.next;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (c.compare(nodeA.data, nodeB.data) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    swap(nodeA, nodeB);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (nodeB == tail) &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                nodeB = nodeB.next;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (nodeA.next == tail) &#123;</span><br><span class="line">                <span class="comment">//避免空指针异常</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            nodeA = nodeA.next;</span><br><span class="line">            nodeB = nodeA.next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">swap</span><span class="params">(Node nodeA, Node nodeB)</span> &#123;</span><br><span class="line">        <span class="type">E</span> <span class="variable">tmp</span> <span class="operator">=</span> nodeA.data;</span><br><span class="line">        nodeA.data = nodeB.data;</span><br><span class="line">        nodeB.data = tmp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;E&gt; <span class="title function_">subList</span><span class="params">(<span class="type">int</span> fromIndex, <span class="type">int</span> toIndex)</span> &#123;</span><br><span class="line">        <span class="comment">//0 &lt;= fromIndex &lt;= toIndex &lt;= size - 1 [fromIndex,toIndex]</span></span><br><span class="line">        <span class="keyword">if</span> (fromIndex &lt; <span class="number">0</span> || toIndex &gt;= size ||fromIndex &gt; toIndex) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;must 0 &lt;= fromIndex &lt;= toIndex &lt;= size&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        LinkedSinglyList&lt;E&gt; list = <span class="keyword">new</span> <span class="title class_">LinkedSinglyList</span>&lt;&gt;();</span><br><span class="line"><span class="comment">//        时间复杂度相当于 O(n^2)</span></span><br><span class="line"><span class="comment">//        for (int i = fromIndex; i &lt;= toIndex; i++) &#123;</span></span><br><span class="line"><span class="comment">//            list.add(get(i));</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line"><span class="comment">//        return list;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//整体时间复杂度为O(n)</span></span><br><span class="line">        <span class="type">Node</span> <span class="variable">nodeA</span> <span class="operator">=</span> head;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; fromIndex; i++) &#123;</span><br><span class="line">            nodeA = nodeA.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">nodeB</span> <span class="operator">=</span> head;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; toIndex; i++) &#123;</span><br><span class="line">            nodeB = nodeB.next;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">Node</span> <span class="variable">p</span> <span class="operator">=</span> nodeA;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            list.add(p.data);</span><br><span class="line">            <span class="keyword">if</span> (p == nodeB) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            p = p.next;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        sb.append(<span class="string">&#x27;[&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (isEmpty()) &#123;</span><br><span class="line">            sb.append(<span class="string">&#x27;]&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">p</span> <span class="operator">=</span> head;</span><br><span class="line">            <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">                sb.append(p.data);</span><br><span class="line">                <span class="keyword">if</span> (p == tail) &#123;</span><br><span class="line">                    sb.append(<span class="string">&#x27;]&#x27;</span>);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                sb.append(<span class="string">&#x27;,&#x27;</span>);</span><br><span class="line">                sb.append(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">                p = p.next;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Iterator&lt;E&gt; <span class="title function_">iterator</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">LinkedSinglyListIterator</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">LinkedSinglyListIterator</span> <span class="keyword">implements</span> <span class="title class_">Iterator</span>&lt;E&gt; &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">private</span> <span class="type">Node</span> <span class="variable">cur</span> <span class="operator">=</span> head;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">hasNext</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> cur != <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> E <span class="title function_">next</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="type">E</span> <span class="variable">ret</span> <span class="operator">=</span> cur.data;</span><br><span class="line">            cur = cur.next;</span><br><span class="line">            <span class="keyword">return</span> ret;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h4 id="单向循环链表"><a href="#单向循环链表" class="headerlink" title="单向循环链表"></a>单向循环链表</h4><blockquote>
<p><strong>单向循环链表性质</strong></p>
</blockquote>
<ul>
<li>定义<strong>头指针</strong>与<strong>尾指针</strong> –辅助操作链表</li>
<li>单向链表头尾不相连 而单向循环链表 <strong>尾节点指向头节点</strong></li>
</ul>
<blockquote>
<p><strong>手写代码实现</strong></p>
</blockquote>
<p>LinkedSinglyCircularList</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P3.chainStructure;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> P1.Interface.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Comparator;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="comment">//单向循环链表</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LinkedSinglyCircularList</span>&lt;E&gt; <span class="keyword">implements</span> <span class="title class_">List</span>&lt;E&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//定义结点类 内部类</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">class</span> <span class="title class_">Node</span> &#123;</span><br><span class="line">        <span class="comment">//数据域</span></span><br><span class="line">        E data;</span><br><span class="line">        <span class="comment">//结点域</span></span><br><span class="line">        Node next;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//构造函数</span></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">()</span> &#123;</span><br><span class="line">            data = <span class="literal">null</span>;</span><br><span class="line">            next = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">(E data)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.data = data;</span><br><span class="line">            next = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">(E data, Node next)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.data = data;</span><br><span class="line">            <span class="built_in">this</span>.next = next;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> data.toString();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Node head;  <span class="comment">//头指针</span></span><br><span class="line">    <span class="keyword">private</span> Node tail;  <span class="comment">//尾指针</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> size;   <span class="comment">//链表元素个数 同时元素个数也是结点个数</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//构造函数 空链表</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">LinkedSinglyCircularList</span><span class="params">()</span> &#123;</span><br><span class="line">        head = <span class="literal">null</span>;</span><br><span class="line">        tail = <span class="literal">null</span>;</span><br><span class="line">        size = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//构造函数 传入数组 将数组封装成链表</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">LinkedSinglyCircularList</span><span class="params">(E[] arr)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (arr == <span class="literal">null</span> || arr.length == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;arr is null&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">            add(arr[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(E element)</span> &#123;</span><br><span class="line">        add(size, element);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> index, E element)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (index &lt; <span class="number">0</span> || index &gt; size) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;add index out of range&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">n</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Node</span>(element);</span><br><span class="line">        <span class="keyword">if</span> (size == <span class="number">0</span>) &#123;</span><br><span class="line">            head = n;</span><br><span class="line">            tail = n;</span><br><span class="line">            <span class="comment">//new code</span></span><br><span class="line">            tail.next = head;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (index == <span class="number">0</span>) &#123;</span><br><span class="line">            n.next = head;</span><br><span class="line">            head = n;</span><br><span class="line">            <span class="comment">// new code</span></span><br><span class="line">            tail.next = head;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (index == size) &#123;</span><br><span class="line">            <span class="comment">// new code</span></span><br><span class="line">            n.next = tail.next;</span><br><span class="line">            tail.next = n;</span><br><span class="line">            tail = n;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">p</span> <span class="operator">=</span> head;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; index - <span class="number">1</span>; i++) &#123;</span><br><span class="line">                p = p.next;</span><br><span class="line">            &#125;</span><br><span class="line">            n.next = p.next;</span><br><span class="line">            p.next = n;</span><br><span class="line">        &#125;</span><br><span class="line">        size++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">remove</span><span class="params">(E element)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> indexOf(element);</span><br><span class="line">        <span class="keyword">if</span> (index != -<span class="number">1</span>) &#123;</span><br><span class="line">            remove(index);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">remove</span><span class="params">(<span class="type">int</span> index)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (index &lt; <span class="number">0</span> || index &gt;= size) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;index is out of range&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">E</span> <span class="variable">ret</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (size == <span class="number">1</span>) &#123;</span><br><span class="line">            ret = head.data;</span><br><span class="line">            head = <span class="literal">null</span>;</span><br><span class="line">            tail = <span class="literal">null</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (index == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">n</span> <span class="operator">=</span> head;</span><br><span class="line">            ret = n.data;</span><br><span class="line">            head = n.next;</span><br><span class="line">            n.next = <span class="literal">null</span>;</span><br><span class="line">            <span class="comment">//new code</span></span><br><span class="line">            tail.next = head;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (index == size - <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">p</span> <span class="operator">=</span> head;</span><br><span class="line">            <span class="keyword">while</span> (p.next != tail) &#123;</span><br><span class="line">                p = p.next;</span><br><span class="line">            &#125;</span><br><span class="line">            ret = tail.data;</span><br><span class="line">            <span class="comment">//change code</span></span><br><span class="line">            p.next = head;</span><br><span class="line">            tail = p;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">p</span> <span class="operator">=</span> head;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; index - <span class="number">1</span>; i++) &#123;</span><br><span class="line">                p = p.next;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">n</span> <span class="operator">=</span> p.next;</span><br><span class="line">            ret = n.data;</span><br><span class="line">            p.next = n.next;</span><br><span class="line">            n.next = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        size--;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">get</span><span class="params">(<span class="type">int</span> index)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (index &lt; <span class="number">0</span> || index &gt;= size) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;get index out of range&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (index == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> head.data;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (index == size - <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> tail.data;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">p</span> <span class="operator">=</span> head;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; index; i++) &#123;</span><br><span class="line">                p = p.next;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> p.data;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">set</span><span class="params">(<span class="type">int</span> index, E element)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (index &lt; <span class="number">0</span> || index &gt;= size) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;get index out of range&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">E</span> <span class="variable">ret</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (index == <span class="number">0</span>) &#123;</span><br><span class="line">            ret = head.data;</span><br><span class="line">            ;</span><br><span class="line">            head.data = element;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (index == size - <span class="number">1</span>) &#123;</span><br><span class="line">            tail.data = element;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">p</span> <span class="operator">=</span> head;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; index; i++) &#123;</span><br><span class="line">                p = p.next;</span><br><span class="line">            &#125;</span><br><span class="line">            ret = p.data;</span><br><span class="line">            p.data = element;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> size;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">indexOf</span><span class="params">(E element)</span> &#123;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">p</span> <span class="operator">=</span> head;</span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (!p.data.equals(element)) &#123;</span><br><span class="line">            p = p.next;</span><br><span class="line">            index++;</span><br><span class="line">            <span class="keyword">if</span> (p == head) &#123;    <span class="comment">//change code</span></span><br><span class="line">                <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> index;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">contains</span><span class="params">(E element)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> indexOf(element) != -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> size == <span class="number">0</span> &amp;&amp; head == <span class="literal">null</span> &amp;&amp; tail == <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">clear</span><span class="params">()</span> &#123;</span><br><span class="line">        head = <span class="literal">null</span>;</span><br><span class="line">        tail = <span class="literal">null</span>;</span><br><span class="line">        size = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sort</span><span class="params">(Comparator&lt;E&gt; c)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (c == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;comparator can not be null&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//        插入排序进行 链表的排序</span></span><br><span class="line"><span class="comment">//        此处的出入排序的时间复杂度为O(n^3) 故而用插入排序不合适</span></span><br><span class="line"><span class="comment">//        for (int i = 0; i &lt; size; i++) &#123;</span></span><br><span class="line"><span class="comment">//            E e = get(i);</span></span><br><span class="line"><span class="comment">//            int j = 0;</span></span><br><span class="line"><span class="comment">//            for (j = i; j &gt; 0 &amp;&amp; c.compare(get(j - 1), e) &gt; 0; j--) &#123;</span></span><br><span class="line"><span class="comment">//                set(j, get(j - 1));</span></span><br><span class="line"><span class="comment">//            &#125;</span></span><br><span class="line"><span class="comment">//            set(j, e);</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//故而借助于选择排序来进行排序</span></span><br><span class="line">        <span class="comment">//选择 选择排序的原因是因为 选择排序和冒泡排序 的整体数据向后 后移</span></span><br><span class="line">        <span class="comment">//时间复杂度为O(n^2)</span></span><br><span class="line">        <span class="keyword">if</span> (size == <span class="number">0</span> || size == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">nodeA</span> <span class="operator">=</span> head;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">nodeB</span> <span class="operator">=</span> nodeA.next;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (c.compare(nodeA.data, nodeB.data) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    swap(nodeA, nodeB);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (nodeB == tail) &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                nodeB = nodeB.next;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (nodeA.next == tail) &#123;</span><br><span class="line">                <span class="comment">//避免空指针异常</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            nodeA = nodeA.next;</span><br><span class="line">            nodeB = nodeA.next;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">swap</span><span class="params">(Node nodeA, Node nodeB)</span> &#123;</span><br><span class="line">        <span class="type">E</span> <span class="variable">tmp</span> <span class="operator">=</span> nodeA.data;</span><br><span class="line">        nodeA.data = nodeB.data;</span><br><span class="line">        nodeB.data = tmp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;E&gt; <span class="title function_">subList</span><span class="params">(<span class="type">int</span> fromIndex, <span class="type">int</span> toIndex)</span> &#123;</span><br><span class="line">        <span class="comment">//0 &lt;= fromIndex &lt;= toIndex &lt;= size - 1 [fromIndex,toIndex]</span></span><br><span class="line">        <span class="keyword">if</span> (fromIndex &lt; <span class="number">0</span> || toIndex &gt;= size || fromIndex &gt; toIndex) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;must 0 &lt;= fromIndex &lt;= toIndex &lt;= size&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        LinkedSinglyList&lt;E&gt; list = <span class="keyword">new</span> <span class="title class_">LinkedSinglyList</span>&lt;&gt;();</span><br><span class="line">        </span><br><span class="line"><span class="comment">//        时间复杂度相当于 O(n^2)</span></span><br><span class="line"><span class="comment">//        for (int i = fromIndex; i &lt;= toIndex; i++) &#123;</span></span><br><span class="line"><span class="comment">//            list.add(get(i));</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line"><span class="comment">//        return list;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//整体时间复杂度为O(n)</span></span><br><span class="line">        <span class="type">Node</span> <span class="variable">nodeA</span> <span class="operator">=</span> head;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; fromIndex; i++) &#123;</span><br><span class="line">            nodeA = nodeA.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">nodeB</span> <span class="operator">=</span> head;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; toIndex; i++) &#123;</span><br><span class="line">            nodeB = nodeB.next;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">Node</span> <span class="variable">p</span> <span class="operator">=</span> nodeA;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            list.add(p.data);</span><br><span class="line">            <span class="keyword">if</span> (p == nodeB) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            p = p.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        sb.append(<span class="string">&#x27;[&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (isEmpty()) &#123;</span><br><span class="line">            sb.append(<span class="string">&#x27;]&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">p</span> <span class="operator">=</span> head;</span><br><span class="line">            <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">                sb.append(p.data);</span><br><span class="line">                <span class="keyword">if</span> (p == tail) &#123;</span><br><span class="line">                    sb.append(<span class="string">&#x27;]&#x27;</span>);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                sb.append(<span class="string">&#x27;,&#x27;</span>);</span><br><span class="line">                sb.append(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">                p = p.next;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Iterator&lt;E&gt; <span class="title function_">iterator</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">LinkedSinglyCircularListIterator</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">LinkedSinglyCircularListIterator</span> <span class="keyword">implements</span> <span class="title class_">Iterator</span>&lt;E&gt; &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="type">Node</span> <span class="variable">cur</span> <span class="operator">=</span> head;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">true</span>;   <span class="comment">//是否在第一圈</span></span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">hasNext</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (isEmpty()) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> flag;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> E <span class="title function_">next</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="type">E</span> <span class="variable">ret</span> <span class="operator">=</span> cur.data;</span><br><span class="line">            cur = cur.next;</span><br><span class="line">            <span class="keyword">if</span> (cur == head) &#123;</span><br><span class="line">                flag = <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ret;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//约瑟夫环问题</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">josephusLoop</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (size &lt;= <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">p</span> <span class="operator">=</span> head;</span><br><span class="line">        <span class="keyword">while</span> (size != <span class="number">2</span>) &#123;</span><br><span class="line">            p = p.next;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">del</span> <span class="operator">=</span> p.next;</span><br><span class="line">            <span class="keyword">if</span> (del == head) &#123;</span><br><span class="line">                head = del.next;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (del == tail) &#123;</span><br><span class="line">                tail = p;</span><br><span class="line">            &#125;</span><br><span class="line">            p.next = del.next;</span><br><span class="line">            del.next = <span class="literal">null</span>;</span><br><span class="line">            p = p.next;</span><br><span class="line">            size--;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//链表反转</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">reverse</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (size == <span class="number">0</span> || size == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//创建虚拟头结点</span></span><br><span class="line">        <span class="type">Node</span> <span class="variable">dummpyHead</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Node</span>();</span><br><span class="line">        <span class="type">Node</span> <span class="variable">p</span> <span class="operator">=</span> head;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">n</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Node</span>(p.data);</span><br><span class="line">            <span class="keyword">if</span> (dummpyHead.next == <span class="literal">null</span>) &#123;</span><br><span class="line">                tail = n;</span><br><span class="line">            &#125;</span><br><span class="line">            n.next = dummpyHead.next;</span><br><span class="line">            dummpyHead.next = n;</span><br><span class="line">            p = p.next;</span><br><span class="line">        &#125;</span><br><span class="line">        head = dummpyHead.next;</span><br><span class="line">        dummpyHead.next = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//拉丁方阵问题???</span></span><br><span class="line">    <span class="comment">//反转不利用新结点，只使用自己的结点</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意</p>
<ul>
<li>Iterator 迭代器 判断是否走了一圈问题<code>private boolean flag = true;   // 判断是否在第一圈</code></li>
</ul>
<blockquote>
<p><strong>单向循环链表相关应用</strong></p>
</blockquote>
<ul>
<li>约瑟夫环问题</li>
<li>逢七过问题</li>
</ul>
<p>SevenGame</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P3.chainStructure;</span><br><span class="line"></span><br><span class="line"><span class="comment">//逢七过游戏</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">输入玩家个数</span></span><br><span class="line"><span class="comment">输入从哪个玩家开始</span></span><br><span class="line"><span class="comment">输入从哪个个数开始</span></span><br><span class="line"><span class="comment">输入一共玩几个数字</span></span><br><span class="line"><span class="comment">打印出每个玩家将要报出的所有数字</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> P2.linearStructure.ArrayList;</span><br><span class="line"><span class="keyword">import</span> com.sun.xml.internal.stream.StaxErrorReporter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SevenGame</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">input</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        System.out.println(<span class="string">&quot;&gt;&gt;&gt;请输入玩家的个数：&quot;</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">playerCount</span> <span class="operator">=</span> input.nextInt();</span><br><span class="line">        System.out.println(<span class="string">&quot;&gt;&gt;&gt;请输入从哪个玩家开始：&quot;</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">beginPlayer</span> <span class="operator">=</span> input.nextInt();</span><br><span class="line">        System.out.println(<span class="string">&quot;&gt;&gt;&gt;请输入从哪个数字开始：&quot;</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">beginNumber</span> <span class="operator">=</span> input.nextInt();</span><br><span class="line">        System.out.println(<span class="string">&quot;&gt;&gt;&gt;请输入数字的最大值：&quot;</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">maxNumber</span> <span class="operator">=</span> input.nextInt();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//创建玩家的集合</span></span><br><span class="line">        LinkedSinglyCircularList&lt;ArrayList&lt;String&gt;&gt; list = <span class="keyword">new</span> <span class="title class_">LinkedSinglyCircularList</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">//创建玩家对应的对象ArrayList</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; playerCount; i++) &#123;</span><br><span class="line">            list.add(<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//开始玩家的索引</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> beginPlayer - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//将数字依次分给每个玩家</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> beginNumber; num &lt;= maxNumber; num++) &#123;</span><br><span class="line"><span class="comment">//            String answer = getAnswer(num);</span></span><br><span class="line">            list.get(index++ % playerCount).add(getAnswer(num));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; list.size(); i++ ) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;第&quot;</span> + (i + <span class="number">1</span>) + <span class="string">&quot;位玩家：&quot;</span> + list.get(i));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">getAnswer</span><span class="params">(<span class="type">int</span> num)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (num % <span class="number">7</span> == <span class="number">0</span> || (num + <span class="string">&quot;&quot;</span>).contains(<span class="string">&quot;7&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;过&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> num + <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h4 id="双向循环链表"><a href="#双向循环链表" class="headerlink" title="双向循环链表"></a>双向循环链表</h4><blockquote>
<p><strong>双向循环链表性质</strong></p>
</blockquote>
<ul>
<li>定义<strong>头指针</strong>与<strong>尾指针</strong> –辅助操作链表</li>
<li>头尾节点相连 <strong>尾节点指向头节点</strong> 形成循环</li>
<li>可<strong>双向传递位置节点</strong> &#x3D;&#x3D;每个节点指针域&#x3D;&#x3D; 有 <code>pre</code> 与 <code>next</code> 两个指针来确定位置</li>
</ul>
<blockquote>
<p><strong>手写代码实现</strong></p>
</blockquote>
<p>LinkedList</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P3.chainStructure;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> P1.Interface.Dequeue;</span><br><span class="line"><span class="keyword">import</span> P1.Interface.List;</span><br><span class="line"><span class="keyword">import</span> P1.Interface.Stack;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Comparator;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//双向循环链表</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LinkedList</span>&lt;E&gt; <span class="keyword">implements</span> <span class="title class_">List</span>&lt;E&gt; , Dequeue&lt;E&gt; , Stack&lt;E&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addFirst</span><span class="params">(E element)</span> &#123;</span><br><span class="line">        add(<span class="number">0</span>, element);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addLast</span><span class="params">(E element)</span> &#123;</span><br><span class="line">        add(size, element);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">removeFirst</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> remove(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">reomveLast</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> remove(size - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">getFirst</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> get(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">getLast</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> get(size - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">class</span> <span class="title class_">Node</span> &#123;</span><br><span class="line">        <span class="comment">//数据域</span></span><br><span class="line">        E data;</span><br><span class="line">        <span class="comment">//直接前驱</span></span><br><span class="line">        Node pre;</span><br><span class="line">        <span class="comment">//直接后继</span></span><br><span class="line">        Node next;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>(<span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">(E data)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>(data, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">(E data, Node pre, Node next)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.data = data;</span><br><span class="line">            <span class="built_in">this</span>.pre = pre;</span><br><span class="line">            <span class="built_in">this</span>.next = next;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> data.toString();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Node head;</span><br><span class="line">    <span class="keyword">private</span> Node tail;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> size;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">LinkedList</span><span class="params">()</span> &#123;</span><br><span class="line">        head = <span class="literal">null</span>;</span><br><span class="line">        tail = <span class="literal">null</span>;</span><br><span class="line">        size = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">LinkedList</span><span class="params">(E[] arr)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (arr == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;arr can not be null&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (E e : arr) &#123;</span><br><span class="line">            add(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(E element)</span> &#123;</span><br><span class="line">        add(size, element);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> index, E element)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (index &lt; <span class="number">0</span> || index &gt; size) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;add index out of range&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">n</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Node</span>(element);</span><br><span class="line">        <span class="keyword">if</span> (size == <span class="number">0</span>) &#123;</span><br><span class="line">            head = n;</span><br><span class="line">            tail = n;</span><br><span class="line">            tail.next = head;</span><br><span class="line">            head.pre = tail;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (index == <span class="number">0</span>) &#123;</span><br><span class="line">            n.pre = head.pre;</span><br><span class="line">            n.next = head;</span><br><span class="line">            head.pre = n;</span><br><span class="line">            head = n;</span><br><span class="line">            tail.next = head;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (index == size) &#123;</span><br><span class="line">            n.next = tail.next;</span><br><span class="line">            tail.next = n;</span><br><span class="line">            n.pre = tail;</span><br><span class="line">            tail = n;</span><br><span class="line">            head.pre = tail;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            Node p, q;</span><br><span class="line">            <span class="keyword">if</span> (index &lt;= size / <span class="number">2</span>) &#123;</span><br><span class="line">                p = head;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; index - <span class="number">1</span>; i++) &#123;</span><br><span class="line">                    p = p.next;</span><br><span class="line">                &#125;</span><br><span class="line">                q = p.next;</span><br><span class="line">                p.next = n;</span><br><span class="line">                n.pre = p;</span><br><span class="line">                q.pre = n;</span><br><span class="line">                n.next = q;</span><br><span class="line">            &#125; <span class="keyword">else</span>  &#123;</span><br><span class="line">                p = tail;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> size - <span class="number">1</span>; i &gt; index; i--) &#123;</span><br><span class="line">                    p = p.pre;</span><br><span class="line">                &#125;</span><br><span class="line">                q = p.pre;</span><br><span class="line">                q.next = n;</span><br><span class="line">                n.pre = q;</span><br><span class="line">                n.next = p;</span><br><span class="line">                p.pre = n;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        size++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">remove</span><span class="params">(E element)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> indexOf(element);</span><br><span class="line">        <span class="keyword">if</span> (index != -<span class="number">1</span>) &#123;</span><br><span class="line">            remove(index);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">remove</span><span class="params">(<span class="type">int</span> index)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (index &lt; <span class="number">0</span> || index &gt;= size) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;remove index out of range&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">E</span> <span class="variable">ret</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        Node node;</span><br><span class="line">        <span class="keyword">if</span> (size == <span class="number">1</span>) &#123;</span><br><span class="line">            ret = head.data;</span><br><span class="line">            head = <span class="literal">null</span>;</span><br><span class="line">            tail = <span class="literal">null</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (index == <span class="number">0</span>) &#123;</span><br><span class="line">            ret = head.data;;</span><br><span class="line">            node = head.next;</span><br><span class="line">            head.next = <span class="literal">null</span>;</span><br><span class="line">            node.pre = head.pre;</span><br><span class="line">            head.pre = <span class="literal">null</span>;</span><br><span class="line">            head = node;</span><br><span class="line">            tail.next = node;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (index == size - <span class="number">1</span>) &#123;</span><br><span class="line">            ret = tail.data;</span><br><span class="line">            node = tail.pre;</span><br><span class="line">            tail.pre = <span class="literal">null</span>;</span><br><span class="line">            node.next = tail.next;</span><br><span class="line">            tail.next = <span class="literal">null</span>;</span><br><span class="line">            tail = node;</span><br><span class="line">            head.pre = node;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            Node p, q, r;</span><br><span class="line">            <span class="keyword">if</span> (index &lt;= size / <span class="number">2</span>) &#123;</span><br><span class="line">                p = head;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; index - <span class="number">1</span>; i++) &#123;</span><br><span class="line">                    p = p.next;</span><br><span class="line">                &#125;</span><br><span class="line">                q = p.next;</span><br><span class="line">                r = q.next;</span><br><span class="line">                ret = q.data;</span><br><span class="line">                p.next = r;</span><br><span class="line">                r.pre = p;</span><br><span class="line">                q.next = <span class="literal">null</span>;</span><br><span class="line">                q.pre = <span class="literal">null</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                p = tail;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> size - <span class="number">1</span>; i &gt; index + <span class="number">1</span>; i--) &#123;</span><br><span class="line">                    p = p.pre;</span><br><span class="line">                &#125;</span><br><span class="line">                q = p.pre;</span><br><span class="line">                r = q.pre;</span><br><span class="line">                ret = q.data;</span><br><span class="line">                r.next = p;</span><br><span class="line">                p.pre = r;</span><br><span class="line">                q.next = <span class="literal">null</span>;</span><br><span class="line">                q.pre = <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        size--;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">get</span><span class="params">(<span class="type">int</span> index)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (index &lt; <span class="number">0</span> || index &gt;= size) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;get index out of range&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (index == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> head.data;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (index == size - <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> tail.data;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">p</span> <span class="operator">=</span> head;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; index; i++) &#123;</span><br><span class="line">                p = p.next;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> p.data;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">set</span><span class="params">(<span class="type">int</span> index, E element)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (index &lt; <span class="number">0</span> || index &gt;= size) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;get index out of range&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">E</span> <span class="variable">ret</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (index == <span class="number">0</span>) &#123;</span><br><span class="line">            ret = head.data;</span><br><span class="line">            head.data = element;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (index == size - <span class="number">1</span>) &#123;</span><br><span class="line">            ret = tail.data;</span><br><span class="line">            tail.data = element;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">p</span> <span class="operator">=</span> head;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; index; i++) &#123;</span><br><span class="line">                p = p.next;</span><br><span class="line">            &#125;</span><br><span class="line">            ret = p.data;</span><br><span class="line">            p.data = element;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> size;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">indexOf</span><span class="params">(E element)</span> &#123;</span><br><span class="line">        <span class="comment">//判空的操作 在测试TreeSet时发现bug 已修改 2022.2.15 23:37</span></span><br><span class="line">        <span class="keyword">if</span> (isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">p</span> <span class="operator">=</span> head;</span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (!p.data.equals(element)) &#123;</span><br><span class="line">            p = p.next;</span><br><span class="line">            index++;</span><br><span class="line">            <span class="keyword">if</span> (p == head) &#123;</span><br><span class="line">                <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> index;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">contains</span><span class="params">(E element)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> indexOf(element) != -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">offer</span><span class="params">(E element)</span> &#123;</span><br><span class="line">        addLast(element);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">poll</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> removeFirst();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">element</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> getFirst();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> size == <span class="number">0</span> &amp;&amp; head == <span class="literal">null</span> &amp;&amp; head == <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">push</span><span class="params">(E element)</span> &#123;</span><br><span class="line">        addLast(element);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">pop</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> reomveLast();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">peek</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> getLast();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">clear</span><span class="params">()</span> &#123;</span><br><span class="line">        head = <span class="literal">null</span>;</span><br><span class="line">        tail = <span class="literal">null</span>;</span><br><span class="line">        size = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sort</span><span class="params">(Comparator&lt;E&gt; c)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (c == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;comparator can not be null&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//使用插入排序来做</span></span><br><span class="line">        <span class="keyword">if</span> (size == <span class="number">0</span> || size == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">Node</span> <span class="variable">nodeA</span> <span class="operator">=</span> head.next; nodeA != head; nodeA = nodeA.next) &#123;</span><br><span class="line">            <span class="type">E</span> <span class="variable">e</span> <span class="operator">=</span> nodeA.data;</span><br><span class="line">            Node nodeB;</span><br><span class="line">            Node nodeC;</span><br><span class="line">            <span class="keyword">for</span> (nodeB = nodeA, nodeC = nodeB.pre; nodeC != tail &amp;&amp; c.compare(nodeC.data, e) &gt; <span class="number">0</span> ; nodeB = nodeB.pre, nodeC = nodeC.pre) &#123;</span><br><span class="line">                nodeB.data = nodeC.data;</span><br><span class="line">            &#125;</span><br><span class="line">            nodeB.data = e;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;E&gt; <span class="title function_">subList</span><span class="params">(<span class="type">int</span> fromIndex, <span class="type">int</span> toIndex)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (fromIndex &lt; <span class="number">0</span> || toIndex &gt;= size || fromIndex &gt; toIndex) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;must 0 &lt;= fromIndex &lt;= toIndex &lt;= size&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">nodeA</span> <span class="operator">=</span> head;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; fromIndex; i++) &#123;</span><br><span class="line">            nodeA = nodeA.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">nodeB</span> <span class="operator">=</span> head;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; toIndex; i++) &#123;</span><br><span class="line">            nodeB = nodeB.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">p</span> <span class="operator">=</span> nodeA;</span><br><span class="line">        LinkedList&lt;E&gt; list = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            list.add(p.data);</span><br><span class="line">            <span class="keyword">if</span> (p == nodeB) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            p = p.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        sb.append(<span class="string">&#x27;[&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (isEmpty()) &#123;</span><br><span class="line">            sb.append(<span class="string">&#x27;]&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">p</span> <span class="operator">=</span> head;</span><br><span class="line">            <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">                sb.append(p.data);</span><br><span class="line">                <span class="keyword">if</span> (p == tail) &#123;</span><br><span class="line">                    sb.append(<span class="string">&#x27;]&#x27;</span>);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                sb.append(<span class="string">&#x27;,&#x27;</span>);</span><br><span class="line">                sb.append(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">                p = p.next;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Iterator&lt;E&gt; <span class="title function_">iterator</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">LinkedListIterator</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">LinkedListIterator</span> <span class="keyword">implements</span> <span class="title class_">Iterator</span>&lt;E&gt; &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="type">Node</span> <span class="variable">cur</span> <span class="operator">=</span> head;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">true</span>;   <span class="comment">//是否在第一圈</span></span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">hasNext</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (isEmpty()) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> flag;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> E <span class="title function_">next</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="type">E</span> <span class="variable">ret</span> <span class="operator">=</span> cur.data;</span><br><span class="line">            cur = cur.next;</span><br><span class="line">            <span class="keyword">if</span> (cur == head) &#123;</span><br><span class="line">                flag = <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ret;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="链栈"><a href="#链栈" class="headerlink" title="链栈"></a>链栈</h4><h4 id="链队列"><a href="#链队列" class="headerlink" title="链队列"></a>链队列</h4><h2 id="非线性结构"><a href="#非线性结构" class="headerlink" title="非线性结构"></a>非线性结构</h2><h3 id="集合"><a href="#集合" class="headerlink" title="集合"></a>集合</h3><blockquote>
<p><strong>Set特点</strong></p>
</blockquote>
<ul>
<li>存储不重复元素的容器</li>
<li>链表实现 LinkedSet 有序</li>
<li>二分搜索树实现 TreeSet 有序 自然排序</li>
<li>哈希表实现 HashSet 无序</li>
</ul>
<blockquote>
<p><strong>Map特点</strong></p>
</blockquote>
<ul>
<li>存储键值对数据 K V</li>
<li>根据键 Key 查询值 Value</li>
<li>链表实现 LinkedMap 有序</li>
<li>二分搜索树实现 TreeMap 有序 键自然排序</li>
<li>哈希表实现 HashMap 无序</li>
</ul>
<h4 id="LinkedSet"><a href="#LinkedSet" class="headerlink" title="LinkedSet"></a>LinkedSet</h4><blockquote>
<p><strong>LinkedSet特点</strong></p>
</blockquote>
<ul>
<li>存储不重复元素</li>
<li>链表实现 LinkedSet 且有序</li>
</ul>
<blockquote>
<p><strong>手写代码实现</strong></p>
</blockquote>
<p>LinkedSet</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P7.TreeStructure;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> P1.Interface.Set;</span><br><span class="line"><span class="keyword">import</span> P3.chainStructure.LinkedList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="comment">//底层由链表实现的集合</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LinkedSet</span>&lt;E&gt; <span class="keyword">implements</span> <span class="title class_">Set</span>&lt;E&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> LinkedList&lt;E&gt; list;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">LinkedSet</span><span class="params">()</span> &#123;</span><br><span class="line">        list = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(E e)</span> &#123;</span><br><span class="line">        <span class="comment">//O(n)</span></span><br><span class="line">        <span class="keyword">if</span> (!list.contains(e)) &#123;</span><br><span class="line">            list.add(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">remove</span><span class="params">(E e)</span> &#123;</span><br><span class="line">        <span class="comment">//O(n)</span></span><br><span class="line">        list.remove(e);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">contains</span><span class="params">(E e)</span> &#123;</span><br><span class="line">        <span class="comment">//O(n)</span></span><br><span class="line">        <span class="keyword">return</span> list.contains(e);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> list.size();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> list.isEmpty();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> list.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Iterator&lt;E&gt; <span class="title function_">iterator</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> list.iterator();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="TreeSet"><a href="#TreeSet" class="headerlink" title="TreeSet"></a>TreeSet</h4><blockquote>
<p><strong>TreeSet特点</strong></p>
</blockquote>
<ul>
<li>存储不重复元素</li>
<li>二分搜索树实现 TreeSet 有序 自然排序</li>
</ul>
<blockquote>
<p><strong>手写代码实现</strong></p>
</blockquote>
<p>TreeSet</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P7.TreeStructure;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> P1.Interface.Set;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="comment">//底层由二分搜索树BST实现的集合</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TreeSet</span>&lt;E <span class="keyword">extends</span> <span class="title class_">Comparable</span>&lt;E&gt;&gt; <span class="keyword">implements</span> <span class="title class_">Set</span>&lt;E&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> BinarySearchTree&lt;E&gt; bst;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">TreeSet</span><span class="params">()</span> &#123;</span><br><span class="line">        bst = <span class="keyword">new</span> <span class="title class_">BinarySearchTree</span>&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(E e)</span> &#123;</span><br><span class="line">        <span class="comment">//O(logn)</span></span><br><span class="line">        bst.add(e);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">remove</span><span class="params">(E e)</span> &#123;</span><br><span class="line">        <span class="comment">//O(logn)</span></span><br><span class="line">        bst.remove(e);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">contains</span><span class="params">(E e)</span> &#123;</span><br><span class="line">        <span class="comment">//O(logn)</span></span><br><span class="line">        <span class="keyword">return</span> bst.contains(e);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> bst.size();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> bst.isEmpty();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> bst.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Iterator&lt;E&gt; <span class="title function_">iterator</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> bst.iterator();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="TreeMap"><a href="#TreeMap" class="headerlink" title="TreeMap"></a>TreeMap</h4><blockquote>
<p><strong>TreeMap特点</strong></p>
</blockquote>
<ul>
<li>存储键值对数据 K V</li>
<li>二分搜索树实现 TreeMap 有序 键自然排序</li>
</ul>
<blockquote>
<p><strong>手写代码实现</strong></p>
</blockquote>
<p>TreeMap</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P7.TreeStructure;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> P1.Interface.List;</span><br><span class="line"><span class="keyword">import</span> P1.Interface.Map;</span><br><span class="line"><span class="keyword">import</span> P1.Interface.Set;</span><br><span class="line"><span class="keyword">import</span> P3.chainStructure.LinkedList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TreeMap</span>&lt;K <span class="keyword">extends</span> <span class="title class_">Comparable</span>&lt;K&gt;, V&gt; <span class="keyword">implements</span> <span class="title class_">Map</span>&lt;K, V&gt;, Iterable&lt;Map.Entry&lt;K, V&gt;&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">class</span> <span class="title class_">Node</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> K key;   <span class="comment">//键</span></span><br><span class="line">        <span class="keyword">public</span> V value; <span class="comment">//值</span></span><br><span class="line">        <span class="keyword">public</span> Node left;</span><br><span class="line">        <span class="keyword">public</span> Node right;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">()</span> &#123;&#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">(K key, V value)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.key = key;</span><br><span class="line">            <span class="built_in">this</span>.value = value;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&#123;&quot;</span> + key + <span class="string">&quot;, &quot;</span> + value + <span class="string">&quot;&#125;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Node root;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> size;   <span class="comment">//键值对个数</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">TreeMap</span><span class="params">()</span> &#123;</span><br><span class="line">        root = <span class="literal">null</span>;</span><br><span class="line">        size = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//辅助函数 获取指定key所在的结点</span></span><br><span class="line">    <span class="comment">//以node为根的二分搜索树中 查找 key 所在的结点 --递归方式</span></span><br><span class="line">    <span class="keyword">private</span> Node <span class="title function_">getNode</span><span class="params">(Node node, K key)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (node == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (key.compareTo(node.key) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> getNode(node.left, key);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (key.compareTo(node.key) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> getNode(node.right, key);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> node;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">put</span><span class="params">(K key, V value)</span> &#123;</span><br><span class="line">        root = put(root, key, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Node <span class="title function_">put</span><span class="params">(Node node, K key, V value)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (node == <span class="literal">null</span>) &#123;</span><br><span class="line">            size++;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Node</span>(key, value);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (key.compareTo(node.key) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            node.left = put(node.left, key, value);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (key.compareTo(node.key) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            node.right = put(node.right, key, value);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//如果key已经存在 则put为修改</span></span><br><span class="line">            node.value = value;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> node;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> V <span class="title function_">remove</span><span class="params">(K key)</span> &#123;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">delNode</span> <span class="operator">=</span> getNode(root, key);</span><br><span class="line">        <span class="keyword">if</span> (delNode != <span class="literal">null</span>) &#123;</span><br><span class="line">            root = remove(root, key);</span><br><span class="line">            <span class="keyword">return</span> delNode.value;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Node <span class="title function_">remove</span><span class="params">(Node node, K key)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (node == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (key.compareTo(node.key) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            node.left = remove(node.left, key);</span><br><span class="line">            <span class="keyword">return</span> node;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (key.compareTo(node.key) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            node.right = remove(node.right, key);</span><br><span class="line">            <span class="keyword">return</span> node;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (node.left == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="type">Node</span> <span class="variable">rightNode</span> <span class="operator">=</span> node.right;</span><br><span class="line">                node.right =<span class="literal">null</span>;</span><br><span class="line">                size--;</span><br><span class="line">                <span class="keyword">return</span> rightNode;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (node.right == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="type">Node</span> <span class="variable">leftNode</span> <span class="operator">=</span> node.left;</span><br><span class="line">                node.left = <span class="literal">null</span>;</span><br><span class="line">                size--;</span><br><span class="line">                <span class="keyword">return</span> leftNode;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">successor</span> <span class="operator">=</span> minimum(node.right);</span><br><span class="line">            successor.right = removeMin(node.right);</span><br><span class="line">            successor.left = node.left;</span><br><span class="line">            node.left = node.right = <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">return</span> successor;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Node <span class="title function_">removeMin</span><span class="params">(Node node)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (node.left == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">rightNode</span> <span class="operator">=</span> node.right;</span><br><span class="line">            node.right = <span class="literal">null</span>;</span><br><span class="line">            size--;</span><br><span class="line">            <span class="keyword">return</span> rightNode;</span><br><span class="line">        &#125;</span><br><span class="line">        node.left = removeMin(node.left);</span><br><span class="line">        <span class="keyword">return</span> node;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Node <span class="title function_">minimum</span><span class="params">(Node node)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (node.left == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> node;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> minimum(node.left);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">contains</span><span class="params">(K key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> getNode(root, key) != <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> V <span class="title function_">get</span><span class="params">(K key)</span> &#123;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">node</span> <span class="operator">=</span> getNode(root, key);</span><br><span class="line">        <span class="keyword">if</span> (node != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> node.value;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">set</span><span class="params">(K key, V value)</span> &#123;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">node</span> <span class="operator">=</span> getNode(root, key);</span><br><span class="line">        <span class="keyword">if</span> (node == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;key-value is not exist&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        node.value = value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> size;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> size == <span class="number">0</span> &amp;&amp; root == <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取所有键的Set</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Set&lt;K&gt; <span class="title function_">keySet</span><span class="params">()</span> &#123;</span><br><span class="line">        TreeSet&lt;K&gt; set = <span class="keyword">new</span> <span class="title class_">TreeSet</span>&lt;&gt;();</span><br><span class="line">        inOrderKeySet(root, set);</span><br><span class="line">        <span class="keyword">return</span> set;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">inOrderKeySet</span><span class="params">(Node node, TreeSet&lt;K&gt; set)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (node == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        inOrderKeySet(node.left, set);</span><br><span class="line">        set.add(node.key);</span><br><span class="line">        inOrderKeySet(node.right, set);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取所有值的List</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;V&gt; <span class="title function_">values</span><span class="params">()</span> &#123;</span><br><span class="line">        LinkedList&lt;V&gt; list = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        inOrderValues(root, list);</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">inOrderValues</span><span class="params">(Node node, LinkedList&lt;V&gt; list)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (node == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        inOrderValues(node.left, list);</span><br><span class="line">        list.add(node.value);</span><br><span class="line">        inOrderValues(node.right, list);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取键值对</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Set&lt;Entry&lt;K, V&gt;&gt; <span class="title function_">entrySet</span><span class="params">()</span> &#123;</span><br><span class="line">        TreeSet&lt;Entry&lt;K, V&gt;&gt; entries = <span class="keyword">new</span> <span class="title class_">TreeSet</span>&lt;&gt;();</span><br><span class="line">        inOrderEntrys(root, entries);</span><br><span class="line">        <span class="keyword">return</span> entries;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">inOrderEntrys</span><span class="params">(Node node, TreeSet&lt;Entry&lt;K,V&gt;&gt; entries)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (node == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        inOrderEntrys(node.left, entries);</span><br><span class="line">        entries.add(<span class="keyword">new</span> <span class="title class_">BSTEntry</span>&lt;&gt;(node.key, node.value));</span><br><span class="line">        inOrderEntrys(node.right, entries);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//自己实现homework</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//自己实现homework</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Iterator&lt;Entry&lt;K, V&gt;&gt; <span class="title function_">iterator</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//键值对 对象 进行封装</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">class</span> <span class="title class_">BSTEntry</span>&lt;K <span class="keyword">extends</span> <span class="title class_">Comparable</span>&lt;K&gt;, V&gt; <span class="keyword">implements</span> <span class="title class_">Entry</span>&lt;K, V&gt; &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> K key;</span><br><span class="line">        <span class="keyword">private</span> V value;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">BSTEntry</span><span class="params">(K key, V value)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.key = key;</span><br><span class="line">            <span class="built_in">this</span>.value = value;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> K <span class="title function_">getKey</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> key;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> V <span class="title function_">getValue</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> value;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> key + <span class="string">&quot;:&quot;</span> + value;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compareTo</span><span class="params">(Entry&lt;K, V&gt; o)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>.getKey().compareTo(o.getKey()) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="散列结构"><a href="#散列结构" class="headerlink" title="散列结构"></a>散列结构</h3><h4 id="哈希表"><a href="#哈希表" class="headerlink" title="哈希表"></a>哈希表</h4><blockquote>
<p><strong>HashTable特点</strong></p>
</blockquote>
<ul>
<li>散列表也叫哈希表 根据 K-V 直接访问数据结构。通过关键码值映射到表中位置来访问记录，来加快查找速度。此映射函数叫做散列函数，存放记录的数组叫做散列表</li>
<li>给定表 M，存在函数 f(key)，对任意给定关键字值 key，代入函数后能得到包含该关键字记录在表中的地址，此表 M 为哈希 (Hash) 表，函数 f(key) 为哈希函数</li>
<li>key通过哈希函数得到的索引分布越均匀越好 –通常我们只关注哈希函数的设计</li>
<li>哈希函数的设计原则遵循<ul>
<li>一致性</li>
<li>高效性</li>
<li>均匀性</li>
</ul>
</li>
<li>整型 hash函数设计<ul>
<li>小范围正整数直接使用</li>
<li>小范围负整数进行偏移处理 -100 ~ 100 &#x3D;&gt; 0 ~ 200</li>
<li>大规模整数进行取模处理 –有局限 分布不均匀 没有利用所有key 增加了hash冲突 –常见解决方法 模一个素数 本质是数论问题</li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>手写代码实现</strong></p>
</blockquote>
<p>HashTable</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P7.TreeStructure;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> P1.Interface.List;</span><br><span class="line"><span class="keyword">import</span> P1.Interface.Map;</span><br><span class="line"><span class="keyword">import</span> P1.Interface.Set;</span><br><span class="line"><span class="keyword">import</span> P3.chainStructure.LinkedList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HashTable</span>&lt;K <span class="keyword">extends</span> <span class="title class_">Comparable</span>&lt;K&gt;, V&gt; <span class="keyword">implements</span> <span class="title class_">Map</span>&lt;K, V&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//哈希表要缩容和扩容 但不是简单的×2 ÷2 而是利用素数表</span></span><br><span class="line">    <span class="comment">// 哈希表预设容量</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span>[] capacity = &#123;</span><br><span class="line">            <span class="number">53</span>, <span class="number">97</span>, <span class="number">193</span>, <span class="number">389</span>, <span class="number">769</span>, <span class="number">1543</span>, <span class="number">3079</span>, <span class="number">6151</span>, <span class="number">12289</span>, <span class="number">24593</span>,</span><br><span class="line">            <span class="number">49157</span>, <span class="number">98317</span>, <span class="number">196613</span>, <span class="number">393241</span>, <span class="number">768433</span>, <span class="number">1572869</span>, <span class="number">3145739</span>, <span class="number">6291469</span>,</span><br><span class="line">            <span class="number">12582917</span>, <span class="number">25165843</span>, <span class="number">50331653</span>, <span class="number">100663319</span>, <span class="number">201326611</span>, <span class="number">402653189</span>, <span class="number">805306457</span>, <span class="number">1610612741</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//哈希表中每个桶的上限和下限 超过上限需要扩容 小于下限需要缩容 避免极端高瘦或者矮胖的情况</span></span><br><span class="line">    <span class="comment">//主要因为每个桶最多有N/M个元素</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">upperTol</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">lowerTol</span> <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//素数表中的索引 用来标记当前哈希表的长度 扩容++ 缩容--</span></span><br><span class="line">    <span class="keyword">private</span>  <span class="type">int</span> <span class="variable">capacityIndex</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//M当前哈希表中桶的个数</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> M;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//size当前哈希表中元素的个数</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> size;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//桶的定义:平衡树的数组</span></span><br><span class="line">    <span class="keyword">private</span> AVLTreeMap&lt;K, V&gt;[] hashTable;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">HashTable</span><span class="params">()</span> &#123;</span><br><span class="line">        M = capacity[capacityIndex];</span><br><span class="line">        hashTable = <span class="keyword">new</span> <span class="title class_">AVLTreeMap</span>[M];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; M; i++) &#123;</span><br><span class="line">            hashTable[i] = <span class="keyword">new</span> <span class="title class_">AVLTreeMap</span>&lt;&gt;();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="title function_">hash</span><span class="params">(K key)</span> &#123;</span><br><span class="line">        <span class="comment">//获取key的哈希值 纠正正负数 再对M取余 得到要去的桶的索引</span></span><br><span class="line">        <span class="keyword">return</span> key.hashCode() &amp;<span class="number">0x7fffffff</span> % M;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">put</span><span class="params">(K key, V value)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> hash(key);</span><br><span class="line">        AVLTreeMap&lt;K, V&gt; map = hashTable[index];</span><br><span class="line">        <span class="keyword">if</span> (map.contains(key)) &#123;</span><br><span class="line">            <span class="comment">//如果该桶中已经包含该键key所对应的键值对 --修改即可</span></span><br><span class="line">            map.put(key, value);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//在该桶中新增一个键值对</span></span><br><span class="line">            map.put(key, value);</span><br><span class="line">            size++;</span><br><span class="line">            <span class="comment">//新增元素后考虑扩容</span></span><br><span class="line">            <span class="keyword">if</span> (size &gt; upperTol * M &amp;&amp; capacityIndex + <span class="number">1</span> &lt; capacity.length) &#123;</span><br><span class="line">                capacityIndex++;</span><br><span class="line">                resize(capacity[capacityIndex]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> V <span class="title function_">remove</span><span class="params">(K key)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> hash(key);</span><br><span class="line">        AVLTreeMap&lt;K, V&gt; map = hashTable[index];</span><br><span class="line">        <span class="type">V</span> <span class="variable">ret</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (map.contains(key)) &#123;</span><br><span class="line">            ret = map.remove(key);</span><br><span class="line">            size--;</span><br><span class="line">            <span class="comment">//删除元素后考虑缩容</span></span><br><span class="line">            <span class="keyword">if</span> (size &lt; lowerTol * M &amp;&amp; capacityIndex - <span class="number">1</span> &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">                capacityIndex--;</span><br><span class="line">                resize(capacity[capacityIndex]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">resize</span><span class="params">(<span class="type">int</span> newM)</span> &#123;</span><br><span class="line">        AVLTreeMap&lt;K, V&gt;[] newHashTable = <span class="keyword">new</span> <span class="title class_">AVLTreeMap</span>[newM];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; newHashTable.length; i++) &#123;</span><br><span class="line">            newHashTable[i] = <span class="keyword">new</span> <span class="title class_">AVLTreeMap</span>&lt;&gt;();</span><br><span class="line">        &#125;</span><br><span class="line">        M = newM;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; hashTable.length; i++) &#123;</span><br><span class="line">            AVLTreeMap&lt;K, V&gt; map = hashTable[i];</span><br><span class="line">            <span class="keyword">for</span> (K key : map.keySet()) &#123;</span><br><span class="line">                newHashTable[hash(key)].put(key, map.get(key));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        hashTable = newHashTable;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">contains</span><span class="params">(K key)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> hash(key);</span><br><span class="line">        AVLTreeMap&lt;K, V&gt; map = hashTable[index];</span><br><span class="line">        <span class="keyword">return</span> map.contains(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> V <span class="title function_">get</span><span class="params">(K key)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> hash(key);</span><br><span class="line">        AVLTreeMap&lt;K, V&gt; map = hashTable[index];</span><br><span class="line">        <span class="keyword">return</span> map.get(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">set</span><span class="params">(K key, V value)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> hash(key);</span><br><span class="line">        AVLTreeMap&lt;K, V&gt; map = hashTable[index];</span><br><span class="line">        map.set(key, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> size;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> size == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Set&lt;K&gt; <span class="title function_">keySet</span><span class="params">()</span> &#123;</span><br><span class="line">        TreeSet&lt;K&gt; set = <span class="keyword">new</span> <span class="title class_">TreeSet</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; hashTable.length; i++) &#123;</span><br><span class="line">            AVLTreeMap&lt;K, V&gt; map = hashTable[i];</span><br><span class="line">            <span class="keyword">for</span> (K key : map.keySet()) &#123;</span><br><span class="line">                set.add(key);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> set;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;V&gt; <span class="title function_">values</span><span class="params">()</span> &#123;</span><br><span class="line">        LinkedList&lt;V&gt; list = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; hashTable.length; i++) &#123;</span><br><span class="line">            AVLTreeMap&lt;K, V&gt; map = hashTable[i];</span><br><span class="line">            <span class="keyword">for</span> (V value : map.values()) &#123;</span><br><span class="line">                list.add(value);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Set&lt;Entry&lt;K, V&gt;&gt; <span class="title function_">entrySet</span><span class="params">()</span> &#123;</span><br><span class="line">        TreeSet&lt;Entry&lt;K, V&gt;&gt; set = <span class="keyword">new</span> <span class="title class_">TreeSet</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; hashTable.length; i++) &#123;</span><br><span class="line">            AVLTreeMap&lt;K, V&gt; map = hashTable[i];</span><br><span class="line">            <span class="keyword">for</span> (Entry entry : map.entrySet()) &#123;</span><br><span class="line">                set.add(entry);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> set;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p><strong>注意要点</strong></p>
</blockquote>
<ul>
<li>解决hash冲突问题 <strong>链地址法</strong> –使用另一种数据结构存储同一hash值的</li>
<li>哈希表是时间与空间之间的平衡，本质上<strong>哈希函数</strong>的<strong>设计是非常重要的</strong></li>
</ul>
<h3 id="树"><a href="#树" class="headerlink" title="树"></a>树</h3><blockquote>
<p><strong>树的性质</strong></p>
</blockquote>
<ul>
<li>Root </li>
<li>SubTree </li>
<li>Leaf </li>
<li>Level &#x2F; Depth </li>
<li>Degree –节点子树个数 &#x2F; 树内节点的最大值</li>
<li>树通常通过递归操作</li>
</ul>
<h4 id="二叉树"><a href="#二叉树" class="headerlink" title="二叉树"></a>二叉树</h4><blockquote>
<p><strong>二叉树的性质</strong></p>
</blockquote>
<ul>
<li>二叉树的基本形态<ul>
<li>空二叉树</li>
<li>只有 Root 节点</li>
<li>根节点 只有左子树 &#x2F; 只有右子树</li>
<li>二叉树 只有左子树 &#x2F; 只有右子树 –退化成 链表 左右斜树</li>
<li>同时满足拥有 左右子树</li>
<li>满二叉树 所有分支都右 左右节点 最后一层叶子节点 即满树状态 –满二叉树是一种平衡二叉树</li>
<li>完全二叉树 叶子节点层只能出现在最下面两层 最后一层叶子 从右往左连续排布 –完全二叉树是一种平衡二叉树</li>
</ul>
</li>
<li>depth &#x3D; k 的二叉树 最多有 2^k - 1 个节点</li>
<li>二叉树的第 k 层 最多有 2^(k - 1) 个节点</li>
</ul>
<blockquote>
<p><strong>二叉树的顺序存储结构</strong></p>
</blockquote>
<ul>
<li>顺序存储结构在极端情况 ( 左右斜树 ) 下极其浪费空间 只适合存储平衡树</li>
<li>故而二叉树的存储通常使用 链表存储 –二叉链表</li>
</ul>
<blockquote>
<p><strong>二叉树的遍历</strong></p>
</blockquote>
<ul>
<li>深度优先遍历 DFS<ul>
<li>前序遍历<ul>
<li>DLR</li>
<li>递归实现</li>
<li>迭代实现</li>
</ul>
</li>
<li>中序遍历<ul>
<li>LDR</li>
</ul>
</li>
<li>后序遍历<ul>
<li>LRD</li>
</ul>
</li>
</ul>
</li>
<li>广度优先遍历 BFS<ul>
<li>层序遍历<ul>
<li>使用队列辅助操作</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="二分搜索树"><a href="#二分搜索树" class="headerlink" title="二分搜索树"></a>二分搜索树</h4><blockquote>
<p><strong>二分搜索树的性质</strong></p>
</blockquote>
<ul>
<li>任何一个节点都大于其左子树所有节点的值 都小于其右子树所有节点的值</li>
<li>该树中元素必须要具有可比性 同时 不包含重复元素</li>
<li>具备自排序能力</li>
</ul>
<blockquote>
<p><strong>手写代码实现</strong></p>
</blockquote>
<p>BinarySearchTree</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P7.TreeStructure;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> P3.chainStructure.LinkedList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="comment">//二分搜索树(BST)  不能存储重复的元素 如何解决？ 容易产生极端情况（斜树）  非平衡树</span></span><br><span class="line"><span class="comment">//平衡树 在二分搜索树中 任意一个结点的左子树高度和右子树高度差 &lt;= 1</span></span><br><span class="line"><span class="comment">//红黑树 --平衡二分搜索树</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BinarySearchTree</span>&lt;E <span class="keyword">extends</span> <span class="title class_">Comparable</span>&lt;E&gt;&gt; <span class="keyword">implements</span> <span class="title class_">Iterable</span>&lt;E&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//定义二分搜索树的结点信息</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">class</span> <span class="title class_">Node</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> E e; <span class="comment">//数据域</span></span><br><span class="line">        <span class="keyword">public</span> Node left;   <span class="comment">//左孩子（当前node结点左子树的根）</span></span><br><span class="line">        <span class="keyword">public</span> Node right;  <span class="comment">//右孩子（当前node结点右子树的根）</span></span><br><span class="line"><span class="comment">//        public int count = 1;   //记录元素出现的次数 默认为1</span></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">(E e)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.e = e;</span><br><span class="line">            left = <span class="literal">null</span>;</span><br><span class="line">            right = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> e.toString();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Node root;  <span class="comment">//根结点的指针 根指针采用真实根结点 如果二分搜索树的根为空则 root == null</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> size;   <span class="comment">//二分搜索树中元素的个数（结点的个数）</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BinarySearchTree</span><span class="params">()</span> &#123;</span><br><span class="line">        root = <span class="literal">null</span>;</span><br><span class="line">        size = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//向外提供的添加方法 此方法不能直接递归</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(E e)</span> &#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        //迭代思路</span></span><br><span class="line"><span class="comment">        Node node = new Node(e);</span></span><br><span class="line"><span class="comment">        if (isEmpty()) &#123;</span></span><br><span class="line"><span class="comment">            root = node;</span></span><br><span class="line"><span class="comment">            size++;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        Node cur = root;</span></span><br><span class="line"><span class="comment">        while (true) &#123;</span></span><br><span class="line"><span class="comment">            //新元素比当前元素大 往右走</span></span><br><span class="line"><span class="comment">            if (node.e.compareTo(cur.e) &gt; 0) &#123;</span></span><br><span class="line"><span class="comment">                if (cur.right == null) &#123;</span></span><br><span class="line"><span class="comment">                    cur.right = node;</span></span><br><span class="line"><span class="comment">                    size++;</span></span><br><span class="line"><span class="comment">                    break;</span></span><br><span class="line"><span class="comment">                &#125; else &#123;</span></span><br><span class="line"><span class="comment">                    cur = cur.right;</span></span><br><span class="line"><span class="comment">                &#125;</span></span><br><span class="line"><span class="comment">            //新元素比当前元素小 往左走</span></span><br><span class="line"><span class="comment">            &#125; else if (node.e.compareTo(cur.e) &lt; 0) &#123;</span></span><br><span class="line"><span class="comment">                if (cur.left == null) &#123;</span></span><br><span class="line"><span class="comment">                    cur.left = node;</span></span><br><span class="line"><span class="comment">                    size++;</span></span><br><span class="line"><span class="comment">                    break;</span></span><br><span class="line"><span class="comment">                &#125; else &#123;</span></span><br><span class="line"><span class="comment">                    cur = cur.left;</span></span><br><span class="line"><span class="comment">                &#125;</span></span><br><span class="line"><span class="comment">            &#125; else &#123;</span></span><br><span class="line"><span class="comment">                break;</span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment">        &#125;*/</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//递归思路 --二叉树以递归为主</span></span><br><span class="line">        <span class="comment">//以当前node为根结点 在其子树中添加新元素 并返回新树的根</span></span><br><span class="line">        root = add(root, e);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//在以node为根的树中 插入元素e 并返回新树的根</span></span><br><span class="line">    <span class="keyword">private</span> Node <span class="title function_">add</span><span class="params">(Node node, E e)</span> &#123;</span><br><span class="line">        <span class="comment">//从下一层到上一层</span></span><br><span class="line">        <span class="keyword">if</span> (node == <span class="literal">null</span>) &#123;</span><br><span class="line">            size++;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Node</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//当前层向下一层</span></span><br><span class="line">        <span class="keyword">if</span> (e.compareTo(node.e) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            node.left = add(node.left, e);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (e.compareTo(node.e) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            node.right = add(node.right, e);</span><br><span class="line">        &#125;</span><br><span class="line">            <span class="comment">//等于的情况 想要重复</span></span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">            *else &#123;</span></span><br><span class="line"><span class="comment">            *   node.count++;</span></span><br><span class="line"><span class="comment">            * &#125;</span></span><br><span class="line"><span class="comment">            *</span></span><br><span class="line"><span class="comment">            *</span></span><br><span class="line"><span class="comment">            * */</span></span><br><span class="line">        <span class="comment">//当前层向上一层</span></span><br><span class="line">        <span class="keyword">return</span> node;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">contains</span><span class="params">(E e)</span> &#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        //迭代思路</span></span><br><span class="line"><span class="comment">        Node cur = root;</span></span><br><span class="line"><span class="comment">        while (true) &#123;</span></span><br><span class="line"><span class="comment">            if (e.compareTo(cur.e) &lt; 0) &#123;</span></span><br><span class="line"><span class="comment">                if (cur.left == null) &#123;</span></span><br><span class="line"><span class="comment">                    return false;</span></span><br><span class="line"><span class="comment">                &#125;</span></span><br><span class="line"><span class="comment">                cur = cur.left;</span></span><br><span class="line"><span class="comment">            &#125; else if (e.compareTo(cur.e) &gt; 0) &#123;</span></span><br><span class="line"><span class="comment">                if (cur.right == null) &#123;</span></span><br><span class="line"><span class="comment">                    return false;</span></span><br><span class="line"><span class="comment">                &#125;</span></span><br><span class="line"><span class="comment">                cur = cur.right;</span></span><br><span class="line"><span class="comment">            &#125; else &#123;</span></span><br><span class="line"><span class="comment">                return true;</span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment">        &#125;*/</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//递归思路</span></span><br><span class="line">        <span class="keyword">return</span> contains(root, e);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//查看以node为根的二分搜索树中是否包含元素e</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">contains</span><span class="params">(Node node, E e)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (node == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (e.compareTo(node.e) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> contains(node.left, e);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (e.compareTo(node.e) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> contains(node.right, e);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//前序遍历 --向外提供的API</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">preOrder</span><span class="params">()</span> &#123;</span><br><span class="line">        preOrder(root);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//前序遍历 --封装在内部 --以递归方式实现 --以node为根结点进行前序遍历DLR</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">preOrder</span><span class="params">(Node node)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (node == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(node.e);</span><br><span class="line">        preOrder(node.left);</span><br><span class="line">        preOrder(node.right);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//前序遍历 --迭代方式 可直接给外界调用 应用数据结构 --栈结构</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">preOrderNR</span><span class="params">()</span> &#123;</span><br><span class="line">        LinkedList&lt;Node&gt; stack = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">if</span> (isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        stack.push(root);</span><br><span class="line">        <span class="keyword">while</span> (!stack.isEmpty()) &#123;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">cur</span> <span class="operator">=</span> stack.poll();</span><br><span class="line">            System.out.println(cur.e);</span><br><span class="line">            <span class="keyword">if</span> (cur.right != <span class="literal">null</span>) &#123;</span><br><span class="line">                stack.push(cur.right);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (cur.left != <span class="literal">null</span>) &#123;</span><br><span class="line">                stack.push(cur.left);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//中序遍历 --向外提供的API</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">inOrder</span><span class="params">()</span> &#123;</span><br><span class="line">        inOrder(root);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//中序遍历 --封装在内部 --以递归方式实现 --以node为根结点进行中序遍历LDR</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">inOrder</span><span class="params">(Node node)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (node == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        inOrder(node.left);</span><br><span class="line">        System.out.println(node.e);</span><br><span class="line">        inOrder(node.right);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//中序遍历 --迭代方式 可直接给外界调用 应用数据结构 --栈结构</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">inOrderNR</span><span class="params">()</span> &#123;</span><br><span class="line">        LinkedList&lt;Node&gt; stack = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        <span class="type">Node</span> <span class="variable">p</span> <span class="operator">=</span> root;</span><br><span class="line">        <span class="keyword">while</span> (p != <span class="literal">null</span>) &#123;</span><br><span class="line">            stack.push(p);</span><br><span class="line">            p = p.left;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (!stack.isEmpty()) &#123;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">cur</span> <span class="operator">=</span> stack.pop();</span><br><span class="line">            System.out.println(cur.e);</span><br><span class="line">            <span class="keyword">if</span> (cur.right != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="type">Node</span> <span class="variable">n</span> <span class="operator">=</span> cur.right;</span><br><span class="line">                <span class="keyword">while</span> (n != <span class="literal">null</span>) &#123;</span><br><span class="line">                    stack.push(n);</span><br><span class="line">                    n = n.left;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//后续遍历 --向外提供的API</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postOrder</span><span class="params">()</span> &#123;</span><br><span class="line">        postOrder(root);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//后序遍历 --封装在内部 --以递归方式实现 --以node为根结点进行后续遍历LRD</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">postOrder</span><span class="params">(Node node)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (node == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        postOrder(node.left);</span><br><span class="line">        postOrder(node.right);</span><br><span class="line">        System.out.println(node.e);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//层序遍历 --迭代方式 --使用数据结构 队列结构</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">levelOrder</span><span class="params">()</span> &#123;</span><br><span class="line">        LinkedList&lt;Node&gt; queue = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">if</span> (isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        queue.offer(root);</span><br><span class="line">        <span class="keyword">while</span> (!queue.isEmpty()) &#123;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">cur</span> <span class="operator">=</span> queue.poll();</span><br><span class="line">            System.out.println(cur.e);</span><br><span class="line">            <span class="keyword">if</span> (cur.left != <span class="literal">null</span>) &#123;</span><br><span class="line">                queue.offer(cur.left);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (cur.right != <span class="literal">null</span>) &#123;</span><br><span class="line">                queue.offer(cur.right);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> size;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> root == <span class="literal">null</span> &amp;&amp; size == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//寻找二分搜索树中的最小值</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">minimum</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;bst is null&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> minimum(root).e;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//以node为根结点 查找最小值所在的结点 --递归</span></span><br><span class="line">    <span class="comment">//作业：尝试迭代方式实现</span></span><br><span class="line">    <span class="keyword">private</span> Node <span class="title function_">minimum</span><span class="params">(Node node)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (node.left == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> node;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> minimum(node.left);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//寻找二分搜索树中的最大值</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">maximum</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;bst is null&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> maximum(root).e;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//以node为根结点 查找最大值所在的结点 --递归</span></span><br><span class="line">    <span class="comment">//作业：尝试迭代方式实现</span></span><br><span class="line">    <span class="keyword">private</span> Node <span class="title function_">maximum</span><span class="params">(Node node)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (node.right == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> node;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> maximum(node.right);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//删除最小值 --对外提供API</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">removeMin</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">E</span> <span class="variable">ret</span> <span class="operator">=</span> minimum();</span><br><span class="line">        root = removeMin(root);</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//以node为根 删除其中的最小值结点 返回更新后新树的根</span></span><br><span class="line">    <span class="keyword">private</span> Node <span class="title function_">removeMin</span><span class="params">(Node node)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (node.left == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">rightNode</span> <span class="operator">=</span> node.right;</span><br><span class="line">            node.right = <span class="literal">null</span>;</span><br><span class="line">            size--;</span><br><span class="line">            <span class="keyword">return</span> rightNode;</span><br><span class="line">        &#125;</span><br><span class="line">        node.left = removeMin(node.left);</span><br><span class="line">        <span class="keyword">return</span> node;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//删除最大值 --对外提供API</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">removeMax</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">E</span> <span class="variable">ret</span> <span class="operator">=</span> maximum();</span><br><span class="line">        root = removeMax(root);</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Node <span class="title function_">removeMax</span><span class="params">(Node node)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (node.right == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">leftNode</span> <span class="operator">=</span> node.left;</span><br><span class="line">            node.left = <span class="literal">null</span>;</span><br><span class="line">            size--;</span><br><span class="line">            <span class="keyword">return</span> leftNode;</span><br><span class="line">        &#125;</span><br><span class="line">        node.right = removeMax(node.right);</span><br><span class="line">        <span class="keyword">return</span> node;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//删除指定元素 向外api</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">remove</span><span class="params">(E e)</span> &#123;</span><br><span class="line">        root = remove(root, e);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//以node为根 删除元素e 并返回删除后新树的根</span></span><br><span class="line">    <span class="keyword">private</span> Node <span class="title function_">remove</span><span class="params">(Node node, E e)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (node == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (e.compareTo(node.e) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            node.left = remove(node.left, e);</span><br><span class="line">            <span class="keyword">return</span> node;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (e.compareTo(node.e) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            node.right = remove(node.right, e);</span><br><span class="line">            <span class="keyword">return</span> node;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//找到了需要删除的结点</span></span><br><span class="line">            <span class="comment">//如果待删除结点的左边为空 则右子树直接上去</span></span><br><span class="line">            <span class="keyword">if</span> (node.left == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="type">Node</span> <span class="variable">rightNode</span> <span class="operator">=</span> node.right;</span><br><span class="line">                node.right = <span class="literal">null</span>;</span><br><span class="line">                size--;</span><br><span class="line">                <span class="keyword">return</span> rightNode;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//如果待删除结点的右边为空 则左子树直接上去</span></span><br><span class="line">            <span class="keyword">if</span> (node.right == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="type">Node</span> <span class="variable">leftNode</span> <span class="operator">=</span> node.left;</span><br><span class="line">                node.left = <span class="literal">null</span>;</span><br><span class="line">                size--;</span><br><span class="line">                <span class="keyword">return</span> leftNode;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//左右都不为空 把右子树的最小值作为新树的根返回</span></span><br><span class="line">            <span class="type">Node</span> <span class="variable">successor</span> <span class="operator">=</span> minimum(node.right);</span><br><span class="line">            successor.right = removeMin(node.right);</span><br><span class="line">            successor.left = node.left;</span><br><span class="line">            node.left = node.right = <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">return</span> successor;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>(<span class="string">&quot;[&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (isEmpty()) &#123;</span><br><span class="line">            sb.append(<span class="string">&#x27;]&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            Iterator&lt;E&gt; it = iterator();</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">                sb.append(it.next());</span><br><span class="line">                <span class="keyword">if</span> (i == size - <span class="number">1</span>) &#123;</span><br><span class="line">                    sb.append(<span class="string">&#x27;]&#x27;</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    sb.append(<span class="string">&#x27;,&#x27;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">/*while循环</span></span><br><span class="line"><span class="comment">            while (it.hasNext()) &#123;</span></span><br><span class="line"><span class="comment">                sb.append(it.next());</span></span><br><span class="line"><span class="comment">                sb.append(&#x27;,&#x27;);</span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment">            sb.deleteCharAt(sb.length() - 1);</span></span><br><span class="line"><span class="comment">            sb.append(&#x27;]&#x27;);</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Iterator&lt;E&gt; <span class="title function_">iterator</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">BinarySearchTreeIterator</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">class</span> <span class="title class_">BinarySearchTreeIterator</span> <span class="keyword">implements</span> <span class="title class_">Iterator</span>&lt;E&gt; &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> Iterator&lt;E&gt; it;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">BinarySearchTreeIterator</span><span class="params">()</span> &#123;</span><br><span class="line">            LinkedList&lt;E&gt; list = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">            LinkedList&lt;Node&gt; stack = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">            <span class="type">Node</span> <span class="variable">p</span> <span class="operator">=</span> root;</span><br><span class="line">            <span class="keyword">while</span> (p != <span class="literal">null</span>) &#123;</span><br><span class="line">                stack.push(p);</span><br><span class="line">                p = p.left;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">while</span> (!stack.isEmpty()) &#123;</span><br><span class="line">                <span class="type">Node</span> <span class="variable">cur</span> <span class="operator">=</span> stack.pop();</span><br><span class="line">                list.offer(cur.e);</span><br><span class="line">                <span class="keyword">if</span> (cur.right != <span class="literal">null</span>) &#123;</span><br><span class="line">                    <span class="type">Node</span> <span class="variable">n</span> <span class="operator">=</span> cur.right;</span><br><span class="line">                    <span class="keyword">while</span> (n != <span class="literal">null</span>) &#123;</span><br><span class="line">                        stack.push(n);</span><br><span class="line">                        n =  n.left;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            it = list.iterator();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">hasNext</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> it.hasNext();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> E <span class="title function_">next</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> it.next();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>TODO</p>
<ul>
<li>Iterator细节理解</li>
<li>子树问题具体实现</li>
</ul>
<h4 id="AVL平衡树"><a href="#AVL平衡树" class="headerlink" title="AVL平衡树"></a>AVL平衡树</h4><blockquote>
<p><strong>AVL平衡树特点</strong></p>
</blockquote>
<ul>
<li>二分搜素树性质</li>
<li>自平衡树结构 –任意一节点左子树与右子树的高度差不能超过1</li>
<li>平衡因子 –节点左右子树的高度差</li>
<li>自平衡的四种方式<ul>
<li>插入元素在不平衡节点左侧的左侧 –LL旋转</li>
<li>插入元素在不平衡节点右侧的右侧 –RR旋转</li>
<li>插入元素在不平衡节点左侧的右侧 –LR旋转 –即先对当前不平衡节点左子节点进行RR左旋转 再对当前不平衡节点进行LL右旋转</li>
<li>插入元素在不平衡节点右侧的左侧 –RL旋转 –即先对当前不平衡节点右子节点进行LL右旋转 再对当前不平衡节点进行RR左旋转</li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>手写代码实现</strong></p>
</blockquote>
<p>AVLTreeMap</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P7.TreeStructure;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> P1.Interface.List;</span><br><span class="line"><span class="keyword">import</span> P1.Interface.Map;</span><br><span class="line"><span class="keyword">import</span> P1.Interface.Set;</span><br><span class="line"><span class="keyword">import</span> P2.linearStructure.ArrayList;</span><br><span class="line"><span class="keyword">import</span> P3.chainStructure.LinkedList;</span><br><span class="line"></span><br><span class="line"><span class="comment">// AVL平衡二分搜索树实现的映射</span></span><br><span class="line"><span class="comment">// Ologn</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AVLTreeMap</span>&lt;K <span class="keyword">extends</span> <span class="title class_">Comparable</span>&lt;K&gt;, V&gt; <span class="keyword">implements</span> <span class="title class_">Map</span>&lt;K, V&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">class</span> <span class="title class_">Node</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> K key;   <span class="comment">//键</span></span><br><span class="line">        <span class="keyword">public</span> V value; <span class="comment">//值</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> height;  <span class="comment">//高度</span></span><br><span class="line">        <span class="keyword">public</span> Node left;</span><br><span class="line">        <span class="keyword">public</span> Node right;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">(K key, V value)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.key = key;</span><br><span class="line">            <span class="built_in">this</span>.value = value;</span><br><span class="line">            left = <span class="literal">null</span>;</span><br><span class="line">            right = <span class="literal">null</span>;</span><br><span class="line">            height = <span class="number">1</span>; <span class="comment">//新结点高度默认都是1</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Node root;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> size;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">AVLTreeMap</span><span class="params">()</span> &#123;</span><br><span class="line">        root = <span class="literal">null</span>;</span><br><span class="line">        size = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//辅助函数 --获取以node为根的子树中 查找key所在的结点</span></span><br><span class="line">    <span class="keyword">private</span> Node <span class="title function_">getNode</span><span class="params">(Node node, K key)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (node == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (key.compareTo(node.key) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> getNode(node.left, key);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (key.compareTo(node.key) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> getNode(node.right, key);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> node;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//辅助函数 --获取某个结点的高度 如果该结点为空 则高度为0</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="title function_">getHeight</span><span class="params">(Node node)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (node == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> node.height;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//辅助函数 --计算某个结点的平衡因子（左右子树的高度差） &gt;0左边高 &lt;0右边高 ==0同高</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="title function_">getBalanceFactor</span><span class="params">(Node node)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (node == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> getHeight(node.left) - getHeight(node.right);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//辅助函数 --验证是否是一颗二分搜索树</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isBST</span><span class="params">()</span> &#123;</span><br><span class="line">        ArrayList&lt;K&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        inOrderKeys(root, list);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span><span class="number">1</span>; i &lt; list.size(); i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (list.get(i - <span class="number">1</span>).compareTo(list.get(i)) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">inOrderKeys</span><span class="params">(Node node, ArrayList&lt;K&gt; list)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (node == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        inOrderKeys(node.left, list);</span><br><span class="line">        list.add(node.key);</span><br><span class="line">        inOrderKeys(node.right, list);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//辅助函数 --验证式是否为一颗平衡树</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isBalanced</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> isBalanced(root);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">isBalanced</span><span class="params">(Node node)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (node == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">balancedFactor</span> <span class="operator">=</span> getBalanceFactor(node);</span><br><span class="line">        <span class="keyword">if</span> (Math.abs(balancedFactor) &gt; <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> isBalanced(node.left) &amp;&amp; isBalanced(node.right);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//左旋转（右侧的右侧RR） 将y结点进行左旋转 并返回新根</span></span><br><span class="line">    <span class="keyword">private</span> Node <span class="title function_">leftRotate</span><span class="params">(Node y)</span> &#123;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">x</span> <span class="operator">=</span> y.right;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">T3</span> <span class="operator">=</span> x.left;</span><br><span class="line">        x.left = y;</span><br><span class="line">        y.right = T3;</span><br><span class="line">        y.height = Math.max(getHeight(y.left), getHeight(y.right)) + <span class="number">1</span>;</span><br><span class="line">        x.height = Math.max(getHeight(x.left), getHeight(x.right)) + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//右旋转（左侧的左侧LL） 将y结点进行右旋转 并返回新根</span></span><br><span class="line">    <span class="keyword">private</span> Node <span class="title function_">rightRotate</span><span class="params">(Node y)</span> &#123;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">x</span> <span class="operator">=</span> y.left;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">T3</span> <span class="operator">=</span> x.right;</span><br><span class="line">        x.right = y;</span><br><span class="line">        y.left = T3;</span><br><span class="line">        y.height = Math.max(getHeight(y.left), getHeight(y.right)) + <span class="number">1</span>;</span><br><span class="line">        x.height = Math.max(getHeight(x.left), getHeight(x.right)) + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">put</span><span class="params">(K key, V value)</span> &#123;</span><br><span class="line">        root = put(root, key, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Node <span class="title function_">put</span><span class="params">(Node node, K key, V value)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (node == <span class="literal">null</span>) &#123;</span><br><span class="line">            size++;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Node</span>(key, value);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (key.compareTo(node.key) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            node.left = put(node.left, key, value);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (key.compareTo(node.key) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            node.right = put(node.right, key, value);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            node.value = value;</span><br><span class="line">            <span class="keyword">return</span> node;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//当前结点的高度需要更新</span></span><br><span class="line">        node.height = Math.max(getHeight(node.left), getHeight(node.right)) + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//判断当前结点是否平衡</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">balanceFactor</span> <span class="operator">=</span> getBalanceFactor(node);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// &gt; 1 说明 当前结点左侧不平衡 node.left &gt;= 0 左侧的左侧不平衡</span></span><br><span class="line">        <span class="keyword">if</span> (balanceFactor &gt; <span class="number">1</span> &amp;&amp; getBalanceFactor(node.left) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> rightRotate(node);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// &gt; 1 说明 当前结点左侧不平衡 node.left &lt; 0 左侧的右侧不平衡</span></span><br><span class="line">        <span class="keyword">if</span> (balanceFactor &gt; <span class="number">1</span> &amp;&amp; getBalanceFactor(node.left) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            node.left = leftRotate(node.left);</span><br><span class="line">            <span class="keyword">return</span> rightRotate(node);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// &lt; -1 说明 当前结点的右侧不平衡 node.right &gt;= 0 右侧的左侧不平衡</span></span><br><span class="line">        <span class="keyword">if</span> (balanceFactor &lt; -<span class="number">1</span> &amp;&amp; getBalanceFactor(node.right) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            node.right = rightRotate(node.right);</span><br><span class="line">            <span class="keyword">return</span> leftRotate(node);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// &lt; -1 说明 当前结点的右侧不平衡 node.right &lt; 0 右侧的右侧不平衡</span></span><br><span class="line">        <span class="keyword">if</span> (balanceFactor &lt; -<span class="number">1</span> &amp;&amp; getBalanceFactor(node.right) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> leftRotate(node);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> node;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> V <span class="title function_">remove</span><span class="params">(K key)</span> &#123;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">delNode</span> <span class="operator">=</span> getNode(root, key);</span><br><span class="line">        <span class="keyword">if</span> (delNode != <span class="literal">null</span>) &#123;</span><br><span class="line">            root = remove(root, key);</span><br><span class="line">            <span class="keyword">return</span> delNode.value;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Node <span class="title function_">remove</span><span class="params">(Node node, K key)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (node == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">retNode</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (key.compareTo(node.key) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            node.left = remove(node.left, key);</span><br><span class="line">            retNode = node;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (key.compareTo(node.key) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            node.right = remove(node.right, key);</span><br><span class="line">            retNode = node;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//找到了需要删除的结点</span></span><br><span class="line">            <span class="keyword">if</span> (node.left == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="type">Node</span> <span class="variable">rightNode</span> <span class="operator">=</span> node.right;</span><br><span class="line">                node.right = <span class="literal">null</span>;</span><br><span class="line">                size--;</span><br><span class="line">                retNode = rightNode;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (node.right == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="type">Node</span> <span class="variable">leftNode</span> <span class="operator">=</span> node.left;</span><br><span class="line">                node.left = <span class="literal">null</span>;</span><br><span class="line">                retNode = leftNode;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="type">Node</span> <span class="variable">successor</span> <span class="operator">=</span> minimum(node.right);</span><br><span class="line">                successor.right = remove(node.right, successor.key);</span><br><span class="line">                successor.left = node.left;</span><br><span class="line">                node.left = node.right = <span class="literal">null</span>;</span><br><span class="line">                retNode = successor;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (retNode == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> retNode;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//更新高度</span></span><br><span class="line">        retNode.height = Math.max(getHeight(retNode.left), getHeight(retNode.right)) + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//获取平衡因子判断是否需要自平衡</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">balanceFactor</span> <span class="operator">=</span> getBalanceFactor(retNode);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// &gt; 1 说明 当前结点左侧不平衡 node.left &gt;= 0 左侧的左侧不平衡</span></span><br><span class="line">        <span class="keyword">if</span> (balanceFactor &gt; <span class="number">1</span> &amp;&amp; getBalanceFactor(retNode.left) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> rightRotate(retNode);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// &gt; 1 说明 当前结点左侧不平衡 node.left &lt; 0 左侧的右侧不平衡</span></span><br><span class="line">        <span class="keyword">if</span> (balanceFactor &gt; <span class="number">1</span> &amp;&amp; getBalanceFactor(retNode.left) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            retNode.left = leftRotate(retNode.left);</span><br><span class="line">            <span class="keyword">return</span> rightRotate(retNode);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// &lt; -1 说明 当前结点的右侧不平衡 node.right &gt;= 0 右侧的左侧不平衡</span></span><br><span class="line">        <span class="keyword">if</span> (balanceFactor &lt; -<span class="number">1</span> &amp;&amp; getBalanceFactor(retNode.right) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            retNode.right = rightRotate(retNode.right);</span><br><span class="line">            <span class="keyword">return</span> leftRotate(retNode);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// &lt; -1 说明 当前结点的右侧不平衡 node.right &lt; 0 右侧的右侧不平衡</span></span><br><span class="line">        <span class="keyword">if</span> (balanceFactor &lt; -<span class="number">1</span> &amp;&amp; getBalanceFactor(retNode.right) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> leftRotate(retNode);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> retNode;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Node <span class="title function_">minimum</span><span class="params">(Node node)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (node.left == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> node;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> minimum(node.left);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">contains</span><span class="params">(K key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> getNode(root, key) != <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> V <span class="title function_">get</span><span class="params">(K key)</span> &#123;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">node</span> <span class="operator">=</span> getNode(root, key);</span><br><span class="line">        <span class="keyword">if</span> (node != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> node.value;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">set</span><span class="params">(K key, V value)</span> &#123;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">node</span> <span class="operator">=</span> getNode(root, key);</span><br><span class="line">        <span class="keyword">if</span> (node == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;key-value is not exist&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        node.value = value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> size;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> size == <span class="number">0</span> &amp;&amp; root == <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Set&lt;K&gt; <span class="title function_">keySet</span><span class="params">()</span> &#123;</span><br><span class="line">        TreeSet&lt;K&gt; set = <span class="keyword">new</span> <span class="title class_">TreeSet</span>&lt;&gt;();</span><br><span class="line">        inOrderKeySet(root, set);</span><br><span class="line">        <span class="keyword">return</span> set;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">inOrderKeySet</span><span class="params">(Node node, TreeSet&lt;K&gt; set)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (node == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        inOrderKeySet(node.left, set);</span><br><span class="line">        set.add(node.key);</span><br><span class="line">        inOrderKeySet(node.right, set);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;V&gt; <span class="title function_">values</span><span class="params">()</span> &#123;</span><br><span class="line">        LinkedList&lt;V&gt; list = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        inOrderValues(root, list);</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">inOrderValues</span><span class="params">(Node node, LinkedList&lt;V&gt; list)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (node == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        inOrderValues(node.left, list);</span><br><span class="line">        list.add(node.value);</span><br><span class="line">        inOrderValues(node.right, list);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Set&lt;Entry&lt;K, V&gt;&gt; <span class="title function_">entrySet</span><span class="params">()</span> &#123;</span><br><span class="line">        TreeSet&lt;Entry&lt;K, V&gt;&gt; entries = <span class="keyword">new</span> <span class="title class_">TreeSet</span>&lt;&gt;();</span><br><span class="line">        inOrderEntrys(root, entries);</span><br><span class="line">        <span class="keyword">return</span> entries;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">inOrderEntrys</span><span class="params">(Node node, TreeSet&lt;Entry&lt;K,V&gt;&gt; entries)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (node == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        inOrderEntrys(node.left, entries);</span><br><span class="line">        entries.add(<span class="keyword">new</span> <span class="title class_">BSTEntry</span>&lt;&gt;(node.key, node.value));</span><br><span class="line">        inOrderEntrys(node.right, entries);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//键值对 对象 进行封装</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">class</span> <span class="title class_">BSTEntry</span>&lt;K <span class="keyword">extends</span> <span class="title class_">Comparable</span>&lt;K&gt;, V&gt; <span class="keyword">implements</span> <span class="title class_">Entry</span>&lt;K, V&gt; &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> K key;</span><br><span class="line">        <span class="keyword">private</span> V value;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">BSTEntry</span><span class="params">(K key, V value)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.key = key;</span><br><span class="line">            <span class="built_in">this</span>.value = value;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> K <span class="title function_">getKey</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> key;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> V <span class="title function_">getValue</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> value;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> key + <span class="string">&quot;:&quot;</span> + value;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compareTo</span><span class="params">(Entry&lt;K, V&gt; o)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>.getKey().compareTo(o.getKey()) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//前序遍历 --向外提供的API</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">preOrder</span><span class="params">()</span> &#123;</span><br><span class="line">        preOrder(root);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//前序遍历 --封装在内部 --以递归方式实现 --以node为根结点进行前序遍历DLR</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">preOrder</span><span class="params">(Node node)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (node == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(node.key);</span><br><span class="line">        preOrder(node.left);</span><br><span class="line">        preOrder(node.right);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="Trie前缀树"><a href="#Trie前缀树" class="headerlink" title="Trie前缀树"></a>Trie前缀树</h4><blockquote>
<p><strong>Trie前缀树特点</strong></p>
</blockquote>
<ul>
<li>Trie前缀树又称字典树、单词查找树，是一种多叉树，专门处理字符串</li>
<li>查询每个条目的时间复杂度，和树中一共多少条目无关，其时间复杂度为O(w)，w为所查询单词的长度，大多数单词的长度小于10（优势）</li>
<li>空间换时间的思想</li>
</ul>
<blockquote>
<p><strong>手写代码实现</strong></p>
</blockquote>
<p>Trie</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P7.TreeStructure;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* Trie前缀树</span></span><br><span class="line"><span class="comment">* 又称字典树、单词查找树，是一种多叉树，专门处理字符串</span></span><br><span class="line"><span class="comment">* 查询每个条目的时间复杂度，和树中一共多少条目无关</span></span><br><span class="line"><span class="comment">* 其时间复杂度为O(w)，w为所查询单词的长度，大多数单词的长度小于10（优势）</span></span><br><span class="line"><span class="comment">* 使用虚拟头结点</span></span><br><span class="line"><span class="comment">* 空间换时间的思想</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Trie</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">class</span> <span class="title class_">Node</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> isWord;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> count;</span><br><span class="line">        <span class="keyword">public</span> AVLTreeMap&lt;Character, Node&gt; childs;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>(<span class="literal">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Node</span> <span class="params">(<span class="type">boolean</span> isWord)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.isWord = isWord;</span><br><span class="line">            childs = <span class="keyword">new</span> <span class="title class_">AVLTreeMap</span>&lt;&gt;();</span><br><span class="line">            count = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Node root;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> size;   <span class="comment">//添加进来的单词的个数</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Trie</span><span class="params">()</span> &#123;</span><br><span class="line">        root = <span class="keyword">new</span> <span class="title class_">Node</span>();</span><br><span class="line">        size = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> size;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">count</span><span class="params">(String word)</span> &#123;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">cur</span> <span class="operator">=</span> root;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; word.length(); i++) &#123;</span><br><span class="line">            <span class="type">char</span> <span class="variable">c</span> <span class="operator">=</span> word.charAt(i);</span><br><span class="line">            <span class="keyword">if</span> (cur.childs.get(c) == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            cur = cur.childs.get(c);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (cur.isWord) &#123;</span><br><span class="line">            <span class="keyword">return</span> cur.count;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(String word)</span> &#123;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">cur</span> <span class="operator">=</span> root;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; word.length(); i++) &#123;</span><br><span class="line">            <span class="type">char</span> <span class="variable">c</span> <span class="operator">=</span> word.charAt(i);</span><br><span class="line">            <span class="keyword">if</span> (cur.childs.get(c) == <span class="literal">null</span>) &#123;</span><br><span class="line">                cur.childs.put(c, <span class="keyword">new</span> <span class="title class_">Node</span>());</span><br><span class="line">            &#125;</span><br><span class="line">            cur = cur.childs.get(c);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!cur.isWord) &#123;</span><br><span class="line">            cur.isWord = <span class="literal">true</span>;</span><br><span class="line">            size++;</span><br><span class="line">            cur.count = <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            cur.count++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">contains</span><span class="params">(String word)</span> &#123;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">cur</span> <span class="operator">=</span> root;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span><span class="number">0</span>; i &lt; word.length(); i++) &#123;</span><br><span class="line">            <span class="type">char</span> <span class="variable">c</span> <span class="operator">=</span> word.charAt(i);</span><br><span class="line">            <span class="keyword">if</span> (cur.childs.get(c) == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            cur = cur.childs.get(c);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> cur.isWord;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isPrefix</span><span class="params">(String prefix)</span> &#123;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">cur</span> <span class="operator">=</span> root;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span><span class="number">0</span>; i &lt; prefix.length(); i++) &#123;</span><br><span class="line">            <span class="type">char</span> <span class="variable">c</span> <span class="operator">=</span> prefix.charAt(i);</span><br><span class="line">            <span class="keyword">if</span> (cur.childs.get(c) == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            cur = cur.childs.get(c);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> cur.isWord;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="最大堆"><a href="#最大堆" class="headerlink" title="最大堆"></a>最大堆</h4><blockquote>
<p><strong>MaxHeap特点</strong></p>
</blockquote>
<ul>
<li><strong>最大堆</strong>又叫<strong>二叉堆</strong>，是一颗<strong>完全二叉树</strong> –区别<strong>满二叉树</strong></li>
<li>堆中某个节点的值<strong>总不大于其父节点值</strong> –这种堆定义为最大堆 相应的可以定义<strong>最小堆</strong></li>
<li>下层某一元素<strong>不一定小于</strong>上层的某一元素</li>
<li>完全二叉树可以<strong>使用数组定义</strong>实现该结构 –研究底层后可得知其<strong>线性结构</strong> 故底层使用 <strong>ArrayList</strong> 实现</li>
</ul>
<blockquote>
<p><strong>手写代码实现</strong></p>
</blockquote>
<p>MaxHeap</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P7.TreeStructure;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> P2.linearStructure.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MaxHeap</span>&lt;E <span class="keyword">extends</span> <span class="title class_">Comparable</span>&lt;E&gt;&gt; <span class="keyword">implements</span> <span class="title class_">Iterable</span>&lt;E&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//最大堆底层使用线性表实现</span></span><br><span class="line">    <span class="keyword">private</span> ArrayList&lt;E&gt; data;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MaxHeap</span><span class="params">()</span> &#123;</span><br><span class="line">        data = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//辅助函数 --获取父节点的索引</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="title function_">parent</span><span class="params">(<span class="type">int</span> index)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (index == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;no parent&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (index - <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//辅助函数 --获取左孩子的索引</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="title function_">leftChild</span><span class="params">(<span class="type">int</span> index)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span> * index + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//辅助函数--获取右孩子的索引</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="title function_">rightChild</span><span class="params">(<span class="type">int</span> index)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span> * index + <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//元素上浮操作</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">siftUp</span><span class="params">(<span class="type">int</span> k)</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (k &gt; <span class="number">0</span> &amp;&amp; data.get(k).compareTo(data.get(parent(k))) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            data.swap(k, parent(k));</span><br><span class="line">            k = parent(k);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//元素下沉操作</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">siftDown</span><span class="params">(<span class="type">int</span> k)</span> &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//如果没有左孩子 则也必然没有右孩子 则不需要下沉</span></span><br><span class="line">        <span class="comment">//如果有左孩子 右孩子不一定存在 需要判断右孩子存在性</span></span><br><span class="line">        <span class="comment">//如果右孩子存在 取左右两个孩子的最大值和k对应的值比较</span></span><br><span class="line">        <span class="comment">//如果右孩子不存在 只需要取左孩子的值与k对应值比较</span></span><br><span class="line">        <span class="comment">//如果k对应值比左右两个孩子都大 则不用下沉 否则下沉即可</span></span><br><span class="line">        <span class="keyword">while</span> (leftChild(k) &lt; data.size()) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> leftChild(k);</span><br><span class="line">            <span class="keyword">if</span> (j + <span class="number">1</span> &lt; data.size() &amp;&amp; data.get(j + <span class="number">1</span>).compareTo(data.get(j)) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                j = rightChild(k);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (data.get(k).compareTo(data.get(j)) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                data.swap(k, j);</span><br><span class="line">                k = j;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">break</span>;  <span class="comment">//当前k比左右两孩子都大 不用下沉</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> data.size();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> data.isEmpty();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">clear</span><span class="params">()</span> &#123;</span><br><span class="line">        data.clear();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(E e)</span> &#123;</span><br><span class="line">        data.add(e);</span><br><span class="line">        siftUp(data.size() - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">findMax</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (data.isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;maxheap is empty&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> data.get(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">findMin</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (data.isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;maxheap is empty&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">E</span> <span class="variable">min</span> <span class="operator">=</span> data.get(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; data.size(); i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (data.get(i).compareTo(min) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                min = data.get(i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> min;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">extractMax</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (data.isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;maxheap is empty&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">E</span> <span class="variable">max</span> <span class="operator">=</span> findMax();</span><br><span class="line">        data.swap(<span class="number">0</span>, data.size() - <span class="number">1</span>);</span><br><span class="line">        data.remove(data.size() - <span class="number">1</span>);</span><br><span class="line">        siftDown(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> max;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//替换最大值 并返回原先最大值</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">replace</span><span class="params">(E e)</span> &#123;</span><br><span class="line">        <span class="type">E</span> <span class="variable">res</span> <span class="operator">=</span> findMax();</span><br><span class="line">        data.set(<span class="number">0</span>, e);</span><br><span class="line">        siftDown(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Iterator&lt;E&gt; <span class="title function_">iterator</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> data.iterator();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> data.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="优先队列"><a href="#优先队列" class="headerlink" title="优先队列"></a>优先队列</h4><blockquote>
<p><strong>PriorityQueue特点</strong></p>
</blockquote>
<ul>
<li>普通队列 FIFO LILO。<strong>优先队列 出队顺序与入队顺序无关</strong>，与优先级相关，<strong>本质还是队列的应用</strong></li>
<li>常见具体应用 –<strong>任务管理器</strong>中动态选择优先级最高的任务执行 <strong>塔防游戏</strong>中优先攻击对象根据距离 威胁 先后</li>
<li>底层使用最大堆<strong>MaxHeap</strong>来实现</li>
</ul>
<blockquote>
<p><strong>手写代码实现</strong></p>
</blockquote>
<p>PriorityQueue</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P7.TreeStructure;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> P1.Interface.Queue;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="comment">//优先队列 --由最大堆实现 --线性表 --数组</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PriorityQueue</span>&lt;E <span class="keyword">extends</span> <span class="title class_">Comparable</span>&lt;E&gt;&gt; <span class="keyword">implements</span> <span class="title class_">Queue</span>&lt;E&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> MaxHeap&lt;E&gt; heap;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">PriorityQueue</span><span class="params">()</span> &#123;</span><br><span class="line">        heap = <span class="keyword">new</span> <span class="title class_">MaxHeap</span>&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">offer</span><span class="params">(E element)</span> &#123;</span><br><span class="line">        heap.add(element);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">poll</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> heap.extractMax();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">element</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> heap.findMax();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> heap.isEmpty();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">clear</span><span class="params">()</span> &#123;</span><br><span class="line">        heap.clear();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> heap.size();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Iterator&lt;E&gt; <span class="title function_">iterator</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> heap.iterator();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> heap.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="2-3-树"><a href="#2-3-树" class="headerlink" title="2 - 3 树"></a>2 - 3 树</h4><blockquote>
<p><strong>2 - 3 树特点</strong></p>
</blockquote>
<ul>
<li>2 - 3 树本身属于多叉树分支，作为红黑树、B树的前置结构</li>
<li>2 - 3 树同样是一种 平衡树 二分搜索树，只不过是一种多叉树</li>
<li>2 - 3 树中一个节点可以存放一个元素 –a 两个子结点（ &lt; a , &gt; a） 或 两个元素 –a b 三个子结点（ &lt; a , &gt; a &lt; b , &gt; b）</li>
<li>同时 2 - 3 树 满足二分搜索树的基本性质 –左小右大 不重复</li>
<li>2 - 3 树 是一种<strong>绝对平衡</strong>的树 –从根节点到任意叶子节点所经过的节点数是一样的 –所有的叶子节点在最后一层</li>
<li>节点增加时 <ul>
<li>插入 2 节点会直接增加 </li>
<li>插入 3 节点会有假想 4 节点、拆分节点、平衡节点、向上合并等步骤</li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>手写代码实现</strong></p>
</blockquote>
<p>Tree23</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Test02;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Queue;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ArrayBlockingQueue;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Tree23</span> &#123;</span><br><span class="line">    <span class="type">Node</span> <span class="variable">root</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Node</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> DataItem <span class="title function_">find</span><span class="params">(<span class="type">int</span> value)</span> &#123;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">node</span> <span class="operator">=</span> root;</span><br><span class="line">        <span class="keyword">while</span> (node != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="type">DataItem</span> <span class="variable">item</span> <span class="operator">=</span> node.findItem(value);</span><br><span class="line">            <span class="keyword">if</span> (item == <span class="literal">null</span>) &#123;</span><br><span class="line">                node = node.getNextNode(value);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> item;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">(DataItem item)</span> &#123;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">node</span> <span class="operator">=</span> root;</span><br><span class="line">        <span class="keyword">while</span> (node != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (node.isFull()) &#123;</span><br><span class="line">                <span class="comment">// 当遇到满节点时 进行分裂</span></span><br><span class="line">                split(node);</span><br><span class="line">                <span class="comment">//重新找应该往左还是右子树查找</span></span><br><span class="line">                node = node.getParent().getNextNode(item.getValue());</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (node.isLeaf()) &#123;</span><br><span class="line">                <span class="comment">//找到叶子了</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">//继续往下找</span></span><br><span class="line">                node = node.getNextNode(item.getValue());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        node.insertItem(item);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">split</span><span class="params">(Node node)</span> &#123;</span><br><span class="line">        <span class="type">DataItem</span> <span class="variable">item1</span> <span class="operator">=</span> node.remove(<span class="number">1</span>);</span><br><span class="line">        <span class="type">DataItem</span> <span class="variable">item2</span> <span class="operator">=</span> node.remove(<span class="number">2</span>);</span><br><span class="line">        <span class="type">Node</span> <span class="variable">child2</span> <span class="operator">=</span> node.disconnect(<span class="number">2</span>);</span><br><span class="line">        <span class="type">Node</span> <span class="variable">child3</span> <span class="operator">=</span> node.disconnect(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Node</span> <span class="variable">newRight</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Node</span>();</span><br><span class="line">        newRight.insertItem(item2);</span><br><span class="line">        newRight.connect(<span class="number">0</span>, child2);</span><br><span class="line">        newRight.connect(<span class="number">1</span>, child3);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (node == root) &#123;</span><br><span class="line">            <span class="comment">//当根节点满时</span></span><br><span class="line">            root = <span class="keyword">new</span> <span class="title class_">Node</span>();</span><br><span class="line">            root.insertItem(item1);</span><br><span class="line">            root.connect(<span class="number">0</span>, node);</span><br><span class="line">            root.connect(<span class="number">1</span>, newRight);</span><br><span class="line">            node.setParent(root);</span><br><span class="line">            newRight.setParent(root);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//子节点</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">loc</span> <span class="operator">=</span> node.getParent().insertItem(item1);</span><br><span class="line">            <span class="type">Node</span> <span class="variable">parent</span> <span class="operator">=</span> node.getParent();</span><br><span class="line">            <span class="type">int</span> i;</span><br><span class="line">            <span class="keyword">for</span> (i = node.getParent().getNumItems(); i &gt; loc + <span class="number">1</span>; i--) &#123;</span><br><span class="line">                parent.connect(i, parent.getChild(i - <span class="number">1</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            node.getParent().connect(i, newRight);</span><br><span class="line">            newRight.setParent(parent);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//可以发现插入时  树是向上长高的</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">levelTraverse</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        <span class="keyword">if</span> (root == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//利用对列进行层序遍历</span></span><br><span class="line">        Queue&lt;Node&gt; que = <span class="keyword">new</span> <span class="title class_">ArrayBlockingQueue</span>&lt;Node&gt;(<span class="number">20</span>);</span><br><span class="line">        ((ArrayBlockingQueue&lt;Node&gt;) que).put(root);</span><br><span class="line">        <span class="keyword">while</span> (!que.isEmpty()) &#123;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">node</span> <span class="operator">=</span> que.poll();</span><br><span class="line">            node.displayNode();</span><br><span class="line">            <span class="keyword">if</span> (!node.isLeaf()) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt;= node.getNumItems(); i++) &#123;</span><br><span class="line">                    ((ArrayBlockingQueue&lt;Node&gt;) que).put(node.getChild(i));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DataItem</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> value;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">DataItem</span><span class="params">(<span class="type">int</span> v)</span> &#123;</span><br><span class="line">        value = v;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;/&quot;</span> + value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getValue</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Node</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">ORDER</span> <span class="operator">=</span> <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">numItems</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> Node parent;</span><br><span class="line">    <span class="keyword">private</span> Node childArray[] = <span class="keyword">new</span> <span class="title class_">Node</span>[ORDER];</span><br><span class="line">    <span class="keyword">private</span> DataItem itemArray[] = <span class="keyword">new</span> <span class="title class_">DataItem</span>[ORDER - <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> DataItem <span class="title function_">findItem</span><span class="params">(<span class="type">int</span> value)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (DataItem item : itemArray) &#123;</span><br><span class="line">            <span class="keyword">if</span> (item.getValue() == value) &#123;</span><br><span class="line">                <span class="keyword">return</span> item;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">displayNode</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; numItems; i++) &#123;</span><br><span class="line">            System.out.print(itemArray[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getNumItems</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> numItems;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Node <span class="title function_">getChild</span><span class="params">(<span class="type">int</span> index)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> childArray[index];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> DataItem <span class="title function_">remove</span><span class="params">(<span class="type">int</span> index)</span> &#123;</span><br><span class="line">        <span class="type">DataItem</span> <span class="variable">item</span> <span class="operator">=</span> itemArray[index];</span><br><span class="line">        itemArray[index] = <span class="literal">null</span>;</span><br><span class="line">        numItems--;</span><br><span class="line">        <span class="keyword">return</span> item;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Node <span class="title function_">disconnect</span><span class="params">(<span class="type">int</span> index)</span> &#123;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">node</span> <span class="operator">=</span> childArray[index];</span><br><span class="line">        childArray[index] = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">return</span> node;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">connect</span><span class="params">(<span class="type">int</span> index, Node node)</span> &#123;</span><br><span class="line">        childArray[index] = node;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Node <span class="title function_">getParent</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> parent;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setParent</span><span class="params">(Node node)</span> &#123;</span><br><span class="line">        parent = node;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isFull</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> numItems == <span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">insertItem</span><span class="params">(DataItem item)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (; i &lt; numItems; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (item.getValue() &lt; itemArray[i].getValue()) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> numItems; j &gt; i; j--) &#123;</span><br><span class="line">                    itemArray[j] = itemArray[j - <span class="number">1</span>];</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (item.getValue() == itemArray[i].getValue()) &#123;</span><br><span class="line">                <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        itemArray[i] = item;</span><br><span class="line">        numItems++;</span><br><span class="line">        <span class="comment">//返回插入节点的位置</span></span><br><span class="line">        <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Node <span class="title function_">getNextNode</span><span class="params">(<span class="type">int</span> value)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; numItems; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (value &lt; itemArray[i].getValue()) &#123;</span><br><span class="line">                <span class="keyword">return</span> childArray[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> childArray[numItems];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isLeaf</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> childArray[<span class="number">0</span>] == <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="B树"><a href="#B树" class="headerlink" title="B树"></a>B树</h4><h4 id="B-树"><a href="#B-树" class="headerlink" title="B+树"></a>B+树</h4><h4 id="红黑树"><a href="#红黑树" class="headerlink" title="红黑树"></a>红黑树</h4><blockquote>
<p><strong>RBTree特点</strong></p>
</blockquote>
<ul>
<li><strong>红黑树</strong>是一个<strong>等价于</strong> <strong>2-3 树 性质</strong>的<strong>二叉树</strong></li>
<li>红黑树 <strong>根节点</strong> 规定是 <strong>黑色</strong> 同时每个 <strong>叶子节点</strong>（NIL）是 <strong>黑色</strong></li>
<li>每个 节点 要么是 <strong>黑色</strong>，要么是 <strong>红色</strong></li>
<li>每个 <strong>红色节点</strong> 的两个 子节点 一定都是 <strong>黑色</strong>，不能有两个 <strong>红色节点</strong> 相连</li>
<li>任意一节点到每个 <strong>叶子节点</strong> 的路径都包含数量相同的 <strong>黑色节点</strong></li>
<li>红黑树是保持 “黑平衡” 的二叉树，严格意义上讲不属于平衡二叉树。故相对于 AVL 而言，插入元素与删除元素性能会更好（ 降低了树的高度 ）</li>
<li>在 2 - 3 树的基础上 <strong>3 节点</strong> 使用<strong>红黑</strong>来表示<strong>同一级别</strong> –即用<strong>红黑</strong>来<strong>使二叉树能满足多叉树效果</strong></li>
<li>红色节点都是<strong>左斜的</strong>，红色节点本质是为了标记并列关系，而<strong>黑色节点</strong>从<strong>RBTree结构上</strong>看是<strong>红色节点</strong>的父节点，但从本质上 ( 2 - 3 树结构上 ) 将是 与 <strong>红节点同为 一个 3 节点的两个元素</strong></li>
</ul>
<blockquote>
<p><strong>手写代码实现</strong></p>
</blockquote>
<p>RBTree</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1.创建RBTree，定义颜色</span></span><br><span class="line"><span class="comment"> * 2.创建RBNode</span></span><br><span class="line"><span class="comment"> * 3.辅助方法定义：parentOf(node),isRed(node),isBlack(node),setRed(node),setBlack(node),inOrderPrint();</span></span><br><span class="line"><span class="comment"> * 4.左旋方式定义：leftRotate(node);</span></span><br><span class="line"><span class="comment"> * 5.右旋方式定义：rightRotate(node);</span></span><br><span class="line"><span class="comment"> * 6.公开插入接方法定义：insert(K key, V value);</span></span><br><span class="line"><span class="comment"> * 7.内部插入接口方法定义：insert(RBNode node);</span></span><br><span class="line"><span class="comment"> * 8.修正插入导致红黑树失衡的方法定义：insertFIxUp(RBNode node);</span></span><br><span class="line"><span class="comment"> * 9.测试红黑树正确性</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &lt;K&gt;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &lt;V&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RBTree</span>&lt;K <span class="keyword">extends</span>  <span class="title class_">Comparable</span>&lt;K&gt;, V&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">boolean</span> <span class="variable">RED</span> <span class="operator">=</span> <span class="literal">true</span>;    <span class="comment">// 红色节点</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">boolean</span> <span class="variable">BLACK</span> <span class="operator">=</span> <span class="literal">false</span>; <span class="comment">// 黑色节点</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根节点的引用</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> RBNode root;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> RBNode <span class="title function_">getRoot</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取当前节点的父节点</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> node</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> RBNode <span class="title function_">parentOf</span><span class="params">(RBNode node)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (node != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> node.parent;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 节点是否为红色</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> node</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">isRed</span><span class="params">(RBNode node)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (node != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> node.color == RED;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 节点是否为黑色</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> node</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">isBlack</span><span class="params">(RBNode node)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (node != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> node.color == BLACK;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 设置节点为红色</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> node</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">setRed</span><span class="params">(RBNode node)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (node != <span class="literal">null</span>) &#123;</span><br><span class="line">            node.color = RED;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 设置节点为黑色</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> node</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">setBlack</span><span class="params">(RBNode node)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (node != <span class="literal">null</span>) &#123;</span><br><span class="line">            node.color = BLACK;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 中序打印二叉树</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">inOrderPrint</span><span class="params">()</span> &#123;</span><br><span class="line">        inOrderPrint(<span class="built_in">this</span>.root);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">inOrderPrint</span><span class="params">(RBNode node)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (node != <span class="literal">null</span>) &#123;</span><br><span class="line">            inOrderPrint(node.left);</span><br><span class="line">            System.out.println(<span class="string">&quot;key:&quot;</span> +  node.key + <span class="string">&quot;,value:&quot;</span> + node.value);</span><br><span class="line">            inOrderPrint(node.right);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 公开的插入方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">(K key, V value)</span> &#123;</span><br><span class="line">        <span class="type">RBNode</span> <span class="variable">node</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RBNode</span>();</span><br><span class="line">        node.setKey(key);</span><br><span class="line">        node.setValue(value);</span><br><span class="line">        <span class="comment">// 新节点 一定是红色！</span></span><br><span class="line">        node.setColor(RED);</span><br><span class="line">        insert(node);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">(RBNode node)</span> &#123;</span><br><span class="line">        <span class="comment">// 1.查找当前node的父节点</span></span><br><span class="line">        <span class="type">RBNode</span> <span class="variable">parent</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="comment">// 从 根节点 开始查找</span></span><br><span class="line">        <span class="type">RBNode</span> <span class="variable">x</span> <span class="operator">=</span> <span class="built_in">this</span>.root;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (x != <span class="literal">null</span>) &#123;</span><br><span class="line">            parent = x;</span><br><span class="line">            <span class="comment">// cmp &gt; 0 说明 node.key 大于 x.key</span></span><br><span class="line">            <span class="comment">// cmp = 0 说明 node.key 等于 x.key 说明需要进行替换操作</span></span><br><span class="line">            <span class="comment">// cmp &lt; 0 说明 node.key 小于 x.key 需要到x的左子树查找</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">cmp</span> <span class="operator">=</span> node.key.compareTo(x.key);</span><br><span class="line">            <span class="keyword">if</span> (cmp &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                x = x.right;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (cmp == <span class="number">0</span>) &#123;</span><br><span class="line">                x.setValue(node.getValue());</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                x = x.left;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        node.parent = parent;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (parent != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="comment">// 判断 node与parent 的key 谁大</span></span><br><span class="line">            <span class="comment">// cmp &gt; 0 说明 当前node的key比parent的key大，需要把node放入parent的右子节点</span></span><br><span class="line">            <span class="comment">// cmp &lt; 0 说明 当前node的key比parent的key小，需要把node放入parent的左子节点</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">cmp</span> <span class="operator">=</span> node.key.compareTo(parent.key);</span><br><span class="line">            <span class="keyword">if</span> (cmp &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                parent.right = node;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                parent.left = node;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.root = node;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 需要调用修复红黑树平衡的方法，insertFixup();</span></span><br><span class="line">        insertFixup(node);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 插入后修复红黑树平衡的方法</span></span><br><span class="line"><span class="comment">     *      情景1：红黑树为空树，将根节点染色为黑色</span></span><br><span class="line"><span class="comment">     *      情景2：插入节点的key已经存在</span></span><br><span class="line"><span class="comment">     *      情景3：插入节点的父节点为黑色，因为所插入的路径，黑色节点没有变化，所以红黑树依然平衡，不需要处理</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *      情景4：插入节点的父节点为红色（需要处理）</span></span><br><span class="line"><span class="comment">     *          情景4.1：叔叔节点存在，并且为红色（父-叔 双红），将爸爸和叔叔染色为红色，将爷爷染色为红色，并且再以爷爷节点为当前节点，进行下一轮处理</span></span><br><span class="line"><span class="comment">     *          情景4.2：叔叔节点不存在，或者为黑色，父节点为爷爷节点的左子树</span></span><br><span class="line"><span class="comment">     *              情景4.2.1：插入节点为其父节点的左子节点（LL情况），将爸爸染色为黑色，将爷爷染色为红色，然后以爷爷节点右旋，就完成了</span></span><br><span class="line"><span class="comment">     *              情景4.2.2：插入节点为其父节点的右子节点（LR情况），</span></span><br><span class="line"><span class="comment">     *                        以爸爸节点进行一次左旋，得到LL双红的情景（4.2.1），然后指定爸爸节点为当前节点进行下一轮处理</span></span><br><span class="line"><span class="comment">     *          情景4.3：叔叔节点不存在，或者为黑色，父节点为爷爷节点的右子树</span></span><br><span class="line"><span class="comment">     *              情景4.3.1：插入节点为其父节点的右子节点（RR情况），将爸爸染色为黑色，将爷爷染色为红色，然后以爷爷节点左旋，就完成了</span></span><br><span class="line"><span class="comment">     *              情景4.3.2：插入节点为其父节点的左子节点（RL情况），</span></span><br><span class="line"><span class="comment">     *                        以爸爸节点进行一次右旋，得到RR双红的情景（4.3.1），然后爸爸节点为当前节点进行下一轮处理</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">insertFixup</span><span class="params">(RBNode node)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.root.setColor(BLACK);  <span class="comment">// 处理情景1，情景2、3不需要处理</span></span><br><span class="line"></span><br><span class="line">        <span class="type">RBNode</span> <span class="variable">parent</span> <span class="operator">=</span> parentOf(node);</span><br><span class="line">        <span class="type">RBNode</span> <span class="variable">gparent</span> <span class="operator">=</span> parentOf(parent);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 情景4：插入节点的父节点为红色</span></span><br><span class="line">        <span class="keyword">if</span> (parent != <span class="literal">null</span> &amp;&amp; isRed(parent)) &#123;</span><br><span class="line">            <span class="comment">// 如果父节点为红色，那么一定存在爷爷节点，因为根节点不可能是红色</span></span><br><span class="line"></span><br><span class="line">            <span class="type">RBNode</span> <span class="variable">uncle</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (parent == gparent.left) &#123;   <span class="comment">// 父节点为爷爷节点的左子树</span></span><br><span class="line">                uncle = gparent.right;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 情景4.1：叔叔节点存在，并且为红色</span></span><br><span class="line">                <span class="keyword">if</span> (uncle != <span class="literal">null</span> &amp;&amp; isRed(uncle)) &#123;</span><br><span class="line">                    <span class="comment">// 将爸爸和叔叔染色为红色，将爷爷染色为红色，并且再以爷爷节点为当前节点，进行下一轮处理</span></span><br><span class="line">                    setBlack(parent);</span><br><span class="line">                    setBlack(uncle);</span><br><span class="line">                    setRed(gparent);</span><br><span class="line">                    insertFixup(gparent);</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 情景4.2：叔叔节点不存在，或者为黑色</span></span><br><span class="line">                <span class="keyword">if</span> (uncle == <span class="literal">null</span> || isBlack(uncle)) &#123;</span><br><span class="line">                    <span class="comment">// 插入节点为其父节点的左子节点（LL情况），将爸爸染色为黑色，将爷爷染色为红色，然后以爷爷节点右旋，就完成了</span></span><br><span class="line">                    <span class="keyword">if</span> (node == parent.left) &#123;</span><br><span class="line">                        setBlack(parent);</span><br><span class="line">                        setRed(gparent);</span><br><span class="line">                        rightRotate(gparent);</span><br><span class="line">                        <span class="keyword">return</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">// 情景4.2.2：插入节点为其父节点的右子节点（LR情况）</span></span><br><span class="line">                    <span class="comment">// 以爸爸节点进行一次左旋，得到LL双红的情景（4.2.1），然后指定爸爸节点为当前节点进行下一轮处理</span></span><br><span class="line">                    <span class="keyword">if</span> (node == parent.right) &#123;</span><br><span class="line">                        leftRotate(parent);</span><br><span class="line">                        insertFixup(parent);</span><br><span class="line">                        <span class="keyword">return</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;    <span class="comment">// 父节点为爷爷节点的右子树</span></span><br><span class="line"></span><br><span class="line">                uncle = gparent.left;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 情景4.1：叔叔节点存在，并且为红色</span></span><br><span class="line">                <span class="keyword">if</span> (uncle != <span class="literal">null</span> &amp;&amp; isRed(uncle)) &#123;</span><br><span class="line">                    <span class="comment">// 将爸爸和叔叔染色为红色，将爷爷染色为红色，并且再以爷爷节点为当前节点，进行下一轮处理</span></span><br><span class="line">                    setBlack(parent);</span><br><span class="line">                    setBlack(uncle);</span><br><span class="line">                    setRed(gparent);</span><br><span class="line">                    insertFixup(gparent);</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 情景4.3：叔叔节点不存在，或者为黑色，父节点为爷爷节点的右子树</span></span><br><span class="line">                <span class="keyword">if</span> (uncle == <span class="literal">null</span> || isBlack(uncle)) &#123;</span><br><span class="line">                    <span class="comment">// 情景4.3.1：插入节点为其父节点的右子节点（RR情况），将爸爸染色为黑色，将爷爷染色为红色，然后以爷爷节点左旋，就完成了</span></span><br><span class="line">                    <span class="keyword">if</span> (node == parent.right) &#123;</span><br><span class="line">                        setBlack(parent);</span><br><span class="line">                        setRed(gparent);</span><br><span class="line">                        leftRotate(gparent);</span><br><span class="line">                        <span class="keyword">return</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// 情景4.3.2：插入节点为其父节点的左子节点（RL情况），</span></span><br><span class="line">                    <span class="comment">// 以爸爸节点进行一次右旋，得到RR双红的情景（4.3.1），然后爸爸节点为当前节点进行下一轮处理</span></span><br><span class="line">                    <span class="keyword">if</span> (node == parent.left) &#123;</span><br><span class="line">                        rightRotate(parent);</span><br><span class="line">                        insertFixup(parent);</span><br><span class="line">                        <span class="keyword">return</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 左旋方法</span></span><br><span class="line"><span class="comment">     * 左旋示意图：左旋x节点</span></span><br><span class="line"><span class="comment">     *    p                         p</span></span><br><span class="line"><span class="comment">     *    |                         |</span></span><br><span class="line"><span class="comment">     *    x                         y</span></span><br><span class="line"><span class="comment">     *   / \            ----&gt;      / \</span></span><br><span class="line"><span class="comment">     *  lx  y                     x   ry</span></span><br><span class="line"><span class="comment">     *     / \                   / \</span></span><br><span class="line"><span class="comment">     *    ly  ry                lx  ly</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * 1.x的右子节点指向y的左子节点（ly），将y的左子节点的父节点更新为x</span></span><br><span class="line"><span class="comment">     * 2.当x的父节点（不为空时），更新y的父节点为x的父节点，并将x的父节点 指定子节点（当前x的位置）为y</span></span><br><span class="line"><span class="comment">     * 3.将x的父节点更新为y，将y的左子节点更新为x</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">leftRotate</span><span class="params">(RBNode x)</span> &#123;</span><br><span class="line">        <span class="comment">// 1.x的右子节点指向y的左子节点（ly），将y的左子节点的父节点更新为x</span></span><br><span class="line">        <span class="type">RBNode</span> <span class="variable">y</span> <span class="operator">=</span> x.right;</span><br><span class="line">        x.right = y.left;</span><br><span class="line">        <span class="keyword">if</span> (y.left != <span class="literal">null</span>) &#123;</span><br><span class="line">            y.left.parent = x;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2.当x的父节点（不为空时），更新y的父节点为x的父节点，并将x的父节点 指定子节点（当前x的位置）为y</span></span><br><span class="line">        <span class="keyword">if</span> (x.parent != <span class="literal">null</span>) &#123;</span><br><span class="line">            y.parent = x.parent;</span><br><span class="line">            <span class="keyword">if</span> (x == x.parent.left) &#123;</span><br><span class="line">                x.parent.left = y;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                x.parent.right = y;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 说明 x是根节点，吃时需要更新 y为根节点的引用引用</span></span><br><span class="line">            <span class="built_in">this</span>.root = y;</span><br><span class="line">            <span class="built_in">this</span>.root.parent = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3.将x的父节点更新为y，将y的左子节点更新为x</span></span><br><span class="line">        x.parent = y;</span><br><span class="line">        y.left = x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 右旋方法</span></span><br><span class="line"><span class="comment">     * 右旋示意图：右旋y节点</span></span><br><span class="line"><span class="comment">     *     p                         p</span></span><br><span class="line"><span class="comment">     *     |                         |</span></span><br><span class="line"><span class="comment">     *     y                         x</span></span><br><span class="line"><span class="comment">     *    / \            ----&gt;      / \</span></span><br><span class="line"><span class="comment">     *   x   ry                    lx  y</span></span><br><span class="line"><span class="comment">     *  / \                           / \</span></span><br><span class="line"><span class="comment">     * lx  ly                        ly  ry</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * 1.将y的左子节点指向x的右子节点（ly），将x的右子节点的父节点更新为y</span></span><br><span class="line"><span class="comment">     * 2.当y的父节点（不为空时），更新x的父节点为y的父节点，并将y的父节点 指定子节点（当前y的位置）为x</span></span><br><span class="line"><span class="comment">     * 3.将y的父节点更新为x，将x的右子节点更新为y</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">rightRotate</span><span class="params">(RBNode y)</span> &#123;</span><br><span class="line">        <span class="comment">// 1.将y的左子节点指向x的右子节点（ly），将x的右子节点的父节点更新为y</span></span><br><span class="line">        <span class="type">RBNode</span> <span class="variable">x</span> <span class="operator">=</span> y.left;</span><br><span class="line">        y.left = x.right;</span><br><span class="line">        <span class="keyword">if</span> (x.right != <span class="literal">null</span>) &#123;</span><br><span class="line">            x.right.parent = y;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2.当y的父节点（不为空时），更新x的父节点为y的父节点，并将y的父节点 指定子节点（当前y的位置）为x</span></span><br><span class="line">        <span class="keyword">if</span> (y.parent != <span class="literal">null</span>) &#123;</span><br><span class="line">            x.parent = y.parent;</span><br><span class="line">            <span class="keyword">if</span> (y == y.parent.left) &#123;</span><br><span class="line">                y.parent.left = x;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                y.parent.right = x;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.root = x;</span><br><span class="line">            <span class="built_in">this</span>.root.parent = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3.将y的父节点更新为x，将x的右子节点更新为y</span></span><br><span class="line">        y.parent = x;</span><br><span class="line">        x.right = y;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 红黑树节点，（父亲节点，左节点，右节点，节点颜色，节点值(K,V) ）</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;K&gt;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;V&gt;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">RBNode</span> &lt;K <span class="keyword">extends</span>  <span class="title class_">Comparable</span>&lt;K&gt;, V&gt; &#123;</span><br><span class="line">        <span class="keyword">private</span> RBNode parent;  <span class="comment">// 父亲节点</span></span><br><span class="line">        <span class="keyword">private</span> RBNode left;    <span class="comment">// 左节点</span></span><br><span class="line">        <span class="keyword">private</span> RBNode right;   <span class="comment">// 右节点</span></span><br><span class="line">        <span class="keyword">private</span> <span class="type">boolean</span> color;</span><br><span class="line">        <span class="keyword">private</span> K key;</span><br><span class="line">        <span class="keyword">private</span> V value;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">RBNode</span><span class="params">()</span> &#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">RBNode</span><span class="params">(RBNode parent, RBNode left, RBNode right, <span class="type">boolean</span> color, K key, V value)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.parent = parent;</span><br><span class="line">            <span class="built_in">this</span>.left = left;</span><br><span class="line">            <span class="built_in">this</span>.right = right;</span><br><span class="line">            <span class="built_in">this</span>.color = color;</span><br><span class="line">            <span class="built_in">this</span>.key = key;</span><br><span class="line">            <span class="built_in">this</span>.value = value;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> RBNode <span class="title function_">getParent</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> parent;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setParent</span><span class="params">(RBNode parent)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.parent = parent;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> RBNode <span class="title function_">getLeft</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> left;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setLeft</span><span class="params">(RBNode left)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.left = left;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> RBNode <span class="title function_">getRight</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> right;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setRight</span><span class="params">(RBNode right)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.right = right;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isColor</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> color;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setColor</span><span class="params">(<span class="type">boolean</span> color)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.color = color;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> K <span class="title function_">getKey</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> key;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setKey</span><span class="params">(K key)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.key = key;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> V <span class="title function_">getValue</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> value;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setValue</span><span class="params">(V value)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.value = value;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p><strong>注意细节</strong></p>
</blockquote>
<ul>
<li>新插入节点一定是 <strong>红色节点</strong></li>
<li>新插入节点左旋换色</li>
</ul>
<h3 id="图"><a href="#图" class="headerlink" title="图"></a>图</h3><p><em>许久前跟一哥们去他女同学家修电脑，巧的是女同学跟她闺蜜都在。依稀听见闺蜜说，会修电脑有什么厉害的。我在门前淡淡的想，会修电脑确实没什么厉害的，不过修电脑不要钱确实挺厉害的</em></p>
<h1 id="Algorithm"><a href="#Algorithm" class="headerlink" title="Algorithm"></a>Algorithm</h1><h2 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h2><blockquote>
<p><strong>排序分类</strong></p>
</blockquote>
<ul>
<li><p>比较类排序 –时间复杂度不能突破 O(nlogn)</p>
<ul>
<li>冒泡排序</li>
<li>选择排序</li>
<li>插入排序</li>
<li>快速排序</li>
<li>希尔排序</li>
<li>归并排序</li>
<li>堆排序</li>
</ul>
</li>
<li><p>非比较类排序 –不通过比较来决定元素间次序 可以<strong>突破基于比较排序的时间下限</strong>达到 <strong>O(n)</strong> 的时间复杂度 代价是 <strong>空间换时间</strong></p>
<ul>
<li><p>计数排序</p>
</li>
<li><p>桶排序</p>
</li>
<li><p>基数排序</p>
</li>
</ul>
</li>
</ul>
<p><em><strong>排序的稳定性</strong></em></p>
<p>注意 根据数据分布的不同 来选择更为合适的算法 <em>下为运行时间比较</em></p>
<ul>
<li>数据分布 完全随机 – Select &gt; Bubble &gt; Insert &gt; Shell &gt; QuickUpper &gt; Merge</li>
<li>数据分布 大致有序 升序 – Select &gt; Bubble &gt; Shell &gt; Merge &gt; Insert &gt; QuickUpper</li>
<li>数据分布 大致有序 降序 – Select &gt; Bubble &gt; Insert &gt; Shell &gt; Merge &gt; QuickUpper</li>
<li>数据分布 大致平稳 – Bubble &gt; Select &gt; Insert &gt; Shell &gt; Merge &gt; QuickUpper</li>
</ul>
<p>Sort</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P5.SortingAlgorithm;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* 算法的执行时间 除了与算法的策略有关 还跟数据分布情况有关</span></span><br><span class="line"><span class="comment">* 数据的分布情况有：</span></span><br><span class="line"><span class="comment">*  ms   完全随机  大致有序  大致平稳</span></span><br><span class="line"><span class="comment">* 选择   150      12      70</span></span><br><span class="line"><span class="comment">* 冒泡   120      13      100</span></span><br><span class="line"><span class="comment">* 插入   20       1       10</span></span><br><span class="line"><span class="comment">* 希尔   3        2       3</span></span><br><span class="line"><span class="comment">* 归并   2        0       3</span></span><br><span class="line"><span class="comment">* 单路快  2        2      2</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* 桶排序（非比较类排序）</span></span><br><span class="line"><span class="comment">* 计数排序（非比较类排序）</span></span><br><span class="line"><span class="comment">* 基数排序（非比较类排序）</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Sort</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span>[] arr;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span>  <span class="title function_">Sort</span><span class="params">()</span>&#123;&#125;</span><br><span class="line">    <span class="keyword">public</span>  <span class="title function_">Sort</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.arr = <span class="keyword">new</span> <span class="title class_">int</span>[arr.length];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">            <span class="built_in">this</span>.arr[i] = arr[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">sort</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">swap</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> j)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">tmp</span> <span class="operator">=</span> arr[i];</span><br><span class="line">        arr[i] = arr[j];</span><br><span class="line">        arr[j] = tmp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="比较类排序"><a href="#比较类排序" class="headerlink" title="比较类排序"></a>比较类排序</h3><h4 id="冒泡排序"><a href="#冒泡排序" class="headerlink" title="冒泡排序"></a>冒泡排序</h4><blockquote>
<p><strong>冒泡排序性质</strong></p>
</blockquote>
<ul>
<li>重复依次遍历所有数列 两两比较 判定两者的顺序是否满足要求 如果不满足则交换 从而将 最大或最小的 元素 上浮至末端位置 再从剩余未排序的元素中重复操作</li>
<li>时间复杂度 O(n^2)</li>
<li>空间复杂度 O(1)</li>
<li>稳定</li>
</ul>
<p>BubbleSort</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P5.SortingAlgorithm;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="comment">//冒泡排序 O(n^2) O(1) 稳定</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BubbleSort</span> <span class="keyword">extends</span> <span class="title class_">Sort</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BubbleSort</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(arr);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sort</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; arr.length - <span class="number">1</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; arr.length - i - <span class="number">1</span>; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (arr[j] &gt; arr[j + <span class="number">1</span>]) &#123;</span><br><span class="line">                    swap(j, j + <span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//        System.out.println(Arrays.toString(arr));</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="选择排序"><a href="#选择排序" class="headerlink" title="选择排序"></a>选择排序</h4><blockquote>
<p><strong>选择排序性质</strong></p>
</blockquote>
<ul>
<li>选择排序将最大或最小的元素找出 排列到序列起始位置 再从剩余未排序的元素中依次找出 最大或最小 的元素 直至排列完整</li>
<li>时间复杂度 O(n^2)</li>
<li>空间复杂度 O(1)</li>
<li>不稳定</li>
</ul>
<p>SelectSort</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P5.SortingAlgorithm;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="comment">//选择排序 O(n^2) S(1) 不稳定</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SelectSort</span> <span class="keyword">extends</span> <span class="title class_">Sort</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">SelectSort</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(arr);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sort</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i + <span class="number">1</span>; j &lt; arr.length; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (arr[i] &gt; arr[j]) &#123;</span><br><span class="line">                    swap(i, j);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//        System.out.println(Arrays.toString(arr));</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="插入排序"><a href="#插入排序" class="headerlink" title="插入排序"></a>插入排序</h4><blockquote>
<p><strong>插入排序性质</strong></p>
</blockquote>
<ul>
<li>插入排序通过构建和完善已有的有序数列 同时依次遍历剩余的无序队列 将无序队列中的元素 挨个插入到有序队列中对应位置</li>
<li>时间复杂度 O(n^2)</li>
<li>空间复杂度 O(1)</li>
<li>稳定</li>
</ul>
<p>InsertSort</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P5.SortingAlgorithm;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="comment">//插入排序 O(n^2) S(1) 稳定</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">InsertSort</span> <span class="keyword">extends</span> <span class="title class_">Sort</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">InsertSort</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(arr);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sort</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">e</span> <span class="operator">=</span> arr[i];</span><br><span class="line">            <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (j = i; j &gt; <span class="number">0</span> &amp;&amp; arr[j - <span class="number">1</span>] &gt; e; j--) &#123;</span><br><span class="line">                arr[j] = arr[j - <span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">            arr[j] = e;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//        System.out.println(Arrays.toString(arr));</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="快速排序"><a href="#快速排序" class="headerlink" title="快速排序"></a>快速排序</h4><blockquote>
<p><strong>快速排序性质</strong></p>
</blockquote>
<ul>
<li>通过设置关键字 ( 可将数列第一个数字作为关键字 )  进行第一趟排序 将待排序的数列分成两个独立的部分 其中一部分关键字均比另一部分小 另一部分比关键字大 再进行重复操作 直至关键字左右两部分的 元素只剩一个或没有 最后将 数据整合归并</li>
<li>时间复杂度 O(nlogn) –对于特例 ( 大致升序或降序 –极端子树情况 ) 情况可能导致时间复杂度升至 O(n^2)</li>
<li>空间复杂度 O(1)</li>
<li>不稳定</li>
</ul>
<p>快速排序分为 <em>当元素个数少时 优化排序算法选择 –希尔排序与快速排序结合</em></p>
<ul>
<li>单路快速排序 –一个关键字</li>
<li>通过<strong>交换</strong> 保持 关键字左右两部分的元素</li>
<li>i j 控制的范围 同步增长 从左到右遍历</li>
<li>双路快速排序 –两个关键字<ul>
<li>对比单路快排 将等于的情况 合理的划分到两端</li>
<li>i 控制的范围从左开始遍历增长 j 控制的范围从右开始遍历增长</li>
</ul>
</li>
<li>三路快速排序 –三个关键字<ul>
<li>三路快排将 大于 v 等于 v 与 小于 v 分为三个部分考虑</li>
<li>小于 v 使用 i 从左往右遍历 通过交换 将 等于 排列在 小于后面 而大于 v 使用 j 从右往左 排列交换 总体通过 i 遍历排序</li>
</ul>
</li>
</ul>
<p>QuickSort01</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P5.SortingAlgorithm;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* 单路快排</span></span><br><span class="line"><span class="comment">* 快速排序基本思想：通过一趟排序将待排记录分隔成独立的两部分，其中一部分记录的关键</span></span><br><span class="line"><span class="comment">* 字均比另一部分的关键字小，比另一部分的关键字大，则可分别对这两部分记录继续进行排序，</span></span><br><span class="line"><span class="comment">* 以达到整个序列有序</span></span><br><span class="line"><span class="comment">* O(nlogn)</span></span><br><span class="line"><span class="comment">* S(1)</span></span><br><span class="line"><span class="comment">* 不稳定</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">QuickSort01</span> <span class="keyword">extends</span> <span class="title class_">Sort</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">QuickSort01</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(arr);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sort</span><span class="params">()</span> &#123;</span><br><span class="line">        quickSort(<span class="number">0</span>, arr.length - <span class="number">1</span>);</span><br><span class="line"><span class="comment">//        System.out.println(Arrays.toString(arr));</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">quickSort</span><span class="params">(<span class="type">int</span> L, <span class="type">int</span> R)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (L &gt;= R) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//先对数组进行划分 并返回划分后的中点</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">p</span> <span class="operator">=</span> partition(L, R);</span><br><span class="line">        quickSort(L, p - <span class="number">1</span>);</span><br><span class="line">        quickSort(p + <span class="number">1</span>, R);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="title function_">partition</span><span class="params">(<span class="type">int</span> L, <span class="type">int</span> R)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//优化 随机让后面的数字和第一个数字交换</span></span><br><span class="line">        <span class="comment">//L = 5 R = 10 [0,5] + 5 = [5,10]</span></span><br><span class="line">        <span class="comment">//尽量避免极端情况 --极端子树情况 退化成 O(n)</span></span><br><span class="line">        swap(L, (<span class="type">int</span>)(Math.random() * (R - L + <span class="number">1</span>) + L));</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">v</span> <span class="operator">=</span> arr[L];</span><br><span class="line">        <span class="comment">//arr[l+1 ~ j] &lt; v &lt; arr[j+1 ~ i)</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> L;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> L + <span class="number">1</span>; i &lt;= R; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (arr[i] &lt; v) &#123;</span><br><span class="line">                swap(j + <span class="number">1</span>, i);</span><br><span class="line">                j++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        swap(L, j);</span><br><span class="line">        <span class="keyword">return</span> j;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>QuickSort02</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P5.SortingAlgorithm;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* 双路快排</span></span><br><span class="line"><span class="comment">* 优化使得，当重复出现多次相同数字时，减少递归次数，使得运行时间更接近于nlogn</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">QuickSort02</span> <span class="keyword">extends</span> <span class="title class_">Sort</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">QuickSort02</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(arr);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sort</span><span class="params">()</span> &#123;</span><br><span class="line">        quicSort(<span class="number">0</span>, arr.length - <span class="number">1</span>);</span><br><span class="line">        System.out.println(Arrays.toString(arr));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">quicSort</span><span class="params">(<span class="type">int</span> L, <span class="type">int</span> R)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (L &gt;= R) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//先对数组进行划分 并返回划分后的中点</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">p</span> <span class="operator">=</span> partition(L, R);</span><br><span class="line">        quicSort(L, p - <span class="number">1</span>);</span><br><span class="line">        quicSort(p + <span class="number">1</span>, R);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="title function_">partition</span><span class="params">(<span class="type">int</span> L, <span class="type">int</span> R)</span> &#123;</span><br><span class="line">        <span class="comment">//忧患 随机交换第一个数字和后面的一个数字，尽量避免极端情况(升序情况)</span></span><br><span class="line">        swap(L, (<span class="type">int</span>)(Math.random() * (R - L + <span class="number">1</span>) + L));</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">v</span> <span class="operator">=</span> arr[L];</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> L + <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> R;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="keyword">while</span> (i &lt;= R &amp;&amp; arr[i] &lt; v) &#123;</span><br><span class="line">                i++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">while</span> (j &gt;= L + <span class="number">1</span> &amp;&amp; arr[j] &gt; v) &#123;</span><br><span class="line">                j--;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (i &gt; j) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            swap(i, j);</span><br><span class="line">            i++;</span><br><span class="line">            j--;</span><br><span class="line">        &#125;</span><br><span class="line">        swap(L, j);</span><br><span class="line">        <span class="keyword">return</span> j;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>QuickSort03</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P5.SortingAlgorithm;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 三路快排</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">QuickSort03</span> <span class="keyword">extends</span> <span class="title class_">Sort</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sort</span><span class="params">()</span> &#123;</span><br><span class="line">        quickSort(<span class="number">0</span>, arr.length - <span class="number">1</span>);</span><br><span class="line">        System.out.println(Arrays.toString(arr));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">quickSort</span><span class="params">(<span class="type">int</span> L, <span class="type">int</span> R)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (L &gt;= R) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        swap(L, (<span class="type">int</span>) (Math.random() * (R - L + <span class="number">1</span>) + L));</span><br><span class="line">        <span class="type">int</span> <span class="variable">v</span> <span class="operator">=</span> arr[L];</span><br><span class="line">        <span class="type">int</span> <span class="variable">lt</span> <span class="operator">=</span> L;</span><br><span class="line">        <span class="type">int</span> <span class="variable">gt</span> <span class="operator">=</span> R + <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> L + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (i &lt; gt) &#123;</span><br><span class="line">            <span class="keyword">if</span> (arr[i] &lt; v) &#123;</span><br><span class="line">                swap(i, lt + <span class="number">1</span>);</span><br><span class="line">                lt++;</span><br><span class="line">                i++;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (arr[i] &gt; v) &#123;</span><br><span class="line">                swap(i, gt - <span class="number">1</span>);</span><br><span class="line">                gt--;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                i++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        swap(L, lt);</span><br><span class="line">        quickSort(L, lt - <span class="number">1</span>);</span><br><span class="line">        quickSort(gt, R);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="希尔排序"><a href="#希尔排序" class="headerlink" title="希尔排序"></a>希尔排序</h4><blockquote>
<p><strong>希尔排序性质</strong></p>
</blockquote>
<ul>
<li>Shell 发明第一个突破 O(n^2) 级别的排序 是插入排序的一种改进增强 优先比较距离较远的元素 又称为 缩小增量排序</li>
<li>时间复杂度 O(n^1.3) –Master 主定理 </li>
<li>空间复杂度 O(1)</li>
<li>不稳定</li>
</ul>
<p>ShellSort</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P5.SortingAlgorithm;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* shell sort 是第一个突破O(n^2)的排序算法，是简单插入排序的改进版。他与擦汗如排序</span></span><br><span class="line"><span class="comment">* 的不同之处在于，它会优先比较距离较远的元素。希尔排序又叫缩小增量排序</span></span><br><span class="line"><span class="comment">* O(n^1.3)</span></span><br><span class="line"><span class="comment">* O(1)</span></span><br><span class="line"><span class="comment">* 不稳定</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ShellSort</span> <span class="keyword">extends</span> <span class="title class_">Sort</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ShellSort</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(arr);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sort</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> arr.length;</span><br><span class="line">        <span class="comment">// 选择 grep 跨度空间 可以是 len / 2 也可以是 len / 3 也可以是任意值</span></span><br><span class="line">        <span class="comment">// grep 跨度空间是多少 遍历 i 就从哪个元素开始</span></span><br><span class="line">        <span class="comment">// 比较跨度空间两端的元素 跨度空间依次向前遍历移动 不符合要求就交换 当 i 之前元素遍历结束 i++ 确定下一个跨度空间位置 </span></span><br><span class="line">        <span class="comment">// 一轮结束 缩小跨度空间 重复操作 直至跨度空间为 1 --即普通插入排序</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">gap</span> <span class="operator">=</span> len / <span class="number">2</span>; gap &gt; <span class="number">0</span>; gap = gap / <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> gap; i &lt; len; i++) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">e</span> <span class="operator">=</span> arr[i];</span><br><span class="line">                <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i;</span><br><span class="line">                <span class="keyword">while</span> (j - gap &gt;= <span class="number">0</span> &amp;&amp; arr[j - gap] &gt; e) &#123;</span><br><span class="line">                    arr[j] = arr[j - gap];</span><br><span class="line">                    j = j - gap;</span><br><span class="line">                &#125;</span><br><span class="line">                arr[j] = e;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//        System.out.println(Arrays.toString(arr));</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="归并排序"><a href="#归并排序" class="headerlink" title="归并排序"></a>归并排序</h4><blockquote>
<p><strong>归并排序性质</strong></p>
</blockquote>
<ul>
<li>归并排序采用分治法 将已有序的子序列合并 得到完全有序的序列</li>
<li>将两个有序表合并成一个有序表 称为 二路归并</li>
<li>时间复杂度 O(nlogn)</li>
<li>空间复杂度 O(n)</li>
</ul>
<p>MergeSort</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P5.SortingAlgorithm;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* 归并排序</span></span><br><span class="line"><span class="comment">* 归并排序是建立在归并操作上的一种有效的排序操作。该算法采用分治回溯的思想。</span></span><br><span class="line"><span class="comment">* 将已有序的子序列合并，得到完全有序的序列，即先使每个子序列有序，再</span></span><br><span class="line"><span class="comment">* 使子序列段间有序。若将两个有序表合并成一个有序表，称为二路归并</span></span><br><span class="line"><span class="comment">* O(nlogn)</span></span><br><span class="line"><span class="comment">* S(n)</span></span><br><span class="line"><span class="comment">* 稳定</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MergeSort</span> <span class="keyword">extends</span> <span class="title class_">Sort</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MergeSort</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(arr);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sort</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 归并排序</span></span><br><span class="line">        mergeSort(<span class="number">0</span>, arr.length - <span class="number">1</span>);</span><br><span class="line"><span class="comment">//        System.out.println(Arrays.toString(arr));</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * @Description: 归并排序</span></span><br><span class="line"><span class="comment">     * @param L </span></span><br><span class="line"><span class="comment">     * @param R </span></span><br><span class="line"><span class="comment">     * @return: void </span></span><br><span class="line"><span class="comment">     * @Author: Kking</span></span><br><span class="line"><span class="comment">     * @Date: 2022/11/9 17:55</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">mergeSort</span><span class="params">(<span class="type">int</span> L, <span class="type">int</span> R)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (L &gt;= R) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> (L + R) / <span class="number">2</span>;</span><br><span class="line">        <span class="comment">//递归排序当前层级的左边</span></span><br><span class="line">        mergeSort(L, mid);</span><br><span class="line">        <span class="comment">//递归排序当前层级的右边</span></span><br><span class="line">        mergeSort(mid + <span class="number">1</span>, R);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//左边排序完了 且右边排序完了 进行合并</span></span><br><span class="line">        <span class="comment">//特殊 如果左边的最大值arr[mid]小于等于右边的最小值arr[mid+1] 则不需要合并</span></span><br><span class="line">        <span class="keyword">if</span> (arr[mid] &gt; arr[mid + <span class="number">1</span>]) &#123;</span><br><span class="line">            merge(L, mid, R);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 合并 排序完后 合并返回完整有序</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">merge</span><span class="params">(<span class="type">int</span> L, <span class="type">int</span> mid, <span class="type">int</span> R)</span> &#123;</span><br><span class="line">        <span class="type">int</span>[] aux = <span class="keyword">new</span> <span class="title class_">int</span>[R - L + <span class="number">1</span>];</span><br><span class="line">        <span class="comment">//复制当前层级中 原数组的内容给 aux</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> L; k &lt;= R; k++) &#123;</span><br><span class="line">            aux[k - L] = arr[k];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//对当前层级中 两个子序列部分进行合并</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        * L ~ mid     0 ~ Len / 2 - 1</span></span><br><span class="line"><span class="comment">        * mid+1 ~ R   Len / 2 ~ Len - 1</span></span><br><span class="line"><span class="comment">        * */</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> L;</span><br><span class="line">        <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> mid + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span>  L; k &lt;= R; k++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i &gt; mid) &#123;</span><br><span class="line">                <span class="comment">//判断左边完毕</span></span><br><span class="line">                arr[k] = aux[j - L];</span><br><span class="line">                j++;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (j &gt; R) &#123;</span><br><span class="line">                <span class="comment">//判断右边完毕</span></span><br><span class="line">                arr[k] = aux[i - L];</span><br><span class="line">                i++;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (aux[i - L] &lt; aux[j - L]) &#123;</span><br><span class="line">                arr[k] = aux[i - L];</span><br><span class="line">                i++;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                arr[k] = aux[j - L];</span><br><span class="line">                j++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意</p>
<ul>
<li>归并两个有序数列 分别使用 i j 指针 依次遍历 比较大小后填入新数组即可</li>
</ul>
<h4 id="堆排序"><a href="#堆排序" class="headerlink" title="堆排序"></a>堆排序</h4><blockquote>
<p><strong>HeapSort性质</strong></p>
</blockquote>
<ul>
<li><p>利用堆数据结构设计。堆是一个近似完全二叉树结构。满足性质–子节点的键值或索引总是小于-最大堆（或大于-最小堆）它的父节点。使用数组定义该结构。注意获取孩子节点索引公式。</p>
</li>
<li><p>时间复杂度 Onlogn 空间复杂度 O1</p>
</li>
<li><p>不稳定</p>
</li>
</ul>
<p>HeapSort</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P5.SortingAlgorithm;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="comment">//堆排序 O(nlogn)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HeapSort</span> <span class="keyword">extends</span> <span class="title class_">Sort</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">HeapSort</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(arr);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sort</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//1、对原数组进行最大堆化</span></span><br><span class="line">        heapify(arr);</span><br><span class="line">        <span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> arr.length;</span><br><span class="line">        <span class="comment">//2、将每个范围内的最大值放到该范围的后面即可</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> arr.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">            swap(<span class="number">0</span>, i);</span><br><span class="line">            len--;</span><br><span class="line">            siftDown(<span class="number">0</span>, len);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(Arrays.toString(arr));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">heapify</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">        <span class="comment">//从最后一个元素开始 将每个元素做下沉处理</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> arr.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">            siftDown(i, arr.length);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">siftDown</span><span class="params">(<span class="type">int</span> k, <span class="type">int</span> len)</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (leftChild(k) &lt; len) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> leftChild(k);</span><br><span class="line">            <span class="keyword">if</span> (j + <span class="number">1</span> &lt; len &amp;&amp; arr[j + <span class="number">1</span>] &gt; arr[j]) &#123;</span><br><span class="line">                j = rightChild(k);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (arr[k] &lt; arr[j]) &#123;</span><br><span class="line">                swap(k, j);</span><br><span class="line">                k = j;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//辅助函数 --获取左孩子的索引</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="title function_">leftChild</span><span class="params">(<span class="type">int</span> index)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span> * index + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//辅助函数--获取右孩子的索引</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="title function_">rightChild</span><span class="params">(<span class="type">int</span> index)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span> * index + <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<h3 id="非比较类排序"><a href="#非比较类排序" class="headerlink" title="非比较类排序"></a>非比较类排序</h3><h4 id="计数排序"><a href="#计数排序" class="headerlink" title="计数排序"></a>计数排序</h4><blockquote>
<p><strong>CountingSort基本思想</strong></p>
</blockquote>
<ul>
<li>非比较类排序，核心在于将输入的数据转化成键存储在额外开辟的数组空间</li>
<li>作为一种线性时间复杂度的排序，计数排序要求输入的数据必须是有确定范围的整数</li>
<li>时间复杂度 On+m</li>
<li>空间复杂度 Om</li>
<li>稳定</li>
</ul>
<p>CountingSort</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P5.SortingAlgorithm;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 计数排序</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CountingSort</span> <span class="keyword">extends</span> <span class="title class_">Sort</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">CountingSort</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(arr);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sort</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//1、找最大值和最小值</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">max</span> <span class="operator">=</span> arr[<span class="number">0</span>];</span><br><span class="line">        <span class="type">int</span> <span class="variable">min</span> <span class="operator">=</span> arr[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (arr[i] &gt; max) &#123;</span><br><span class="line">                max = arr[i];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (arr[i] &lt; min) &#123;</span><br><span class="line">                min = arr[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//2、确定桶的长度 确定 数据-&gt;桶索引的转换关系 和 桶索引-&gt;数据的转换关系</span></span><br><span class="line">        <span class="comment">//创建桶（桶专门用于统计数据出现的次数）</span></span><br><span class="line">        <span class="type">int</span>[] counts = <span class="keyword">new</span> <span class="title class_">int</span>[max - min + <span class="number">1</span>];</span><br><span class="line">        <span class="comment">//index = num - min</span></span><br><span class="line">        <span class="comment">//num = index + min</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//3、遍历原数组arr 将每个数据出现的次数统计在桶里</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">            counts[arr[i] - min]++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4、遍历桶 按照从左到右的顺序 将每个数字按照出现的次数 依次回填arr</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> <span class="number">0</span>; index &lt; counts.length; index++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>; count &lt; counts[index]; count++) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> index + min;</span><br><span class="line">                arr[k++] = num;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(Arrays.toString(arr));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h4 id="桶排序"><a href="#桶排序" class="headerlink" title="桶排序"></a>桶排序</h4><blockquote>
<p><strong>BucketSort性质</strong></p>
</blockquote>
<ul>
<li>桶排序是计数排序的升级，利用函数映射，是否高效取决于这个映射函数。原理即，将数据分到有限个数的桶里，每个桶再分别排序</li>
<li>时间复杂度 On+m</li>
<li>空间复杂度 On+m</li>
<li>稳定</li>
</ul>
<p>BucketSort</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P5.SortingAlgorithm;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> P2.linearStructure.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.Comparator;</span><br><span class="line"></span><br><span class="line"><span class="comment">//桶排序</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BucketSort</span> <span class="keyword">extends</span> <span class="title class_">Sort</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BucketSort</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(arr);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sort</span><span class="params">()</span> &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//1、找到最大值和最小值</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">max</span> <span class="operator">=</span> arr[<span class="number">0</span>];</span><br><span class="line">        <span class="type">int</span> <span class="variable">min</span> <span class="operator">=</span> arr[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (arr[i] &gt; max) &#123;</span><br><span class="line">                max = arr[i];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (arr[i] &lt; min) &#123;</span><br><span class="line">                min = arr[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//2、确定桶的个数 并创建桶</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">bucketNum</span> <span class="operator">=</span> (max - min) / arr.length + <span class="number">1</span>;</span><br><span class="line">        ArrayList&lt;Integer&gt; list[] = <span class="keyword">new</span> <span class="title class_">ArrayList</span>[bucketNum];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; list.length; i++) &#123;</span><br><span class="line">            list[i] = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3、遍历源数据 将数据进行分类处理</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">            list[(arr[i] - min) / arr.length].add(arr[i]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4、对每个桶进行排序</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; list.length; i++) &#123;</span><br><span class="line">            list[i].sort(<span class="keyword">new</span> <span class="title class_">Comparator</span>&lt;Integer&gt;() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(Integer o1, Integer o2)</span> &#123;</span><br><span class="line">                    <span class="keyword">return</span> o1 - o2;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line"><span class="comment">//            System.out.println(&quot;第&quot; + (i + 1) + &quot;个桶：&quot; + list[i].toString());</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//5、将所有桶中的数据依次返回到原数组中</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> <span class="number">0</span>;  <span class="comment">//原数组的角标</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; list.length; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; list[i].size(); j++) &#123;</span><br><span class="line">                arr[index++] = list[i].get(j);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//        System.out.println(Arrays.toString(arr));</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="基数排序"><a href="#基数排序" class="headerlink" title="基数排序"></a>基数排序</h4><blockquote>
<p><strong>RadixSort性质</strong></p>
</blockquote>
<ul>
<li>类似于字符串比较 按照低位先排序，后收集，再依次排序高位，直到所有数最高位。但有些属性是有优先级顺序的，可以先按照低优先级排序，再按照高优先级排序，最后高优先级高的在前，高优先级相同，低优先级高的在前</li>
</ul>
<p>RadixSort</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P5.SortingAlgorithm;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> P3.chainStructure.LinkedList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="comment">//基数排序 非比较类排序</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RadixSort</span> <span class="keyword">extends</span> <span class="title class_">Sort</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">RadixSort</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(arr);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sort</span><span class="params">()</span> &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//1、找分类--确定所需要收集的轮数（最大值的长度）</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">radix</span> <span class="operator">=</span> getRadix();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2、创建桶list所有桶的集合 每一个桶是linkedlist 将其当作队列来使用</span></span><br><span class="line">        LinkedList&lt;Integer&gt;[] list = <span class="keyword">new</span> <span class="title class_">LinkedList</span>[<span class="number">10</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; list.length; i++) &#123;</span><br><span class="line">            list[i] = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3、开始 分类--收集</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">r</span> <span class="operator">=</span> <span class="number">1</span>; r &lt;= radix; r++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">                list[getIndex(arr[i], r)].offer(arr[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> <span class="number">0</span>;  <span class="comment">//遍历arr原数组</span></span><br><span class="line">            <span class="comment">//收集的过程</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; list.length; i++) &#123;</span><br><span class="line">                <span class="keyword">while</span> (!list[i].isEmpty()) &#123;</span><br><span class="line">                    arr[index++] =  list[i].poll();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(Arrays.toString(arr));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="title function_">getIndex</span><span class="params">(<span class="type">int</span> num, <span class="type">int</span> r)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">ret</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= r; i++) &#123;</span><br><span class="line">            ret = num % <span class="number">10</span>;</span><br><span class="line">            num /= <span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="title function_">getRadix</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">max</span> <span class="operator">=</span> arr[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (arr[i] &gt; max) &#123;</span><br><span class="line">                max = arr[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (max + <span class="string">&quot;&quot;</span>).length();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="枚举"><a href="#枚举" class="headerlink" title="枚举"></a>枚举</h2><h2 id="分治回溯"><a href="#分治回溯" class="headerlink" title="分治回溯"></a>分治回溯</h2><blockquote>
<p><strong>分治回溯的基本思想</strong></p>
</blockquote>
<ul>
<li>分治算法就是将原问题划分成 n 个规模较小，并且结构与原问题相似的子问题，递归的解决这些子问题，然后不断回溯合并其结果，就能得到原问题的解</li>
<li>&#x3D;&#x3D;回溯思想同样可以用于枚举&#x3D;&#x3D;，回溯归并结果，本质思想还是&#x3D;&#x3D;划分小规模判断暴力破解&#x3D;&#x3D;，将所有可能的结果依次查找出结果，筛选出&#x3D;&#x3D;符合要求的结果&#x3D;&#x3D;，&#x3D;&#x3D;回溯合并&#x3D;&#x3D;出最终结果 –枚举的最好表达<br><strong>优势在于 划分后思维模式简单化 劣势在于代码可读性较差</strong></li>
</ul>
<h2 id="递归"><a href="#递归" class="headerlink" title="递归"></a>递归</h2><blockquote>
<p><strong>递归的基本思想</strong></p>
</blockquote>
<ul>
<li><strong>自身调用自身</strong></li>
<li>递归的应用：将问题分解成规模更小的单位 <strong>加以判断和选择处理问题</strong> 或 <strong>使用与原来问题相同解法</strong> –即&#x3D;&#x3D;分治 分而治之的思想&#x3D;&#x3D;</li>
<li>递归的经典问题 <strong>阶乘</strong>问题 汉诺塔问题 <strong>斐波那契数列</strong>问题….</li>
<li><strong>递归</strong>是<strong>分治回溯思想</strong>的一种实例</li>
</ul>
<blockquote>
<p><strong>递归的优劣</strong></p>
</blockquote>
<ul>
<li>递归策略可以使用少量的代码 <strong>将一个大型复杂的问题层层转换为一个与原来问题相似的 规模相较很小的问题来求解</strong></li>
<li>递归解决问题 <strong>极大的减少了代码量</strong> 但是同样也降低了代码的可读性 导致<strong>高昂的维护成本</strong></li>
</ul>
<blockquote>
<p><strong>分治回溯思想应用</strong></p>
</blockquote>
<ul>
<li>汉诺塔问题</li>
<li>全排列问题</li>
<li>棋盘覆盖问题</li>
<li>迷宫问题</li>
<li>八皇后问题 n皇后问题</li>
<li>数独问题</li>
<li>二分查找、折半查找</li>
<li>递归遍历文件夹</li>
<li></li>
</ul>
<p>RecursionDemo07</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P4.DivideConquerBacktracking;</span><br><span class="line"></span><br><span class="line"><span class="comment">//hanoi汉诺塔问题</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RecursionDemo07</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">x</span> <span class="operator">=</span> <span class="string">&quot;X&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">y</span> <span class="operator">=</span> <span class="string">&quot;Y&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">z</span> <span class="operator">=</span> <span class="string">&quot;Z&quot;</span>;</span><br><span class="line">        hanoi(<span class="number">3</span>, x, y, z);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">hanoi</span><span class="params">(<span class="type">int</span> n, String begin, String mid, String end)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">1</span>) &#123;</span><br><span class="line">            System.out.println(begin + <span class="string">&quot;-&gt;&quot;</span> + end);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            hanoi(n - <span class="number">1</span>, begin, end, mid);</span><br><span class="line">            System.out.println(begin + <span class="string">&quot;-&gt;&quot;</span> + end);</span><br><span class="line">            hanoi(n - <span class="number">1</span>, mid, begin, end);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>BacktrackinDemo01</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P4.DivideConquerBacktracking;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"></span><br><span class="line"><span class="comment">//全排列</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BacktrackinDemo01</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> <span class="string">&quot;ABC&quot;</span>;</span><br><span class="line">        <span class="type">char</span>[] arr = s.toCharArray();</span><br><span class="line">        <span class="comment">// 但凡涉及到去重问题 优先考虑 Set 除非要求实现去重算法</span></span><br><span class="line">        HashSet&lt;String&gt; set = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">        permutation(set, arr, <span class="number">0</span>, arr.length - <span class="number">1</span>);</span><br><span class="line">        System.out.println(set);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">permutation</span><span class="params">(HashSet&lt;String&gt; set, <span class="type">char</span>[] arr, <span class="type">int</span> from, <span class="type">int</span> to)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (from == to) &#123;</span><br><span class="line">            set.add(String.valueOf(arr));    <span class="comment">//[A,B,C] -&gt; &quot;ABC&quot;</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> from; i &lt;= to; i++) &#123;</span><br><span class="line">                swap(arr, i, from);</span><br><span class="line">                permutation(set, arr, from + <span class="number">1</span>, to);</span><br><span class="line">                swap(arr, i, from);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">swap</span><span class="params">(<span class="type">char</span>[] arr, <span class="type">int</span> i, <span class="type">int</span> j)</span> &#123;</span><br><span class="line">        <span class="type">char</span> <span class="variable">tmp</span> <span class="operator">=</span> arr[i];</span><br><span class="line">        arr[i] = arr[j];</span><br><span class="line">        arr[j] = tmp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>BacktrackinDemo02</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P4.DivideConquerBacktracking;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> P3.chainStructure.LinkedList;</span><br><span class="line"></span><br><span class="line"><span class="comment">//迷宫问题，暴力求解，分治回溯，类似于</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BacktrackinDemo02</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span>[][] maze = &#123;</span><br><span class="line">            &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>&#125;,</span><br><span class="line">            &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>&#125;,</span><br><span class="line">            &#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>&#125;,</span><br><span class="line">            &#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>&#125;,</span><br><span class="line">            &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>&#125;,</span><br><span class="line">            &#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>&#125;,</span><br><span class="line">            &#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>&#125;,</span><br><span class="line">            &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>&#125;,</span><br><span class="line">            &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>&#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//入口信息</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">entryX</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">entryY</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//出口信息</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">exitX</span> <span class="operator">=</span> <span class="number">7</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">exitY</span> <span class="operator">=</span> <span class="number">8</span>;</span><br><span class="line">    <span class="comment">//路径访问状态表</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">boolean</span>[][] visitied = <span class="keyword">new</span> <span class="title class_">boolean</span>[<span class="number">9</span>][<span class="number">9</span>];</span><br><span class="line">    <span class="comment">//方向的变化量</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span>[][] direction = &#123;</span><br><span class="line">            &#123;-<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">1</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, -<span class="number">1</span>&#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">//存储路径的栈</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> LinkedList&lt;String&gt; stack = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> go(entryX, entryY);</span><br><span class="line">        <span class="keyword">if</span> (flag) &#123;</span><br><span class="line">            <span class="keyword">for</span> (String path : stack) &#123;</span><br><span class="line">                System.out.println(path);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;迷宫不通&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//以x,y为入口 看是否能够向下找到出口 返回false找不到</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">go</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">        stack.push(<span class="string">&quot;(&quot;</span> + x + <span class="string">&quot;,&quot;</span> + y + <span class="string">&quot;)&quot;</span>);    <span class="comment">//拼出(1, 0) 进栈</span></span><br><span class="line">        visitied[x][y] = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (x == exitX &amp;&amp; y == exitY) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//考虑四个方向 上 右 下 左</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; direction.length; i++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">newX</span> <span class="operator">=</span> direction[i][<span class="number">0</span>] + x;</span><br><span class="line">            <span class="type">int</span> <span class="variable">newY</span> <span class="operator">=</span> direction[i][<span class="number">1</span>] + y;</span><br><span class="line">            <span class="keyword">if</span> (isInArea(newX, newY) &amp;&amp; isRoad(newX, newY) &amp;&amp; !visitied[newX][newY]) &#123;</span><br><span class="line">                <span class="keyword">if</span> (go(newX, newY)) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;    <span class="comment">//某个方向能通，表示此层次x,y能走下去</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        stack.pop();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;   <span class="comment">//此层次不通，向上返回false</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isRoad</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> maze[x][y] == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isInArea</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> x &gt;= <span class="number">0</span> &amp;&amp; x &lt; <span class="number">9</span> &amp;&amp; y &gt;= <span class="number">0</span> &amp;&amp; y &lt; <span class="number">9</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>BacktrackinDemo03</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P4.DivideConquerBacktracking;</span><br><span class="line"></span><br><span class="line"><span class="comment">//八皇后问题 n皇后问题</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BacktrackinDemo03</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;   <span class="comment">//记录解的个数</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> <span class="number">4</span>; <span class="comment">//N皇后 矩阵的尺寸</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span>[][] arr = <span class="keyword">new</span> <span class="title class_">int</span>[N][N]; <span class="comment">//棋盘数据 0 为空 1 为皇后</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        queen(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//递归 解决 row行 皇后问题 如果 row == N 则一个解 就出来了</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">queen</span><span class="params">(<span class="type">int</span> row)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (row == N) &#123;</span><br><span class="line">            count++;</span><br><span class="line">            System.out.println(<span class="string">&quot;第&quot;</span> + count + <span class="string">&quot;个解;&quot;</span>);</span><br><span class="line">            printArr();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//开始遍历当前行的列</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">col</span> <span class="operator">=</span> <span class="number">0</span>; col &lt; N; col++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!isDangerous(row, col)) &#123;</span><br><span class="line">                    <span class="comment">//每次放置皇后之前 都先对当前行进行 清空</span></span><br><span class="line">                    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">c</span> <span class="operator">=</span> <span class="number">0</span>; c &lt; N; c++) &#123;</span><br><span class="line">                        arr[row][c] = <span class="number">0</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    arr[row][col] = <span class="number">1</span>;</span><br><span class="line">                    queen(row + <span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isDangerous</span><span class="params">(<span class="type">int</span> row, <span class="type">int</span> col)</span> &#123;</span><br><span class="line">        <span class="comment">//正上</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">r</span> <span class="operator">=</span> row - <span class="number">1</span>; r &gt;= <span class="number">0</span>; r--) &#123;</span><br><span class="line">            <span class="keyword">if</span> (arr[r][col] == <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//左上</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">r</span> <span class="operator">=</span> row - <span class="number">1</span>, c = col - <span class="number">1</span>; r &gt;= <span class="number">0</span> &amp;&amp; c &gt;= <span class="number">0</span>; r-- , c--) &#123;</span><br><span class="line">            <span class="keyword">if</span> (arr[r][c] == <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//右上</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">r</span> <span class="operator">=</span> row - <span class="number">1</span>, c = col + <span class="number">1</span>; r &gt;= <span class="number">0</span> &amp;&amp; c &lt; N; r-- , c++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (arr[r][c] == <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">printArr</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; N; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; N; j++) &#123;</span><br><span class="line">                System.out.print(arr[i][j] + <span class="string">&quot; &quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>BacktrackinDemo04</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P4.DivideConquerBacktracking;</span><br><span class="line"></span><br><span class="line"><span class="comment">//数独问题</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">每一行、每一列、每一粗线宫(3*3)内数组均为1-9，不重复</span></span><br><span class="line"><span class="comment">以每个格子为小问题单元</span></span><br><span class="line"><span class="comment">每个格子都有一个循环</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">005300000</span></span><br><span class="line"><span class="comment">800000020</span></span><br><span class="line"><span class="comment">070010500</span></span><br><span class="line"><span class="comment">400005300</span></span><br><span class="line"><span class="comment">010070006</span></span><br><span class="line"><span class="comment">003200080</span></span><br><span class="line"><span class="comment">060500009</span></span><br><span class="line"><span class="comment">004000030</span></span><br><span class="line"><span class="comment">000009700</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BacktrackinDemo04</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span>[][] board = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">9</span>][<span class="number">9</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        readFile(<span class="string">&quot;Sudoku.txt&quot;</span>);</span><br><span class="line">        solve(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//求解x-y格子的解 再继续向下递归求解下一个格子</span></span><br><span class="line">    <span class="comment">//本质是求出数独的所有解，但是数独本该只有一个解</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">solve</span><span class="params">(<span class="type">int</span> row, <span class="type">int</span> col)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (row == <span class="number">9</span>) &#123;</span><br><span class="line">            printBoard();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (board[row][col] == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="comment">//需要填数字1-9</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> <span class="number">1</span>; num &lt;= <span class="number">9</span>; num++) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (!isExist(row, col, num)) &#123;</span><br><span class="line">                        board[row][col] = num;  <span class="comment">//当前格子已解决</span></span><br><span class="line">                        <span class="comment">//解决下一个格子</span></span><br><span class="line">                        solve(row + (col + <span class="number">1</span>) / <span class="number">9</span>, (col + <span class="number">1</span>) % <span class="number">9</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">//如果此处没有解 则必须清零返回</span></span><br><span class="line">                    board[row][col] = <span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;    <span class="comment">//已经存在一个已知数字  直接跳过  去解决下一个格子</span></span><br><span class="line">                solve(row + (col + <span class="number">1</span>) / <span class="number">9</span>, (col + <span class="number">1</span>) % <span class="number">9</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isExist</span><span class="params">(<span class="type">int</span> row, <span class="type">int</span> col, <span class="type">int</span> num)</span> &#123;</span><br><span class="line">        <span class="comment">//同行</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">c</span> <span class="operator">=</span> <span class="number">0</span>; c &lt; <span class="number">9</span>; c++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (board[row][c] == num) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//同列</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">r</span> <span class="operator">=</span> <span class="number">0</span>; r &lt; <span class="number">9</span>; r++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (board[r][col] == num) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//同九宫格3*3</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">rowMin</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">colMin</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">rowMax</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">colMax</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (row &gt;= <span class="number">0</span> &amp;&amp; row &lt;= <span class="number">2</span>) &#123;</span><br><span class="line">            rowMin = <span class="number">0</span>;</span><br><span class="line">            rowMax = <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (row &gt;= <span class="number">3</span> &amp;&amp; row &lt;= <span class="number">5</span>) &#123;</span><br><span class="line">            rowMin = <span class="number">3</span>;</span><br><span class="line">            rowMax = <span class="number">5</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (row &gt;= <span class="number">6</span> &amp;&amp; row &lt;= <span class="number">8</span>) &#123;</span><br><span class="line">            rowMin = <span class="number">6</span>;</span><br><span class="line">            rowMax = <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (col &gt;= <span class="number">0</span> &amp;&amp; col &lt;= <span class="number">2</span>) &#123;</span><br><span class="line">            colMin = <span class="number">0</span>;</span><br><span class="line">            colMax = <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (col &gt;= <span class="number">3</span> &amp;&amp; col &lt;= <span class="number">5</span>) &#123;</span><br><span class="line">            colMin = <span class="number">3</span>;</span><br><span class="line">            colMax = <span class="number">5</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (col &gt;= <span class="number">6</span> &amp;&amp; col &lt;= <span class="number">8</span>) &#123;</span><br><span class="line">            colMin = <span class="number">6</span>;</span><br><span class="line">            colMax = <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">r</span> <span class="operator">=</span> rowMin; r &lt;= rowMax; r++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">c</span> <span class="operator">=</span> colMin; c &lt;= colMax; c++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (board[r][c] == num) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">readFile</span><span class="params">(String fileName)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(fileName);</span><br><span class="line">        <span class="type">FileReader</span> <span class="variable">fr</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileReader</span>(file);</span><br><span class="line">        <span class="type">BufferedReader</span> <span class="variable">br</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(fr);</span><br><span class="line">        <span class="type">String</span> <span class="variable">line</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">row</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> ((line = br.readLine()) != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">col</span> <span class="operator">=</span> <span class="number">0</span>; col &lt; <span class="number">9</span>; col++) &#123;</span><br><span class="line">                board[row][col] = Integer.parseInt(line.charAt(col) + <span class="string">&quot;&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            row++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">printBoard</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">9</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; <span class="number">9</span>; j++) &#123;</span><br><span class="line">                System.out.print(board[i][j] + <span class="string">&quot; &quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>RecursionDemo04</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P4.DivideConquerBacktracking;</span><br><span class="line"></span><br><span class="line"><span class="comment">//二分查找、折半查找</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RecursionDemo04</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> count;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">int</span>[] arr = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>&#125;;</span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> binarySearch(arr, <span class="number">0</span>, arr.length - <span class="number">1</span>, <span class="number">5</span>);</span><br><span class="line">        System.out.println(index);</span><br><span class="line">        System.out.println(count);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//在数组arr中L-R区间内进行二分搜索查找key的角标</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">binarySearch</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> L, <span class="type">int</span> R, <span class="type">int</span> key)</span> &#123;</span><br><span class="line">        count++;</span><br><span class="line">        <span class="keyword">if</span> (L &gt; R) &#123;    <span class="comment">//如果元素key不存在</span></span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">M</span> <span class="operator">=</span> (L + R) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (arr[M] == key) &#123;</span><br><span class="line">            <span class="keyword">return</span> M;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (arr[M] &lt; key) &#123;</span><br><span class="line">            <span class="keyword">return</span> binarySearch(arr, M + <span class="number">1</span>, R, key);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> binarySearch(arr, L, M - <span class="number">1</span>, key);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>RecursionDemo05</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P4.DivideConquerBacktracking;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"></span><br><span class="line"><span class="comment">//递归遍历文件夹</span></span><br><span class="line"><span class="comment">//LRD相当于二叉树的后序遍历</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RecursionDemo05</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">File</span> <span class="variable">dir</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;C:\\Users\\黎明\\Desktop\\Java数据结构(code)\\Day04\\DS&quot;</span>);</span><br><span class="line">        traversal(dir);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">traversal</span><span class="params">(File dir)</span> &#123;</span><br><span class="line">        File[] files = dir.listFiles();</span><br><span class="line">        <span class="keyword">if</span> (files.length == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (File file : files) &#123;</span><br><span class="line">            <span class="keyword">if</span> (file.isFile()) &#123;</span><br><span class="line">                System.out.println(file.getName());</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;[&quot;</span> + file.getName() + <span class="string">&quot;]&quot;</span>);</span><br><span class="line">                traversal(file);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>RecursionDemo06</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P4.DivideConquerBacktracking;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">//棋盘覆盖问题</span></span><br><span class="line"><span class="comment">//ChessBoardCoverage</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RecursionDemo06</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">BOARD_SIZE</span> <span class="operator">=</span> <span class="number">8</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span>[][] board = <span class="keyword">new</span> <span class="title class_">int</span>[BOARD_SIZE][BOARD_SIZE];</span><br><span class="line">    <span class="comment">//代表颜色 同一组L骨牌 编号相同</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">title</span> <span class="operator">=</span> <span class="number">0</span>;   <span class="comment">//特殊方格的标志</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">input</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        System.out.println(<span class="string">&quot;&gt;&gt;&gt;请输入特殊方格的索引信息：&quot;</span>);</span><br><span class="line">        <span class="comment">//  dr dc 指的是特殊方格的索引</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">dr</span> <span class="operator">=</span> input.nextInt();</span><br><span class="line">        <span class="type">int</span> <span class="variable">dc</span> <span class="operator">=</span> input.nextInt();</span><br><span class="line"></span><br><span class="line">        chessBoard(<span class="number">0</span>, <span class="number">0</span>, dr, dc, BOARD_SIZE);</span><br><span class="line">        printBoard();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">printBoard</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; BOARD_SIZE; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; BOARD_SIZE; j++) &#123;</span><br><span class="line">                System.out.print(board[i][j] + <span class="string">&quot;\t&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//在size*size的矩阵中 以tr tc为同部分子矩阵的基点 dr dc 是特殊方格的索引 进行填充</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">chessBoard</span><span class="params">(<span class="type">int</span> tr, <span class="type">int</span> tc, <span class="type">int</span> dr, <span class="type">int</span> dc, <span class="type">int</span> size)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (size == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//该层要填充L型骨牌</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> ++title;</span><br><span class="line">        <span class="comment">//该层要继续分为四个部分 每个部分的尺寸为？</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">s</span> <span class="operator">=</span> size / <span class="number">2</span>;</span><br><span class="line">        <span class="comment">//判断当前特殊方格在哪个部分中</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//左上</span></span><br><span class="line">        <span class="keyword">if</span> (dr &lt; tr + s &amp;&amp; dc &lt; tc + s) &#123;</span><br><span class="line">            chessBoard(tr, tc, dr, dc, s);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            board[tr + s - <span class="number">1</span>][tc + s - <span class="number">1</span>] = num;</span><br><span class="line">            chessBoard(tr, tc, tr + s - <span class="number">1</span>, tc + s - <span class="number">1</span>, s);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//右上</span></span><br><span class="line">        <span class="keyword">if</span> (dr &lt; tr + s &amp;&amp; dc &gt;= tc + s) &#123;</span><br><span class="line">            chessBoard(tr, tc + s, dr, dc, s);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            board[tr + s - <span class="number">1</span>][tc + s] = num;</span><br><span class="line">            chessBoard(tr, tc + s, tr + s - <span class="number">1</span>, tc + s, s);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//左下</span></span><br><span class="line">        <span class="keyword">if</span> (dr &gt;= tr + s &amp;&amp; dc &lt; tc + s) &#123;</span><br><span class="line">            chessBoard(tr + s, tc, dr, dc, s);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            board[tr + s][tc + s - <span class="number">1</span>] = num;</span><br><span class="line">            chessBoard(tr + s, tc, tr + s, tc + s - <span class="number">1</span>, s);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//右下</span></span><br><span class="line">        <span class="keyword">if</span> (dr &gt;= tr + s &amp;&amp; dc &gt;= tc + s) &#123;</span><br><span class="line">            chessBoard(tr + s, tc + s, dr, dc, s);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            board[tr + s][tc + s] = num;</span><br><span class="line">            chessBoard(tr + s, tc + s, tr + s, tc + s, s);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="查找"><a href="#查找" class="headerlink" title="查找"></a>查找</h2><blockquote>
<p><strong>查找分类</strong></p>
</blockquote>
<ul>
<li>有序表查找</li>
<li>线性表查找</li>
<li>树结构查找</li>
<li>散列查找</li>
</ul>
<h3 id="有序表查找"><a href="#有序表查找" class="headerlink" title="有序表查找"></a>有序表查找</h3><blockquote>
<p><strong>二分查找</strong></p>
</blockquote>
<ul>
<li>迭代实现 –循环</li>
<li>递归实现</li>
<li>时间复杂度 O(log2n)</li>
</ul>
<p>注意：</p>
<ul>
<li>二分查找中计算中间点：推荐使用 <code>mid = low + 1 / 2 * ( high - low )</code> 不推荐使用<code>mid = ( low + high ) / 2</code>  尽量的去避免索引越界 ( out of range ) 问题</li>
</ul>
<p>RecursionDemo04</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P4.DivideConquerBacktracking;</span><br><span class="line"></span><br><span class="line"><span class="comment">//二分查找、折半查找 --递归实现</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RecursionDemo04</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> count;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">int</span>[] arr = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>&#125;;</span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> binarySearch(arr, <span class="number">0</span>, arr.length - <span class="number">1</span>, <span class="number">5</span>);</span><br><span class="line">        System.out.println(index);</span><br><span class="line">        System.out.println(count);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//在数组arr中L-R区间内进行二分搜索查找key的角标</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">binarySearch</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> L, <span class="type">int</span> R, <span class="type">int</span> key)</span> &#123;</span><br><span class="line">        count++;</span><br><span class="line">        <span class="keyword">if</span> (L &gt; R) &#123;    <span class="comment">//如果元素key不存在</span></span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">M</span> <span class="operator">=</span> (L + R) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (arr[M] == key) &#123;</span><br><span class="line">            <span class="keyword">return</span> M;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (arr[M] &lt; key) &#123;</span><br><span class="line">            <span class="keyword">return</span> binarySearch(arr, M + <span class="number">1</span>, R, key);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> binarySearch(arr, L, M - <span class="number">1</span>, key);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p><strong>插值查找</strong></p>
</blockquote>
<ul>
<li>迭代实现 –循环</li>
<li>递归实现</li>
<li>插值查找本质是更改了二分查找的查找点 将本来的二分 改成了 <code>mid = low + (key - a[low]) / (a[high] - a[low]) * (high - low)</code></li>
<li>时间复杂度 O(logn )</li>
<li>对于<strong>表长较大</strong> <strong>关键字分布比较均匀</strong>的查找表来说 插值查找算法的平均性能比折半查找更好 反之 若<strong>表长较短</strong> 且<strong>分布不均</strong> 那么插值查找的性能可能<strong>有待考量</strong></li>
</ul>
<p>InterpolationSearch</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> P6.SearchAlgorithm;</span><br><span class="line"></span><br><span class="line"><span class="comment">//插值查找</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">InterpolationSearch</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">int</span>[] arr = &#123;-<span class="number">12</span>, -<span class="number">10</span>, -<span class="number">6</span>, -<span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">18</span>, <span class="number">22</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">30</span>, <span class="number">33</span>, <span class="number">38</span>, <span class="number">40</span>&#125;;</span><br><span class="line">        <span class="type">int</span> <span class="variable">key</span> <span class="operator">=</span> -<span class="number">10</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> interpolationSearch(arr,<span class="number">0</span>, arr.length - <span class="number">1</span>,key);</span><br><span class="line">        System.out.println(<span class="string">&quot;index:&quot;</span> + index);</span><br><span class="line">        System.out.println(count);</span><br><span class="line">        count = <span class="number">0</span>;</span><br><span class="line">        index = binarySearch(arr,<span class="number">0</span>,arr.length - <span class="number">1</span>,key);</span><br><span class="line">        System.out.println(<span class="string">&quot;index:&quot;</span> + index);</span><br><span class="line">        System.out.println(count);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">binarySearch</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> min, <span class="type">int</span> max, <span class="type">int</span> key)</span> &#123;</span><br><span class="line">        count++;</span><br><span class="line">        <span class="keyword">if</span> (min &gt; max) &#123;</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> (min + max) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (arr[mid] == key) &#123;</span><br><span class="line">            <span class="keyword">return</span> mid;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (key &lt; arr[mid]) &#123;</span><br><span class="line">            <span class="keyword">return</span> binarySearch(arr,min,mid - <span class="number">1</span>,key);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> binarySearch(arr,mid + <span class="number">1</span>,max,key);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">interpolationSearch</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> low, <span class="type">int</span> high, <span class="type">int</span> key)</span> &#123;</span><br><span class="line">        count++;</span><br><span class="line">        <span class="keyword">if</span> (low &gt; high) &#123;</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> low + (<span class="type">int</span>) (<span class="number">1.0</span> * (key - arr[low]) / (arr[high] - arr[low]) * (high - low));</span><br><span class="line">        <span class="keyword">if</span> (mid &lt; low || mid &gt; high) &#123;</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (arr[mid] == key) &#123;</span><br><span class="line">            <span class="keyword">return</span> mid;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (key &lt; arr[mid] ) &#123;</span><br><span class="line">            <span class="keyword">return</span> interpolationSearch(arr,low,mid - <span class="number">1</span>,key);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> interpolationSearch(arr,mid + <span class="number">1</span>, high,key);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p><strong>斐波那契查找</strong></p>
</blockquote>
<h3 id="线性表查找"><a href="#线性表查找" class="headerlink" title="线性表查找"></a>线性表查找</h3><h3 id="树结构查找"><a href="#树结构查找" class="headerlink" title="树结构查找"></a>树结构查找</h3><h3 id="散列查找"><a href="#散列查找" class="headerlink" title="散列查找"></a>散列查找</h3><h2 id="搜索"><a href="#搜索" class="headerlink" title="搜索"></a>搜索</h2><blockquote>
<p><strong>搜索算法</strong></p>
</blockquote>
<ul>
<li>深度优先搜索 DFS</li>
<li>广度优先搜索 BFS</li>
</ul>
<h2 id="贪心"><a href="#贪心" class="headerlink" title="贪心"></a>贪心</h2><h2 id="动态规划"><a href="#动态规划" class="headerlink" title="动态规划"></a>动态规划</h2><p>参考文档：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/u010365819/article/details/121000532">入门保姆级</a></p>
<h2 id="字符串匹配"><a href="#字符串匹配" class="headerlink" title="字符串匹配"></a>字符串匹配</h2><blockquote>
<p><strong>字符串匹配算法</strong></p>
</blockquote>
<ul>
<li>KMP</li>
<li>前缀树</li>
</ul>
<h2 id="位运算"><a href="#位运算" class="headerlink" title="位运算"></a>位运算</h2><p>注意 jdk底层使用排序 元素数量小于 28 使用插入排序 后快速排序等</p>
<p>引用数据类型使用归并排序</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://negativefunction.github.io/2023/01/21/Java/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/05.jpg">
      <meta itemprop="name" content="Linyuxuan">
      <meta itemprop="description" content="Hope Sometimes Love Brain">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Welcome To Lin's World">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/01/21/Java/" class="post-title-link" itemprop="url">Java</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2023-01-21 07:11:48 / Modified: 07:11:50" itemprop="dateCreated datePublished" datetime="2023-01-21T07:11:48+08:00">2023-01-21</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h1><p><em>Java基础学习通常视频时长在200h以上</em></p>
<p>Java基础：</p>
<ul>
<li>一阶段<ul>
<li>Java概述<ul>
<li>Java历史</li>
<li>Java特点</li>
<li>Java运行机制</li>
<li>JDK</li>
<li>转义字符</li>
<li>Java开发规范</li>
<li>Java API</li>
</ul>
</li>
<li>变量<ul>
<li>数据类型</li>
<li>变量使用</li>
<li>数据类型转换</li>
</ul>
</li>
<li>运算符<ul>
<li>运算符介绍</li>
<li>算术运算符</li>
<li>关系运算符</li>
<li>逻辑运算符</li>
<li>赋值运算符</li>
<li>三元运算符</li>
<li>优先级</li>
<li>二进制</li>
<li>位运算符</li>
</ul>
</li>
<li>控制结构<ul>
<li>顺序</li>
<li>分支</li>
<li>循环</li>
<li>break</li>
<li>continue</li>
<li>return</li>
</ul>
</li>
<li>数组、排序、查找<ul>
<li>数组</li>
<li>排序</li>
<li>查找</li>
</ul>
</li>
<li>面向对象编程OOP<ul>
<li>类与对象</li>
<li>成员方法</li>
<li>成员方法传参机制</li>
<li>overload</li>
<li>可变参数</li>
<li>作用域</li>
<li>构造器</li>
<li>this</li>
<li>包</li>
<li>访问修饰符</li>
<li>封装</li>
<li>继承</li>
<li>多态</li>
<li>Super</li>
<li>overwrite</li>
<li>Object类详解</li>
<li>断点调试</li>
</ul>
</li>
</ul>
</li>
<li>二阶段<ul>
<li>面向对象高级<ul>
<li>类变量和类方法</li>
<li>main方法语法</li>
<li>代码块</li>
<li>单例设计模式</li>
<li>final关键字</li>
<li>抽象类</li>
<li>接口</li>
<li>内部类</li>
</ul>
</li>
<li>枚举和注解<ul>
<li>自定义类实现枚举</li>
<li>enum关键字实现枚举</li>
<li>JDK内置的基本注解类型</li>
<li>元注解：对注解进行注解</li>
</ul>
</li>
<li>Exception<ul>
<li>异常的概念</li>
<li>异常体系图</li>
<li>常见异常</li>
<li>异常处理</li>
<li>自定义异常</li>
<li>throw和throws对比</li>
</ul>
</li>
<li>常用类<ul>
<li>包装类</li>
<li>String</li>
<li>StringBuffer</li>
<li>StringBuilder</li>
<li>Math</li>
<li>Date、Calendar、LocalDate…</li>
<li>System</li>
<li>Arrays</li>
<li>BigInteger BigDecimal</li>
</ul>
</li>
<li>集合<ul>
<li>集合框架体系</li>
<li>Collection<ul>
<li>List<ul>
<li>ArrayList</li>
<li>LinkedList</li>
<li>Vector</li>
</ul>
</li>
<li>Set<ul>
<li>HashSet</li>
<li>LinkedHashSet</li>
<li>TreeSet</li>
</ul>
</li>
</ul>
</li>
<li>Map<ul>
<li>HashMap</li>
<li>Hashtable</li>
<li>LinkedHashMap</li>
<li>TreeMap</li>
<li>Properties</li>
</ul>
</li>
<li>Collections</li>
</ul>
</li>
<li>泛型<ul>
<li>泛型语法</li>
<li>自定义泛型<ul>
<li>泛型类</li>
<li>泛型接口</li>
<li>泛型方法</li>
</ul>
</li>
<li>泛型继承和通配符</li>
</ul>
</li>
<li>线程<ul>
<li>线程介绍</li>
<li>线程使用<ul>
<li>继承Thread</li>
<li>实现Runnable</li>
</ul>
</li>
<li>线程方法</li>
<li>线程生命周期</li>
<li>Synchronized</li>
<li>互斥锁</li>
<li>死锁</li>
</ul>
</li>
<li>IO流<ul>
<li>文件<ul>
<li>概念</li>
<li>常用操作</li>
</ul>
</li>
<li>IO流原理及流的分类</li>
<li>输入流<ul>
<li>InputStream<ul>
<li>FileInputStream</li>
<li>BufferedInputStream</li>
<li>ObjectInputStream</li>
</ul>
</li>
<li>Reader<ul>
<li>FileReader</li>
<li>BufferedReader</li>
<li>InputStreamReader</li>
</ul>
</li>
</ul>
</li>
<li>输出流<ul>
<li>OutputStream<ul>
<li>FileOutputStream</li>
<li>BufferedOutputStream</li>
<li>ObjectOutputStream</li>
</ul>
</li>
<li>Writer<ul>
<li>FileWriter</li>
<li>BufferedWriter</li>
<li>InputStreamWriter</li>
</ul>
</li>
</ul>
</li>
<li>Properties类</li>
</ul>
</li>
</ul>
</li>
<li>三阶段<ul>
<li>网络编程<ul>
<li>网络基础</li>
<li>InetAddress</li>
<li>Socket</li>
<li>TCP编程<ul>
<li>字节流</li>
<li>字符流</li>
</ul>
</li>
<li>UDP编程</li>
</ul>
</li>
<li>反射<ul>
<li>反射机制</li>
<li>类的加载</li>
<li>反射获取类的结构信息<ul>
<li>Class</li>
<li>Field</li>
<li>Method</li>
<li>Constructor</li>
<li>访问属性</li>
<li>访问方法</li>
</ul>
</li>
</ul>
</li>
<li>Mysql基础（后续Mysql高级 优化 集群 项目）<ul>
<li>MySQL安装配置</li>
<li>数据库<ul>
<li>创建</li>
<li>查看、删除数据库</li>
<li>备份恢复数据库</li>
</ul>
</li>
<li>表<ul>
<li>创建</li>
<li>删除</li>
<li>修改</li>
</ul>
</li>
<li>MySQL数据类型</li>
<li>CRUD<ul>
<li>Insert</li>
<li>Update</li>
<li>Delete</li>
<li>Select<ul>
<li>单表</li>
<li>多表</li>
</ul>
</li>
</ul>
</li>
<li>函数<ul>
<li>统计函数</li>
<li>时间日期</li>
<li>字符串函数</li>
<li>数学函数</li>
<li>控制流程</li>
</ul>
</li>
<li>内连接</li>
<li>外连接</li>
<li>约束<ul>
<li>not null</li>
<li>primary key</li>
<li>unique</li>
<li>foreign key</li>
<li>check</li>
<li>自增长</li>
</ul>
</li>
<li>索引<ul>
<li>主键索引</li>
<li>唯一索引（UNIQUE）</li>
<li>普通索引（INDEX）</li>
<li>全文索引</li>
</ul>
</li>
<li>事务</li>
</ul>
</li>
<li>JDBC和连接池<ul>
<li>JDBC概念</li>
<li>JDBC快速入门</li>
<li>JDBC API<ul>
<li>PreparedStatement</li>
<li>DriverManager</li>
<li>Statement</li>
<li>ResultSet</li>
</ul>
</li>
<li>JDBCUtils</li>
<li>事务</li>
<li>批处理</li>
<li>连接池<ul>
<li>DataSource</li>
<li>DBCP</li>
<li>C3P0</li>
<li>Proxool</li>
<li>BoneCP</li>
<li>Druid</li>
</ul>
</li>
<li>Apache-DBUtils</li>
<li>DAO增删改查-BasicDao</li>
</ul>
</li>
<li>正则表达式<ul>
<li>正则表达式入门</li>
<li>正则表达式基本语法</li>
<li>三个常用类<ul>
<li>Pattern</li>
<li>Matcher</li>
<li>PatterSyntaxException</li>
</ul>
</li>
<li>分组、捕获、反向引用</li>
<li>元字符<ul>
<li>限定符</li>
<li>选择匹配符</li>
<li>分组组合和反向引用符</li>
<li>特殊字符</li>
<li>字符匹配符</li>
<li>定位符</li>
</ul>
</li>
<li>应用实例</li>
</ul>
</li>
<li>新特性<ul>
<li>Java8 新特性<ul>
<li>Lambda</li>
<li>函数式接口</li>
<li>接口静态方法</li>
<li>接口默认方法</li>
<li>方法引用</li>
<li>构造器引用</li>
<li>stream API</li>
<li>并行流</li>
<li>串行流</li>
<li>Optional</li>
<li>新时间日期 API</li>
</ul>
</li>
<li>Java11 新特性<ul>
<li>代码层面新特性<ul>
<li>JShell</li>
<li>类型推断</li>
<li>集合增强API</li>
<li>Stream加强</li>
<li>新增字符串处理方法</li>
<li>Optional加强</li>
<li>InputStream增强API</li>
<li>标准Java异步HTTP客户</li>
</ul>
</li>
<li>其他新特性<ul>
<li>简化编译运行</li>
<li>支持Unicode 10</li>
<li>Epsilon垃圾收集器</li>
<li>ZGC</li>
<li>JFR</li>
<li>支持Linux容器</li>
<li>支持G1上的并行完全垃圾手机</li>
<li>增加加密算法 代替RC4</li>
<li>最新HTTPS安全协议TLS 1.3</li>
<li>移除和废弃的内容</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Java高级：</p>
<p>JavaWEB：</p>
<p>主流框架和项目管理：</p>
<p>分布式 微服务 并行架构：</p>
<p>DevOps(开发运维一体化) 自动化部署管理项目 解决CI&#x2F;CD：</p>
<p>大数据技术：</p>
<p>项目实战：</p>
<p>大厂高频面试题：</p>
<p>底层源码&#x2F;内核研究：</p>
<p>编程基础扩展：</p>
<h2 id="泛型"><a href="#泛型" class="headerlink" title="泛型"></a>泛型</h2><p>逆变协变</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_53094471/article/details/125239232">https://blog.csdn.net/qq_53094471/article/details/125239232</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/65284a1a2dee">https://www.jianshu.com/p/65284a1a2dee</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/en-heng/p/5041124.html">https://www.cnblogs.com/en-heng/p/5041124.html</a></p>
<p>逆变与协变用来描述类型转换（type transformation）后的继承关系，其定义：如果A、B表示类型，f(⋅)表示类型转换，≤表示继承关系（比如，A≤B表示A是由B派生出来的子类）；</p>
<ul>
<li>f(⋅)是逆变（contravariant）的，当A≤B时有f(B)≤f(A)成立；</li>
<li>f(⋅)是协变（covariant）的，当A≤B时有f(A)≤f(B)成立；</li>
<li>f(⋅)是不变（invariant）的，当A≤B时上述两个式子均不成立，即f(A)与f(B)相互之间没有继承关系。</li>
</ul>
<h2 id="异常"><a href="#异常" class="headerlink" title="异常"></a>异常</h2><p>Throwable</p>
<ul>
<li>Error	–系统级别错误</li>
<li>Exception<ul>
<li>RuntimeException</li>
<li>CompiletimeException –如日期解析</li>
<li>else</li>
</ul>
</li>
</ul>
<h2 id="IO流"><a href="#IO流" class="headerlink" title="IO流"></a>IO流</h2><p>IO流用于读取数据，可以是本地数据，也可以是网络数据</p>
<h3 id="IO流分类"><a href="#IO流分类" class="headerlink" title="IO流分类"></a>IO流分类</h3><p><strong>流方向</strong></p>
<ul>
<li>输入流</li>
<li>输出流</li>
</ul>
<p><strong>操作文件类型</strong></p>
<ul>
<li>字节流 –操作所有类型文件 图片 文档 音频 视频</li>
<li>字符流 –只能操作纯文本，能用txt打开（md txt…）</li>
</ul>
<p><strong>字节流</strong></p>
<ul>
<li><p>&#x3D;&#x3D;InputStream&#x3D;&#x3D;</p>
<ul>
<li>&#x3D;&#x3D;FileInputStream&#x3D;&#x3D;</li>
<li>&#x3D;&#x3D;ObjectInputStream&#x3D;&#x3D;</li>
<li>&#x3D;&#x3D;BufferedInputStream&#x3D;&#x3D;</li>
<li>解压缩流    解压缩本质就是将 ZipEntry 按层级拷贝到本地另一个文件夹中</li>
</ul>
</li>
<li><p>&#x3D;&#x3D;OutputStream&#x3D;&#x3D;</p>
<ul>
<li>字节打印流<ul>
<li>压缩流	java中的压缩文件实际上都是一个 ZipEntry 对象</li>
</ul>
</li>
</ul>
</li>
<li><p>序列化流</p>
<ul>
<li>ObjectInputStream</li>
<li>ObjectInputStream</li>
</ul>
</li>
</ul>
<p><strong>字符流</strong></p>
<ul>
<li><p>Reader</p>
<ul>
<li>FileReader</li>
<li>LineNumberReader</li>
<li>BufferedReader</li>
</ul>
</li>
<li><p>Writer</p>
<ul>
<li>字符打印流</li>
</ul>
</li>
<li><p>ConvertStream –转换流用于字符流与字节流之间的桥梁（两个作用 1. 指定字符集读写[Deprecated] 2. 字节流使用字符流中的方法）</p>
<ul>
<li><p>InputStreamReader</p>
</li>
<li><p>OutputStreamWriter</p>
</li>
</ul>
</li>
</ul>
<h3 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h3><ol>
<li>创建字节流对象</li>
<li>写数据</li>
<li>释放资源</li>
</ol>
<h3 id="乱码原因"><a href="#乱码原因" class="headerlink" title="乱码原因"></a>乱码原因</h3><ol>
<li>读取数据时，未读完整个汉字</li>
<li>编码和解码的方式不一致</li>
</ol>
<p><strong>如何不产生乱码（解决乱码问题）</strong></p>
<ol>
<li>尽量不使用字节流读取文本文件</li>
<li>编码解码时使用同一个码表，同一个编码方式</li>
</ol>
<p><strong>字节码拷贝通常不会出现问题</strong></p>
<p>BOM（Byte Order Mark），字节顺序标记，出现在文本文件头部，Unicode编码标准中用于标识文件是采用哪种格式的编码。</p>
<p>BOM采用UTF-8编码。几乎所有的文本编辑软件都可以显示并编辑UTF-8编码的文件。但是很遗憾，其中很多软件的表现并不理想。</p>
<h3 id="细节部分"><a href="#细节部分" class="headerlink" title="细节部分"></a>细节部分</h3><blockquote>
<p><em>java中的<strong>char</strong>确实使用2Byte空间，它实际使用的是UCS-2 也就是plane 0，只能表述65536个字符</em><br>对于超出其范围的其它plane内容，编译器会直接报错！<br>尽量别用char类型，因为它会导致一些隐蔽的错误。比如，当你在用String时你定义了一个其它plane的字符，你想当然的认为一个char就能盛放String中的一个字符（毕竟char是字符，而String就是描述的char数组），但是你会发现其实这个String的length()是2而不是1，因为它超出了UCS-2，String用两个char的位置（4字节）来表示了这个char，而String本该用一个char的位置来表示它才对</p>
<p>char可以存储汉字是因为char使用的是unicode编码，且仅使用plane0中包含的字符。unicode的plane0占用两个字节，因此char也占两个字节</p>
<p><em>java中的char是Unicode字符集存储,unicode编码字符集中包含了汉字,所以可以存储中文</em>; java内部其实是使用的UTF-16的编码</p>
</blockquote>
<h4 id="BOM编码"><a href="#BOM编码" class="headerlink" title="BOM编码"></a>BOM编码</h4><p>bom头，在文档最前面有一个隐藏的字符标记</p>
<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20230115204942827.png" alt="image-20230115204942827" style="zoom:67%;margin-left:0" />



<h4 id="序列化问题"><a href="#序列化问题" class="headerlink" title="序列化问题"></a>序列化问题</h4><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20230116022104585.png" alt="image-20230116022104585" style="zoom:67%;margin-left:0" />



<p>解决反序列化异常</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/jj89929665/article/details/123280707">https://blog.csdn.net/jj89929665/article/details/123280707</a></p>
<h4 id="jar包"><a href="#jar包" class="headerlink" title="jar包"></a>jar包</h4><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20230117015256185.png" alt="image-20230117015256185" style="zoom:67%;margin-left:0" />

<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20230117015327682.png" alt="image-20230117015327682" style="zoom:67%;margin-left:0" />

<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20230117015421717.png" alt="image-20230117015421717" style="zoom:67%;margin-left:0" />



<p>apache基金会</p>
<p>Apache Pig</p>
<p>Hadoop Flink Spark</p>
<p>lucene</p>
<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20230116164116201.png" alt="image-20230116164116201" style="zoom:67%;margin-left:0" />



<p>异或与 –加密</p>
<p>字节流</p>
<p>字符流</p>
<p>输入流</p>
<p>输出流</p>
<p>节点流</p>
<p>访问文件的</p>
<p>访问数组的</p>
<p>访问管道的</p>
<p>处理流</p>
<p>缓冲流</p>
<p>对象流</p>
<p>转换流</p>
<h2 id="注解"><a href="#注解" class="headerlink" title="注解"></a>注解</h2><h3 id="自定义注解"><a href="#自定义注解" class="headerlink" title="自定义注解"></a>自定义注解</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Java_Basics;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 自定义注解</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Dracula</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> MyAnno &#123;</span><br><span class="line">    String <span class="title function_">value</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    String <span class="title function_">name</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;linyuxuan&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="注解原理"><a href="#注解原理" class="headerlink" title="注解原理"></a>注解原理</h3><p><strong>.java 文件编译 -&gt; .class 文件 -&gt; 通过 XJad 反编译 -&gt; .java 可以发现 注解本质就是一个接口</strong></p>
<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20230117031649552.png" alt="image-20230117031649552" style="zoom:67%;margin-left:0" />



<h3 id="元注解"><a href="#元注解" class="headerlink" title="元注解"></a>元注解</h3><ul>
<li>@Retention</li>
<li>@Target</li>
<li>…</li>
</ul>
<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20230117032351547.png" alt="image-20230117032351547" style="zoom:67%;margin-left:0" />



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(&#123;ElementType.TYPE, ElementType.FIELD&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> MyAnno &#123;</span><br><span class="line">    String <span class="title function_">value</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    String <span class="title function_">name</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;linyuxuan&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="解析注解"><a href="#解析注解" class="headerlink" title="解析注解"></a>解析注解</h3><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20230117032752491.png" alt="image-20230117032752491" style="zoom:67%;margin-left:0" />



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(&#123;ElementType.TYPE, ElementType.METHOD&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> MyAnno &#123;</span><br><span class="line">    String <span class="title function_">value</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    String <span class="title function_">aaa</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;linyuxuan&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">demo3_anno</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ParseException &#123;</span><br><span class="line">        Class&lt;Student&gt; clazz = Student.class;</span><br><span class="line">        <span class="keyword">if</span> (clazz.isAnnotationPresent(MyAnno.class)) &#123;</span><br><span class="line">            <span class="type">MyAnno</span> <span class="variable">anno</span> <span class="operator">=</span> clazz.getDeclaredAnnotation(MyAnno.class);</span><br><span class="line">            System.out.println(anno.value());</span><br><span class="line">            System.out.println(anno.aaa());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 解析方法 或 成员变量 上的注解，同样要先获得类对象 -&gt; 通过反射</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>模拟@Test</strong></p>
<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20230117034307032.png" alt="image-20230117034307032" style="zoom:67%;margin-left:0" />



<h2 id="反射"><a href="#反射" class="headerlink" title="反射"></a>反射</h2><p>加载类 class 文件的三种方式</p>
<p>读 class</p>
<p>读 包class</p>
<p>读 Object</p>
<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20230117022708726.png" alt="image-20230117022708726" style="zoom:67%;margin-left:0" />

<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/bejsoiv/article/details/115772964">https://blog.csdn.net/bejsoiv/article/details/115772964</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/yong_19930826/article/details/107470914">https://blog.csdn.net/yong_19930826/article/details/107470914</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/wy_05689/article/details/123101320">https://blog.csdn.net/wy_05689/article/details/123101320</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/APCSZDDXM/article/details/122006599%E2%98%85%E2%98%85%E2%98%85%E2%98%85">https://blog.csdn.net/APCSZDDXM/article/details/122006599★★★★</a></p>
<p>sonarLint提示</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/aaacarrot/p/16669817.html">https://www.cnblogs.com/aaacarrot/p/16669817.html</a></p>
<h2 id="动态代理"><a href="#动态代理" class="headerlink" title="动态代理"></a>动态代理</h2><p><strong>开闭原则</strong></p>
<p><code>OOP七大原则</code></p>
<ol>
<li>开闭原则</li>
</ol>
<p>对扩展开放，对修改关闭。最基础，最重要的一个原则。顾名思义，对一个类允许扩展其功能，但是不能影响到现有的功能模块。对提供方开放，对使用方关闭。</p>
<ol start="2">
<li>单一职责原则</li>
</ol>
<p>控制类的粒度大小，将对象解耦、提高其内聚性。一个类做好自己的事情，尽量不要与其他类建立联系。一个类中的方法只做一件事情。</p>
<ol start="3">
<li>接口隔离原则</li>
</ol>
<p>要为各个类建立它们需要的专用接口。不同的类使用同一个接口的部分方法时，应该将每个类对应的方法从接口中抽离出来分别实现。</p>
<ol start="4">
<li>依赖倒置原则</li>
</ol>
<p>要面向接口编程，不要面向实现编程。高层模块不应该依赖底层模块，二者都依赖其抽象。程序要依赖于抽象接口，不要依赖于具体实现。简单的说就是要求对抽象进行编程，不要对实现进行编程，这样就降低了客户与实现模块间的耦合。</p>
<ol start="5">
<li>里氏替换原则</li>
</ol>
<p>继承必须确保超类所拥有的性质在子类中仍然成立。超类能出现的地方，可以用子类代替，子类拥有超类的所有属性和方法，通俗来说子类拥有超类的功能，可以拓展超类的功能，但是不能修改超类的功能</p>
<ol start="6">
<li>迪米特法则</li>
</ol>
<p>也叫最少知道原则。只与你的直接朋友交谈，不跟“陌生人”说话。两个对象之间有耦合关系，说明对象间是朋友关系。出现在成员变量，方法参数，方法返回值中的类为直接朋友；出现在局部变量中的类就是陌生朋友</p>
<ol start="7">
<li>合成复用原则</li>
</ol>
<p>尽量先使用组合或者聚合等关联关系来实现，其次才考虑使用继承关系来实现。判断组合和聚合关系的一个简单方法就是：看整体与部分的生命周期是否一致，部分能够独立于整体而存在则属于聚合；整体消失部分不复存在则属于组合。</p>
<h3 id="静态代理"><a href="#静态代理" class="headerlink" title="静态代理"></a>静态代理</h3><p><strong>通过接口传递能力</strong></p>
<p>被代理类提供方法（具体执行方法能力） -&gt; 代理类（new 一个被代理对象 -&gt; 执行需要代理的方法） -&gt; 通过接口来实现两个类之间方法传递</p>
<p> -&gt; 使用代理类执行整个业务（包括代理新增功能 与 被代理类功能）</p>
<p><em>通过类之间互相方法的创建来组合实现静态代理 -&gt; 每个对象都要创建出来</em></p>
<p><strong>代理的优势</strong></p>
<ul>
<li>使真实角色更加纯粹，而不用去关心一些公共业务（业务分工）</li>
<li>当公共业务发生改变或扩展时，可以集中管理公共业务，降低维护成本</li>
</ul>
<p><strong>缺点</strong></p>
<ul>
<li><em>一个真实角色就需要一个代理类，会使得代码的过于臃肿，同时耦合性较高</em></li>
</ul>
<p>&#x3D;&gt; 反射 动态的创建对象</p>
<h3 id="动态代理-1"><a href="#动态代理-1" class="headerlink" title="动态代理"></a>动态代理</h3><p><strong>动态代理分类</strong></p>
<ul>
<li>基于API接口 –jdk动态代理</li>
<li>基于类 cglib</li>
<li>Java字节码实现 JAVAssist</li>
</ul>
<p><strong>动态代理的本质 -&gt; 通过 interface + reflect -&gt; 动态的创建对象（反射创建对象的三种方式）来实现 interface 的方法（具备某种能力） -&gt; 来实现某个完整的业务</strong></p>
<p><code>通过 接口 来实现能力的传递</code></p>
<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20230120174144870.png" alt="image-20230120174144870" style="zoom:67%;margin-left:0" />

<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20230120174716371.png" alt="image-20230120174716371" style="zoom:67%;margin-left:0" />

<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20230120174104091.png" alt="image-20230120174104091" style="zoom:67%;margin-left:0" />



<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20230120180942166.png" alt="image-20230120180942166" style="zoom:67%;margin-left:0" />



<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20230120174338136.png" alt="image-20230120174338136" style="zoom:67%;margin-left:0" />

<p>思考</p>
<ol>
<li>Java提供了哪些API创建代理？</li>
<li>newProxyInstance 方法在创建代理时，需要接收几个参数，每个参数的含义是什么？</li>
<li>通过 invokeHandler 的 invoke 方法指定代理执行方法时，invoke 实际的执行过程，需要接收哪几个参数？</li>
</ol>
<h2 id="JSON"><a href="#JSON" class="headerlink" title="JSON"></a>JSON</h2><p><strong>JSON</strong>（JavaScript Object Notation, JS对象简谱）是一种<strong>轻量级的数据交换格式</strong>。它基于 ECMAScript（European Computer Manufacturers Association, 欧洲计算机协会制定的js规范）的一个子集，采用完全独立于编程语言的文本格式来存储和表示数据。简洁和清晰的层次结构使得 JSON 成为理想的数据交换语言。 易于人阅读和编写，同时也易于机器解析和生成，并有效地提升网络传输效率</p>
<p><strong>示范</strong></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;firstName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Brett&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;lastName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;McLaughlin&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;people&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;firstName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Brett&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;lastName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;McLaughlin&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;firstName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Jason&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;lastName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Hunter&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>



<p><strong>JSON对比XML</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">country</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>中国<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">province</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>黑龙江<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">cities</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">city</span>&gt;</span>哈尔滨<span class="tag">&lt;/<span class="name">city</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">city</span>&gt;</span>大庆<span class="tag">&lt;/<span class="name">city</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">cities</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">province</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">province</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>广东<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">cities</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">city</span>&gt;</span>广州<span class="tag">&lt;/<span class="name">city</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">city</span>&gt;</span>深圳<span class="tag">&lt;/<span class="name">city</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">city</span>&gt;</span>珠海<span class="tag">&lt;/<span class="name">city</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">cities</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">province</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">province</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>台湾<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">cities</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">city</span>&gt;</span>台北<span class="tag">&lt;/<span class="name">city</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">city</span>&gt;</span>高雄<span class="tag">&lt;/<span class="name">city</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">cities</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">province</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">province</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>新疆<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">cities</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">city</span>&gt;</span>乌鲁木齐<span class="tag">&lt;/<span class="name">city</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">cities</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">province</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">country</span>&gt;</span></span><br></pre></td></tr></table></figure>



<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;中国&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;province&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;黑龙江&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;cities&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;city&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;哈尔滨&quot;</span><span class="punctuation">,</span> <span class="string">&quot;大庆&quot;</span><span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;广东&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;cities&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;city&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;广州&quot;</span><span class="punctuation">,</span> <span class="string">&quot;深圳&quot;</span><span class="punctuation">,</span> <span class="string">&quot;珠海&quot;</span><span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;台湾&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;cities&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;city&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;台北&quot;</span><span class="punctuation">,</span> <span class="string">&quot;高雄&quot;</span><span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;新疆&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;cities&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;city&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;乌鲁木齐&quot;</span><span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>



<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xdr630&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;favorite&quot;</span><span class="punctuation">:</span> <span class="string">&quot;programming&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;兮动人&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;age&quot;</span><span class="punctuation">:</span><span class="number">22</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;fruits&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="string">&quot;apple&quot;</span><span class="punctuation">,</span><span class="string">&quot;pear&quot;</span><span class="punctuation">,</span><span class="string">&quot;grape&quot;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;string&quot;</span><span class="punctuation">:</span><span class="string">&quot;\\ \&quot; &quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;number&quot;</span><span class="punctuation">:</span> <span class="number">1e3</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;n1&quot;</span><span class="punctuation">:</span> <span class="number">1e2</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;n2&quot;</span><span class="punctuation">:</span> <span class="number">-100</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>



<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span></span><br><span class="line">    <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">    <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;three&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;four&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">[</span></span><br><span class="line">        <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">        <span class="number">2</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;兮动人&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>



<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> str = <span class="string">&#x27;&#123;&quot;name&quot;: &quot;兮动人&quot;,&quot;age&quot;:22&#125;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> obj = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(str);</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(obj);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> str = <span class="string">&#x27;&#123;&quot;name&quot;: &quot;兮动人&quot;,&quot;age&quot;:22&#125;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> obj = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(str);</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(obj);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> jsonstr = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(obj);</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(jsonstr);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> str = <span class="string">&quot;console.log(&#x27;hello&#x27;)&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="built_in">eval</span>(str);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> str = <span class="string">&#x27;&#123;&quot;name&quot;:&quot;兮动人&quot;,&quot;age&quot;:22&#125;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> obj = <span class="built_in">eval</span>(<span class="string">&quot;(&quot;</span>+str+<span class="string">&quot;)&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(obj)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> str = <span class="string">&#x27;&#123;&quot;name&quot;:&quot;兮动人&quot;,&quot;age&quot;:22&#125;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> obj = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(str)</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(obj)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> str = <span class="string">&#x27;&#123;&quot;name&quot;:&quot;兮动人&quot;,&quot;age&quot;:22&#125;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> obj = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(str,fun);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">fun</span>(<span class="params">name,value</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(name+<span class="string">&quot;:&quot;</span>+value);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> value</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(obj)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> str = <span class="string">&#x27;&#123;&quot;name&quot;:&quot;兮动人&quot;,&quot;age&quot;:22&#125;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> obj = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(str,fun);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">fun</span>(<span class="params">name,value</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (name == <span class="string">&quot;age&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">            value = <span class="number">14</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> value</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(obj)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> obj = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(value[, replacer[, space]])</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> obj = &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">a</span>: <span class="number">1</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">b</span>: <span class="number">2</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">c</span>: <span class="number">3</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">d</span>: <span class="number">4</span></span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(obj);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> jsonstr = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(obj,[<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>,<span class="string">&quot;c&quot;</span>]);</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(jsonstr)</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> jsonstr = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(obj,[<span class="string">&quot;c&quot;</span>,<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>]);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> jsonstr = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(obj,[<span class="string">&quot;c&quot;</span>,<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>]);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> obj = &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">name</span>: <span class="string">&quot;兮动人&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">age</span>: <span class="number">22</span></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(obj);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> jsonstr = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(obj);</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(jsonstr)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> obj = &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">name</span>: <span class="string">&quot;兮动人&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">age</span>: <span class="number">22</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">a</span>: <span class="literal">undefined</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">f</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">b</span>:[<span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;]</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(obj);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> jsonstr = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(obj);</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(jsonstr)        </span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> obj = &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">a</span>: <span class="number">1</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">b</span>: <span class="number">2</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">c</span>: <span class="number">3</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">d</span>: <span class="number">4</span></span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(obj);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> jsonstr = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(obj,[<span class="string">&quot;c&quot;</span>,<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>],<span class="string">&quot;one&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(jsonstr)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> obj = &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">a</span>: <span class="number">1</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">b</span>: <span class="number">2</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">c</span>: <span class="number">3</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">d</span>: <span class="number">4</span></span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(obj);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> jsonstr = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(obj,[<span class="string">&quot;c&quot;</span>,<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>],<span class="string">&quot;\t&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(jsonstr)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">root</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>兮动人<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">age</span>&gt;</span>22<span class="tag">&lt;/<span class="name">age</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">fruits</span>&gt;</span>apple<span class="tag">&lt;/<span class="name">fruits</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">fruits</span>&gt;</span>pear<span class="tag">&lt;/<span class="name">fruits</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">fruits</span>&gt;</span>grape<span class="tag">&lt;/<span class="name">fruits</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>参考文档</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41684621/article/details/113851644">JSON与JS操作</a></p>
<h1 id="Tips"><a href="#Tips" class="headerlink" title="Tips"></a>Tips</h1><ol>
<li><p>JDK JRE JVM 的包含关系</p>
<ul>
<li>JDK &#x3D; JRE + 开发工具集（例如javac，java编译工具等）</li>
<li>JRE &#x3D; JVM + Java SE标准类库（Java核心类库）</li>
<li>只运行开发好的.class文件 只需要JRE</li>
</ul>
</li>
<li><p>DOS命令Disk Operating System 接受指令-解析指令-执行指令</p>
</li>
<li><p>转义字符</p>
</li>
<li><p>javadoc文档注释</p>
</li>
<li><p>BS架构</p>
<ul>
<li>Java写跨平台项目</li>
<li>.net不跨平台项目</li>
<li>php门户网站</li>
</ul>
<p>Java 原生 jsp + servlet</p>
<p>ssm + ssh</p>
</li>
<li><p>从 JDK 5.0 开始, Java 增加了对元数据(MetaData) 的支持, 也就是Annotation(注解) JDK1.5版本</p>
<p>“<em>Java注解基础注解是JDK1.5版本开始引入的一个特性</em>，用于对程序代码的说明，可以对包、类、接口、字段、方法参数、局部变量等进行注解。”</p>
</li>
<li><blockquote>
<p>Annotation 其实就是代码里的特殊标记, 这些标记可以在编译, 类加载, 运行时被读取, 并执行相应的处理。通过使用 Annotation, 程序员可以在不改变原有逻辑的情况下, 在源文件中嵌入一些补充信息。代码分析工具、开发工具和部署工具可以通过这些补充信息进行验证或者进行部署</p>
</blockquote>
</li>
<li><p>未来的开发模式都是基于注解的，JPA是基于注解的，Spring2.5以上都是基于注解的，Hibernate3.x以后也是基于注解的，现在的Struts2有一部分也是基于注解的了，注解是一种趋势，一定程度上可以说：<strong>框架 &#x3D; 注解 + 反射 + 设计模式</strong>。</p>
<blockquote>
<p>注解都是 @ 符号开头的，例如我们在学习方法重写时使用过的 @Override 注解。同 Class 和 Interface 一样，注解也属于一种类型。</p>
<p>无论是哪一种注解，本质上都一种数据类型，是一种接口类型。到 Java 8 为止 Java SE 提供了 11 个内置注解。其中有 5 个是基本注解，它们来自于 java.lang 包。有 6 个是元注解，它们来自于 java.lang.annotation 包，自定义注解会用到元注解。</p>
<p>提示：元注解就是负责注解其他的注解。</p>
<p>基本注解包括：@Override、@Deprecated、@SuppressWarnings、@SafeVarargs 和 @FunctionalInterface。</p>
</blockquote>
<blockquote>
<p><em><strong>常见的Annotation示例</strong></em></p>
<p>使用 Annotation 时要在其前面增加 @ 符号, 并把该 Annotation 当成一个修饰符使用。用于修饰它支持的程序元素</p>
<p><strong>生成文档相关的注解</strong><br>@author 标明开发该类模块的作者，多个作者之间使用,分割<br>@version 标明该类模块的版本<br>@see 参考转向，也就是相关主题<br>@since 从哪个版本开始增加的<br>@param 对方法中某参数的说明，如果没有参数就不能写<br>@return 对方法返回值的说明，如果方法的返回值类型是void就不能写<br>@exception 对方法可能抛出的异常进行说明 ，如果方法没有用throws显式抛出的异常就不能写<br>其中<br>@param @return 和 @exception 这三个标记都是只用于方法的。<br>@param的格式要求：@param 形参名 形参类型 形参说明<br>@return 的格式要求：@return 返回值类型 返回值说明<br>@exception的格式要求：@exception 异常类型 异常说明<br>@param和@exception可以并列多个</p>
<p>JDK内置的基本注解<br>@Override 注解是用来指定方法重写的，只能修饰方法并且只能用于方法重写，不能修饰其它的元素。它可以强制一个子类必须重写父类方法或者实现接口的方法。<br>@Deprecated 可以用来注解类、接口、成员方法和成员变量等，用于表示某个元素（类、方法等）已过时。通常是因为所修饰的结构危险或存在更好的选择。当其他程序使用已过时的元素时，编译器将会给出警告。<br>@SuppressWarnings 注解指示被该注解修饰的程序元素（以及该程序元素中的所有子元素）取消显示指定的编译器警告，且会一直作用于该程序元素的所有子元素。例如，使@SuppressWarnings 修饰某个类取消显示某个编译器警告，同时又修饰该类里的某个方法取消显示另一个编译器警告，那么该方法将会同时取消显示这两个编译器警告。</p>
<p>跟踪代码依赖性，实现替代配置文件功能<br>Servlet3.0提供了注解(annotation),使得不再需要在web.xml文件中进行Servlet的部署。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/login&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"> <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line"> <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span></span><br><span class="line">         ServletException, IOException &#123; &#125;</span><br><span class="line"> <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span></span><br><span class="line">         ServletException, IOException &#123;</span><br><span class="line">     doGet(request, response);</span><br><span class="line"> &#125; &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>LoginServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.servlet.LoginServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>LoginServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/login<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p><strong>自定义Annotation</strong><br>定义新的 Annotation 类型使用 @interface 关键字<br>自定义注解自动继承了java.lang.annotation.Annotation接口<br>Annotation 的成员变量在 Annotation 定义中以无参数方法的形式来声明。其方法名和返回值定义了该成员的名字和类型。我们称为配置参数。类型只能是八种基本数据类型、String类型、Class类型、enum类型、Annotation类型、以上所有类型的数组。  可以在定义 Annotation 的成员变量时为其指定初始值, 指定成员变量的初始值可使用 default 关键字<br>如果只有一个参数成员，建议使用参数名为value<br>如果定义的注解含有配置参数，那么使用时必须指定参数值，除非它有默认值。格式是“参数名 &#x3D; 参数值”，如果只有一个参数成员，且名称为value 可以省略“value&#x3D;”<br>没有成员定义的 Annotation 称为标记; 包含成员变量的 Annotation 称为元数据 Annotation<br>注意：自定义注解必须配上注解的信息处理流程才有意义。</p>
<p>声明自定义注解使用 @interface 关键字（interface 关键字前加 @ 符号）实现。定义注解与定义接口非常像，如下代码可定义一个简单形式的注解类型。</p>
<p><strong>JDK 中的元注解</strong><br>JDK 的元 Annotation 用于修饰其他 Annotation 定义<br>JDK5.0提供了4个标准的meta-annotation类型，分别是：</p>
<p>Retention<br>Target<br>Documented<br>Inherited<br>Java 8 又增加了 @Repeatable 和 @Native 两个注解。这些注解都可以在 java.lang.annotation 包中找到。下面主要介绍每个元注解的作用及使用。</p>
<p>1、@Retention<br>@Retention: 只能用于修饰一个 Annotation 定义, 用于指定该 Annotation 的生命周期, @Rentention 包含一个 RetentionPolicy 类型的成员变量, 使用@Rentention 时必须为该 value 成员变量指定值:</p>
<p>RetentionPolicy.SOURCE:在源文件中有效（即源文件保留），编译器直接丢弃这种策略的注释<br>RetentionPolicy.CLASS:在class文件中有效（即class保留） ， 当运行 Java 程序时, JVM 不会保留注解。 这是默认值<br>RetentionPolicy.RUNTIME:在运行时有效（即运行时保留），当运行 Java 程序时, JVM 会保留注释。程序可以通过反射获取该注释。</p>
<p>2、@Target</p>
<p>@Target: 用于修饰 Annotation 定义, 用于指定被修饰的 Annotation 能用于修饰哪些程序元素。 @Target 也包含一个名为 value 的成员变量。</p>
<p>JDK1.8之后，关于元注解@Target的参数类型ElementType枚举值多了两个：<br>TYPE_PARAMETER,TYPE_USE。</p>
<p>在Java 8之前，注解只能是在声明的地方所使用，Java8开始，注解可以应用在任何地方。 </p>
<ul>
<li>ElementType.TYPE_PARAMETER 表示该注解能写在类型变量的声明语句中（如：泛型声明）。 </li>
<li>ElementType.TYPE_USE 表示该注解能写在使用类型的任何语句中。</li>
</ul>
</blockquote>
</li>
</ol>
<h2 id="1-集合"><a href="#1-集合" class="headerlink" title="1. 集合"></a>1. 集合</h2><h3 id="1-1-数组"><a href="#1-1-数组" class="headerlink" title="1.1 数组"></a>1.1 数组</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Char[] cs = new Char[]&#123;&#x27;K&#x27;, &#x27;k&#x27;, &#x27;i&#x27;, &#x27;n&#x27;, &#x27;g&#x27;&#125;;</span><br><span class="line">Char[] cs1 = new Char[5];</span><br><span class="line">cs1[0] = &#x27;K&#x27;;</span><br><span class="line">....</span><br></pre></td></tr></table></figure>



<p>特点：</p>
<blockquote>
<ol>
<li>内存地址连续 使用之前必须要指定数组长度</li>
<li>可以通过下标方式访问成员 查询效率高</li>
<li><span style="color: red">增删</span>操作会给系统带来性能消耗 –需要保证避免下标越界的问题 故而动态扩容</li>
</ol>
</blockquote>
<h3 id="1-2-链表"><a href="#1-2-链表" class="headerlink" title="1.2 链表"></a>1.2 链表</h3><p>单向链表 与 双向链表</p>
<blockquote>
<p>双向链表</p>
<p>特点：</p>
<ol>
<li>灵活的空间要求 存储空间不要求连续</li>
<li>不支持下标访问 支持顺序遍历检索</li>
<li>针对<span style="color: red">增删</span>效率会更高 只与操作节点的前后节点有关系 无需移动元素</li>
</ol>
</blockquote>
<p>LinkedList –&gt; 双向链表的一个简单应用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Node</span>&lt;E&gt; &#123;</span><br><span class="line">    E item;</span><br><span class="line">    Node&lt;E&gt; next;</span><br><span class="line">    Node&lt;E&gt; prev;</span><br><span class="line"></span><br><span class="line">    Node(Node&lt;E&gt; prev, E element, Node&lt;E&gt; next) &#123;</span><br><span class="line">        <span class="built_in">this</span>.item = element;</span><br><span class="line">        <span class="built_in">this</span>.next = next;</span><br><span class="line">        <span class="built_in">this</span>.prev = prev;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="1-3-树"><a href="#1-3-树" class="headerlink" title="1.3 树"></a>1.3 树</h3><h4 id="1-3-1-二叉树"><a href="#1-3-1-二叉树" class="headerlink" title="1.3.1 二叉树"></a>1.3.1 二叉树</h4><blockquote>
<p>二叉树特点：</p>
<ol>
<li>某节点的左子树节点值仅包含小于该节点值</li>
<li>某节点的右子树节点值仅包含大于该节点值</li>
<li>左右子树每个也必须是二叉查找树</li>
<li>顺序排列</li>
</ol>
</blockquote>
<h4 id="1-3-2-不平衡二叉树"><a href="#1-3-2-不平衡二叉树" class="headerlink" title="1.3.2 不平衡二叉树"></a>1.3.2 不平衡二叉树</h4><blockquote>
<p>不平衡二叉树特点：</p>
<p>查询效率不高，面对这个问题我们可以参考在高中学习生物时学过一个关键字去除顶端优势，通过去除植物顶端优势，侧芽会迅速生长，慢慢变得强壮和平衡， 红黑树其实就是去除二叉查找树顶端优势的解决方案，从而达到树的平衡</p>
</blockquote>
<h4 id="1-3-3-平衡二叉树"><a href="#1-3-3-平衡二叉树" class="headerlink" title="1.3.3 平衡二叉树"></a>1.3.3 平衡二叉树</h4><h4 id="1-3-4-红黑树"><a href="#1-3-4-红黑树" class="headerlink" title="1.3.4 红黑树"></a>1.3.4 红黑树</h4><p>RBT（red black tree） –<strong>自平衡</strong>的二叉树 不是绝对平衡的二叉查找树</p>
<p>树上的节点<b>满足</b>： </p>
<blockquote>
<ol>
<li>每个节点 非黑即红</li>
<li>根节点必须是黑色</li>
<li>每个叶子节点【NIL】都是黑色</li>
<li>每个红色节点的两个子节点必须是黑色 –相邻两层不能同时出现红色 一个红色叶子节点的子结点和父节点必须都是黑色</li>
<li>任意节点到每个叶子节点的路径包含相同数量的黑节点</li>
</ol>
</blockquote>
<p>红黑树是一个黑平衡二叉树</p>
<p>红黑树遵守规则：</p>
<blockquote>
<ol>
<li>recolor –重新标志节点为红色或者黑色</li>
<li>rotation –选择实现树平衡的关键</li>
</ol>
</blockquote>
<p>红黑树能自平衡 靠的是</p>
<ul>
<li><p>左旋：</p>
<p>以某个节点作为支点（旋转节点），其右子节点变为旋转节点的父节点，右子节点的左子节点变为旋转节点的右子节点，左子节点保持不变</p>
</li>
<li><p>右旋：</p>
<p>以某个节点作为支点（旋转节点），其左子节点变为旋转节点的父节点，左子节点的右子节点变为旋转节点的左子节点，右子节点保持不变</p>
</li>
<li><p>变色：</p>
<p>节点的颜色由红变黑或由黑变红</p>
</li>
</ul>
<p>红黑树插入场景</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://negativefunction.github.io/2022/11/21/webpack/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/05.jpg">
      <meta itemprop="name" content="Linyuxuan">
      <meta itemprop="description" content="Hope Sometimes Love Brain">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Welcome To Lin's World">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/21/webpack/" class="post-title-link" itemprop="url">webpack</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-21 07:24:21" itemprop="dateCreated datePublished" datetime="2022-11-21T07:24:21+08:00">2022-11-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-01-21 19:04:08" itemprop="dateModified" datetime="2023-01-21T19:04:08+08:00">2023-01-21</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Nodejs"><a href="#Nodejs" class="headerlink" title="Nodejs"></a>Nodejs</h1><h2 id="1-预科准备"><a href="#1-预科准备" class="headerlink" title="1. 预科准备"></a>1. 预科准备</h2><ol>
<li>前端开发工具</li>
<li>Nodejs安装</li>
<li>ES6新语法糖</li>
<li>npm包管理器</li>
<li>Babel –新一代JavaScript编译器</li>
<li>模块化管理</li>
<li>Webpack打包 编译</li>
<li>快速构建nodejs项目 –vue-admin-element实例应用</li>
<li>快速构建nodejs项目antd</li>
</ol>
<blockquote>
<p><strong>前端工具vscode</strong></p>
</blockquote>
<ol>
<li>下载安装vscode</li>
<li>傻瓜式安装</li>
<li>左侧工具栏 从上到下依次为 目录结构 代码搜索及替换 版本控制 运行及调试 插件市场</li>
<li>emment 自动补全 语法学习</li>
</ol>
<blockquote>
<p><strong>Nodejs安装与应用</strong></p>
</blockquote>
<p>Nodejs是一个JavaScript运行的服务端开发平台 使JavaScript成为与php python perl ruby 等服务端语言平起平坐的脚本语言 由Ryan Dahl开发 实质是将Chrome V8引擎进行封装</p>
<p>通俗讲Nodejs就是运行在服务端的JavaScript Nodejs是一个基于Chrom JavaScript 运行时建立的一个平台 底层架构是 JavaScript 文件后缀为.js</p>
<p>同时Nodejs 是一个 事件驱动 I&#x2F;O 的服务端JavaScript环境 基于Google的V8引擎 V8引擎执行JavaScript的速度非常快 性能非常好</p>
<ol>
<li><p>.msi文件 傻瓜式安装</p>
</li>
<li><p><code>node -v</code> &#96;&#96;npm -v&#96; 查看 安装后的版本 测试是否安装成功</p>
</li>
<li><p>Nodejs参考文献</p>
<ul>
<li><p>官网 <a target="_blank" rel="noopener" href="http://nodejs.cn/">http://nodejs.cn/</a></p>
</li>
<li><p>下载地址 <a target="_blank" rel="noopener" href="https://nodejs.org/zh-cn/download">https://nodejs.org/zh-cn/download</a></p>
</li>
<li><p>帮助文档 <a target="_blank" rel="noopener" href="https://nodejs.org/zh-cn/docs">https://nodejs.org/zh-cn/docs</a></p>
</li>
<li><p>关于Nodejs <a target="_blank" rel="noopener" href="https://nodejs.org/zh-cn/about">https://nodejs.org/zh-cn/about</a></p>
</li>
</ul>
</li>
<li><p>.js文件 为JavaScript脚本 直接终端 <code>node chapter01</code> 即可运行</p>
</li>
</ol>
<table>
    <thead>
        <td></td>
        <td colspan="2"><b>.java</b></td>
        <td colspan="2"><b>.js</b></td>
    </thead>
    <tbody>
        <tr>
            <td rowspan="4">代码运行流程</td>
            <td>API</td>
            <td rowspan="2">jdk</td>
            <td>API</td>
            <td rowspan="2">Nodejs</td>
        </tr>
        <tr>
            <td>JVM --> 将.class字节码文件解析给操作系统</td>
            <td>Chrome V8引擎 --> 将.js文件解释给操作系统</td>
        </tr>
        <tr>
            <td>操作系统</td>
            <td></td>
            <td>操作系统</td>
            <td></td>
        </tr>
    </tbody>
</table>




<h2 id="2-Nodejs-实现请求响应"><a href="#2-Nodejs-实现请求响应" class="headerlink" title="2. Nodejs 实现请求响应"></a>2. Nodejs 实现请求响应</h2><blockquote>
<p><strong>require</strong></p>
</blockquote>
<p>require 是导入模块 类似于 <code>import java.io</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>);</span><br></pre></td></tr></table></figure>



<blockquote>
<p><strong>请求响应</strong></p>
</blockquote>
<p>请求响应事件步骤：</p>
<ol>
<li>创建一个httpserver服务</li>
<li>监听一个端口 8888</li>
<li>启动运行服务node httpserver.js</li>
<li>在浏览器中访问<a target="_blank" rel="noopener" href="http://localhost:8888/%E6%B5%8B%E8%AF%95">http://localhost:8888/测试</a></li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * @Description: </span></span><br><span class="line"><span class="comment"> * @Version: 1.0</span></span><br><span class="line"><span class="comment"> * @Autor: negativeFunction</span></span><br><span class="line"><span class="comment"> * @Date: 2022-09-24 00:27:29</span></span><br><span class="line"><span class="comment"> * @FilePath: \Test\chapter02.js</span></span><br><span class="line"><span class="comment"> * @LastEditors: negativeFunction</span></span><br><span class="line"><span class="comment"> * @LastEditTime: 2022-09-24 08:35:26</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">// 导入模块 require 类似于 import java.io</span></span><br><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. 创建一个HTTP server服务</span></span><br><span class="line">http.<span class="title function_">createServer</span>(<span class="keyword">function</span>(<span class="params">request, response</span>) &#123;</span><br><span class="line">    <span class="comment">// 浏览器如何识别 hello world</span></span><br><span class="line">    response.<span class="title function_">writeHead</span>(<span class="number">200</span>, &#123;<span class="string">&#x27;Content-type&#x27;</span>:<span class="string">&#x27;text/html&#x27;</span>&#125;);  <span class="comment">// 含义 --告知浏览器将以 text/plain 去解析hello world 这段数据</span></span><br><span class="line">    <span class="comment">// 给浏览器输出内容 若上句解析为 text/html 就会以html去解析 text/plain</span></span><br><span class="line">    response.<span class="title function_">end</span>(<span class="string">&quot;&lt;h1&gt;hello world&lt;/h1&gt;&quot;</span>);</span><br><span class="line">&#125;).<span class="title function_">listen</span>(<span class="number">8888</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;已启动端口为8888 的http服务 --&gt; chapter02 访问路径为: http://localhost:8888/&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 监听一个端口8888</span></span><br><span class="line"><span class="comment">// 3. 启动运行服务 node httpserver.js</span></span><br><span class="line"><span class="comment">// 使用node 运行js 时 可直接 node httpserver 省去js后缀</span></span><br><span class="line"><span class="comment">// 4. 在浏览器中访问http://localhost:8888/测试</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="3-Nodejs-操作MySQL数据库"><a href="#3-Nodejs-操作MySQL数据库" class="headerlink" title="3. Nodejs 操作MySQL数据库"></a>3. Nodejs 操作MySQL数据库</h2><p>参考文档：<a target="_blank" rel="noopener" href="https://www.npmjs.com/package/mysql">https://www.npmjs.com/package/mysql</a></p>
<p>操作步骤：</p>
<ol>
<li>安装mysql 第三方依赖 <code>npm install mysql</code></li>
<li>创建db.js进行操作数据库代码编写<ol>
<li>导入mysql依赖包</li>
<li>创建一个mysql的Connection对象</li>
<li>配置数据连接信息</li>
<li>开辟连接</li>
<li>执行CRUD</li>
<li>关闭连接</li>
</ol>
</li>
<li>运行 <code>node db.js</code> 测试<br>使用node 运行js 时 可直接 <code>node httpserver</code> 省去js后缀</li>
</ol>
<h2 id="4-ES6概述"><a href="#4-ES6概述" class="headerlink" title="4. ES6概述"></a>4. ES6概述</h2><blockquote>
<p><strong>ES6概述</strong></p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/ECMAScript/1889420?fromModule=lemma_inlink">ECMAScript</a> 6（简称ES6）是于2015年6月正式发布的<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/JavaScript/321142?fromModule=lemma_inlink">JavaScript</a>语言的标准，正式名为ECMAScript 2015（ES2015）。它的目标是使得JavaScript语言可以用来编写复杂的大型应用程序，成为企业级开发语言</p>
<p><strong>ECMAScript</strong>是一种由<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/Ecma%E5%9B%BD%E9%99%85?fromModule=lemma_inlink">Ecma国际</a>（前身为<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%AC%A7%E6%B4%B2%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%88%B6%E9%80%A0%E5%95%86%E5%8D%8F%E4%BC%9A/2052072?fromModule=lemma_inlink">欧洲计算机制造商协会</a>，European Computer Manufacturers Association）通过ECMA-262标准化的脚本<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E8%AF%AD%E8%A8%80?fromModule=lemma_inlink">程序设计语言</a>。这种语言在<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E4%B8%87%E7%BB%B4%E7%BD%91?fromModule=lemma_inlink">万维网</a>上应用广泛，它往往被称为<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/JavaScript?fromModule=lemma_inlink">JavaScript</a>或<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/JScript?fromModule=lemma_inlink">JScript</a>，所以它可以理解为是JavaScript的一个标准,但实际上后两者是ECMA-262标准的实现和扩展。</p>
<p>ECMAScript是由网景的布兰登·艾奇开发的一种脚本语言的标准化规范；最初命名为Mocha，后来改名为LiveScript，最后重命名为JavaScript。1995年12月，升阳与网景联合发表了JavaScript。1996年11月，网景公司将JavaScript提交给<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%AC%A7%E6%B4%B2%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%88%B6%E9%80%A0%E5%95%86%E5%8D%8F%E4%BC%9A/2052072?fromModule=lemma_inlink">欧洲计算机制造商协会</a>进行标准化。ECMA-262的第一个版本于1997年6月被Ecma组织采纳。ECMA Script是ECMA-262标准化的脚本语言的名称。尽管JavaScript和JScript与ECMAScript兼容，但包含超出ECMA Script的功能。</p>
<p>ECMAScript是一种可以在宿主环境中执行计算并能操作可计算对象的基于对象的<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E8%AF%AD%E8%A8%80/2317999?fromModule=lemma_inlink">程序设计语言</a>。ECMAScript最先被设计成一种Web脚本语言，用来支持Web页面的动态表现以及为基于Web的客户机—服务器架构提供服务器端的计算能力。但作为一种脚本语言， ECMAScript具备同其他脚本语言一样的性质，即“用来操纵、定制一个已存在系统所提供的功能，以及对其进行自动化”。</p>
<p>2022年6月22日，第 123 届 ECMA 大会批准了 <a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=ECMAScript&spm=1001.2101.3001.7020">ECMAScript</a> 2022 语言规范，这意味着它现在正式成为标准。下面就来看看 ECMAScript 2022</p>
<p><strong>ECMAScript版本发展</strong></p>
<ul>
<li>1998.6 ES2.0发布</li>
<li>1999.1 ES3.0发布</li>
<li>2007.10 ES4.0起草</li>
<li>2009.12 ES5.0发布</li>
<li>2011.6 ES5.1发布</li>
<li>2015.6 ES6.0发布</li>
</ul>
<h3 id="4-1-ES6语法：let-和-const命令"><a href="#4-1-ES6语法：let-和-const命令" class="headerlink" title="4.1 ES6语法：let 和 const命令"></a>4.1 ES6语法：let 和 const命令</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 传统定义变量和常量的方式 统一使用 var</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> name = <span class="string">&quot;nihaoya&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> link = <span class="string">&quot;www.baidu.com&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> <span class="variable constant_">PI</span> = <span class="title class_">Math</span>.<span class="property">PI</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(name);</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(link);</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable constant_">PI</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// ES6 定义方式 区分了常量和变量</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> name2 = <span class="string">&quot;nibuhaoya&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> link2 = <span class="string">&quot;www.weibo.com&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 定义常量</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> <span class="title class_">PI2</span> = <span class="title class_">Math</span>.<span class="property">PI</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(name2);</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(link2);</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">PI2</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// let 与 const 解决</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 1. var 变量穿透问题</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 2. 常量修改问题</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(i);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 再次console.log 就会造成变量穿透问题</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(i);</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 使用let替换就能解决 穿透 --&gt; 会直接报错 i未定义</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable constant_">PI</span> = <span class="number">100</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">PI2</span> = <span class="number">100</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 注意在实际开发和生产中 如果是小程序 uniapp 或者一些脚手架 可以大胆使用let 和 const</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 但是如果在web开发中 不建议使用 还是建议使用var 因为在低版本浏览器中 并不支持 let 和 const</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="4-2-ES6语法：模板字符串"><a href="#4-2-ES6语法：模板字符串" class="headerlink" title="4.2 ES6语法：模板字符串"></a>4.2 ES6语法：模板字符串</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> person = &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">name</span>: <span class="string">&quot;lin&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">address</span>: <span class="string">&quot;hello world&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">link</span>: <span class="string">&quot;www.baidu.com&quot;</span></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> address = <span class="string">&quot;传统js I am &quot;</span> + person.<span class="property">name</span> + <span class="string">&quot;I want to say &quot;</span> + person.<span class="property">address</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(address);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> address2 = <span class="string">`ES6 I am <span class="subst">$&#123;person.name&#125;</span> I want to say <span class="subst">$&#123;person.address&#125;</span>`</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(address2);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="4-3-ES6语法：函数默认参数与箭头函数"><a href="#4-3-ES6语法：函数默认参数与箭头函数" class="headerlink" title="4.3 ES6语法：函数默认参数与箭头函数"></a>4.3 ES6语法：函数默认参数与箭头函数</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 默认函数</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">f</span>(<span class="params">a, b</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> a + b;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> result = <span class="title function_">f</span>(<span class="number">199</span>, <span class="number">233</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 箭头函数 --重点 在比如 小程序 uniapp 常见脚手架中 大量使用</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> <span class="title function_">x</span> = (<span class="params">a, b</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> a + b;</span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">x</span>(<span class="number">12</span>, <span class="number">44</span>));</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 写法一</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> <span class="title function_">y</span> = (<span class="params">a, b</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> a + b;</span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 写法二</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> <span class="title function_">sum</span> = (<span class="params">a, b</span>) =&gt; a + b;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">y</span>(<span class="number">132</span>, <span class="number">44</span>));</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">sum</span>(<span class="number">1352</span>, <span class="number">44</span>));</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>];</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> answer = arr.<span class="title function_">map</span>(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a + b);</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(answer);</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 如果 参数 只有一个 可以 括号也省去</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 多个参数 则不能省去</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="4-4-ES6语法：对象初始化简写"><a href="#4-4-ES6语法：对象初始化简写" class="headerlink" title="4.4 ES6语法：对象初始化简写"></a>4.4 ES6语法：对象初始化简写</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment"> * @Description: </span></span><br><span class="line"><span class="comment"> * @Version: 1.0</span></span><br><span class="line"><span class="comment"> * @Autor: negativeFunction</span></span><br><span class="line"><span class="comment"> * @Date: 2022-07-28 17:53:32</span></span><br><span class="line"><span class="comment"> * @FilePath: \Demo01\demo02.html</span></span><br><span class="line"><span class="comment"> * @LastEditors: negativeFunction</span></span><br><span class="line"><span class="comment"> * @LastEditTime: 2022-07-28 18:00:35</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/1999/html&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>账号: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;account&quot;</span> <span class="attr">id</span>=<span class="string">&quot;account&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>密码: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">id</span>=<span class="string">&quot;password&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">id</span>=<span class="string">&quot;loginbtn&quot;</span> <span class="attr">value</span>=<span class="string">&quot;login&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 案例</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// document.getElementById(&quot;loginbtn&quot;).onclick = function () &#123;&#125;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&quot;#loginbtn&quot;</span>).<span class="title function_">on</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">var</span> account = $(<span class="string">&quot;#account&quot;</span>).<span class="title function_">val</span>();</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">var</span> password = $(<span class="string">&quot;#password&quot;</span>).<span class="title function_">val</span>();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 对象简写 应用场景</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">var</span> params = &#123;account, password&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 执行异步请求</span></span></span><br><span class="line"><span class="language-javascript">            $.<span class="title function_">ajax</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">type</span>: <span class="string">&quot;post&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">url</span>: <span class="string">&quot;xxx&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">data</span>: params,</span></span><br><span class="line"><span class="language-javascript">                <span class="title function_">success</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;abc&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 传统对象</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> info = &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">title</span>: <span class="string">&quot;hello world&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">link</span>: <span class="string">&quot;www.baidu.com&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="title class_">Autor</span>: <span class="string">&quot;lin&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">goto</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;hello&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(info);</span></span><br><span class="line"><span class="language-javascript">        info.<span class="title function_">goto</span>();</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(info.<span class="property">title</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(info.<span class="property">link</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(info.<span class="property">Autor</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">/*</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        * ES6 简写</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        * js对象是以 key:value 键值对存在</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        * 1. 如果key和变量的名字一致 可以只定义一次</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        * 2. 如果value 是一个函数 可以讲 `:function` 去掉 只剩下 `()` 即可</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        * */</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;------------------------------------------&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> link2 = <span class="string">&quot;www.4399.com&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> title2 = <span class="string">&quot;4399&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> info2 = &#123;</span></span><br><span class="line"><span class="language-javascript">            title2,</span></span><br><span class="line"><span class="language-javascript">            link2,</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">go</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;nishigedashagua&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(info2);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(info2.<span class="property">title2</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(info2.<span class="property">link2</span>);</span></span><br><span class="line"><span class="language-javascript">        info2.<span class="title function_">go</span>();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="4-5-ES6语法：对象解构"><a href="#4-5-ES6语法：对象解构" class="headerlink" title="4.5 ES6语法：对象解构"></a>4.5 ES6语法：对象解构</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment"> * @Description: </span></span><br><span class="line"><span class="comment"> * @Version: 1.0</span></span><br><span class="line"><span class="comment"> * @Autor: negativeFunction</span></span><br><span class="line"><span class="comment"> * @Date: 2022-07-28 17:53:32</span></span><br><span class="line"><span class="comment"> * @FilePath: \Demo01\demo02.html</span></span><br><span class="line"><span class="comment"> * @LastEditors: negativeFunction</span></span><br><span class="line"><span class="comment"> * @LastEditTime: 2022-07-28 18:00:35</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">/*</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        * 对象是以 key: value 的形式存在</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        * 获取对象属性和方法的方式有两种</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        * 1. 通过 .</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        * 2. 通过 []</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        * */</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> link2 = <span class="string">&quot;www.4399.com&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> title2 = <span class="string">&quot;4399&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> info2 = &#123;</span></span><br><span class="line"><span class="language-javascript">            title2,</span></span><br><span class="line"><span class="language-javascript">            link2,</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">go</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;nishigedashagua&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(info2);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 通过 .</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(info2.<span class="property">title2</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(info2.<span class="property">link2</span>);</span></span><br><span class="line"><span class="language-javascript">        info2.<span class="title function_">go</span>();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;-------------------------------------------------------&quot;</span>)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 通过 []</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(info2[<span class="string">&quot;link2&quot;</span>]);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(info2[<span class="string">&quot;title2&quot;</span>]);</span></span><br><span class="line"><span class="language-javascript">        info2[<span class="string">&quot;go&quot;</span>]();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;-------------------------------------------------------&quot;</span>)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// ES6 对象解构 -快速获取属性和方法的一种形式</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> &#123;title2, link2, go&#125; = info2;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 还原代码</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// var title2 = info2.title2;</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// var link2 = info2.link2;</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(title2);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(link2);</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">go</span>();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 为什么 对象的取值 提供两种方式 . []</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="4-6-ES6语法：传播操作符"><a href="#4-6-ES6语法：传播操作符" class="headerlink" title="4.6 ES6语法：传播操作符"></a>4.6 ES6语法：传播操作符</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment"> * @Description: </span></span><br><span class="line"><span class="comment"> * @Version: 1.0</span></span><br><span class="line"><span class="comment"> * @Autor: negativeFunction</span></span><br><span class="line"><span class="comment"> * @Date: 2022-07-28 17:53:32</span></span><br><span class="line"><span class="comment"> * @FilePath: \Demo01\demo02.html</span></span><br><span class="line"><span class="comment"> * @LastEditors: negativeFunction</span></span><br><span class="line"><span class="comment"> * @LastEditTime: 2022-07-28 18:00:35</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 对象传播操作符 ...</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> person = &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">name</span>: <span class="string">&quot;lin&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">address</span>: <span class="string">&quot;China&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">link</span>: <span class="string">&quot;https://www.baidu.com&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">phone</span>: <span class="string">&quot;11111&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">go</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;go to school&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 解构</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> &#123;name, address, ...person2&#125; =person;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(name);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(address);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(person2);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 应用案例</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">/*</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        * java --后台</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        * 数据格式 var userPage = &#123;pages: 10, users: [&#123;&#125;, &#123;&#125;], pageNo: 1, pageSize: 100, total: 100&#125;;</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        * 异步请求</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        * $.post(&quot;/user/search&quot;, function(res) &#123;&#125;</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        * */</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        res = &#123;<span class="attr">pages</span>: <span class="number">10</span>, <span class="attr">users</span>: [&#123;&#125;, &#123;&#125;], <span class="attr">pageNo</span>: <span class="number">1</span>, <span class="attr">pageSize</span>: <span class="number">100</span>, <span class="attr">total</span>: <span class="number">100</span>&#125;;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> userPage = &#123;<span class="attr">pages</span>: <span class="number">10</span>, <span class="attr">users</span>: [&#123;&#125;, &#123;&#125;], <span class="attr">pageNo</span>: <span class="number">1</span>, <span class="attr">pageSize</span>: <span class="number">100</span>, <span class="attr">total</span>: <span class="number">100</span>&#125;;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> &#123;users, total, pageNo, pages&#125; = userPage;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="4-7-ES6语法：数组-map-和-reduce-方法使用"><a href="#4-7-ES6语法：数组-map-和-reduce-方法使用" class="headerlink" title="4.7 ES6语法：数组 map 和 reduce 方法使用"></a>4.7 ES6语法：数组 map 和 reduce 方法使用</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment"> * @Description: </span></span><br><span class="line"><span class="comment"> * @Version: 1.0</span></span><br><span class="line"><span class="comment"> * @Autor: negativeFunction</span></span><br><span class="line"><span class="comment"> * @Date: 2022-07-28 17:53:32</span></span><br><span class="line"><span class="comment"> * @FilePath: \Demo01\demo02.html</span></span><br><span class="line"><span class="comment"> * @LastEditors: negativeFunction</span></span><br><span class="line"><span class="comment"> * @LastEditTime: 2022-07-28 18:00:35</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 对arr 数组每个元素 *2</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 传统方式</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> newArr = [];</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.<span class="property">length</span>; i++) &#123;</span></span><br><span class="line"><span class="language-javascript">            newArr.<span class="title function_">push</span>(arr[i] * <span class="number">2</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(newArr);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// map增强</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// map中自带循环遍历 并且在循环时 会将处理的值 回填到对应位置</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> newArr2 = arr.<span class="title function_">map</span>(<span class="keyword">function</span> (<span class="params">ele</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span> ele * <span class="number">2</span></span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> newArr3 = arr.<span class="title function_">map</span>( <span class="function"><span class="params">ele</span> =&gt;</span> ele * <span class="number">2</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 不能这样写</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// var ele = [1, 2, 3, 4]; 无法找到函数参数ele定义</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// var newArr4 = ele.map( () =&gt; ele * 2);</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;2---&quot;</span> + newArr2);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;3---&quot;</span> + newArr3);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// map 处理对象数据</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> users = [&#123;<span class="attr">age</span>: <span class="number">10</span>, <span class="attr">name</span>: <span class="string">&quot;xiaoming&quot;</span>&#125;, &#123;<span class="attr">age</span>: <span class="number">12</span>, <span class="attr">name</span>: <span class="string">&quot;xiaohong&quot;</span>&#125;, &#123;<span class="attr">age</span>: <span class="number">15</span>, <span class="attr">name</span>: <span class="string">&quot;xiaolan&quot;</span>&#125;];</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> newUsers = users.<span class="title function_">map</span>(<span class="function"><span class="params">ele</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            ele.<span class="property">age</span> += <span class="number">1</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span> ele;</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(newUsers);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 将数组不断依次 取出两个 相加后赋值到原来的位置 直至参数不够 一次性出去两个</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">/*</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        * 1 2 3 4</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        * =&gt; 1 + 2 = 3</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        * 3 3 4</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        * =&gt; 3 + 3 = 6</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        * 6 4</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        * =&gt; 6 + 4 = 10</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        * log 10</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        * */</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> result = arr.<span class="title function_">reduce</span>(<span class="keyword">function</span> (<span class="params">a, b</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span> a + b;</span></span><br><span class="line"><span class="language-javascript">        &#125;)</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;result==&gt;&quot;</span> + result);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="5-npm包管理器"><a href="#5-npm包管理器" class="headerlink" title="5. npm包管理器"></a>5. npm包管理器</h2><blockquote>
<p><strong>npm包管理器简介</strong></p>
</blockquote>
<p>官网：<a target="_blank" rel="noopener" href="https://www.npmjs.com/">https://www.npmjs.com/</a></p>
<p>npm全球Node Package Manager 是Nodejs包管理工具 号称全球最大的模块生态系统 里面所有的模块都是开源免费的 也是Nodejs的包管理工具 相当于前端的Maven 地位对比Maven在Java中的地位</p>
<p>简单操作：</p>
<ul>
<li><p><code>npm -v</code> 查看当前npm 版本 –在安装nodejs时 会自动安装npm</p>
</li>
<li><p>用于 快速构建 nodejs 工程 和 快速安装依赖与第三方模块 如 <code>npm install redis</code>  <code>npm install mysql</code></p>
</li>
<li><p>项目骨架构建步骤：</p>
<ol>
<li><p>创建文件夹 并在文件夹中 执行 <code>npm init</code> 选择对应需要的参数 构建npm 项目 使用 <code>npm inti -y</code> 可以一键默认值创建项目初始化</p>
</li>
<li><p>得到package.json 即 在执行 <code>npm init</code> 时选择的参数与信息<br>package.json 类似于 pom.xml 文件用于管理第三方依赖</p>
</li>
<li><p>快速安装第三方依赖 通过 <code>npm install xxx</code> 或者 <code>npm i redis模块名</code> 来安装第三方依赖</p>
<p>执行命令后 会自动生成 node_modules 文件夹来存放第三方项目依赖</p>
<p>安装完成后 require 导入依赖并使用 –<strong>参考官方文档</strong></p>
<p>通过 <code>npm install xxx</code> 安装的依赖会 记录在package.json 这个文件中 就类似于maven 将依赖以及项目信息记录在 pom.xml中类似 </p>
<p>记录的作用在于 –&gt; 便于复用 所安装的依赖 同时 适配版本</p>
<p><em>不直接拷贝node_modules文件夹的原因是 一个完整的前端项目 所包含的node_modules第三方依赖数量较为庞大 可能多大上万个文件 直接拷贝的速率会相当低 同时也存在版本更新问题</em></p>
</li>
<li><p>更改 npm 镜像 为淘宝镜像</p>
<p><code>npm install -g cnpm --registry=https://registry.npm.taobao.org</code></p>
</li>
<li><p>一次性下载多个依赖<code>npm install redis jquery@1.4.5 mysql</code><br>具体版本号查看官网 <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/redis">https://www.npmjs.com/package/redis</a></p>
</li>
<li><p>卸载模块 通过<code>npm uninstall veu redis</code></p>
</li>
</ol>
</li>
</ul>
<h2 id="6-Babel"><a href="#6-Babel" class="headerlink" title="6. Babel"></a>6. Babel</h2><blockquote>
<p><strong>Babel 简介</strong></p>
</blockquote>
<p>ES6的部分高级语法 在浏览器甚至Nodejs环境中无法运行</p>
<p>Babel 是一个广泛的转码器 用于将ES6转码成ES5代码 从而能满足Nodejs和浏览器的环境适配 –即可以使用ES6代码规范 语法糖来编写程序 而不用担心环境是否支持</p>
<p>官网：<a target="_blank" rel="noopener" href="https://www.babeljs.cn/">https://www.babeljs.cn/</a></p>
<p><strong>Babel 自带了一个内置的 CLI 命令行工具 –babe-cli，可通过命令行编译文件。</strong></p>
<p>此外，各种可直接调用脚本都存放在 <code>@babel/cli/bin</code> 中。一个可通过 shell 执行的实用脚本 - <code>babel-external-helpers.js</code>，以及 Babel cli 主脚本 <code>babel.js</code>。</p>
<blockquote>
<p><strong>安装以及简单操作步骤</strong></p>
</blockquote>
<p>命令行安装babel转码工具 –babel提供babel-cli工具 用于命令行 转码</p>
<p><strong>具体安装步骤：</strong></p>
<ol>
<li><p><code>npm install -g babel cli</code> 安装babel-cli 工具 –实际操作不确定成功</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// 若不成功 则使用以下命令</span><br><span class="line">cnpm install babel -g</span><br><span class="line">cnpm install babel-cli -g</span><br></pre></td></tr></table></figure>


</li>
<li><p><code>babel --version</code> 查看是否安装成功 以及版本</p>
</li>
</ol>
<p><strong>简单应用操作：</strong></p>
<ol>
<li><p>创建babel工程文件夹</p>
</li>
<li><p>初始化项目 <code>npm init -y</code></p>
</li>
<li><p>创建文件src&#x2F;example.js 并编写一段ES6代码</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 转码前</span></span><br><span class="line"><span class="comment">// 定义数据</span></span><br><span class="line"><span class="keyword">let</span> input = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="comment">// 将数组每个元素都 + 1</span></span><br><span class="line">input = input.<span class="title function_">map</span>( <span class="function"><span class="params">params</span> =&gt;</span> params + <span class="number">1</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(input)</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置 .babelrc<br>babel的配置文件是 .babelrc 存放在项目的根目录下 该文件用来设置转码规则和插件 基本格式如下</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;presets&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;plugins&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>presets字段设定转码规则 将ES2015规则加入 .babelrc</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;presets&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;es2015&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;plugins&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>使用命令<code>npm install --save-dev babel-preset-es2015</code>安装转码器 在项目中安装</p>
</li>
<li><p>通过执行 <code>babel src -d dist</code>命令进行 转换</p>
</li>
</ol>
<blockquote>
<p><strong>自定义脚本运行babel</strong></p>
</blockquote>
<p>具体操作步骤：</p>
<ol>
<li><p>改写package.json</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">    <span class="attr">&quot;script&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">        <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="string">&quot;babel src\\example.js -o dist\\compiled.js&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>转码时 执行以下命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir dist</span><br><span class="line">npm run build</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="7-模块化"><a href="#7-模块化" class="headerlink" title="7. 模块化"></a>7. 模块化</h2><blockquote>
<p><strong>模块化简介</strong></p>
</blockquote>
<p><strong>模块化产生背景</strong></p>
<p>随着网站逐渐变成 “互联网应用程序” 嵌入网页的JavaScript代码也越来越庞大 越来越复杂</p>
<p>JavaScript模块化编程 成为一种迫切需求 在模块化开发下 开发者只需要实现核心业务逻辑 其他只需要加载第三方模块 但早年的JavaScript并不是一种模块化编程语言 它不支持 类class 包package 等概念 也不支持模块 module</p>
<p>故而JavaScript需要进阶成模块化编程</p>
<p><strong>模块化规范</strong></p>
<ul>
<li>CommonJS模块化规范 –require mysql require app</li>
<li>ES6模块化规范 –vue uniapp</li>
</ul>
<blockquote>
<p><strong>CommonJS模块化规范</strong></p>
</blockquote>
<p>需要导入的工具类：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 工具类</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">sum</span> = (<span class="params">a, b</span>) =&gt; a + b;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">sub</span> = (<span class="params">a, b</span>) =&gt; a - b;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">mul</span> = (<span class="params">a, b</span>) =&gt; a * b;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">di</span> = (<span class="params">a, b</span>) =&gt; a / b;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入工具类 提供给别人使用</span></span><br><span class="line"><span class="comment">// module.exports = &#123;</span></span><br><span class="line"><span class="comment">//     sum: sum,</span></span><br><span class="line"><span class="comment">//     sub: sub,</span></span><br><span class="line"><span class="comment">//     mul: mul,</span></span><br><span class="line"><span class="comment">//     di: di,</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 必须要导出才能是外部引用使用</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    sum,</span><br><span class="line">    sub,</span><br><span class="line">    mul,</span><br><span class="line">    di</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// common js 模块化规范</span></span><br></pre></td></tr></table></figure>

<p>导出测试：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用 require 导入自己写的工具类</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> util = <span class="built_in">require</span>(<span class="string">&#x27;./common.js&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(util.<span class="title function_">sum</span>(<span class="number">1</span>, <span class="number">2</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(util.<span class="title function_">sub</span>(<span class="number">1</span>, <span class="number">2</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(util.<span class="title function_">mul</span>(<span class="number">1</span>, <span class="number">2</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(util.<span class="title function_">di</span>(<span class="number">1</span>, <span class="number">2</span>));</span><br></pre></td></tr></table></figure>



<blockquote>
<p><strong>ES6模块化规范</strong></p>
</blockquote>
<p><strong>ES6 使用export 与 import 来实现 导入导入模块</strong></p>
<p>ES6 export 与 import</p>
<p>es6.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getList</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 真实业务中 异步获取 数据</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;获取数据列表&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">addData</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 真实业务中 异步获取 数据</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;保存数据&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>es6-plus.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 新版es6 export 与 import 写法</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="title function_">addData</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 真实业务中 异步获取 数据</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;保存数据&quot;</span>);</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="title function_">getList</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// 真实业务中 异步获取 数据</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;获取数据列表&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>test.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用 require 导入自己写的工具类</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> util = <span class="built_in">require</span>(<span class="string">&#x27;./common.js&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(util.<span class="title function_">sum</span>(<span class="number">1</span>, <span class="number">2</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(util.<span class="title function_">sub</span>(<span class="number">1</span>, <span class="number">2</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(util.<span class="title function_">mul</span>(<span class="number">1</span>, <span class="number">2</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(util.<span class="title function_">di</span>(<span class="number">1</span>, <span class="number">2</span>));</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;-----------------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注意 默认不支持 ES6 语法 import 需要将其 使用babel 降级 打包成ES5 语法</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123;getList, addData&#125; <span class="keyword">from</span> <span class="string">&#x27;./es6&#x27;</span></span><br><span class="line"><span class="title function_">getList</span>();</span><br><span class="line"><span class="title function_">addData</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;-----------------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> util2 <span class="keyword">from</span> <span class="string">&#x27;./es6-plus&#x27;</span></span><br><span class="line">util2.<span class="title function_">addData</span>();</span><br><span class="line">util2.<span class="title function_">getList</span>();</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><strong>注意：</strong>&#x3D;&#x3D;默认不支持 ES6 语法 import 需要将其 使用babel 降级 打包成ES5 语法后 执行&#x3D;&#x3D;</p>
<h2 id="8-Webpack"><a href="#8-Webpack" class="headerlink" title="8. Webpack"></a>8. Webpack</h2><blockquote>
<p><strong>Webpack简介</strong></p>
</blockquote>
<p>Webpack是一个前端资源加载&#x2F;打包工具 它根据模块的依赖关系进行静态分析 将这些模块按照指定规则生成对应的静态资源 Webpack可以将多种静态资源 js css less 转换 成一个静态文件 从而减少了页面的请求</p>
<p>官网：<a target="_blank" rel="noopener" href="https://webpack.docschina.org/">https://webpack.docschina.org/</a></p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/image-20220925143327685.png" alt="image-20220925143327685"></p>
<p>不仅将静态资源整合 同时也集成 编译 babel 以及 vue 里面的一些功能</p>
<blockquote>
<p><strong>Webpack安装及使用</strong></p>
</blockquote>
<p><strong>webpack安装</strong></p>
<p>具体操作步骤：</p>
<ol>
<li>使用<code>npm install -g webpack-cli</code> 全局安装</li>
<li><code>webpack -v</code> 查看安装后的版本号</li>
</ol>
<p>Todo</p>
<p>注意解决 Webpack与webpack-dev-server 版本不兼容问题</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">解决installed问题</span><br><span class="line">PS E:\aPersonalData\vue\Projects\Test\demo-04-webpack&gt; webpack -v</span><br><span class="line">webpack: 5.74.0</span><br><span class="line">webpack-cli: 4.10.0</span><br><span class="line">webpack-dev-server not installed</span><br><span class="line"></span><br><span class="line">执行 npm install --save-dev webpack-dev-server </span><br></pre></td></tr></table></figure>



<p><strong>webpack合并JS 打包</strong></p>
<p>具体操作步骤：</p>
<ol>
<li>创建一个nodejs项目 目录名为demo-04-webpack <code>npm init -y</code></li>
<li>创建一个src目录</li>
<li>在src中存放两个需要合并的util.js 和 common.js</li>
<li>准备一个入口文件 main.js 即模块集中进行引用</li>
<li>准备进行 JS打包 在根目录下定义一个webpack.config.js文件配置打包规则</li>
<li>执行 <code>webpack</code> 查看效果</li>
<li>执行 <code>webpack -w</code> 可以实现监听文件改动 实现热更新</li>
</ol>
<p>README.md</p>
<figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">1.</span> 创建一个nodejs项目 npm init -y</span><br><span class="line"><span class="bullet">2.</span> 创建一个src目录</span><br><span class="line"><span class="bullet">3.</span> 在src中存放两个需要合并的util.js 和 common.js</span><br><span class="line"><span class="bullet">4.</span> 准备一个入口文件 main.js 即模块集中进行引用</span><br><span class="line"></span><br><span class="line">// JS打包</span><br><span class="line"><span class="bullet">5.</span> 在根目录下定义一个webpack.config.js文件配置打包规则</span><br><span class="line"><span class="bullet">6.</span> 执行webpack查看效果</span><br></pre></td></tr></table></figure>



<p>util.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 相加函数</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">add</span> =  <span class="function">(<span class="params">a, b</span>) =&gt;</span> a + b;</span><br></pre></td></tr></table></figure>



<p>common.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 输出案例</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">info</span> = <span class="keyword">function</span> (<span class="params">str</span>) &#123;</span><br><span class="line">    <span class="comment">// 向控制台输出</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(str);</span><br><span class="line">    <span class="comment">// 向浏览器输出</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">writeln</span>(str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>main.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入 util</span></span><br><span class="line"><span class="keyword">const</span> util = <span class="built_in">require</span>(<span class="string">&#x27;./util&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入 common</span></span><br><span class="line"><span class="keyword">const</span>  common = <span class="built_in">require</span>(<span class="string">&#x27;./common&#x27;</span>);</span><br><span class="line"></span><br><span class="line">common.<span class="title function_">info</span>(<span class="string">&quot;hello world&quot;</span> + util.<span class="title function_">add</span>(<span class="number">1</span>,<span class="number">32</span>));</span><br></pre></td></tr></table></figure>



<p>webpack.config.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入 path模块 nodejs的内置模块</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义JS 打包规则</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="comment">// 入口函数 从哪里开始进行编译打包</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">entry</span>: <span class="string">&quot;./src/main.js&quot;</span>,</span><br><span class="line">    <span class="comment">// 编译成功后 把内容输出到...</span></span><br><span class="line">    <span class="attr">output</span>: &#123;</span><br><span class="line">        <span class="comment">// 定义输出指定的目录 __dirname 为一个常量 --&gt; 当前项目根目录 产生一个 dist 文件夹</span></span><br><span class="line">        <span class="attr">path</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&quot;./dist&quot;</span>),</span><br><span class="line">        <span class="comment">// 最终生成 合并的 js 文件存储在dist/bundle.js 文件中</span></span><br><span class="line">        <span class="attr">filename</span>: <span class="string">&quot;bundle.js&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>webpack合并CSS 打包</strong></p>
<p>webpack本身只能处理 JavaScript 模块 如需处理其他类型文件 就需要使用loader进行转换  loader可以理解为模块与资源的转换器</p>
<p>在使用 loader 时 需要安装 相关 loader 插件</p>
<ul>
<li>css-loader 是将 css 装载到 JavaScript</li>
<li>style-loader 是使得 JavaScript 能识别 css</li>
</ul>
<p>具体操作步骤：</p>
<ol>
<li>执行 <code>npm install --save-dev style-loader css-loader</code> 安装 style-loader 和 css-loader</li>
<li>修改 配置webpack.config.js</li>
<li>在src目录下 创建 style.css</li>
<li>修改 main.js 在第一行 引入 style.css</li>
<li>将 <code>webpack -w</code> 写进package.json中 运行 <code>npm run dev</code> 编译命令</li>
</ol>
<p>style.css</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: yellow;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>main.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入 util</span></span><br><span class="line"><span class="keyword">const</span> util = <span class="built_in">require</span>(<span class="string">&#x27;./util&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入 common</span></span><br><span class="line"><span class="keyword">const</span>  common = <span class="built_in">require</span>(<span class="string">&#x27;./common&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入css</span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">&quot;./style.css&quot;</span>)</span><br><span class="line"></span><br><span class="line">common.<span class="title function_">info</span>(<span class="string">&quot;hello world&quot;</span> + util.<span class="title function_">add</span>(<span class="number">1</span>,<span class="number">32</span>));</span><br></pre></td></tr></table></figure>



<p>webpack.config.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入 path模块 nodejs的内置模块</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义JS 打包规则</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="comment">// 入口函数 从哪里开始进行编译打包</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">entry</span>: <span class="string">&quot;./src/main.js&quot;</span>,</span><br><span class="line">    <span class="comment">// 编译成功后 把内容输出到...</span></span><br><span class="line">    <span class="attr">output</span>: &#123;</span><br><span class="line">        <span class="comment">// 定义输出指定的目录 __dirname 为一个常量 --&gt; 当前项目根目录 产生一个 dist 文件夹</span></span><br><span class="line">        <span class="attr">path</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&quot;./dist&quot;</span>),</span><br><span class="line">        <span class="comment">// 最终生成 合并的 js 文件存储在dist/bundle.js 文件中</span></span><br><span class="line">        <span class="attr">filename</span>: <span class="string">&quot;bundle.js&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">module</span>: &#123;</span><br><span class="line">        <span class="attr">rules</span>: [&#123;</span><br><span class="line">            <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="comment">//将项目中 所有的.css 结尾的文件 都进行打包</span></span><br><span class="line">            <span class="attr">use</span>: [<span class="string">&quot;style-loader&quot;</span>, <span class="string">&quot;css-loader&quot;</span>]</span><br><span class="line">        &#125;]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>package.json</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;demo-04-webpack&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;main&quot;</span><span class="punctuation">:</span> <span class="string">&quot;index.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;test&quot;</span><span class="punctuation">:</span> <span class="string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;dev&quot;</span><span class="punctuation">:</span> <span class="string">&quot;webpack -w&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;keywords&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;author&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;license&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ISC&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;devDependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;css-loader&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^6.7.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;style-loader&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^3.3.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;webpack-dev-server&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^4.11.1&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="9-Vue-element-admin"><a href="#9-Vue-element-admin" class="headerlink" title="9. Vue-element-admin"></a>9. Vue-element-admin</h2><blockquote>
<p><strong>Vue-element-admin简介</strong></p>
</blockquote>
<p>Vue-element-admin 是一个 后台前端解决方案 基于vue 与element-ui 实现 它使用了最新的前端技术栈 内置了i18n 国际化解决方案 动态路由 权限认证 提炼了最具典型的业务模型 提供了丰富的功能插件 可以帮助你快速搭建企业级中后台产品原型 </p>
<p>官网：<a target="_blank" rel="noopener" href="https://panjiachen.github.io/vue-element-admin-site/zh/">https://panjiachen.github.io/vue-element-admin-site/zh/</a></p>
<h2 id="10-AntDesign"><a href="#10-AntDesign" class="headerlink" title="10. AntDesign"></a>10. AntDesign</h2><h2 id="11-package-json"><a href="#11-package-json" class="headerlink" title="11. package.json"></a>11. package.json</h2>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Linyuxuan"
      src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/252/05.jpg">
  <p class="site-author-name" itemprop="name">Linyuxuan</p>
  <div class="site-description" itemprop="description">Hope Sometimes Love Brain</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">16</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2020 – 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa-gift"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Linyuxuan</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/pjax/pjax.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script>




  















    <div id="pjax">
  

  

    </div>
</body>
</html>
